[2024-08-03 13:24:04,133] {logger:43} INFO - run_experiment.py, args: Namespace(experiment='exp002_C')
================================================================================
[2024-08-03 13:24:04,133] {logger:44} INFO - config:
[2024-08-03 13:24:04,133] {logger:45} INFO - parameter name      | parameter value
[2024-08-03 13:24:04,133] {logger:46} INFO - experiment          : exp002_C
[2024-08-03 13:24:04,134] {logger:46} INFO - RUN_NAME            : exp002_C_2024-08-03_13-24-04
[2024-08-03 13:24:04,134] {logger:46} INFO - DEVICE              : cuda
[2024-08-03 13:24:04,134] {logger:46} INFO - EXPERIMENT_DIR      : /home/s202283/code/grieger_validation/results/exp002_C
[2024-08-03 13:24:04,134] {logger:46} INFO - MODELS_DIR          : /home/s202283/code/grieger_validation/results/exp002_C/models
[2024-08-03 13:24:04,134] {logger:46} INFO - VISUALS_DIR         : /home/s202283/code/grieger_validation/results/exp002_C/visuals/exp002_C_2024-08-03_13-24-04
[2024-08-03 13:24:04,134] {logger:46} INFO - DATA_DIR            : /scratch/s202283/data/mice-data-tuebingen/data
[2024-08-03 13:24:04,134] {logger:46} INFO - SAMPLE_DURATION     : 10
[2024-08-03 13:24:04,134] {logger:46} INFO - SAMPLING_RATE       : 64
[2024-08-03 13:24:04,134] {logger:46} INFO - SCORING_MAP         : {'Wake': [1, 17], 'REM': [3, 19], 'Non REM': [2, 18], 'Pre REM': [4, 20], 'Artifact': [8, 24]}
[2024-08-03 13:24:04,134] {logger:46} INFO - STAGE_MAP           : {'Wake': 'Wake', 'REM': 'REM', 'Non REM': 'Non REM', 'Pre REM': 'Non REM', 'Artifact': None}
[2024-08-03 13:24:04,134] {logger:46} INFO - DATA_SPLIT          : {'train': ['M19', 'M20', 'M21', 'M22', 'M23', 'M24', 'M25', 'M26', 'M27', 'M28', 'M29', 'M31', 'M32', 'M33'], 'valid': ['M34', 'M35'], 'test': ['M36', 'M37']}
[2024-08-03 13:24:04,134] {logger:46} INFO - DATA_FILE           : /home/s202283/code/grieger_validation/cache/dataset/data_tuebingen_main_stages.h5
[2024-08-03 13:24:04,134] {logger:46} INFO - STAGES              : ['Wake', 'REM', 'Non REM']
[2024-08-03 13:24:04,134] {logger:46} INFO - BALANCED_TRAINING   : True
[2024-08-03 13:24:04,134] {logger:46} INFO - BALANCING_WEIGHTS   : [0.41, 0.25, 0.34]
[2024-08-03 13:24:04,134] {logger:46} INFO - CHANNELS            : ['EEG_PR']
[2024-08-03 13:24:04,134] {logger:46} INFO - SAMPLES_LEFT        : 1
[2024-08-03 13:24:04,134] {logger:46} INFO - SAMPLES_RIGHT       : 1
[2024-08-03 13:24:04,134] {logger:46} INFO - LOG_INTERVAL        : 10
[2024-08-03 13:24:04,134] {logger:46} INFO - EXTRA_SAFE_MODELS   : False
[2024-08-03 13:24:04,134] {logger:46} INFO - BATCH_SIZE          : 256
[2024-08-03 13:24:04,135] {logger:46} INFO - DATA_FRACTION       : 1.0
[2024-08-03 13:24:04,135] {logger:46} INFO - DATA_FRACTION_STRAT : None
[2024-08-03 13:24:04,135] {logger:46} INFO - EPOCHS              : 50
[2024-08-03 13:24:04,135] {logger:46} INFO - WARMUP_EPOCHS       : 12
[2024-08-03 13:24:04,135] {logger:46} INFO - S_OPTIM_MODE        : exp
[2024-08-03 13:24:04,135] {logger:46} INFO - S_OPTIM_PARAS       : [0.06]
[2024-08-03 13:24:04,135] {logger:46} INFO - LEARNING_RATE       : 0.000256
[2024-08-03 13:24:04,135] {logger:46} INFO - OPTIMIZER           : <class 'torch.optim.adam.Adam'>
[2024-08-03 13:24:04,135] {logger:46} INFO - OPTIM_PARAS         : {}
[2024-08-03 13:24:04,135] {logger:46} INFO - L1_WEIGHT_DECAY     : 0
[2024-08-03 13:24:04,135] {logger:46} INFO - L2_WEIGHT_DECAY     : 0.0001
[2024-08-03 13:24:04,135] {logger:46} INFO - BATCH_SIZE_EVAL     : 512
[2024-08-03 13:24:04,135] {logger:46} INFO - FILTERS             : 96
[2024-08-03 13:24:04,135] {logger:46} INFO - CLASSIFIER_DROPOUT  : [0.2, 0.2]
[2024-08-03 13:24:04,135] {logger:46} INFO - FEATURE_EXTR_DROPOUT: [0.0, 0.2, 0.0, 0.2, 0.0, 0.2, 0.0, 0.2]
[2024-08-03 13:24:04,135] {logger:46} INFO - MODEL_NAME          : model_8conv_2fc
[2024-08-03 13:24:04,135] {logger:46} INFO - GAIN                : 0.0
[2024-08-03 13:24:04,135] {logger:46} INFO - FLIP                : 0.0
[2024-08-03 13:24:04,135] {logger:46} INFO - FLIP_ALL            : 0.0
[2024-08-03 13:24:04,135] {logger:46} INFO - WINDOW_WARP_SIZE    : 0.0
[2024-08-03 13:24:04,135] {logger:46} INFO - FLIP_HORI           : 0.0
[2024-08-03 13:24:04,135] {logger:46} INFO - TIME_SHIFT          : 0.0
[2024-08-03 13:24:04,136] {logger:50} INFO - 
[2024-08-03 13:24:04,136] {logger:51} INFO - ================================================================================
[2024-08-03 13:24:04,136] {logger:52} INFO - start training with model: model_8conv_2fc
[2024-08-03 13:24:04,136] {logger:53} INFO - ================================================================================
[2024-08-03 13:24:04,136] {logger:54} INFO - 
[2024-08-03 13:24:15,369] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-03 13:24:15,394] {dataloader:147} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2024-08-03 13:24:16,701] {dataloader:120} INFO - data distribution in database for dataset valid:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 20704
[2024-08-03 13:24:16,705] {dataloader:147} INFO - data distribution after processing:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 20704
[2024-08-03 13:24:20,287] {run_experiment:48} INFO - classifier:
Model(
  (feature_extractor): Sequential(
    (0): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): Conv1d(1, 96, kernel_size=(5,), stride=(1,))
    (2): ReLU(inplace=True)
    (3): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): Dropout(p=0.0, inplace=False)
    (5): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (6): ReLU(inplace=True)
    (7): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): Dropout(p=0.2, inplace=False)
    (9): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (10): ReLU(inplace=True)
    (11): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (12): Dropout(p=0.0, inplace=False)
    (13): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (14): ReLU(inplace=True)
    (15): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (16): Dropout(p=0.2, inplace=False)
    (17): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (18): ReLU(inplace=True)
    (19): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (20): Dropout(p=0.0, inplace=False)
    (21): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (22): ReLU(inplace=True)
    (23): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (24): Dropout(p=0.2, inplace=False)
    (25): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (26): ReLU(inplace=True)
    (27): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (28): Dropout(p=0.0, inplace=False)
    (29): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (30): ReLU(inplace=True)
    (31): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (32): Dropout(p=0.2, inplace=False)
  )
  (classifier): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=10848, out_features=80, bias=True)
    (2): ReLU(inplace=True)
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=80, out_features=3, bias=True)
  )
)
[2024-08-03 13:24:42,470] {train_model:82} INFO - Train Epoch: 1 [36352/366120 (10%)]	lr:2.56e-05	Loss: 63.156487
[2024-08-03 13:24:55,407] {train_model:82} INFO - Train Epoch: 1 [72960/366120 (20%)]	lr:2.56e-05	Loss: 66.931725
[2024-08-03 13:25:08,382] {train_model:82} INFO - Train Epoch: 1 [109568/366120 (30%)]	lr:2.56e-05	Loss: 63.778580
[2024-08-03 13:25:21,416] {train_model:82} INFO - Train Epoch: 1 [146176/366120 (40%)]	lr:2.56e-05	Loss: 48.204147
[2024-08-03 13:25:34,414] {train_model:82} INFO - Train Epoch: 1 [182784/366120 (50%)]	lr:2.56e-05	Loss: 49.180183
[2024-08-03 13:25:47,522] {train_model:82} INFO - Train Epoch: 1 [219392/366120 (60%)]	lr:2.56e-05	Loss: 47.083061
[2024-08-03 13:26:00,635] {train_model:82} INFO - Train Epoch: 1 [256000/366120 (70%)]	lr:2.56e-05	Loss: 36.741589
[2024-08-03 13:26:13,757] {train_model:82} INFO - Train Epoch: 1 [292608/366120 (80%)]	lr:2.56e-05	Loss: 22.139324
[2024-08-03 13:26:26,922] {train_model:82} INFO - Train Epoch: 1 [329216/366120 (90%)]	lr:2.56e-05	Loss: 22.389151
[2024-08-03 13:26:43,469] {train_model:82} INFO - Train Epoch: 1 [365824/366120 (100%)]	lr:2.56e-05	Loss: 25.653593
[2024-08-03 13:26:50,301] {run_experiment:79} INFO - 
[2024-08-03 13:26:50,301] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-03 13:26:51,026] {result_logger:103} INFO - precision on Wake: 0.576
[2024-08-03 13:26:51,512] {result_logger:104} INFO - recall on Wake: 0.502
[2024-08-03 13:26:51,996] {result_logger:107} INFO - F1-score on Wake: 0.537
[2024-08-03 13:26:51,996] {result_logger:108} INFO - 
[2024-08-03 13:26:52,758] {result_logger:103} INFO - precision on REM: 0.416
[2024-08-03 13:26:53,240] {result_logger:104} INFO - recall on REM: 0.535
[2024-08-03 13:26:53,731] {result_logger:107} INFO - F1-score on REM: 0.468
[2024-08-03 13:26:53,731] {result_logger:108} INFO - 
[2024-08-03 13:26:54,483] {result_logger:103} INFO - precision on Non REM: 0.664
[2024-08-03 13:26:55,006] {result_logger:104} INFO - recall on Non REM: 0.627
[2024-08-03 13:26:55,505] {result_logger:107} INFO - F1-score on Non REM: 0.645
[2024-08-03 13:26:55,505] {result_logger:108} INFO - 
[2024-08-03 13:26:55,632] {result_logger:111} INFO - average precision on sleep stages: 0.552
[2024-08-03 13:26:55,758] {result_logger:113} INFO - average recall on sleep stages: 0.555
[2024-08-03 13:26:55,884] {result_logger:115} INFO - average F1-score on sleep stages: 0.550
[2024-08-03 13:26:55,886] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-03 13:26:55,986] {result_logger:103} INFO - precision on Wake: 0.695
[2024-08-03 13:26:56,047] {result_logger:104} INFO - recall on Wake: 0.936
[2024-08-03 13:26:56,110] {result_logger:107} INFO - F1-score on Wake: 0.798
[2024-08-03 13:26:56,110] {result_logger:108} INFO - 
[2024-08-03 13:26:56,208] {result_logger:103} INFO - precision on REM: 0.430
[2024-08-03 13:26:56,274] {result_logger:104} INFO - recall on REM: 0.659
[2024-08-03 13:26:56,336] {result_logger:107} INFO - F1-score on REM: 0.520
[2024-08-03 13:26:56,336] {result_logger:108} INFO - 
[2024-08-03 13:26:56,436] {result_logger:103} INFO - precision on Non REM: 0.978
[2024-08-03 13:26:56,499] {result_logger:104} INFO - recall on Non REM: 0.450
[2024-08-03 13:26:56,565] {result_logger:107} INFO - F1-score on Non REM: 0.616
[2024-08-03 13:26:56,565] {result_logger:108} INFO - 
[2024-08-03 13:26:56,579] {result_logger:111} INFO - average precision on sleep stages: 0.701
[2024-08-03 13:26:56,592] {result_logger:113} INFO - average recall on sleep stages: 0.681
[2024-08-03 13:26:56,605] {result_logger:115} INFO - average F1-score on sleep stages: 0.645
[2024-08-03 13:26:56,605] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-03 13:26:56,697] {result_logger:134} INFO - 
[[75400 48120 26587]
 [29588 49003 12940]
 [25851 20617 78014]]
[2024-08-03 13:26:56,782] {result_logger:141} INFO - 
[[ 50.23%  32.06%  17.71%]
 [ 32.33%  53.54%  14.14%]
 [ 20.77%  16.56%  62.67%]]
[2024-08-03 13:26:56,867] {result_logger:145} INFO - 
[[ 57.63%  40.87%  22.62%]
 [ 22.61%  41.62%  11.01%]
 [ 19.76%  17.51%  66.37%]]
[2024-08-03 13:26:56,867] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-03 13:26:56,876] {result_logger:134} INFO - 
[[26574  1611   197]
 [  858  1676    11]
 [10787   610  9306]]
[2024-08-03 13:26:57,116] {result_logger:141} INFO - 
[[ 93.63%   5.68%   0.69%]
 [ 33.71%  65.85%   0.43%]
 [ 52.10%   2.95%  44.95%]]
[2024-08-03 13:26:57,253] {result_logger:145} INFO - 
[[ 69.53%  41.34%   2.07%]
 [  2.24%  43.01%   0.12%]
 [ 28.22%  15.65%  97.81%]]
[2024-08-03 13:26:57,635] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-03 13:26:57,635] {result_logger:77} INFO - actual:
[2024-08-03 13:26:57,635] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-03 13:26:57,635] {result_logger:79} INFO - predicted:
[2024-08-03 13:26:57,635] {result_logger:80} INFO - 
[[89.37%  5.25%  5.38%]
 [56.02% 42.34%  1.64%]
 [19.76%  2.51% 77.73%]]
[2024-08-03 13:26:57,719] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_C/model_8conv_2fc-best.pth
[2024-08-03 13:26:57,719] {run_experiment:113} INFO - [epoch   1] execution time: 157.43s	 avg f1-score: 0.6448

[2024-08-03 13:26:57,719] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-03 13:26:57,744] {dataloader:147} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2024-08-03 13:27:17,339] {train_model:82} INFO - Train Epoch: 2 [36352/366120 (10%)]	lr:4.65e-05	Loss: 12.984453
[2024-08-03 13:27:30,382] {train_model:82} INFO - Train Epoch: 2 [72960/366120 (20%)]	lr:4.65e-05	Loss: 20.385277
[2024-08-03 13:27:43,597] {train_model:82} INFO - Train Epoch: 2 [109568/366120 (30%)]	lr:4.65e-05	Loss: 9.496880
[2024-08-03 13:27:56,797] {train_model:82} INFO - Train Epoch: 2 [146176/366120 (40%)]	lr:4.65e-05	Loss: 7.713875
[2024-08-03 13:28:09,995] {train_model:82} INFO - Train Epoch: 2 [182784/366120 (50%)]	lr:4.65e-05	Loss: 7.110062
[2024-08-03 13:28:23,485] {train_model:82} INFO - Train Epoch: 2 [219392/366120 (60%)]	lr:4.65e-05	Loss: 6.251803
[2024-08-03 13:28:36,744] {train_model:82} INFO - Train Epoch: 2 [256000/366120 (70%)]	lr:4.65e-05	Loss: 5.520735
[2024-08-03 13:28:50,043] {train_model:82} INFO - Train Epoch: 2 [292608/366120 (80%)]	lr:4.65e-05	Loss: 6.564383
[2024-08-03 13:29:03,407] {train_model:82} INFO - Train Epoch: 2 [329216/366120 (90%)]	lr:4.65e-05	Loss: 9.270862
[2024-08-03 13:29:21,460] {train_model:82} INFO - Train Epoch: 2 [365824/366120 (100%)]	lr:4.65e-05	Loss: 5.027613
[2024-08-03 13:29:28,684] {run_experiment:79} INFO - 
[2024-08-03 13:29:28,684] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-03 13:29:29,493] {result_logger:103} INFO - precision on Wake: 0.744
[2024-08-03 13:29:30,000] {result_logger:104} INFO - recall on Wake: 0.744
[2024-08-03 13:29:30,508] {result_logger:107} INFO - F1-score on Wake: 0.744
[2024-08-03 13:29:30,508] {result_logger:108} INFO - 
[2024-08-03 13:29:31,242] {result_logger:103} INFO - precision on REM: 0.727
[2024-08-03 13:29:31,722] {result_logger:104} INFO - recall on REM: 0.748
[2024-08-03 13:29:32,205] {result_logger:107} INFO - F1-score on REM: 0.737
[2024-08-03 13:29:32,205] {result_logger:108} INFO - 
[2024-08-03 13:29:33,001] {result_logger:103} INFO - precision on Non REM: 0.826
[2024-08-03 13:29:33,506] {result_logger:104} INFO - recall on Non REM: 0.808
[2024-08-03 13:29:33,976] {result_logger:107} INFO - F1-score on Non REM: 0.817
[2024-08-03 13:29:33,976] {result_logger:108} INFO - 
[2024-08-03 13:29:34,091] {result_logger:111} INFO - average precision on sleep stages: 0.765
[2024-08-03 13:29:34,210] {result_logger:113} INFO - average recall on sleep stages: 0.767
[2024-08-03 13:29:34,329] {result_logger:115} INFO - average F1-score on sleep stages: 0.766
[2024-08-03 13:29:34,331] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-03 13:29:34,427] {result_logger:103} INFO - precision on Wake: 0.707
[2024-08-03 13:29:34,486] {result_logger:104} INFO - recall on Wake: 0.989
[2024-08-03 13:29:34,543] {result_logger:107} INFO - F1-score on Wake: 0.825
[2024-08-03 13:29:34,543] {result_logger:108} INFO - 
[2024-08-03 13:29:34,637] {result_logger:103} INFO - precision on REM: 0.743
[2024-08-03 13:29:34,693] {result_logger:104} INFO - recall on REM: 0.590
[2024-08-03 13:29:34,753] {result_logger:107} INFO - F1-score on REM: 0.658
[2024-08-03 13:29:34,753] {result_logger:108} INFO - 
[2024-08-03 13:29:34,849] {result_logger:103} INFO - precision on Non REM: 0.980
[2024-08-03 13:29:34,905] {result_logger:104} INFO - recall on Non REM: 0.469
[2024-08-03 13:29:34,961] {result_logger:107} INFO - F1-score on Non REM: 0.635
[2024-08-03 13:29:34,961] {result_logger:108} INFO - 
[2024-08-03 13:29:34,972] {result_logger:111} INFO - average precision on sleep stages: 0.810
[2024-08-03 13:29:34,983] {result_logger:113} INFO - average recall on sleep stages: 0.683
[2024-08-03 13:29:34,995] {result_logger:115} INFO - average F1-score on sleep stages: 0.706
[2024-08-03 13:29:34,995] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-03 13:29:35,075] {result_logger:134} INFO - 
[[111686  21263  17161]
 [ 19050  68429   4051]
 [ 19451   4436 100593]]
[2024-08-03 13:29:35,152] {result_logger:141} INFO - 
[[ 74.40%  14.16%  11.43%]
 [ 20.81%  74.76%   4.43%]
 [ 15.63%   3.56%  80.81%]]
[2024-08-03 13:29:35,229] {result_logger:145} INFO - 
[[ 74.36%  22.59%  14.09%]
 [ 12.68%  72.70%   3.33%]
 [ 12.95%   4.71%  82.59%]]
[2024-08-03 13:29:35,229] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-03 13:29:35,238] {result_logger:134} INFO - 
[[28077   128   177]
 [ 1025  1502    18]
 [10595   392  9716]]
[2024-08-03 13:29:35,352] {result_logger:141} INFO - 
[[ 98.93%   0.45%   0.62%]
 [ 40.28%  59.02%   0.71%]
 [ 51.18%   1.89%  46.93%]]
[2024-08-03 13:29:35,455] {result_logger:145} INFO - 
[[ 70.73%   6.33%   1.79%]
 [  2.58%  74.28%   0.18%]
 [ 26.69%  19.39%  98.03%]]
[2024-08-03 13:29:35,751] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-03 13:29:35,751] {result_logger:77} INFO - actual:
[2024-08-03 13:29:35,752] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-03 13:29:35,752] {result_logger:79} INFO - predicted:
[2024-08-03 13:29:35,752] {result_logger:80} INFO - 
[[94.89%  1.21%  3.89%]
 [34.52% 64.19%  1.29%]
 [13.41%  2.45% 84.14%]]
[2024-08-03 13:29:35,812] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_C/model_8conv_2fc-best.pth
[2024-08-03 13:29:35,813] {run_experiment:113} INFO - [epoch   2] execution time: 158.09s	 avg f1-score: 0.7058

[2024-08-03 13:29:35,813] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-03 13:29:35,833] {dataloader:147} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2024-08-03 13:29:55,408] {train_model:82} INFO - Train Epoch: 3 [36352/366120 (10%)]	lr:6.75e-05	Loss: 5.512025
[2024-08-03 13:30:08,516] {train_model:82} INFO - Train Epoch: 3 [72960/366120 (20%)]	lr:6.75e-05	Loss: 2.075390
[2024-08-03 13:30:21,898] {train_model:82} INFO - Train Epoch: 3 [109568/366120 (30%)]	lr:6.75e-05	Loss: 2.549021
[2024-08-03 13:30:35,263] {train_model:82} INFO - Train Epoch: 3 [146176/366120 (40%)]	lr:6.75e-05	Loss: 5.169010
[2024-08-03 13:30:48,643] {train_model:82} INFO - Train Epoch: 3 [182784/366120 (50%)]	lr:6.75e-05	Loss: 8.148169
[2024-08-03 13:31:02,048] {train_model:82} INFO - Train Epoch: 3 [219392/366120 (60%)]	lr:6.75e-05	Loss: 1.740107
[2024-08-03 13:31:15,497] {train_model:82} INFO - Train Epoch: 3 [256000/366120 (70%)]	lr:6.75e-05	Loss: 4.142446
[2024-08-03 13:31:28,816] {train_model:82} INFO - Train Epoch: 3 [292608/366120 (80%)]	lr:6.75e-05	Loss: 3.669206
[2024-08-03 13:31:42,070] {train_model:82} INFO - Train Epoch: 3 [329216/366120 (90%)]	lr:6.75e-05	Loss: 3.446906
[2024-08-03 13:32:05,900] {train_model:82} INFO - Train Epoch: 3 [365824/366120 (100%)]	lr:6.75e-05	Loss: 4.894574
[2024-08-03 13:32:13,574] {run_experiment:79} INFO - 
[2024-08-03 13:32:13,574] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-03 13:32:14,385] {result_logger:103} INFO - precision on Wake: 0.761
[2024-08-03 13:32:14,934] {result_logger:104} INFO - recall on Wake: 0.866
[2024-08-03 13:32:15,448] {result_logger:107} INFO - F1-score on Wake: 0.810
[2024-08-03 13:32:15,448] {result_logger:108} INFO - 
[2024-08-03 13:32:16,169] {result_logger:103} INFO - precision on REM: 0.818
[2024-08-03 13:32:16,624] {result_logger:104} INFO - recall on REM: 0.757
[2024-08-03 13:32:17,067] {result_logger:107} INFO - F1-score on REM: 0.786
[2024-08-03 13:32:17,068] {result_logger:108} INFO - 
[2024-08-03 13:32:17,772] {result_logger:103} INFO - precision on Non REM: 0.898
[2024-08-03 13:32:18,220] {result_logger:104} INFO - recall on Non REM: 0.797
[2024-08-03 13:32:18,668] {result_logger:107} INFO - F1-score on Non REM: 0.844
[2024-08-03 13:32:18,668] {result_logger:108} INFO - 
[2024-08-03 13:32:18,779] {result_logger:111} INFO - average precision on sleep stages: 0.825
[2024-08-03 13:32:18,891] {result_logger:113} INFO - average recall on sleep stages: 0.807
[2024-08-03 13:32:19,003] {result_logger:115} INFO - average F1-score on sleep stages: 0.813
[2024-08-03 13:32:19,004] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-03 13:32:19,095] {result_logger:103} INFO - precision on Wake: 0.642
[2024-08-03 13:32:19,149] {result_logger:104} INFO - recall on Wake: 0.994
[2024-08-03 13:32:19,206] {result_logger:107} INFO - F1-score on Wake: 0.780
[2024-08-03 13:32:19,206] {result_logger:108} INFO - 
[2024-08-03 13:32:19,297] {result_logger:103} INFO - precision on REM: 0.781
[2024-08-03 13:32:19,349] {result_logger:104} INFO - recall on REM: 0.708
[2024-08-03 13:32:19,402] {result_logger:107} INFO - F1-score on REM: 0.743
[2024-08-03 13:32:19,402] {result_logger:108} INFO - 
[2024-08-03 13:32:19,493] {result_logger:103} INFO - precision on Non REM: 0.990
[2024-08-03 13:32:19,547] {result_logger:104} INFO - recall on Non REM: 0.257
[2024-08-03 13:32:19,604] {result_logger:107} INFO - F1-score on Non REM: 0.408
[2024-08-03 13:32:19,604] {result_logger:108} INFO - 
[2024-08-03 13:32:19,616] {result_logger:111} INFO - average precision on sleep stages: 0.804
[2024-08-03 13:32:19,627] {result_logger:113} INFO - average recall on sleep stages: 0.653
[2024-08-03 13:32:19,637] {result_logger:115} INFO - average F1-score on sleep stages: 0.644
[2024-08-03 13:32:19,637] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-03 13:32:19,715] {result_logger:134} INFO - 
[[130025  11903   8180]
 [ 19145  69270   3115]
 [ 21741   3559  99182]]
[2024-08-03 13:32:19,790] {result_logger:141} INFO - 
[[ 86.62%   7.93%   5.45%]
 [ 20.92%  75.68%   3.40%]
 [ 17.47%   2.86%  79.68%]]
[2024-08-03 13:32:19,864] {result_logger:145} INFO - 
[[ 76.08%  14.05%   7.40%]
 [ 11.20%  81.75%   2.82%]
 [ 12.72%   4.20%  89.78%]]
[2024-08-03 13:32:19,864] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-03 13:32:19,872] {result_logger:134} INFO - 
[[28215   123    44]
 [  734  1802     9]
 [15001   383  5319]]
[2024-08-03 13:32:19,880] {result_logger:141} INFO - 
[[ 99.41%   0.43%   0.16%]
 [ 28.84%  70.81%   0.35%]
 [ 72.46%   1.85%  25.69%]]
[2024-08-03 13:32:19,888] {result_logger:145} INFO - 
[[ 64.20%   5.33%   0.82%]
 [  1.67%  78.08%   0.17%]
 [ 34.13%  16.59%  99.01%]]
[2024-08-03 13:32:19,986] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-03 13:32:19,987] {result_logger:77} INFO - actual:
[2024-08-03 13:32:19,987] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-03 13:32:19,987] {result_logger:79} INFO - predicted:
[2024-08-03 13:32:19,987] {result_logger:80} INFO - 
[[95.49%  1.08%  3.43%]
 [28.77% 69.58%  1.65%]
 [24.50%  4.24% 71.26%]]
[2024-08-03 13:32:19,987] {run_experiment:113} INFO - [epoch   3] execution time: 164.17s	 avg f1-score: 0.6436

[2024-08-03 13:32:19,987] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-03 13:32:20,006] {dataloader:147} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2024-08-03 13:32:39,549] {train_model:82} INFO - Train Epoch: 4 [36352/366120 (10%)]	lr:8.84e-05	Loss: 1.231568
[2024-08-03 13:32:52,623] {train_model:82} INFO - Train Epoch: 4 [72960/366120 (20%)]	lr:8.84e-05	Loss: 0.551968
[2024-08-03 13:33:05,977] {train_model:82} INFO - Train Epoch: 4 [109568/366120 (30%)]	lr:8.84e-05	Loss: 8.438937
[2024-08-03 13:33:19,371] {train_model:82} INFO - Train Epoch: 4 [146176/366120 (40%)]	lr:8.84e-05	Loss: 0.564682
[2024-08-03 13:33:32,615] {train_model:82} INFO - Train Epoch: 4 [182784/366120 (50%)]	lr:8.84e-05	Loss: 0.317765
[2024-08-03 13:33:45,880] {train_model:82} INFO - Train Epoch: 4 [219392/366120 (60%)]	lr:8.84e-05	Loss: 0.852914
[2024-08-03 13:33:59,203] {train_model:82} INFO - Train Epoch: 4 [256000/366120 (70%)]	lr:8.84e-05	Loss: 0.457008
[2024-08-03 13:34:12,681] {train_model:82} INFO - Train Epoch: 4 [292608/366120 (80%)]	lr:8.84e-05	Loss: 0.570281
[2024-08-03 13:34:26,171] {train_model:82} INFO - Train Epoch: 4 [329216/366120 (90%)]	lr:8.84e-05	Loss: 0.490447
[2024-08-03 13:34:49,558] {train_model:82} INFO - Train Epoch: 4 [365824/366120 (100%)]	lr:8.84e-05	Loss: 0.919758
[2024-08-03 13:34:56,554] {run_experiment:79} INFO - 
[2024-08-03 13:34:56,555] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-03 13:34:57,367] {result_logger:103} INFO - precision on Wake: 0.796
[2024-08-03 13:34:57,882] {result_logger:104} INFO - recall on Wake: 0.914
[2024-08-03 13:34:58,410] {result_logger:107} INFO - F1-score on Wake: 0.851
[2024-08-03 13:34:58,410] {result_logger:108} INFO - 
[2024-08-03 13:34:59,174] {result_logger:103} INFO - precision on REM: 0.889
[2024-08-03 13:34:59,653] {result_logger:104} INFO - recall on REM: 0.789
[2024-08-03 13:35:00,103] {result_logger:107} INFO - F1-score on REM: 0.836
[2024-08-03 13:35:00,103] {result_logger:108} INFO - 
[2024-08-03 13:35:00,835] {result_logger:103} INFO - precision on Non REM: 0.909
[2024-08-03 13:35:01,292] {result_logger:104} INFO - recall on Non REM: 0.822
[2024-08-03 13:35:01,741] {result_logger:107} INFO - F1-score on Non REM: 0.863
[2024-08-03 13:35:01,741] {result_logger:108} INFO - 
[2024-08-03 13:35:01,853] {result_logger:111} INFO - average precision on sleep stages: 0.865
[2024-08-03 13:35:01,963] {result_logger:113} INFO - average recall on sleep stages: 0.842
[2024-08-03 13:35:02,075] {result_logger:115} INFO - average F1-score on sleep stages: 0.850
[2024-08-03 13:35:02,076] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-03 13:35:02,167] {result_logger:103} INFO - precision on Wake: 0.577
[2024-08-03 13:35:02,222] {result_logger:104} INFO - recall on Wake: 0.999
[2024-08-03 13:35:02,277] {result_logger:107} INFO - F1-score on Wake: 0.732
[2024-08-03 13:35:02,277] {result_logger:108} INFO - 
[2024-08-03 13:35:02,366] {result_logger:103} INFO - precision on REM: 0.868
[2024-08-03 13:35:02,419] {result_logger:104} INFO - recall on REM: 0.337
[2024-08-03 13:35:02,472] {result_logger:107} INFO - F1-score on REM: 0.486
[2024-08-03 13:35:02,472] {result_logger:108} INFO - 
[2024-08-03 13:35:02,570] {result_logger:103} INFO - precision on Non REM: 0.984
[2024-08-03 13:35:02,626] {result_logger:104} INFO - recall on Non REM: 0.074
[2024-08-03 13:35:02,681] {result_logger:107} INFO - F1-score on Non REM: 0.137
[2024-08-03 13:35:02,682] {result_logger:108} INFO - 
[2024-08-03 13:35:02,692] {result_logger:111} INFO - average precision on sleep stages: 0.810
[2024-08-03 13:35:02,703] {result_logger:113} INFO - average recall on sleep stages: 0.470
[2024-08-03 13:35:02,713] {result_logger:115} INFO - average F1-score on sleep stages: 0.452
[2024-08-03 13:35:02,714] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-03 13:35:02,790] {result_logger:134} INFO - 
[[137275   5738   7097]
 [ 16204  72178   3148]
 [ 18964   3254 102262]]
[2024-08-03 13:35:02,866] {result_logger:141} INFO - 
[[ 91.45%   3.82%   4.73%]
 [ 17.70%  78.86%   3.44%]
 [ 15.23%   2.61%  82.15%]]
[2024-08-03 13:35:02,940] {result_logger:145} INFO - 
[[ 79.61%   7.07%   6.31%]
 [  9.40%  88.92%   2.80%]
 [ 11.00%   4.01%  90.89%]]
[2024-08-03 13:35:02,940] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-03 13:35:02,947] {result_logger:134} INFO - 
[[28345    14    23]
 [ 1685   858     2]
 [19057   117  1529]]
[2024-08-03 13:35:02,954] {result_logger:141} INFO - 
[[ 99.87%   0.05%   0.08%]
 [ 66.21%  33.71%   0.08%]
 [ 92.05%   0.57%   7.39%]]
[2024-08-03 13:35:02,962] {result_logger:145} INFO - 
[[ 57.74%   1.42%   1.48%]
 [  3.43%  86.75%   0.13%]
 [ 38.82%  11.83%  98.39%]]
[2024-08-03 13:35:03,063] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-03 13:35:03,063] {result_logger:77} INFO - actual:
[2024-08-03 13:35:03,064] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-03 13:35:03,064] {result_logger:79} INFO - predicted:
[2024-08-03 13:35:03,064] {result_logger:80} INFO - 
[[98.12%  0.57%  1.30%]
 [35.69% 63.30%  1.01%]
 [36.62%  5.21% 58.17%]]
[2024-08-03 13:35:03,064] {run_experiment:113} INFO - [epoch   4] execution time: 163.08s	 avg f1-score: 0.4516

[2024-08-03 13:35:03,064] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-03 13:35:03,084] {dataloader:147} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2024-08-03 13:35:22,613] {train_model:82} INFO - Train Epoch: 5 [36352/366120 (10%)]	lr:1.09e-04	Loss: 5.541689
[2024-08-03 13:35:35,710] {train_model:82} INFO - Train Epoch: 5 [72960/366120 (20%)]	lr:1.09e-04	Loss: 0.251252
[2024-08-03 13:35:49,149] {train_model:82} INFO - Train Epoch: 5 [109568/366120 (30%)]	lr:1.09e-04	Loss: 2.072803
[2024-08-03 13:36:02,417] {train_model:82} INFO - Train Epoch: 5 [146176/366120 (40%)]	lr:1.09e-04	Loss: 0.303448
[2024-08-03 13:36:15,677] {train_model:82} INFO - Train Epoch: 5 [182784/366120 (50%)]	lr:1.09e-04	Loss: 4.555249
[2024-08-03 13:36:29,060] {train_model:82} INFO - Train Epoch: 5 [219392/366120 (60%)]	lr:1.09e-04	Loss: 2.998045
[2024-08-03 13:36:42,367] {train_model:82} INFO - Train Epoch: 5 [256000/366120 (70%)]	lr:1.09e-04	Loss: 0.258777
[2024-08-03 13:36:55,878] {train_model:82} INFO - Train Epoch: 5 [292608/366120 (80%)]	lr:1.09e-04	Loss: 0.464191
[2024-08-03 13:37:13,639] {train_model:82} INFO - Train Epoch: 5 [329216/366120 (90%)]	lr:1.09e-04	Loss: 3.020392
[2024-08-03 13:37:33,548] {train_model:82} INFO - Train Epoch: 5 [365824/366120 (100%)]	lr:1.09e-04	Loss: 0.561133
[2024-08-03 13:37:40,502] {run_experiment:79} INFO - 
[2024-08-03 13:37:40,502] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-03 13:37:41,286] {result_logger:103} INFO - precision on Wake: 0.879
[2024-08-03 13:37:41,795] {result_logger:104} INFO - recall on Wake: 0.933
[2024-08-03 13:37:42,322] {result_logger:107} INFO - F1-score on Wake: 0.905
[2024-08-03 13:37:42,322] {result_logger:108} INFO - 
[2024-08-03 13:37:43,093] {result_logger:103} INFO - precision on REM: 0.922
[2024-08-03 13:37:43,560] {result_logger:104} INFO - recall on REM: 0.863
[2024-08-03 13:37:44,021] {result_logger:107} INFO - F1-score on REM: 0.892
[2024-08-03 13:37:44,021] {result_logger:108} INFO - 
[2024-08-03 13:37:44,749] {result_logger:103} INFO - precision on Non REM: 0.913
[2024-08-03 13:37:45,207] {result_logger:104} INFO - recall on Non REM: 0.888
[2024-08-03 13:37:45,660] {result_logger:107} INFO - F1-score on Non REM: 0.901
[2024-08-03 13:37:45,660] {result_logger:108} INFO - 
[2024-08-03 13:37:45,776] {result_logger:111} INFO - average precision on sleep stages: 0.905
[2024-08-03 13:37:45,890] {result_logger:113} INFO - average recall on sleep stages: 0.895
[2024-08-03 13:37:46,004] {result_logger:115} INFO - average F1-score on sleep stages: 0.899
[2024-08-03 13:37:46,006] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-03 13:37:46,096] {result_logger:103} INFO - precision on Wake: 0.649
[2024-08-03 13:37:46,154] {result_logger:104} INFO - recall on Wake: 0.994
[2024-08-03 13:37:46,209] {result_logger:107} INFO - F1-score on Wake: 0.785
[2024-08-03 13:37:46,210] {result_logger:108} INFO - 
[2024-08-03 13:37:46,301] {result_logger:103} INFO - precision on REM: 0.718
[2024-08-03 13:37:46,356] {result_logger:104} INFO - recall on REM: 0.760
[2024-08-03 13:37:46,412] {result_logger:107} INFO - F1-score on REM: 0.738
[2024-08-03 13:37:46,412] {result_logger:108} INFO - 
[2024-08-03 13:37:46,503] {result_logger:103} INFO - precision on Non REM: 0.994
[2024-08-03 13:37:46,560] {result_logger:104} INFO - recall on Non REM: 0.263
[2024-08-03 13:37:46,615] {result_logger:107} INFO - F1-score on Non REM: 0.416
[2024-08-03 13:37:46,615] {result_logger:108} INFO - 
[2024-08-03 13:37:46,626] {result_logger:111} INFO - average precision on sleep stages: 0.787
[2024-08-03 13:37:46,638] {result_logger:113} INFO - average recall on sleep stages: 0.672
[2024-08-03 13:37:46,649] {result_logger:115} INFO - average F1-score on sleep stages: 0.647
[2024-08-03 13:37:46,649] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-03 13:37:46,729] {result_logger:134} INFO - 
[[140053   3051   7001]
 [  8980  79018   3533]
 [ 10286   3594 110604]]
[2024-08-03 13:37:46,806] {result_logger:141} INFO - 
[[ 93.30%   2.03%   4.66%]
 [  9.81%  86.33%   3.86%]
 [  8.26%   2.89%  88.85%]]
[2024-08-03 13:37:46,883] {result_logger:145} INFO - 
[[ 87.91%   3.56%   5.78%]
 [  5.64%  92.24%   2.92%]
 [  6.46%   4.20%  91.30%]]
[2024-08-03 13:37:46,883] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-03 13:37:46,890] {result_logger:134} INFO - 
[[28211   147    24]
 [  603  1935     7]
 [14645   614  5444]]
[2024-08-03 13:37:46,898] {result_logger:141} INFO - 
[[ 99.40%   0.52%   0.08%]
 [ 23.69%  76.03%   0.28%]
 [ 70.74%   2.97%  26.30%]]
[2024-08-03 13:37:46,906] {result_logger:145} INFO - 
[[ 64.91%   5.45%   0.44%]
 [  1.39%  71.77%   0.13%]
 [ 33.70%  22.77%  99.43%]]
[2024-08-03 13:37:47,004] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-03 13:37:47,004] {result_logger:77} INFO - actual:
[2024-08-03 13:37:47,004] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-03 13:37:47,004] {result_logger:79} INFO - predicted:
[2024-08-03 13:37:47,004] {result_logger:80} INFO - 
[[95.03%  0.92%  4.05%]
 [25.59% 73.66%  0.74%]
 [26.83%  5.68% 67.49%]]
[2024-08-03 13:37:47,005] {run_experiment:113} INFO - [epoch   5] execution time: 163.94s	 avg f1-score: 0.6466

[2024-08-03 13:37:47,005] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-03 13:37:47,024] {dataloader:147} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2024-08-03 13:38:06,546] {train_model:82} INFO - Train Epoch: 6 [36352/366120 (10%)]	lr:1.30e-04	Loss: 0.202478
[2024-08-03 13:38:19,688] {train_model:82} INFO - Train Epoch: 6 [72960/366120 (20%)]	lr:1.30e-04	Loss: 0.197203
[2024-08-03 13:38:32,954] {train_model:82} INFO - Train Epoch: 6 [109568/366120 (30%)]	lr:1.30e-04	Loss: 0.214750
[2024-08-03 13:38:46,222] {train_model:82} INFO - Train Epoch: 6 [146176/366120 (40%)]	lr:1.30e-04	Loss: 1.517463
[2024-08-03 13:38:59,589] {train_model:82} INFO - Train Epoch: 6 [182784/366120 (50%)]	lr:1.30e-04	Loss: 0.200438
[2024-08-03 13:39:12,861] {train_model:82} INFO - Train Epoch: 6 [219392/366120 (60%)]	lr:1.30e-04	Loss: 0.324811
[2024-08-03 13:39:26,392] {train_model:82} INFO - Train Epoch: 6 [256000/366120 (70%)]	lr:1.30e-04	Loss: 0.165315
[2024-08-03 13:39:39,781] {train_model:82} INFO - Train Epoch: 6 [292608/366120 (80%)]	lr:1.30e-04	Loss: 0.443592
[2024-08-03 13:39:57,983] {train_model:82} INFO - Train Epoch: 6 [329216/366120 (90%)]	lr:1.30e-04	Loss: 1.825487
[2024-08-03 13:40:17,785] {train_model:82} INFO - Train Epoch: 6 [365824/366120 (100%)]	lr:1.30e-04	Loss: 0.460988
[2024-08-03 13:40:25,284] {run_experiment:79} INFO - 
[2024-08-03 13:40:25,285] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-03 13:40:26,096] {result_logger:103} INFO - precision on Wake: 0.922
[2024-08-03 13:40:26,618] {result_logger:104} INFO - recall on Wake: 0.944
[2024-08-03 13:40:27,143] {result_logger:107} INFO - F1-score on Wake: 0.933
[2024-08-03 13:40:27,144] {result_logger:108} INFO - 
[2024-08-03 13:40:27,883] {result_logger:103} INFO - precision on REM: 0.933
[2024-08-03 13:40:28,351] {result_logger:104} INFO - recall on REM: 0.905
[2024-08-03 13:40:28,801] {result_logger:107} INFO - F1-score on REM: 0.919
[2024-08-03 13:40:28,801] {result_logger:108} INFO - 
[2024-08-03 13:40:29,529] {result_logger:103} INFO - precision on Non REM: 0.923
[2024-08-03 13:40:29,985] {result_logger:104} INFO - recall on Non REM: 0.917
[2024-08-03 13:40:30,435] {result_logger:107} INFO - F1-score on Non REM: 0.920
[2024-08-03 13:40:30,435] {result_logger:108} INFO - 
[2024-08-03 13:40:30,548] {result_logger:111} INFO - average precision on sleep stages: 0.926
[2024-08-03 13:40:30,662] {result_logger:113} INFO - average recall on sleep stages: 0.922
[2024-08-03 13:40:30,777] {result_logger:115} INFO - average F1-score on sleep stages: 0.924
[2024-08-03 13:40:30,779] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-03 13:40:30,871] {result_logger:103} INFO - precision on Wake: 0.779
[2024-08-03 13:40:30,926] {result_logger:104} INFO - recall on Wake: 0.989
[2024-08-03 13:40:30,981] {result_logger:107} INFO - F1-score on Wake: 0.872
[2024-08-03 13:40:30,981] {result_logger:108} INFO - 
[2024-08-03 13:40:31,072] {result_logger:103} INFO - precision on REM: 0.626
[2024-08-03 13:40:31,129] {result_logger:104} INFO - recall on REM: 0.924
[2024-08-03 13:40:31,185] {result_logger:107} INFO - F1-score on REM: 0.746
[2024-08-03 13:40:31,185] {result_logger:108} INFO - 
[2024-08-03 13:40:31,276] {result_logger:103} INFO - precision on Non REM: 0.997
[2024-08-03 13:40:31,332] {result_logger:104} INFO - recall on Non REM: 0.571
[2024-08-03 13:40:31,387] {result_logger:107} INFO - F1-score on Non REM: 0.726
[2024-08-03 13:40:31,387] {result_logger:108} INFO - 
[2024-08-03 13:40:31,399] {result_logger:111} INFO - average precision on sleep stages: 0.801
[2024-08-03 13:40:31,411] {result_logger:113} INFO - average recall on sleep stages: 0.828
[2024-08-03 13:40:31,422] {result_logger:115} INFO - average F1-score on sleep stages: 0.781
[2024-08-03 13:40:31,422] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-03 13:40:31,501] {result_logger:134} INFO - 
[[141707   2241   6159]
 [  5330  82820   3381]
 [  6589   3719 114174]]
[2024-08-03 13:40:31,578] {result_logger:141} INFO - 
[[ 94.40%   1.49%   4.10%]
 [  5.82%  90.48%   3.69%]
 [  5.29%   2.99%  91.72%]]
[2024-08-03 13:40:31,655] {result_logger:145} INFO - 
[[ 92.24%   2.52%   4.98%]
 [  3.47%  93.29%   2.73%]
 [  4.29%   4.19%  92.29%]]
[2024-08-03 13:40:31,655] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-03 13:40:31,663] {result_logger:134} INFO - 
[[28059   296    27]
 [  184  2352     9]
 [ 7766  1112 11825]]
[2024-08-03 13:40:31,773] {result_logger:141} INFO - 
[[ 98.86%   1.04%   0.10%]
 [  7.23%  92.42%   0.35%]
 [ 37.51%   5.37%  57.12%]]
[2024-08-03 13:40:31,878] {result_logger:145} INFO - 
[[ 77.92%   7.87%   0.23%]
 [  0.51%  62.55%   0.08%]
 [ 21.57%  29.57%  99.70%]]
[2024-08-03 13:40:32,166] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-03 13:40:32,166] {result_logger:77} INFO - actual:
[2024-08-03 13:40:32,166] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-03 13:40:32,167] {result_logger:79} INFO - predicted:
[2024-08-03 13:40:32,167] {result_logger:80} INFO - 
[[92.67%  1.06%  6.27%]
 [25.48% 73.09%  1.44%]
 [14.18%  5.32% 80.50%]]
[2024-08-03 13:40:32,226] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_C/model_8conv_2fc-best.pth
[2024-08-03 13:40:32,226] {run_experiment:113} INFO - [epoch   6] execution time: 165.22s	 avg f1-score: 0.7813

[2024-08-03 13:40:32,226] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-03 13:40:32,245] {dataloader:147} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2024-08-03 13:40:51,909] {train_model:82} INFO - Train Epoch: 7 [36352/366120 (10%)]	lr:1.51e-04	Loss: 0.186385
[2024-08-03 13:41:05,098] {train_model:82} INFO - Train Epoch: 7 [72960/366120 (20%)]	lr:1.51e-04	Loss: 0.237870
[2024-08-03 13:41:18,390] {train_model:82} INFO - Train Epoch: 7 [109568/366120 (30%)]	lr:1.51e-04	Loss: 0.262013
[2024-08-03 13:41:31,687] {train_model:82} INFO - Train Epoch: 7 [146176/366120 (40%)]	lr:1.51e-04	Loss: 0.144801
[2024-08-03 13:41:45,096] {train_model:82} INFO - Train Epoch: 7 [182784/366120 (50%)]	lr:1.51e-04	Loss: 0.675848
[2024-08-03 13:41:58,405] {train_model:82} INFO - Train Epoch: 7 [219392/366120 (60%)]	lr:1.51e-04	Loss: 0.280941
[2024-08-03 13:42:11,797] {train_model:82} INFO - Train Epoch: 7 [256000/366120 (70%)]	lr:1.51e-04	Loss: 0.167947
[2024-08-03 13:42:25,202] {train_model:82} INFO - Train Epoch: 7 [292608/366120 (80%)]	lr:1.51e-04	Loss: 0.178059
[2024-08-03 13:42:48,996] {train_model:82} INFO - Train Epoch: 7 [329216/366120 (90%)]	lr:1.51e-04	Loss: 0.117180
[2024-08-03 13:43:02,139] {train_model:82} INFO - Train Epoch: 7 [365824/366120 (100%)]	lr:1.51e-04	Loss: 0.148415
[2024-08-03 13:43:09,728] {run_experiment:79} INFO - 
[2024-08-03 13:43:09,729] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-03 13:43:10,561] {result_logger:103} INFO - precision on Wake: 0.940
[2024-08-03 13:43:11,101] {result_logger:104} INFO - recall on Wake: 0.954
[2024-08-03 13:43:11,630] {result_logger:107} INFO - F1-score on Wake: 0.947
[2024-08-03 13:43:11,630] {result_logger:108} INFO - 
[2024-08-03 13:43:12,384] {result_logger:103} INFO - precision on REM: 0.939
[2024-08-03 13:43:12,849] {result_logger:104} INFO - recall on REM: 0.930
[2024-08-03 13:43:13,313] {result_logger:107} INFO - F1-score on REM: 0.935
[2024-08-03 13:43:13,314] {result_logger:108} INFO - 
[2024-08-03 13:43:14,053] {result_logger:103} INFO - precision on Non REM: 0.936
[2024-08-03 13:43:14,514] {result_logger:104} INFO - recall on Non REM: 0.926
[2024-08-03 13:43:14,974] {result_logger:107} INFO - F1-score on Non REM: 0.931
[2024-08-03 13:43:14,974] {result_logger:108} INFO - 
[2024-08-03 13:43:15,086] {result_logger:111} INFO - average precision on sleep stages: 0.938
[2024-08-03 13:43:15,199] {result_logger:113} INFO - average recall on sleep stages: 0.936
[2024-08-03 13:43:15,313] {result_logger:115} INFO - average F1-score on sleep stages: 0.937
[2024-08-03 13:43:15,315] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-03 13:43:15,412] {result_logger:103} INFO - precision on Wake: 0.843
[2024-08-03 13:43:15,471] {result_logger:104} INFO - recall on Wake: 0.981
[2024-08-03 13:43:15,529] {result_logger:107} INFO - F1-score on Wake: 0.907
[2024-08-03 13:43:15,529] {result_logger:108} INFO - 
[2024-08-03 13:43:15,623] {result_logger:103} INFO - precision on REM: 0.577
[2024-08-03 13:43:15,679] {result_logger:104} INFO - recall on REM: 0.982
[2024-08-03 13:43:15,735] {result_logger:107} INFO - F1-score on REM: 0.727
[2024-08-03 13:43:15,735] {result_logger:108} INFO - 
[2024-08-03 13:43:15,828] {result_logger:103} INFO - precision on Non REM: 0.996
[2024-08-03 13:43:15,886] {result_logger:104} INFO - recall on Non REM: 0.686
[2024-08-03 13:43:15,941] {result_logger:107} INFO - F1-score on Non REM: 0.812
[2024-08-03 13:43:15,941] {result_logger:108} INFO - 
[2024-08-03 13:43:15,952] {result_logger:111} INFO - average precision on sleep stages: 0.805
[2024-08-03 13:43:15,964] {result_logger:113} INFO - average recall on sleep stages: 0.883
[2024-08-03 13:43:15,975] {result_logger:115} INFO - average F1-score on sleep stages: 0.815
[2024-08-03 13:43:15,975] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-03 13:43:16,053] {result_logger:134} INFO - 
[[143153   1889   5067]
 [  3552  85130   2848]
 [  5651   3599 115231]]
[2024-08-03 13:43:16,130] {result_logger:141} INFO - 
[[ 95.37%   1.26%   3.38%]
 [  3.88%  93.01%   3.11%]
 [  4.54%   2.89%  92.57%]]
[2024-08-03 13:43:16,205] {result_logger:145} INFO - 
[[ 93.96%   2.08%   4.11%]
 [  2.33%  93.94%   2.31%]
 [  3.71%   3.97%  93.57%]]
[2024-08-03 13:43:16,206] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-03 13:43:16,214] {result_logger:134} INFO - 
[[27849   481    52]
 [   34  2499    12]
 [ 5150  1348 14205]]
[2024-08-03 13:43:16,321] {result_logger:141} INFO - 
[[ 98.12%   1.69%   0.18%]
 [  1.34%  98.19%   0.47%]
 [ 24.88%   6.51%  68.61%]]
[2024-08-03 13:43:16,423] {result_logger:145} INFO - 
[[ 84.31%  11.11%   0.36%]
 [  0.10%  57.74%   0.08%]
 [ 15.59%  31.15%  99.55%]]
[2024-08-03 13:43:16,717] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-03 13:43:16,717] {result_logger:77} INFO - actual:
[2024-08-03 13:43:16,717] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-03 13:43:16,717] {result_logger:79} INFO - predicted:
[2024-08-03 13:43:16,717] {result_logger:80} INFO - 
[[91.66%  1.22%  7.12%]
 [23.91% 72.34%  3.74%]
 [12.06%  5.56% 82.38%]]
[2024-08-03 13:43:16,775] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_C/model_8conv_2fc-best.pth
[2024-08-03 13:43:16,775] {run_experiment:113} INFO - [epoch   7] execution time: 164.55s	 avg f1-score: 0.8155

[2024-08-03 13:43:16,775] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-03 13:43:16,795] {dataloader:147} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2024-08-03 13:43:36,275] {train_model:82} INFO - Train Epoch: 8 [36352/366120 (10%)]	lr:1.72e-04	Loss: 1.836671
[2024-08-03 13:43:49,536] {train_model:82} INFO - Train Epoch: 8 [72960/366120 (20%)]	lr:1.72e-04	Loss: 0.914801
[2024-08-03 13:44:02,935] {train_model:82} INFO - Train Epoch: 8 [109568/366120 (30%)]	lr:1.72e-04	Loss: 0.176415
[2024-08-03 13:44:16,254] {train_model:82} INFO - Train Epoch: 8 [146176/366120 (40%)]	lr:1.72e-04	Loss: 0.099391
[2024-08-03 13:44:29,621] {train_model:82} INFO - Train Epoch: 8 [182784/366120 (50%)]	lr:1.72e-04	Loss: 0.191353
[2024-08-03 13:44:43,018] {train_model:82} INFO - Train Epoch: 8 [219392/366120 (60%)]	lr:1.72e-04	Loss: 0.289637
[2024-08-03 13:44:56,365] {train_model:82} INFO - Train Epoch: 8 [256000/366120 (70%)]	lr:1.72e-04	Loss: 0.408753
[2024-08-03 13:45:11,461] {train_model:82} INFO - Train Epoch: 8 [292608/366120 (80%)]	lr:1.72e-04	Loss: 0.876270
[2024-08-03 13:45:34,171] {train_model:82} INFO - Train Epoch: 8 [329216/366120 (90%)]	lr:1.72e-04	Loss: 0.198980
[2024-08-03 13:45:47,279] {train_model:82} INFO - Train Epoch: 8 [365824/366120 (100%)]	lr:1.72e-04	Loss: 0.595616
[2024-08-03 13:45:54,346] {run_experiment:79} INFO - 
[2024-08-03 13:45:54,347] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-03 13:45:55,142] {result_logger:103} INFO - precision on Wake: 0.949
[2024-08-03 13:45:55,663] {result_logger:104} INFO - recall on Wake: 0.959
[2024-08-03 13:45:56,194] {result_logger:107} INFO - F1-score on Wake: 0.954
[2024-08-03 13:45:56,194] {result_logger:108} INFO - 
[2024-08-03 13:45:56,930] {result_logger:103} INFO - precision on REM: 0.944
[2024-08-03 13:45:57,391] {result_logger:104} INFO - recall on REM: 0.940
[2024-08-03 13:45:57,856] {result_logger:107} INFO - F1-score on REM: 0.942
[2024-08-03 13:45:57,856] {result_logger:108} INFO - 
[2024-08-03 13:45:58,592] {result_logger:103} INFO - precision on Non REM: 0.941
[2024-08-03 13:45:59,049] {result_logger:104} INFO - recall on Non REM: 0.931
[2024-08-03 13:45:59,508] {result_logger:107} INFO - F1-score on Non REM: 0.936
[2024-08-03 13:45:59,508] {result_logger:108} INFO - 
[2024-08-03 13:45:59,617] {result_logger:111} INFO - average precision on sleep stages: 0.945
[2024-08-03 13:45:59,730] {result_logger:113} INFO - average recall on sleep stages: 0.944
[2024-08-03 13:45:59,841] {result_logger:115} INFO - average F1-score on sleep stages: 0.944
[2024-08-03 13:45:59,842] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-03 13:45:59,935] {result_logger:103} INFO - precision on Wake: 0.912
[2024-08-03 13:45:59,991] {result_logger:104} INFO - recall on Wake: 0.979
[2024-08-03 13:46:00,048] {result_logger:107} INFO - F1-score on Wake: 0.944
[2024-08-03 13:46:00,048] {result_logger:108} INFO - 
[2024-08-03 13:46:00,137] {result_logger:103} INFO - precision on REM: 0.655
[2024-08-03 13:46:00,193] {result_logger:104} INFO - recall on REM: 0.974
[2024-08-03 13:46:00,248] {result_logger:107} INFO - F1-score on REM: 0.783
[2024-08-03 13:46:00,248] {result_logger:108} INFO - 
[2024-08-03 13:46:00,339] {result_logger:103} INFO - precision on Non REM: 0.989
[2024-08-03 13:46:00,396] {result_logger:104} INFO - recall on Non REM: 0.832
[2024-08-03 13:46:00,454] {result_logger:107} INFO - F1-score on Non REM: 0.903
[2024-08-03 13:46:00,454] {result_logger:108} INFO - 
[2024-08-03 13:46:00,465] {result_logger:111} INFO - average precision on sleep stages: 0.852
[2024-08-03 13:46:00,477] {result_logger:113} INFO - average recall on sleep stages: 0.928
[2024-08-03 13:46:00,488] {result_logger:115} INFO - average F1-score on sleep stages: 0.877
[2024-08-03 13:46:00,489] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-03 13:46:00,566] {result_logger:134} INFO - 
[[144015   1682   4411]
 [  2629  86007   2895]
 [  5063   3468 115950]]
[2024-08-03 13:46:00,640] {result_logger:141} INFO - 
[[ 95.94%   1.12%   2.94%]
 [  2.87%  93.96%   3.16%]
 [  4.07%   2.79%  93.15%]]
[2024-08-03 13:46:00,715] {result_logger:145} INFO - 
[[ 94.93%   1.85%   3.58%]
 [  1.73%  94.35%   2.35%]
 [  3.34%   3.80%  94.07%]]
[2024-08-03 13:46:00,715] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-03 13:46:00,723] {result_logger:134} INFO - 
[[27772   442   168]
 [   43  2478    24]
 [ 2621   865 17217]]
[2024-08-03 13:46:00,859] {result_logger:141} INFO - 
[[ 97.85%   1.56%   0.59%]
 [  1.69%  97.37%   0.94%]
 [ 12.66%   4.18%  83.16%]]
[2024-08-03 13:46:00,964] {result_logger:145} INFO - 
[[ 91.25%  11.68%   0.97%]
 [  0.14%  65.47%   0.14%]
 [  8.61%  22.85%  98.90%]]
[2024-08-03 13:46:01,262] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-03 13:46:01,262] {result_logger:77} INFO - actual:
[2024-08-03 13:46:01,262] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-03 13:46:01,262] {result_logger:79} INFO - predicted:
[2024-08-03 13:46:01,263] {result_logger:80} INFO - 
[[92.98%  1.08%  5.94%]
 [24.25% 72.87%  2.88%]
 [ 7.00%  4.02% 88.99%]]
[2024-08-03 13:46:01,321] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_C/model_8conv_2fc-best.pth
[2024-08-03 13:46:01,322] {run_experiment:113} INFO - [epoch   8] execution time: 164.55s	 avg f1-score: 0.8769

[2024-08-03 13:46:01,322] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-03 13:46:01,341] {dataloader:147} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2024-08-03 13:46:21,064] {train_model:82} INFO - Train Epoch: 9 [36352/366120 (10%)]	lr:1.93e-04	Loss: 0.097607
[2024-08-03 13:46:34,235] {train_model:82} INFO - Train Epoch: 9 [72960/366120 (20%)]	lr:1.93e-04	Loss: 0.099288
[2024-08-03 13:46:47,495] {train_model:82} INFO - Train Epoch: 9 [109568/366120 (30%)]	lr:1.93e-04	Loss: 0.443330
[2024-08-03 13:47:00,757] {train_model:82} INFO - Train Epoch: 9 [146176/366120 (40%)]	lr:1.93e-04	Loss: 0.091586
[2024-08-03 13:47:14,044] {train_model:82} INFO - Train Epoch: 9 [182784/366120 (50%)]	lr:1.93e-04	Loss: 0.139353
[2024-08-03 13:47:27,320] {train_model:82} INFO - Train Epoch: 9 [219392/366120 (60%)]	lr:1.93e-04	Loss: 0.134697
[2024-08-03 13:47:40,655] {train_model:82} INFO - Train Epoch: 9 [256000/366120 (70%)]	lr:1.93e-04	Loss: 0.117312
[2024-08-03 13:47:58,619] {train_model:82} INFO - Train Epoch: 9 [292608/366120 (80%)]	lr:1.93e-04	Loss: 0.124009
[2024-08-03 13:48:18,058] {train_model:82} INFO - Train Epoch: 9 [329216/366120 (90%)]	lr:1.93e-04	Loss: 1.249092
[2024-08-03 13:48:31,331] {train_model:82} INFO - Train Epoch: 9 [365824/366120 (100%)]	lr:1.93e-04	Loss: 0.332702
[2024-08-03 13:48:38,958] {run_experiment:79} INFO - 
[2024-08-03 13:48:38,958] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-03 13:48:39,763] {result_logger:103} INFO - precision on Wake: 0.957
[2024-08-03 13:48:40,303] {result_logger:104} INFO - recall on Wake: 0.965
[2024-08-03 13:48:40,829] {result_logger:107} INFO - F1-score on Wake: 0.961
[2024-08-03 13:48:40,829] {result_logger:108} INFO - 
[2024-08-03 13:48:41,574] {result_logger:103} INFO - precision on REM: 0.947
[2024-08-03 13:48:42,038] {result_logger:104} INFO - recall on REM: 0.951
[2024-08-03 13:48:42,488] {result_logger:107} INFO - F1-score on REM: 0.949
[2024-08-03 13:48:42,488] {result_logger:108} INFO - 
[2024-08-03 13:48:43,198] {result_logger:103} INFO - precision on Non REM: 0.948
[2024-08-03 13:48:43,656] {result_logger:104} INFO - recall on Non REM: 0.935
[2024-08-03 13:48:44,110] {result_logger:107} INFO - F1-score on Non REM: 0.942
[2024-08-03 13:48:44,111] {result_logger:108} INFO - 
[2024-08-03 13:48:44,222] {result_logger:111} INFO - average precision on sleep stages: 0.951
[2024-08-03 13:48:44,330] {result_logger:113} INFO - average recall on sleep stages: 0.950
[2024-08-03 13:48:44,437] {result_logger:115} INFO - average F1-score on sleep stages: 0.950
[2024-08-03 13:48:44,439] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-03 13:48:44,531] {result_logger:103} INFO - precision on Wake: 0.873
[2024-08-03 13:48:44,589] {result_logger:104} INFO - recall on Wake: 0.892
[2024-08-03 13:48:44,645] {result_logger:107} INFO - F1-score on Wake: 0.882
[2024-08-03 13:48:44,645] {result_logger:108} INFO - 
[2024-08-03 13:48:44,737] {result_logger:103} INFO - precision on REM: 0.388
[2024-08-03 13:48:44,792] {result_logger:104} INFO - recall on REM: 0.987
[2024-08-03 13:48:44,847] {result_logger:107} INFO - F1-score on REM: 0.557
[2024-08-03 13:48:44,847] {result_logger:108} INFO - 
[2024-08-03 13:48:44,935] {result_logger:103} INFO - precision on Non REM: 0.994
[2024-08-03 13:48:44,991] {result_logger:104} INFO - recall on Non REM: 0.775
[2024-08-03 13:48:45,047] {result_logger:107} INFO - F1-score on Non REM: 0.871
[2024-08-03 13:48:45,047] {result_logger:108} INFO - 
[2024-08-03 13:48:45,058] {result_logger:111} INFO - average precision on sleep stages: 0.752
[2024-08-03 13:48:45,069] {result_logger:113} INFO - average recall on sleep stages: 0.885
[2024-08-03 13:48:45,080] {result_logger:115} INFO - average F1-score on sleep stages: 0.770
[2024-08-03 13:48:45,081] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-03 13:48:45,156] {result_logger:134} INFO - 
[[144876   1460   3776]
 [  1894  87037   2600]
 [  4645   3437 116395]]
[2024-08-03 13:48:45,230] {result_logger:141} INFO - 
[[ 96.51%   0.97%   2.52%]
 [  2.07%  95.09%   2.84%]
 [  3.73%   2.76%  93.51%]]
[2024-08-03 13:48:45,306] {result_logger:145} INFO - 
[[ 95.68%   1.59%   3.08%]
 [  1.25%  94.67%   2.12%]
 [  3.07%   3.74%  94.81%]]
[2024-08-03 13:48:45,306] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-03 13:48:45,314] {result_logger:134} INFO - 
[[25326  2972    84]
 [   16  2512    17]
 [ 3680   985 16038]]
[2024-08-03 13:48:45,322] {result_logger:141} INFO - 
[[ 89.23%  10.47%   0.30%]
 [  0.63%  98.70%   0.67%]
 [ 17.78%   4.76%  77.47%]]
[2024-08-03 13:48:45,330] {result_logger:145} INFO - 
[[ 87.26%  45.94%   0.52%]
 [  0.06%  38.83%   0.11%]
 [ 12.68%  15.23%  99.37%]]
[2024-08-03 13:48:45,427] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-03 13:48:45,427] {result_logger:77} INFO - actual:
[2024-08-03 13:48:45,428] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-03 13:48:45,428] {result_logger:79} INFO - predicted:
[2024-08-03 13:48:45,428] {result_logger:80} INFO - 
[[88.96%  3.79%  7.26%]
 [25.54% 72.42%  2.04%]
 [ 9.62%  4.24% 86.13%]]
[2024-08-03 13:48:45,428] {run_experiment:113} INFO - [epoch   9] execution time: 164.11s	 avg f1-score: 0.7701

[2024-08-03 13:48:45,428] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-03 13:48:45,448] {dataloader:147} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2024-08-03 13:49:05,014] {train_model:82} INFO - Train Epoch: 10 [36352/366120 (10%)]	lr:2.14e-04	Loss: 0.101953
[2024-08-03 13:49:18,283] {train_model:82} INFO - Train Epoch: 10 [72960/366120 (20%)]	lr:2.14e-04	Loss: 1.659957
[2024-08-03 13:49:31,448] {train_model:82} INFO - Train Epoch: 10 [109568/366120 (30%)]	lr:2.14e-04	Loss: 1.623154
[2024-08-03 13:49:44,716] {train_model:82} INFO - Train Epoch: 10 [146176/366120 (40%)]	lr:2.14e-04	Loss: 0.110127
[2024-08-03 13:49:58,116] {train_model:82} INFO - Train Epoch: 10 [182784/366120 (50%)]	lr:2.14e-04	Loss: 0.136652
[2024-08-03 13:50:11,434] {train_model:82} INFO - Train Epoch: 10 [219392/366120 (60%)]	lr:2.14e-04	Loss: 1.695125
[2024-08-03 13:50:24,950] {train_model:82} INFO - Train Epoch: 10 [256000/366120 (70%)]	lr:2.14e-04	Loss: 0.137160
[2024-08-03 13:50:42,795] {train_model:82} INFO - Train Epoch: 10 [292608/366120 (80%)]	lr:2.14e-04	Loss: 0.049601
[2024-08-03 13:51:01,804] {train_model:82} INFO - Train Epoch: 10 [329216/366120 (90%)]	lr:2.14e-04	Loss: 0.606807
[2024-08-03 13:51:15,306] {train_model:82} INFO - Train Epoch: 10 [365824/366120 (100%)]	lr:2.14e-04	Loss: 0.124895
[2024-08-03 13:51:22,839] {run_experiment:79} INFO - 
[2024-08-03 13:51:22,839] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-03 13:51:23,616] {result_logger:103} INFO - precision on Wake: 0.961
[2024-08-03 13:51:24,141] {result_logger:104} INFO - recall on Wake: 0.968
[2024-08-03 13:51:24,663] {result_logger:107} INFO - F1-score on Wake: 0.964
[2024-08-03 13:51:24,663] {result_logger:108} INFO - 
[2024-08-03 13:51:25,391] {result_logger:103} INFO - precision on REM: 0.949
[2024-08-03 13:51:25,858] {result_logger:104} INFO - recall on REM: 0.957
[2024-08-03 13:51:26,328] {result_logger:107} INFO - F1-score on REM: 0.953
[2024-08-03 13:51:26,328] {result_logger:108} INFO - 
[2024-08-03 13:51:27,037] {result_logger:103} INFO - precision on Non REM: 0.952
[2024-08-03 13:51:27,493] {result_logger:104} INFO - recall on Non REM: 0.937
[2024-08-03 13:51:27,944] {result_logger:107} INFO - F1-score on Non REM: 0.944
[2024-08-03 13:51:27,945] {result_logger:108} INFO - 
[2024-08-03 13:51:28,053] {result_logger:111} INFO - average precision on sleep stages: 0.954
[2024-08-03 13:51:28,164] {result_logger:113} INFO - average recall on sleep stages: 0.954
[2024-08-03 13:51:28,278] {result_logger:115} INFO - average F1-score on sleep stages: 0.954
[2024-08-03 13:51:28,280] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-03 13:51:28,373] {result_logger:103} INFO - precision on Wake: 0.961
[2024-08-03 13:51:28,430] {result_logger:104} INFO - recall on Wake: 0.920
[2024-08-03 13:51:28,485] {result_logger:107} INFO - F1-score on Wake: 0.940
[2024-08-03 13:51:28,485] {result_logger:108} INFO - 
[2024-08-03 13:51:28,576] {result_logger:103} INFO - precision on REM: 0.467
[2024-08-03 13:51:28,633] {result_logger:104} INFO - recall on REM: 0.987
[2024-08-03 13:51:28,687] {result_logger:107} INFO - F1-score on REM: 0.634
[2024-08-03 13:51:28,687] {result_logger:108} INFO - 
[2024-08-03 13:51:28,776] {result_logger:103} INFO - precision on Non REM: 0.978
[2024-08-03 13:51:28,833] {result_logger:104} INFO - recall on Non REM: 0.902
[2024-08-03 13:51:28,890] {result_logger:107} INFO - F1-score on Non REM: 0.939
[2024-08-03 13:51:28,891] {result_logger:108} INFO - 
[2024-08-03 13:51:28,902] {result_logger:111} INFO - average precision on sleep stages: 0.802
[2024-08-03 13:51:28,914] {result_logger:113} INFO - average recall on sleep stages: 0.936
[2024-08-03 13:51:28,925] {result_logger:115} INFO - average F1-score on sleep stages: 0.838
[2024-08-03 13:51:28,926] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-03 13:51:29,003] {result_logger:134} INFO - 
[[145264   1264   3580]
 [  1571  87638   2322]
 [  4386   3450 116645]]
[2024-08-03 13:51:29,076] {result_logger:141} INFO - 
[[ 96.77%   0.84%   2.38%]
 [  1.72%  95.75%   2.54%]
 [  3.52%   2.77%  93.71%]]
[2024-08-03 13:51:29,150] {result_logger:145} INFO - 
[[ 96.06%   1.37%   2.92%]
 [  1.04%  94.90%   1.89%]
 [  2.90%   3.74%  95.18%]]
[2024-08-03 13:51:29,150] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-03 13:51:29,158] {result_logger:134} INFO - 
[[26111  1879   392]
 [   11  2513    21]
 [ 1043   988 18672]]
[2024-08-03 13:51:29,166] {result_logger:141} INFO - 
[[ 92.00%   6.62%   1.38%]
 [  0.43%  98.74%   0.83%]
 [  5.04%   4.77%  90.19%]]
[2024-08-03 13:51:29,174] {result_logger:145} INFO - 
[[ 96.12%  34.93%   2.05%]
 [  0.04%  46.71%   0.11%]
 [  3.84%  18.36%  97.84%]]
[2024-08-03 13:51:29,278] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-03 13:51:29,279] {result_logger:77} INFO - actual:
[2024-08-03 13:51:29,279] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-03 13:51:29,279] {result_logger:79} INFO - predicted:
[2024-08-03 13:51:29,279] {result_logger:80} INFO - 
[[92.08%  3.06%  4.87%]
 [24.65% 69.96%  5.39%]
 [ 4.33%  4.12% 91.55%]]
[2024-08-03 13:51:29,279] {run_experiment:113} INFO - [epoch  10] execution time: 163.85s	 avg f1-score: 0.8376

[2024-08-03 13:51:29,279] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-03 13:51:29,299] {dataloader:147} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2024-08-03 13:51:49,045] {train_model:82} INFO - Train Epoch: 11 [36352/366120 (10%)]	lr:2.35e-04	Loss: 0.100717
[2024-08-03 13:52:02,286] {train_model:82} INFO - Train Epoch: 11 [72960/366120 (20%)]	lr:2.35e-04	Loss: 0.294871
[2024-08-03 13:52:15,509] {train_model:82} INFO - Train Epoch: 11 [109568/366120 (30%)]	lr:2.35e-04	Loss: 0.111882
[2024-08-03 13:52:28,791] {train_model:82} INFO - Train Epoch: 11 [146176/366120 (40%)]	lr:2.35e-04	Loss: 0.068792
[2024-08-03 13:52:42,159] {train_model:82} INFO - Train Epoch: 11 [182784/366120 (50%)]	lr:2.35e-04	Loss: 0.086347
[2024-08-03 13:52:55,521] {train_model:82} INFO - Train Epoch: 11 [219392/366120 (60%)]	lr:2.35e-04	Loss: 1.721330
[2024-08-03 13:53:08,953] {train_model:82} INFO - Train Epoch: 11 [256000/366120 (70%)]	lr:2.35e-04	Loss: 0.111918
[2024-08-03 13:53:33,845] {train_model:82} INFO - Train Epoch: 11 [292608/366120 (80%)]	lr:2.35e-04	Loss: 0.105320
[2024-08-03 13:53:46,977] {train_model:82} INFO - Train Epoch: 11 [329216/366120 (90%)]	lr:2.35e-04	Loss: 0.139040
[2024-08-03 13:54:00,347] {train_model:82} INFO - Train Epoch: 11 [365824/366120 (100%)]	lr:2.35e-04	Loss: 0.069505
[2024-08-03 13:54:07,211] {run_experiment:79} INFO - 
[2024-08-03 13:54:07,211] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-03 13:54:08,002] {result_logger:103} INFO - precision on Wake: 0.965
[2024-08-03 13:54:08,535] {result_logger:104} INFO - recall on Wake: 0.969
[2024-08-03 13:54:09,079] {result_logger:107} INFO - F1-score on Wake: 0.967
[2024-08-03 13:54:09,079] {result_logger:108} INFO - 
[2024-08-03 13:54:09,854] {result_logger:103} INFO - precision on REM: 0.953
[2024-08-03 13:54:10,334] {result_logger:104} INFO - recall on REM: 0.965
[2024-08-03 13:54:10,815] {result_logger:107} INFO - F1-score on REM: 0.959
[2024-08-03 13:54:10,815] {result_logger:108} INFO - 
[2024-08-03 13:54:11,544] {result_logger:103} INFO - precision on Non REM: 0.954
[2024-08-03 13:54:12,013] {result_logger:104} INFO - recall on Non REM: 0.941
[2024-08-03 13:54:12,479] {result_logger:107} INFO - F1-score on Non REM: 0.947
[2024-08-03 13:54:12,479] {result_logger:108} INFO - 
[2024-08-03 13:54:12,597] {result_logger:111} INFO - average precision on sleep stages: 0.957
[2024-08-03 13:54:12,714] {result_logger:113} INFO - average recall on sleep stages: 0.958
[2024-08-03 13:54:12,827] {result_logger:115} INFO - average F1-score on sleep stages: 0.958
[2024-08-03 13:54:12,828] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-03 13:54:12,922] {result_logger:103} INFO - precision on Wake: 0.919
[2024-08-03 13:54:12,980] {result_logger:104} INFO - recall on Wake: 0.993
[2024-08-03 13:54:13,037] {result_logger:107} INFO - F1-score on Wake: 0.955
[2024-08-03 13:54:13,037] {result_logger:108} INFO - 
[2024-08-03 13:54:13,126] {result_logger:103} INFO - precision on REM: 0.727
[2024-08-03 13:54:13,182] {result_logger:104} INFO - recall on REM: 0.985
[2024-08-03 13:54:13,236] {result_logger:107} INFO - F1-score on REM: 0.837
[2024-08-03 13:54:13,236] {result_logger:108} INFO - 
[2024-08-03 13:54:13,327] {result_logger:103} INFO - precision on Non REM: 0.993
[2024-08-03 13:54:13,384] {result_logger:104} INFO - recall on Non REM: 0.842
[2024-08-03 13:54:13,441] {result_logger:107} INFO - F1-score on Non REM: 0.911
[2024-08-03 13:54:13,441] {result_logger:108} INFO - 
[2024-08-03 13:54:13,452] {result_logger:111} INFO - average precision on sleep stages: 0.880
[2024-08-03 13:54:13,463] {result_logger:113} INFO - average recall on sleep stages: 0.940
[2024-08-03 13:54:13,474] {result_logger:115} INFO - average F1-score on sleep stages: 0.901
[2024-08-03 13:54:13,474] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-03 13:54:13,551] {result_logger:134} INFO - 
[[145504   1097   3510]
 [  1128  88322   2081]
 [  4090   3302 117086]]
[2024-08-03 13:54:13,629] {result_logger:141} INFO - 
[[ 96.93%   0.73%   2.34%]
 [  1.23%  96.49%   2.27%]
 [  3.29%   2.65%  94.06%]]
[2024-08-03 13:54:13,707] {result_logger:145} INFO - 
[[ 96.54%   1.18%   2.86%]
 [  0.75%  95.26%   1.70%]
 [  2.71%   3.56%  95.44%]]
[2024-08-03 13:54:13,708] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-03 13:54:13,716] {result_logger:134} INFO - 
[[28174   109    99]
 [   22  2506    17]
 [ 2451   830 17422]]
[2024-08-03 13:54:13,825] {result_logger:141} INFO - 
[[ 99.27%   0.38%   0.35%]
 [  0.86%  98.47%   0.67%]
 [ 11.84%   4.01%  84.15%]]
[2024-08-03 13:54:13,928] {result_logger:145} INFO - 
[[ 91.93%   3.16%   0.56%]
 [  0.07%  72.74%   0.10%]
 [  8.00%  24.09%  99.34%]]
[2024-08-03 13:54:14,334] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-03 13:54:14,334] {result_logger:77} INFO - actual:
[2024-08-03 13:54:14,334] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-03 13:54:14,334] {result_logger:79} INFO - predicted:
[2024-08-03 13:54:14,334] {result_logger:80} INFO - 
[[93.46%  0.28%  6.25%]
 [19.59% 77.50%  2.90%]
 [ 7.57%  3.92% 88.50%]]
[2024-08-03 13:54:14,392] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_C/model_8conv_2fc-best.pth
[2024-08-03 13:54:14,392] {run_experiment:113} INFO - [epoch  11] execution time: 165.11s	 avg f1-score: 0.9008

[2024-08-03 13:54:14,392] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-03 13:54:14,414] {dataloader:147} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2024-08-03 13:54:34,037] {train_model:82} INFO - Train Epoch: 12 [36352/366120 (10%)]	lr:2.56e-04	Loss: 0.104507
[2024-08-03 13:54:47,313] {train_model:82} INFO - Train Epoch: 12 [72960/366120 (20%)]	lr:2.56e-04	Loss: 0.115433
[2024-08-03 13:55:00,609] {train_model:82} INFO - Train Epoch: 12 [109568/366120 (30%)]	lr:2.56e-04	Loss: 0.160859
[2024-08-03 13:55:14,027] {train_model:82} INFO - Train Epoch: 12 [146176/366120 (40%)]	lr:2.56e-04	Loss: 0.158262
[2024-08-03 13:55:27,373] {train_model:82} INFO - Train Epoch: 12 [182784/366120 (50%)]	lr:2.56e-04	Loss: 0.429584
[2024-08-03 13:55:40,734] {train_model:82} INFO - Train Epoch: 12 [219392/366120 (60%)]	lr:2.56e-04	Loss: 0.070737
[2024-08-03 13:55:58,914] {train_model:82} INFO - Train Epoch: 12 [256000/366120 (70%)]	lr:2.56e-04	Loss: 1.840306
[2024-08-03 13:56:18,460] {train_model:82} INFO - Train Epoch: 12 [292608/366120 (80%)]	lr:2.56e-04	Loss: 2.557084
[2024-08-03 13:56:31,696] {train_model:82} INFO - Train Epoch: 12 [329216/366120 (90%)]	lr:2.56e-04	Loss: 0.083159
[2024-08-03 13:56:45,216] {train_model:82} INFO - Train Epoch: 12 [365824/366120 (100%)]	lr:2.56e-04	Loss: 2.682325
[2024-08-03 13:56:52,516] {run_experiment:79} INFO - 
[2024-08-03 13:56:52,517] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-03 13:56:53,373] {result_logger:103} INFO - precision on Wake: 0.968
[2024-08-03 13:56:53,923] {result_logger:104} INFO - recall on Wake: 0.972
[2024-08-03 13:56:54,467] {result_logger:107} INFO - F1-score on Wake: 0.970
[2024-08-03 13:56:54,468] {result_logger:108} INFO - 
[2024-08-03 13:56:55,230] {result_logger:103} INFO - precision on REM: 0.956
[2024-08-03 13:56:55,715] {result_logger:104} INFO - recall on REM: 0.968
[2024-08-03 13:56:56,193] {result_logger:107} INFO - F1-score on REM: 0.962
[2024-08-03 13:56:56,193] {result_logger:108} INFO - 
[2024-08-03 13:56:56,960] {result_logger:103} INFO - precision on Non REM: 0.958
[2024-08-03 13:56:57,436] {result_logger:104} INFO - recall on Non REM: 0.943
[2024-08-03 13:56:57,910] {result_logger:107} INFO - F1-score on Non REM: 0.950
[2024-08-03 13:56:57,910] {result_logger:108} INFO - 
[2024-08-03 13:56:58,024] {result_logger:111} INFO - average precision on sleep stages: 0.960
[2024-08-03 13:56:58,139] {result_logger:113} INFO - average recall on sleep stages: 0.961
[2024-08-03 13:56:58,256] {result_logger:115} INFO - average F1-score on sleep stages: 0.961
[2024-08-03 13:56:58,257] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-03 13:56:58,357] {result_logger:103} INFO - precision on Wake: 0.947
[2024-08-03 13:56:58,415] {result_logger:104} INFO - recall on Wake: 0.966
[2024-08-03 13:56:58,473] {result_logger:107} INFO - F1-score on Wake: 0.957
[2024-08-03 13:56:58,473] {result_logger:108} INFO - 
[2024-08-03 13:56:58,565] {result_logger:103} INFO - precision on REM: 0.653
[2024-08-03 13:56:58,624] {result_logger:104} INFO - recall on REM: 0.981
[2024-08-03 13:56:58,679] {result_logger:107} INFO - F1-score on REM: 0.784
[2024-08-03 13:56:58,680] {result_logger:108} INFO - 
[2024-08-03 13:56:58,775] {result_logger:103} INFO - precision on Non REM: 0.984
[2024-08-03 13:56:58,834] {result_logger:104} INFO - recall on Non REM: 0.896
[2024-08-03 13:56:58,893] {result_logger:107} INFO - F1-score on Non REM: 0.938
[2024-08-03 13:56:58,893] {result_logger:108} INFO - 
[2024-08-03 13:56:58,905] {result_logger:111} INFO - average precision on sleep stages: 0.861
[2024-08-03 13:56:58,917] {result_logger:113} INFO - average recall on sleep stages: 0.948
[2024-08-03 13:56:58,928] {result_logger:115} INFO - average F1-score on sleep stages: 0.893
[2024-08-03 13:56:58,928] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-03 13:56:59,005] {result_logger:134} INFO - 
[[145968    917   3222]
 [   977  88582   1972]
 [  3910   3189 117383]]
[2024-08-03 13:56:59,081] {result_logger:141} INFO - 
[[ 97.24%   0.61%   2.15%]
 [  1.07%  96.78%   2.15%]
 [  3.14%   2.56%  94.30%]]
[2024-08-03 13:56:59,160] {result_logger:145} INFO - 
[[ 96.76%   0.99%   2.63%]
 [  0.65%  95.57%   1.61%]
 [  2.59%   3.44%  95.76%]]
[2024-08-03 13:56:59,161] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-03 13:56:59,169] {result_logger:134} INFO - 
[[27423   686   273]
 [   11  2496    38]
 [ 1521   640 18542]]
[2024-08-03 13:56:59,178] {result_logger:141} INFO - 
[[ 96.62%   2.42%   0.96%]
 [  0.43%  98.07%   1.49%]
 [  7.35%   3.09%  89.56%]]
[2024-08-03 13:56:59,186] {result_logger:145} INFO - 
[[ 94.71%  17.95%   1.45%]
 [  0.04%  65.31%   0.20%]
 [  5.25%  16.75%  98.35%]]
[2024-08-03 13:56:59,290] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-03 13:56:59,290] {result_logger:77} INFO - actual:
[2024-08-03 13:56:59,290] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-03 13:56:59,290] {result_logger:79} INFO - predicted:
[2024-08-03 13:56:59,291] {result_logger:80} INFO - 
[[92.77%  1.31%  5.92%]
 [23.81% 73.10%  3.09%]
 [ 6.27%  3.45% 90.28%]]
[2024-08-03 13:56:59,291] {run_experiment:113} INFO - [epoch  12] execution time: 164.90s	 avg f1-score: 0.8927

[2024-08-03 13:56:59,291] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-03 13:56:59,313] {dataloader:147} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2024-08-03 13:57:18,848] {train_model:82} INFO - Train Epoch: 13 [36352/366120 (10%)]	lr:2.41e-04	Loss: 1.224678
[2024-08-03 13:57:32,086] {train_model:82} INFO - Train Epoch: 13 [72960/366120 (20%)]	lr:2.41e-04	Loss: 0.108229
[2024-08-03 13:57:45,420] {train_model:82} INFO - Train Epoch: 13 [109568/366120 (30%)]	lr:2.41e-04	Loss: 0.623926
[2024-08-03 13:57:58,800] {train_model:82} INFO - Train Epoch: 13 [146176/366120 (40%)]	lr:2.41e-04	Loss: 0.078793
[2024-08-03 13:58:12,156] {train_model:82} INFO - Train Epoch: 13 [182784/366120 (50%)]	lr:2.41e-04	Loss: 0.082270
[2024-08-03 13:58:25,648] {train_model:82} INFO - Train Epoch: 13 [219392/366120 (60%)]	lr:2.41e-04	Loss: 0.066716
[2024-08-03 13:58:43,894] {train_model:82} INFO - Train Epoch: 13 [256000/366120 (70%)]	lr:2.41e-04	Loss: 0.080356
[2024-08-03 13:59:02,851] {train_model:82} INFO - Train Epoch: 13 [292608/366120 (80%)]	lr:2.41e-04	Loss: 0.122903
[2024-08-03 13:59:16,140] {train_model:82} INFO - Train Epoch: 13 [329216/366120 (90%)]	lr:2.41e-04	Loss: 0.107621
[2024-08-03 13:59:29,570] {train_model:82} INFO - Train Epoch: 13 [365824/366120 (100%)]	lr:2.41e-04	Loss: 0.102003
[2024-08-03 13:59:37,079] {run_experiment:79} INFO - 
[2024-08-03 13:59:37,079] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-03 13:59:37,922] {result_logger:103} INFO - precision on Wake: 0.971
[2024-08-03 13:59:38,464] {result_logger:104} INFO - recall on Wake: 0.974
[2024-08-03 13:59:39,007] {result_logger:107} INFO - F1-score on Wake: 0.973
[2024-08-03 13:59:39,007] {result_logger:108} INFO - 
[2024-08-03 13:59:39,794] {result_logger:103} INFO - precision on REM: 0.958
[2024-08-03 13:59:40,280] {result_logger:104} INFO - recall on REM: 0.973
[2024-08-03 13:59:40,760] {result_logger:107} INFO - F1-score on REM: 0.965
[2024-08-03 13:59:40,760] {result_logger:108} INFO - 
[2024-08-03 13:59:41,516] {result_logger:103} INFO - precision on Non REM: 0.959
[2024-08-03 13:59:41,986] {result_logger:104} INFO - recall on Non REM: 0.945
[2024-08-03 13:59:42,452] {result_logger:107} INFO - F1-score on Non REM: 0.952
[2024-08-03 13:59:42,453] {result_logger:108} INFO - 
[2024-08-03 13:59:42,571] {result_logger:111} INFO - average precision on sleep stages: 0.963
[2024-08-03 13:59:42,692] {result_logger:113} INFO - average recall on sleep stages: 0.964
[2024-08-03 13:59:42,812] {result_logger:115} INFO - average F1-score on sleep stages: 0.963
[2024-08-03 13:59:42,813] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-03 13:59:42,916] {result_logger:103} INFO - precision on Wake: 0.970
[2024-08-03 13:59:42,974] {result_logger:104} INFO - recall on Wake: 0.968
[2024-08-03 13:59:43,033] {result_logger:107} INFO - F1-score on Wake: 0.969
[2024-08-03 13:59:43,034] {result_logger:108} INFO - 
[2024-08-03 13:59:43,128] {result_logger:103} INFO - precision on REM: 0.726
[2024-08-03 13:59:43,185] {result_logger:104} INFO - recall on REM: 0.971
[2024-08-03 13:59:43,243] {result_logger:107} INFO - F1-score on REM: 0.831
[2024-08-03 13:59:43,244] {result_logger:108} INFO - 
[2024-08-03 13:59:43,342] {result_logger:103} INFO - precision on Non REM: 0.967
[2024-08-03 13:59:43,402] {result_logger:104} INFO - recall on Non REM: 0.930
[2024-08-03 13:59:43,461] {result_logger:107} INFO - F1-score on Non REM: 0.948
[2024-08-03 13:59:43,461] {result_logger:108} INFO - 
[2024-08-03 13:59:43,472] {result_logger:111} INFO - average precision on sleep stages: 0.888
[2024-08-03 13:59:43,484] {result_logger:113} INFO - average recall on sleep stages: 0.956
[2024-08-03 13:59:43,495] {result_logger:115} INFO - average F1-score on sleep stages: 0.916
[2024-08-03 13:59:43,496] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-03 13:59:43,578] {result_logger:134} INFO - 
[[146202    759   3147]
 [   646  89063   1822]
 [  3663   3182 117636]]
[2024-08-03 13:59:43,661] {result_logger:141} INFO - 
[[ 97.40%   0.51%   2.10%]
 [  0.71%  97.30%   1.99%]
 [  2.94%   2.56%  94.50%]]
[2024-08-03 13:59:43,743] {result_logger:145} INFO - 
[[ 97.14%   0.82%   2.57%]
 [  0.43%  95.76%   1.49%]
 [  2.43%   3.42%  95.95%]]
[2024-08-03 13:59:43,743] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-03 13:59:43,752] {result_logger:134} INFO - 
[[27467   289   626]
 [   35  2472    38]
 [  805   643 19255]]
[2024-08-03 13:59:43,864] {result_logger:141} INFO - 
[[ 96.78%   1.02%   2.21%]
 [  1.38%  97.13%   1.49%]
 [  3.89%   3.11%  93.01%]]
[2024-08-03 13:59:43,974] {result_logger:145} INFO - 
[[ 97.03%   8.49%   3.14%]
 [  0.12%  72.62%   0.19%]
 [  2.84%  18.89%  96.67%]]
[2024-08-03 13:59:44,273] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-03 13:59:44,273] {result_logger:77} INFO - actual:
[2024-08-03 13:59:44,273] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-03 13:59:44,273] {result_logger:79} INFO - predicted:
[2024-08-03 13:59:44,273] {result_logger:80} INFO - 
[[93.87%  0.64%  5.48%]
 [19.80% 75.68%  4.52%]
 [ 5.32%  3.24% 91.44%]]
[2024-08-03 13:59:44,331] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_C/model_8conv_2fc-best.pth
[2024-08-03 13:59:44,332] {run_experiment:113} INFO - [epoch  13] execution time: 165.04s	 avg f1-score: 0.9160

[2024-08-03 13:59:44,332] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-03 13:59:44,352] {dataloader:147} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2024-08-03 14:00:03,988] {train_model:82} INFO - Train Epoch: 14 [36352/366120 (10%)]	lr:2.27e-04	Loss: 0.078021
[2024-08-03 14:00:17,147] {train_model:82} INFO - Train Epoch: 14 [72960/366120 (20%)]	lr:2.27e-04	Loss: 0.063942
[2024-08-03 14:00:30,544] {train_model:82} INFO - Train Epoch: 14 [109568/366120 (30%)]	lr:2.27e-04	Loss: 0.107489
[2024-08-03 14:00:44,059] {train_model:82} INFO - Train Epoch: 14 [146176/366120 (40%)]	lr:2.27e-04	Loss: 0.318120
[2024-08-03 14:00:57,662] {train_model:82} INFO - Train Epoch: 14 [182784/366120 (50%)]	lr:2.27e-04	Loss: 0.089221
[2024-08-03 14:01:11,155] {train_model:82} INFO - Train Epoch: 14 [219392/366120 (60%)]	lr:2.27e-04	Loss: 0.073549
[2024-08-03 14:01:36,092] {train_model:82} INFO - Train Epoch: 14 [256000/366120 (70%)]	lr:2.27e-04	Loss: 0.051112
[2024-08-03 14:01:49,238] {train_model:82} INFO - Train Epoch: 14 [292608/366120 (80%)]	lr:2.27e-04	Loss: 0.086852
[2024-08-03 14:02:02,640] {train_model:82} INFO - Train Epoch: 14 [329216/366120 (90%)]	lr:2.27e-04	Loss: 0.157124
[2024-08-03 14:02:15,977] {train_model:82} INFO - Train Epoch: 14 [365824/366120 (100%)]	lr:2.27e-04	Loss: 0.149358
[2024-08-03 14:02:23,407] {run_experiment:79} INFO - 
[2024-08-03 14:02:23,408] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-03 14:02:24,246] {result_logger:103} INFO - precision on Wake: 0.973
[2024-08-03 14:02:24,788] {result_logger:104} INFO - recall on Wake: 0.974
[2024-08-03 14:02:25,326] {result_logger:107} INFO - F1-score on Wake: 0.974
[2024-08-03 14:02:25,327] {result_logger:108} INFO - 
[2024-08-03 14:02:26,123] {result_logger:103} INFO - precision on REM: 0.961
[2024-08-03 14:02:26,607] {result_logger:104} INFO - recall on REM: 0.975
[2024-08-03 14:02:27,082] {result_logger:107} INFO - F1-score on REM: 0.968
[2024-08-03 14:02:27,083] {result_logger:108} INFO - 
[2024-08-03 14:02:27,841] {result_logger:103} INFO - precision on Non REM: 0.961
[2024-08-03 14:02:28,313] {result_logger:104} INFO - recall on Non REM: 0.949
[2024-08-03 14:02:28,786] {result_logger:107} INFO - F1-score on Non REM: 0.955
[2024-08-03 14:02:28,786] {result_logger:108} INFO - 
[2024-08-03 14:02:28,904] {result_logger:111} INFO - average precision on sleep stages: 0.965
[2024-08-03 14:02:29,020] {result_logger:113} INFO - average recall on sleep stages: 0.966
[2024-08-03 14:02:29,138] {result_logger:115} INFO - average F1-score on sleep stages: 0.966
[2024-08-03 14:02:29,139] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-03 14:02:29,236] {result_logger:103} INFO - precision on Wake: 0.968
[2024-08-03 14:02:29,294] {result_logger:104} INFO - recall on Wake: 0.981
[2024-08-03 14:02:29,352] {result_logger:107} INFO - F1-score on Wake: 0.975
[2024-08-03 14:02:29,352] {result_logger:108} INFO - 
[2024-08-03 14:02:29,450] {result_logger:103} INFO - precision on REM: 0.765
[2024-08-03 14:02:29,505] {result_logger:104} INFO - recall on REM: 0.977
[2024-08-03 14:02:29,562] {result_logger:107} INFO - F1-score on REM: 0.858
[2024-08-03 14:02:29,562] {result_logger:108} INFO - 
[2024-08-03 14:02:29,662] {result_logger:103} INFO - precision on Non REM: 0.980
[2024-08-03 14:02:29,721] {result_logger:104} INFO - recall on Non REM: 0.928
[2024-08-03 14:02:29,780] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2024-08-03 14:02:29,780] {result_logger:108} INFO - 
[2024-08-03 14:02:29,792] {result_logger:111} INFO - average precision on sleep stages: 0.904
[2024-08-03 14:02:29,803] {result_logger:113} INFO - average recall on sleep stages: 0.962
[2024-08-03 14:02:29,815] {result_logger:115} INFO - average F1-score on sleep stages: 0.929
[2024-08-03 14:02:29,816] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-03 14:02:29,893] {result_logger:134} INFO - 
[[146276    752   3080]
 [   553  89277   1701]
 [  3487   2833 118161]]
[2024-08-03 14:02:29,972] {result_logger:141} INFO - 
[[ 97.45%   0.50%   2.05%]
 [  0.60%  97.54%   1.86%]
 [  2.80%   2.28%  94.92%]]
[2024-08-03 14:02:30,051] {result_logger:145} INFO - 
[[ 97.31%   0.81%   2.51%]
 [  0.37%  96.14%   1.38%]
 [  2.32%   3.05%  96.11%]]
[2024-08-03 14:02:30,051] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-03 14:02:30,059] {result_logger:134} INFO - 
[[27852   188   342]
 [   12  2486    47]
 [  909   575 19219]]
[2024-08-03 14:02:30,172] {result_logger:141} INFO - 
[[ 98.13%   0.66%   1.20%]
 [  0.47%  97.68%   1.85%]
 [  4.39%   2.78%  92.83%]]
[2024-08-03 14:02:30,277] {result_logger:145} INFO - 
[[ 96.80%   5.79%   1.74%]
 [  0.04%  76.52%   0.24%]
 [  3.16%  17.70%  98.02%]]
[2024-08-03 14:02:30,584] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-03 14:02:30,584] {result_logger:77} INFO - actual:
[2024-08-03 14:02:30,584] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-03 14:02:30,584] {result_logger:79} INFO - predicted:
[2024-08-03 14:02:30,585] {result_logger:80} INFO - 
[[94.50%  0.34%  5.16%]
 [17.73% 77.29%  4.99%]
 [ 5.13%  3.26% 91.61%]]
[2024-08-03 14:02:30,643] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_C/model_8conv_2fc-best.pth
[2024-08-03 14:02:30,644] {run_experiment:113} INFO - [epoch  14] execution time: 166.31s	 avg f1-score: 0.9288

[2024-08-03 14:02:30,644] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-03 14:02:30,667] {dataloader:147} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2024-08-03 14:02:50,355] {train_model:82} INFO - Train Epoch: 15 [36352/366120 (10%)]	lr:2.14e-04	Loss: 0.064206
[2024-08-03 14:03:03,534] {train_model:82} INFO - Train Epoch: 15 [72960/366120 (20%)]	lr:2.14e-04	Loss: 0.054672
[2024-08-03 14:03:16,836] {train_model:82} INFO - Train Epoch: 15 [109568/366120 (30%)]	lr:2.14e-04	Loss: 0.078704
[2024-08-03 14:03:30,200] {train_model:82} INFO - Train Epoch: 15 [146176/366120 (40%)]	lr:2.14e-04	Loss: 0.128713
[2024-08-03 14:03:43,555] {train_model:82} INFO - Train Epoch: 15 [182784/366120 (50%)]	lr:2.14e-04	Loss: 0.087069
[2024-08-03 14:04:01,497] {train_model:82} INFO - Train Epoch: 15 [219392/366120 (60%)]	lr:2.14e-04	Loss: 0.155119
[2024-08-03 14:04:21,124] {train_model:82} INFO - Train Epoch: 15 [256000/366120 (70%)]	lr:2.14e-04	Loss: 0.100828
[2024-08-03 14:04:34,416] {train_model:82} INFO - Train Epoch: 15 [292608/366120 (80%)]	lr:2.14e-04	Loss: 0.043064
[2024-08-03 14:04:47,825] {train_model:82} INFO - Train Epoch: 15 [329216/366120 (90%)]	lr:2.14e-04	Loss: 0.088928
[2024-08-03 14:05:01,303] {train_model:82} INFO - Train Epoch: 15 [365824/366120 (100%)]	lr:2.14e-04	Loss: 0.041586
[2024-08-03 14:05:08,901] {run_experiment:79} INFO - 
[2024-08-03 14:05:08,901] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-03 14:05:09,728] {result_logger:103} INFO - precision on Wake: 0.974
[2024-08-03 14:05:10,278] {result_logger:104} INFO - recall on Wake: 0.976
[2024-08-03 14:05:10,819] {result_logger:107} INFO - F1-score on Wake: 0.975
[2024-08-03 14:05:10,819] {result_logger:108} INFO - 
[2024-08-03 14:05:11,595] {result_logger:103} INFO - precision on REM: 0.962
[2024-08-03 14:05:12,071] {result_logger:104} INFO - recall on REM: 0.980
[2024-08-03 14:05:12,543] {result_logger:107} INFO - F1-score on REM: 0.971
[2024-08-03 14:05:12,543] {result_logger:108} INFO - 
[2024-08-03 14:05:13,289] {result_logger:103} INFO - precision on Non REM: 0.965
[2024-08-03 14:05:13,758] {result_logger:104} INFO - recall on Non REM: 0.950
[2024-08-03 14:05:14,223] {result_logger:107} INFO - F1-score on Non REM: 0.958
[2024-08-03 14:05:14,223] {result_logger:108} INFO - 
[2024-08-03 14:05:14,340] {result_logger:111} INFO - average precision on sleep stages: 0.967
[2024-08-03 14:05:14,455] {result_logger:113} INFO - average recall on sleep stages: 0.969
[2024-08-03 14:05:14,572] {result_logger:115} INFO - average F1-score on sleep stages: 0.968
[2024-08-03 14:05:14,573] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-03 14:05:14,668] {result_logger:103} INFO - precision on Wake: 0.962
[2024-08-03 14:05:14,726] {result_logger:104} INFO - recall on Wake: 0.983
[2024-08-03 14:05:14,784] {result_logger:107} INFO - F1-score on Wake: 0.973
[2024-08-03 14:05:14,784] {result_logger:108} INFO - 
[2024-08-03 14:05:14,878] {result_logger:103} INFO - precision on REM: 0.796
[2024-08-03 14:05:14,935] {result_logger:104} INFO - recall on REM: 0.974
[2024-08-03 14:05:14,988] {result_logger:107} INFO - F1-score on REM: 0.876
[2024-08-03 14:05:14,989] {result_logger:108} INFO - 
[2024-08-03 14:05:15,080] {result_logger:103} INFO - precision on Non REM: 0.977
[2024-08-03 14:05:15,138] {result_logger:104} INFO - recall on Non REM: 0.921
[2024-08-03 14:05:15,196] {result_logger:107} INFO - F1-score on Non REM: 0.948
[2024-08-03 14:05:15,196] {result_logger:108} INFO - 
[2024-08-03 14:05:15,208] {result_logger:111} INFO - average precision on sleep stages: 0.912
[2024-08-03 14:05:15,220] {result_logger:113} INFO - average recall on sleep stages: 0.960
[2024-08-03 14:05:15,232] {result_logger:115} INFO - average F1-score on sleep stages: 0.932
[2024-08-03 14:05:15,232] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-03 14:05:15,311] {result_logger:134} INFO - 
[[146554    647   2907]
 [   508  89702   1319]
 [  3399   2865 118219]]
[2024-08-03 14:05:15,390] {result_logger:141} INFO - 
[[ 97.63%   0.43%   1.94%]
 [  0.56%  98.00%   1.44%]
 [  2.73%   2.30%  94.97%]]
[2024-08-03 14:05:15,468] {result_logger:145} INFO - 
[[ 97.40%   0.69%   2.37%]
 [  0.34%  96.23%   1.08%]
 [  2.26%   3.07%  96.55%]]
[2024-08-03 14:05:15,469] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-03 14:05:15,477] {result_logger:134} INFO - 
[[27901    77   404]
 [   18  2480    47]
 [ 1074   560 19069]]
[2024-08-03 14:05:15,589] {result_logger:141} INFO - 
[[ 98.31%   0.27%   1.42%]
 [  0.71%  97.45%   1.85%]
 [  5.19%   2.70%  92.11%]]
[2024-08-03 14:05:15,692] {result_logger:145} INFO - 
[[ 96.23%   2.47%   2.07%]
 [  0.06%  79.56%   0.24%]
 [  3.70%  17.97%  97.69%]]
[2024-08-03 14:05:15,989] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-03 14:05:15,990] {result_logger:77} INFO - actual:
[2024-08-03 14:05:15,990] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-03 14:05:15,990] {result_logger:79} INFO - predicted:
[2024-08-03 14:05:15,990] {result_logger:80} INFO - 
[[94.22%  0.14%  5.64%]
 [17.52% 78.28%  4.20%]
 [ 5.79%  3.26% 90.95%]]
[2024-08-03 14:05:16,046] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_C/model_8conv_2fc-best.pth
[2024-08-03 14:05:16,047] {run_experiment:113} INFO - [epoch  15] execution time: 165.40s	 avg f1-score: 0.9323

[2024-08-03 14:05:16,047] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-03 14:05:16,066] {dataloader:147} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2024-08-03 14:05:35,797] {train_model:82} INFO - Train Epoch: 16 [36352/366120 (10%)]	lr:2.01e-04	Loss: 0.057906
[2024-08-03 14:05:49,178] {train_model:82} INFO - Train Epoch: 16 [72960/366120 (20%)]	lr:2.01e-04	Loss: 0.101033
[2024-08-03 14:06:02,536] {train_model:82} INFO - Train Epoch: 16 [109568/366120 (30%)]	lr:2.01e-04	Loss: 0.092013
[2024-08-03 14:06:16,031] {train_model:82} INFO - Train Epoch: 16 [146176/366120 (40%)]	lr:2.01e-04	Loss: 0.076367
[2024-08-03 14:06:29,490] {train_model:82} INFO - Train Epoch: 16 [182784/366120 (50%)]	lr:2.01e-04	Loss: 0.054749
[2024-08-03 14:06:47,507] {train_model:82} INFO - Train Epoch: 16 [219392/366120 (60%)]	lr:2.01e-04	Loss: 0.091080
[2024-08-03 14:07:06,583] {train_model:82} INFO - Train Epoch: 16 [256000/366120 (70%)]	lr:2.01e-04	Loss: 0.096802
[2024-08-03 14:07:19,906] {train_model:82} INFO - Train Epoch: 16 [292608/366120 (80%)]	lr:2.01e-04	Loss: 0.088125
[2024-08-03 14:07:33,323] {train_model:82} INFO - Train Epoch: 16 [329216/366120 (90%)]	lr:2.01e-04	Loss: 0.039096
[2024-08-03 14:07:46,672] {train_model:82} INFO - Train Epoch: 16 [365824/366120 (100%)]	lr:2.01e-04	Loss: 0.070524
[2024-08-03 14:07:54,078] {run_experiment:79} INFO - 
[2024-08-03 14:07:54,078] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-03 14:07:54,922] {result_logger:103} INFO - precision on Wake: 0.977
[2024-08-03 14:07:55,471] {result_logger:104} INFO - recall on Wake: 0.978
[2024-08-03 14:07:56,016] {result_logger:107} INFO - F1-score on Wake: 0.978
[2024-08-03 14:07:56,016] {result_logger:108} INFO - 
[2024-08-03 14:07:56,798] {result_logger:103} INFO - precision on REM: 0.967
[2024-08-03 14:07:57,279] {result_logger:104} INFO - recall on REM: 0.985
[2024-08-03 14:07:57,751] {result_logger:107} INFO - F1-score on REM: 0.976
[2024-08-03 14:07:57,752] {result_logger:108} INFO - 
[2024-08-03 14:07:58,516] {result_logger:103} INFO - precision on Non REM: 0.969
[2024-08-03 14:07:58,989] {result_logger:104} INFO - recall on Non REM: 0.955
[2024-08-03 14:07:59,461] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2024-08-03 14:07:59,461] {result_logger:108} INFO - 
[2024-08-03 14:07:59,580] {result_logger:111} INFO - average precision on sleep stages: 0.971
[2024-08-03 14:07:59,698] {result_logger:113} INFO - average recall on sleep stages: 0.973
[2024-08-03 14:07:59,816] {result_logger:115} INFO - average F1-score on sleep stages: 0.972
[2024-08-03 14:07:59,817] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-03 14:07:59,915] {result_logger:103} INFO - precision on Wake: 0.978
[2024-08-03 14:07:59,972] {result_logger:104} INFO - recall on Wake: 0.959
[2024-08-03 14:08:00,029] {result_logger:107} INFO - F1-score on Wake: 0.969
[2024-08-03 14:08:00,029] {result_logger:108} INFO - 
[2024-08-03 14:08:00,124] {result_logger:103} INFO - precision on REM: 0.679
[2024-08-03 14:08:00,181] {result_logger:104} INFO - recall on REM: 0.981
[2024-08-03 14:08:00,238] {result_logger:107} INFO - F1-score on REM: 0.802
[2024-08-03 14:08:00,238] {result_logger:108} INFO - 
[2024-08-03 14:08:00,335] {result_logger:103} INFO - precision on Non REM: 0.968
[2024-08-03 14:08:00,393] {result_logger:104} INFO - recall on Non REM: 0.940
[2024-08-03 14:08:00,450] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2024-08-03 14:08:00,451] {result_logger:108} INFO - 
[2024-08-03 14:08:00,462] {result_logger:111} INFO - average precision on sleep stages: 0.875
[2024-08-03 14:08:00,474] {result_logger:113} INFO - average recall on sleep stages: 0.960
[2024-08-03 14:08:00,486] {result_logger:115} INFO - average F1-score on sleep stages: 0.908
[2024-08-03 14:08:00,486] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-03 14:08:00,568] {result_logger:134} INFO - 
[[146852    529   2728]
 [   349  90138   1043]
 [  3077   2582 118822]]
[2024-08-03 14:08:00,650] {result_logger:141} INFO - 
[[ 97.83%   0.35%   1.82%]
 [  0.38%  98.48%   1.14%]
 [  2.47%   2.07%  95.45%]]
[2024-08-03 14:08:00,734] {result_logger:145} INFO - 
[[ 97.72%   0.57%   2.23%]
 [  0.23%  96.66%   0.85%]
 [  2.05%   2.77%  96.92%]]
[2024-08-03 14:08:00,734] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-03 14:08:00,743] {result_logger:134} INFO - 
[[27224   545   613]
 [    7  2497    41]
 [  595   638 19470]]
[2024-08-03 14:08:00,751] {result_logger:141} INFO - 
[[ 95.92%   1.92%   2.16%]
 [  0.28%  98.11%   1.61%]
 [  2.87%   3.08%  94.04%]]
[2024-08-03 14:08:00,759] {result_logger:145} INFO - 
[[ 97.84%  14.81%   3.05%]
 [  0.03%  67.85%   0.20%]
 [  2.14%  17.34%  96.75%]]
[2024-08-03 14:08:00,863] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-03 14:08:00,863] {result_logger:77} INFO - actual:
[2024-08-03 14:08:00,863] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-03 14:08:00,863] {result_logger:79} INFO - predicted:
[2024-08-03 14:08:00,863] {result_logger:80} INFO - 
[[93.71%  1.15%  5.14%]
 [21.39% 72.55%  6.06%]
 [ 4.78%  3.43% 91.79%]]
[2024-08-03 14:08:00,863] {run_experiment:113} INFO - [epoch  16] execution time: 164.82s	 avg f1-score: 0.9082

[2024-08-03 14:08:00,864] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-03 14:08:00,885] {dataloader:147} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2024-08-03 14:08:20,514] {train_model:82} INFO - Train Epoch: 17 [36352/366120 (10%)]	lr:1.90e-04	Loss: 0.037162
[2024-08-03 14:08:33,811] {train_model:82} INFO - Train Epoch: 17 [72960/366120 (20%)]	lr:1.90e-04	Loss: 0.037809
[2024-08-03 14:08:47,127] {train_model:82} INFO - Train Epoch: 17 [109568/366120 (30%)]	lr:1.90e-04	Loss: 0.112320
[2024-08-03 14:09:00,530] {train_model:82} INFO - Train Epoch: 17 [146176/366120 (40%)]	lr:1.90e-04	Loss: 0.050518
[2024-08-03 14:09:13,822] {train_model:82} INFO - Train Epoch: 17 [182784/366120 (50%)]	lr:1.90e-04	Loss: 0.115366
[2024-08-03 14:09:37,548] {train_model:82} INFO - Train Epoch: 17 [219392/366120 (60%)]	lr:1.90e-04	Loss: 0.051423
[2024-08-03 14:09:50,674] {train_model:82} INFO - Train Epoch: 17 [256000/366120 (70%)]	lr:1.90e-04	Loss: 0.122658
[2024-08-03 14:10:04,073] {train_model:82} INFO - Train Epoch: 17 [292608/366120 (80%)]	lr:1.90e-04	Loss: 0.086505
[2024-08-03 14:10:17,635] {train_model:82} INFO - Train Epoch: 17 [329216/366120 (90%)]	lr:1.90e-04	Loss: 0.117049
[2024-08-03 14:10:31,198] {train_model:82} INFO - Train Epoch: 17 [365824/366120 (100%)]	lr:1.90e-04	Loss: 0.074680
[2024-08-03 14:10:38,467] {run_experiment:79} INFO - 
[2024-08-03 14:10:38,468] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-03 14:10:39,297] {result_logger:103} INFO - precision on Wake: 0.978
[2024-08-03 14:10:39,841] {result_logger:104} INFO - recall on Wake: 0.979
[2024-08-03 14:10:40,396] {result_logger:107} INFO - F1-score on Wake: 0.979
[2024-08-03 14:10:40,396] {result_logger:108} INFO - 
[2024-08-03 14:10:41,182] {result_logger:103} INFO - precision on REM: 0.970
[2024-08-03 14:10:41,661] {result_logger:104} INFO - recall on REM: 0.987
[2024-08-03 14:10:42,137] {result_logger:107} INFO - F1-score on REM: 0.979
[2024-08-03 14:10:42,137] {result_logger:108} INFO - 
[2024-08-03 14:10:42,891] {result_logger:103} INFO - precision on Non REM: 0.971
[2024-08-03 14:10:43,359] {result_logger:104} INFO - recall on Non REM: 0.958
[2024-08-03 14:10:43,824] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2024-08-03 14:10:43,824] {result_logger:108} INFO - 
[2024-08-03 14:10:43,940] {result_logger:111} INFO - average precision on sleep stages: 0.973
[2024-08-03 14:10:44,056] {result_logger:113} INFO - average recall on sleep stages: 0.975
[2024-08-03 14:10:44,172] {result_logger:115} INFO - average F1-score on sleep stages: 0.974
[2024-08-03 14:10:44,174] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-03 14:10:44,269] {result_logger:103} INFO - precision on Wake: 0.971
[2024-08-03 14:10:44,326] {result_logger:104} INFO - recall on Wake: 0.982
[2024-08-03 14:10:44,383] {result_logger:107} INFO - F1-score on Wake: 0.976
[2024-08-03 14:10:44,383] {result_logger:108} INFO - 
[2024-08-03 14:10:44,476] {result_logger:103} INFO - precision on REM: 0.814
[2024-08-03 14:10:44,533] {result_logger:104} INFO - recall on REM: 0.967
[2024-08-03 14:10:44,590] {result_logger:107} INFO - F1-score on REM: 0.884
[2024-08-03 14:10:44,590] {result_logger:108} INFO - 
[2024-08-03 14:10:44,686] {result_logger:103} INFO - precision on Non REM: 0.974
[2024-08-03 14:10:44,744] {result_logger:104} INFO - recall on Non REM: 0.937
[2024-08-03 14:10:44,802] {result_logger:107} INFO - F1-score on Non REM: 0.955
[2024-08-03 14:10:44,802] {result_logger:108} INFO - 
[2024-08-03 14:10:44,813] {result_logger:111} INFO - average precision on sleep stages: 0.920
[2024-08-03 14:10:44,824] {result_logger:113} INFO - average recall on sleep stages: 0.962
[2024-08-03 14:10:44,836] {result_logger:115} INFO - average F1-score on sleep stages: 0.939
[2024-08-03 14:10:44,836] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-03 14:10:44,913] {result_logger:134} INFO - 
[[146989    489   2637]
 [   291  90362    877]
 [  2996   2292 119187]]
[2024-08-03 14:10:44,992] {result_logger:141} INFO - 
[[ 97.92%   0.33%   1.76%]
 [  0.32%  98.72%   0.96%]
 [  2.41%   1.84%  95.75%]]
[2024-08-03 14:10:45,069] {result_logger:145} INFO - 
[[ 97.81%   0.52%   2.15%]
 [  0.19%  97.01%   0.71%]
 [  1.99%   2.46%  97.14%]]
[2024-08-03 14:10:45,070] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-03 14:10:45,078] {result_logger:134} INFO - 
[[27859    73   450]
 [   21  2461    63]
 [  807   490 19406]]
[2024-08-03 14:10:45,188] {result_logger:141} INFO - 
[[ 98.16%   0.26%   1.59%]
 [  0.83%  96.70%   2.48%]
 [  3.90%   2.37%  93.74%]]
[2024-08-03 14:10:45,294] {result_logger:145} INFO - 
[[ 97.11%   2.41%   2.26%]
 [  0.07%  81.38%   0.32%]
 [  2.81%  16.20%  97.42%]]
[2024-08-03 14:10:45,588] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-03 14:10:45,588] {result_logger:77} INFO - actual:
[2024-08-03 14:10:45,588] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-03 14:10:45,588] {result_logger:79} INFO - predicted:
[2024-08-03 14:10:45,588] {result_logger:80} INFO - 
[[95.08%  0.11%  4.81%]
 [16.07% 79.03%  4.89%]
 [ 4.64%  3.03% 92.33%]]
[2024-08-03 14:10:45,645] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_C/model_8conv_2fc-best.pth
[2024-08-03 14:10:45,645] {run_experiment:113} INFO - [epoch  17] execution time: 164.78s	 avg f1-score: 0.9385

[2024-08-03 14:10:45,645] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-03 14:10:45,668] {dataloader:147} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2024-08-03 14:11:05,518] {train_model:82} INFO - Train Epoch: 18 [36352/366120 (10%)]	lr:1.79e-04	Loss: 0.075961
[2024-08-03 14:11:18,659] {train_model:82} INFO - Train Epoch: 18 [72960/366120 (20%)]	lr:1.79e-04	Loss: 0.074446
[2024-08-03 14:11:31,934] {train_model:82} INFO - Train Epoch: 18 [109568/366120 (30%)]	lr:1.79e-04	Loss: 0.061865
[2024-08-03 14:11:45,380] {train_model:82} INFO - Train Epoch: 18 [146176/366120 (40%)]	lr:1.79e-04	Loss: 0.058090
[2024-08-03 14:12:03,430] {train_model:82} INFO - Train Epoch: 18 [182784/366120 (50%)]	lr:1.79e-04	Loss: 0.023453
[2024-08-03 14:12:22,740] {train_model:82} INFO - Train Epoch: 18 [219392/366120 (60%)]	lr:1.79e-04	Loss: 0.083088
[2024-08-03 14:12:35,919] {train_model:82} INFO - Train Epoch: 18 [256000/366120 (70%)]	lr:1.79e-04	Loss: 0.075126
[2024-08-03 14:12:49,411] {train_model:82} INFO - Train Epoch: 18 [292608/366120 (80%)]	lr:1.79e-04	Loss: 0.055785
[2024-08-03 14:13:02,870] {train_model:82} INFO - Train Epoch: 18 [329216/366120 (90%)]	lr:1.79e-04	Loss: 0.040792
[2024-08-03 14:13:16,304] {train_model:82} INFO - Train Epoch: 18 [365824/366120 (100%)]	lr:1.79e-04	Loss: 0.082580
[2024-08-03 14:13:23,913] {run_experiment:79} INFO - 
[2024-08-03 14:13:23,913] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-03 14:13:24,724] {result_logger:103} INFO - precision on Wake: 0.979
[2024-08-03 14:13:25,256] {result_logger:104} INFO - recall on Wake: 0.980
[2024-08-03 14:13:25,788] {result_logger:107} INFO - F1-score on Wake: 0.980
[2024-08-03 14:13:25,788] {result_logger:108} INFO - 
[2024-08-03 14:13:26,562] {result_logger:103} INFO - precision on REM: 0.972
[2024-08-03 14:13:27,047] {result_logger:104} INFO - recall on REM: 0.988
[2024-08-03 14:13:27,524] {result_logger:107} INFO - F1-score on REM: 0.980
[2024-08-03 14:13:27,524] {result_logger:108} INFO - 
[2024-08-03 14:13:28,258] {result_logger:103} INFO - precision on Non REM: 0.973
[2024-08-03 14:13:28,733] {result_logger:104} INFO - recall on Non REM: 0.960
[2024-08-03 14:13:29,206] {result_logger:107} INFO - F1-score on Non REM: 0.966
[2024-08-03 14:13:29,206] {result_logger:108} INFO - 
[2024-08-03 14:13:29,321] {result_logger:111} INFO - average precision on sleep stages: 0.975
[2024-08-03 14:13:29,437] {result_logger:113} INFO - average recall on sleep stages: 0.976
[2024-08-03 14:13:29,554] {result_logger:115} INFO - average F1-score on sleep stages: 0.975
[2024-08-03 14:13:29,555] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-03 14:13:29,650] {result_logger:103} INFO - precision on Wake: 0.969
[2024-08-03 14:13:29,707] {result_logger:104} INFO - recall on Wake: 0.979
[2024-08-03 14:13:29,765] {result_logger:107} INFO - F1-score on Wake: 0.974
[2024-08-03 14:13:29,765] {result_logger:108} INFO - 
[2024-08-03 14:13:29,858] {result_logger:103} INFO - precision on REM: 0.771
[2024-08-03 14:13:29,914] {result_logger:104} INFO - recall on REM: 0.977
[2024-08-03 14:13:29,973] {result_logger:107} INFO - F1-score on REM: 0.862
[2024-08-03 14:13:29,973] {result_logger:108} INFO - 
[2024-08-03 14:13:30,065] {result_logger:103} INFO - precision on Non REM: 0.976
[2024-08-03 14:13:30,123] {result_logger:104} INFO - recall on Non REM: 0.931
[2024-08-03 14:13:30,179] {result_logger:107} INFO - F1-score on Non REM: 0.953
[2024-08-03 14:13:30,180] {result_logger:108} INFO - 
[2024-08-03 14:13:30,192] {result_logger:111} INFO - average precision on sleep stages: 0.905
[2024-08-03 14:13:30,203] {result_logger:113} INFO - average recall on sleep stages: 0.962
[2024-08-03 14:13:30,214] {result_logger:115} INFO - average F1-score on sleep stages: 0.930
[2024-08-03 14:13:30,215] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-03 14:13:30,294] {result_logger:134} INFO - 
[[147097    456   2553]
 [   283  90442    806]
 [  2846   2178 119459]]
[2024-08-03 14:13:30,372] {result_logger:141} INFO - 
[[ 98.00%   0.30%   1.70%]
 [  0.31%  98.81%   0.88%]
 [  2.29%   1.75%  95.96%]]
[2024-08-03 14:13:30,450] {result_logger:145} INFO - 
[[ 97.92%   0.49%   2.08%]
 [  0.19%  97.17%   0.66%]
 [  1.89%   2.34%  97.27%]]
[2024-08-03 14:13:30,450] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-03 14:13:30,458] {result_logger:134} INFO - 
[[27780   179   423]
 [    5  2486    54]
 [  871   559 19273]]
[2024-08-03 14:13:30,467] {result_logger:141} INFO - 
[[ 97.88%   0.63%   1.49%]
 [  0.20%  97.68%   2.12%]
 [  4.21%   2.70%  93.09%]]
[2024-08-03 14:13:30,474] {result_logger:145} INFO - 
[[ 96.94%   5.55%   2.14%]
 [  0.02%  77.11%   0.27%]
 [  3.04%  17.34%  97.58%]]
[2024-08-03 14:13:30,579] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-03 14:13:30,579] {result_logger:77} INFO - actual:
[2024-08-03 14:13:30,580] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-03 14:13:30,580] {result_logger:79} INFO - predicted:
[2024-08-03 14:13:30,580] {result_logger:80} INFO - 
[[94.45%  0.35%  5.20%]
 [17.74% 77.17%  5.09%]
 [ 5.15%  3.23% 91.63%]]
[2024-08-03 14:13:30,580] {run_experiment:113} INFO - [epoch  18] execution time: 164.93s	 avg f1-score: 0.9296

[2024-08-03 14:13:30,580] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-03 14:13:30,600] {dataloader:147} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2024-08-03 14:13:50,225] {train_model:82} INFO - Train Epoch: 19 [36352/366120 (10%)]	lr:1.68e-04	Loss: 0.065717
[2024-08-03 14:14:03,547] {train_model:82} INFO - Train Epoch: 19 [72960/366120 (20%)]	lr:1.68e-04	Loss: 0.062153
[2024-08-03 14:14:16,947] {train_model:82} INFO - Train Epoch: 19 [109568/366120 (30%)]	lr:1.68e-04	Loss: 0.104627
[2024-08-03 14:14:30,465] {train_model:82} INFO - Train Epoch: 19 [146176/366120 (40%)]	lr:1.68e-04	Loss: 0.074086
[2024-08-03 14:14:48,257] {train_model:82} INFO - Train Epoch: 19 [182784/366120 (50%)]	lr:1.68e-04	Loss: 0.059835
[2024-08-03 14:15:07,057] {train_model:82} INFO - Train Epoch: 19 [219392/366120 (60%)]	lr:1.68e-04	Loss: 0.071798
[2024-08-03 14:15:20,335] {train_model:82} INFO - Train Epoch: 19 [256000/366120 (70%)]	lr:1.68e-04	Loss: 0.059327
[2024-08-03 14:15:33,731] {train_model:82} INFO - Train Epoch: 19 [292608/366120 (80%)]	lr:1.68e-04	Loss: 0.078481
[2024-08-03 14:15:47,192] {train_model:82} INFO - Train Epoch: 19 [329216/366120 (90%)]	lr:1.68e-04	Loss: 0.051961
[2024-08-03 14:16:00,696] {train_model:82} INFO - Train Epoch: 19 [365824/366120 (100%)]	lr:1.68e-04	Loss: 0.050772
[2024-08-03 14:16:07,343] {run_experiment:79} INFO - 
[2024-08-03 14:16:07,344] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-03 14:16:08,161] {result_logger:103} INFO - precision on Wake: 0.981
[2024-08-03 14:16:08,673] {result_logger:104} INFO - recall on Wake: 0.982
[2024-08-03 14:16:09,208] {result_logger:107} INFO - F1-score on Wake: 0.981
[2024-08-03 14:16:09,208] {result_logger:108} INFO - 
[2024-08-03 14:16:10,017] {result_logger:103} INFO - precision on REM: 0.974
[2024-08-03 14:16:10,497] {result_logger:104} INFO - recall on REM: 0.990
[2024-08-03 14:16:10,984] {result_logger:107} INFO - F1-score on REM: 0.982
[2024-08-03 14:16:10,984] {result_logger:108} INFO - 
[2024-08-03 14:16:11,730] {result_logger:103} INFO - precision on Non REM: 0.975
[2024-08-03 14:16:12,209] {result_logger:104} INFO - recall on Non REM: 0.962
[2024-08-03 14:16:12,676] {result_logger:107} INFO - F1-score on Non REM: 0.968
[2024-08-03 14:16:12,676] {result_logger:108} INFO - 
[2024-08-03 14:16:12,790] {result_logger:111} INFO - average precision on sleep stages: 0.977
[2024-08-03 14:16:12,906] {result_logger:113} INFO - average recall on sleep stages: 0.978
[2024-08-03 14:16:13,022] {result_logger:115} INFO - average F1-score on sleep stages: 0.977
[2024-08-03 14:16:13,023] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-03 14:16:13,114] {result_logger:103} INFO - precision on Wake: 0.971
[2024-08-03 14:16:13,168] {result_logger:104} INFO - recall on Wake: 0.975
[2024-08-03 14:16:13,226] {result_logger:107} INFO - F1-score on Wake: 0.973
[2024-08-03 14:16:13,226] {result_logger:108} INFO - 
[2024-08-03 14:16:13,319] {result_logger:103} INFO - precision on REM: 0.766
[2024-08-03 14:16:13,375] {result_logger:104} INFO - recall on REM: 0.979
[2024-08-03 14:16:13,431] {result_logger:107} INFO - F1-score on REM: 0.860
[2024-08-03 14:16:13,431] {result_logger:108} INFO - 
[2024-08-03 14:16:13,522] {result_logger:103} INFO - precision on Non REM: 0.972
[2024-08-03 14:16:13,581] {result_logger:104} INFO - recall on Non REM: 0.934
[2024-08-03 14:16:13,638] {result_logger:107} INFO - F1-score on Non REM: 0.952
[2024-08-03 14:16:13,638] {result_logger:108} INFO - 
[2024-08-03 14:16:13,649] {result_logger:111} INFO - average precision on sleep stages: 0.903
[2024-08-03 14:16:13,660] {result_logger:113} INFO - average recall on sleep stages: 0.962
[2024-08-03 14:16:13,672] {result_logger:115} INFO - average F1-score on sleep stages: 0.928
[2024-08-03 14:16:13,672] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-03 14:16:13,751] {result_logger:134} INFO - 
[[147368    372   2373]
 [   233  90583    714]
 [  2689   2024 119764]]
[2024-08-03 14:16:13,829] {result_logger:141} INFO - 
[[ 98.17%   0.25%   1.58%]
 [  0.25%  98.97%   0.78%]
 [  2.16%   1.63%  96.21%]]
[2024-08-03 14:16:13,907] {result_logger:145} INFO - 
[[ 98.06%   0.40%   1.93%]
 [  0.16%  97.42%   0.58%]
 [  1.79%   2.18%  97.49%]]
[2024-08-03 14:16:13,907] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-03 14:16:13,915] {result_logger:134} INFO - 
[[27660   200   522]
 [   11  2491    43]
 [  808   560 19335]]
[2024-08-03 14:16:13,923] {result_logger:141} INFO - 
[[ 97.46%   0.70%   1.84%]
 [  0.43%  97.88%   1.69%]
 [  3.90%   2.70%  93.39%]]
[2024-08-03 14:16:13,931] {result_logger:145} INFO - 
[[ 97.12%   6.15%   2.62%]
 [  0.04%  76.62%   0.22%]
 [  2.84%  17.23%  97.16%]]
[2024-08-03 14:16:14,033] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-03 14:16:14,034] {result_logger:77} INFO - actual:
[2024-08-03 14:16:14,034] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-03 14:16:14,034] {result_logger:79} INFO - predicted:
[2024-08-03 14:16:14,034] {result_logger:80} INFO - 
[[94.81%  0.39%  4.80%]
 [17.10% 77.67%  5.23%]
 [ 4.63%  3.09% 92.28%]]
[2024-08-03 14:16:14,034] {run_experiment:113} INFO - [epoch  19] execution time: 163.45s	 avg f1-score: 0.9283

[2024-08-03 14:16:14,034] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-03 14:16:14,055] {dataloader:147} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2024-08-03 14:16:33,856] {train_model:82} INFO - Train Epoch: 20 [36352/366120 (10%)]	lr:1.58e-04	Loss: 0.060467
[2024-08-03 14:16:47,106] {train_model:82} INFO - Train Epoch: 20 [72960/366120 (20%)]	lr:1.58e-04	Loss: 0.039295
[2024-08-03 14:17:00,391] {train_model:82} INFO - Train Epoch: 20 [109568/366120 (30%)]	lr:1.58e-04	Loss: 0.038734
[2024-08-03 14:17:13,709] {train_model:82} INFO - Train Epoch: 20 [146176/366120 (40%)]	lr:1.58e-04	Loss: 0.052321
[2024-08-03 14:17:38,957] {train_model:82} INFO - Train Epoch: 20 [182784/366120 (50%)]	lr:1.58e-04	Loss: 0.037282
[2024-08-03 14:17:52,020] {train_model:82} INFO - Train Epoch: 20 [219392/366120 (60%)]	lr:1.58e-04	Loss: 0.072598
[2024-08-03 14:18:05,454] {train_model:82} INFO - Train Epoch: 20 [256000/366120 (70%)]	lr:1.58e-04	Loss: 0.070684
[2024-08-03 14:18:18,969] {train_model:82} INFO - Train Epoch: 20 [292608/366120 (80%)]	lr:1.58e-04	Loss: 0.040579
[2024-08-03 14:18:32,430] {train_model:82} INFO - Train Epoch: 20 [329216/366120 (90%)]	lr:1.58e-04	Loss: 0.118381
[2024-08-03 14:18:45,889] {train_model:82} INFO - Train Epoch: 20 [365824/366120 (100%)]	lr:1.58e-04	Loss: 0.033215
[2024-08-03 14:18:53,815] {run_experiment:79} INFO - 
[2024-08-03 14:18:53,816] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-03 14:18:54,640] {result_logger:103} INFO - precision on Wake: 0.982
[2024-08-03 14:18:55,190] {result_logger:104} INFO - recall on Wake: 0.982
[2024-08-03 14:18:55,721] {result_logger:107} INFO - F1-score on Wake: 0.982
[2024-08-03 14:18:55,721] {result_logger:108} INFO - 
[2024-08-03 14:18:56,475] {result_logger:103} INFO - precision on REM: 0.977
[2024-08-03 14:18:56,963] {result_logger:104} INFO - recall on REM: 0.992
[2024-08-03 14:18:57,435] {result_logger:107} INFO - F1-score on REM: 0.984
[2024-08-03 14:18:57,436] {result_logger:108} INFO - 
[2024-08-03 14:18:58,194] {result_logger:103} INFO - precision on Non REM: 0.976
[2024-08-03 14:18:58,666] {result_logger:104} INFO - recall on Non REM: 0.965
[2024-08-03 14:18:59,135] {result_logger:107} INFO - F1-score on Non REM: 0.971
[2024-08-03 14:18:59,136] {result_logger:108} INFO - 
[2024-08-03 14:18:59,258] {result_logger:111} INFO - average precision on sleep stages: 0.979
[2024-08-03 14:18:59,376] {result_logger:113} INFO - average recall on sleep stages: 0.980
[2024-08-03 14:18:59,496] {result_logger:115} INFO - average F1-score on sleep stages: 0.979
[2024-08-03 14:18:59,497] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-03 14:18:59,594] {result_logger:103} INFO - precision on Wake: 0.971
[2024-08-03 14:18:59,652] {result_logger:104} INFO - recall on Wake: 0.983
[2024-08-03 14:18:59,710] {result_logger:107} INFO - F1-score on Wake: 0.977
[2024-08-03 14:18:59,710] {result_logger:108} INFO - 
[2024-08-03 14:18:59,805] {result_logger:103} INFO - precision on REM: 0.845
[2024-08-03 14:18:59,863] {result_logger:104} INFO - recall on REM: 0.958
[2024-08-03 14:18:59,919] {result_logger:107} INFO - F1-score on REM: 0.898
[2024-08-03 14:18:59,919] {result_logger:108} INFO - 
[2024-08-03 14:19:00,017] {result_logger:103} INFO - precision on Non REM: 0.975
[2024-08-03 14:19:00,075] {result_logger:104} INFO - recall on Non REM: 0.942
[2024-08-03 14:19:00,134] {result_logger:107} INFO - F1-score on Non REM: 0.958
[2024-08-03 14:19:00,134] {result_logger:108} INFO - 
[2024-08-03 14:19:00,146] {result_logger:111} INFO - average precision on sleep stages: 0.930
[2024-08-03 14:19:00,157] {result_logger:113} INFO - average recall on sleep stages: 0.961
[2024-08-03 14:19:00,168] {result_logger:115} INFO - average F1-score on sleep stages: 0.944
[2024-08-03 14:19:00,169] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-03 14:19:00,249] {result_logger:134} INFO - 
[[147448    336   2325]
 [   179  90770    582]
 [  2510   1790 120180]]
[2024-08-03 14:19:00,330] {result_logger:141} INFO - 
[[ 98.23%   0.22%   1.55%]
 [  0.20%  99.17%   0.64%]
 [  2.02%   1.44%  96.55%]]
[2024-08-03 14:19:00,415] {result_logger:145} INFO - 
[[ 98.21%   0.36%   1.89%]
 [  0.12%  97.71%   0.47%]
 [  1.67%   1.93%  97.64%]]
[2024-08-03 14:19:00,415] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-03 14:19:00,423] {result_logger:134} INFO - 
[[27891    64   427]
 [   25  2439    81]
 [  811   383 19509]]
[2024-08-03 14:19:00,538] {result_logger:141} INFO - 
[[ 98.27%   0.23%   1.50%]
 [  0.98%  95.83%   3.18%]
 [  3.92%   1.85%  94.23%]]
[2024-08-03 14:19:00,643] {result_logger:145} INFO - 
[[ 97.09%   2.22%   2.13%]
 [  0.09%  84.51%   0.40%]
 [  2.82%  13.27%  97.46%]]
[2024-08-03 14:19:00,948] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-03 14:19:00,949] {result_logger:77} INFO - actual:
[2024-08-03 14:19:00,949] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-03 14:19:00,949] {result_logger:79} INFO - predicted:
[2024-08-03 14:19:00,949] {result_logger:80} INFO - 
[[94.98%  0.12%  4.90%]
 [15.94% 79.28%  4.78%]
 [ 4.91%  2.81% 92.28%]]
[2024-08-03 14:19:01,008] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_C/model_8conv_2fc-best.pth
[2024-08-03 14:19:01,008] {run_experiment:113} INFO - [epoch  20] execution time: 166.97s	 avg f1-score: 0.9444

[2024-08-03 14:19:01,009] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-03 14:19:01,031] {dataloader:147} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2024-08-03 14:19:20,767] {train_model:82} INFO - Train Epoch: 21 [36352/366120 (10%)]	lr:1.49e-04	Loss: 0.052298
[2024-08-03 14:19:34,045] {train_model:82} INFO - Train Epoch: 21 [72960/366120 (20%)]	lr:1.49e-04	Loss: 0.070032
[2024-08-03 14:19:47,448] {train_model:82} INFO - Train Epoch: 21 [109568/366120 (30%)]	lr:1.49e-04	Loss: 0.058742
[2024-08-03 14:20:05,252] {train_model:82} INFO - Train Epoch: 21 [146176/366120 (40%)]	lr:1.49e-04	Loss: 0.050139
[2024-08-03 14:20:25,780] {train_model:82} INFO - Train Epoch: 21 [182784/366120 (50%)]	lr:1.49e-04	Loss: 0.057376
[2024-08-03 14:20:38,938] {train_model:82} INFO - Train Epoch: 21 [219392/366120 (60%)]	lr:1.49e-04	Loss: 0.075862
[2024-08-03 14:20:52,335] {train_model:82} INFO - Train Epoch: 21 [256000/366120 (70%)]	lr:1.49e-04	Loss: 0.066745
[2024-08-03 14:21:05,802] {train_model:82} INFO - Train Epoch: 21 [292608/366120 (80%)]	lr:1.49e-04	Loss: 0.076888
[2024-08-03 14:21:19,299] {train_model:82} INFO - Train Epoch: 21 [329216/366120 (90%)]	lr:1.49e-04	Loss: 0.075224
[2024-08-03 14:21:32,668] {train_model:82} INFO - Train Epoch: 21 [365824/366120 (100%)]	lr:1.49e-04	Loss: 0.070663
[2024-08-03 14:21:39,693] {run_experiment:79} INFO - 
[2024-08-03 14:21:39,693] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-03 14:21:40,543] {result_logger:103} INFO - precision on Wake: 0.982
[2024-08-03 14:21:41,079] {result_logger:104} INFO - recall on Wake: 0.983
[2024-08-03 14:21:41,623] {result_logger:107} INFO - F1-score on Wake: 0.983
[2024-08-03 14:21:41,624] {result_logger:108} INFO - 
[2024-08-03 14:21:42,432] {result_logger:103} INFO - precision on REM: 0.979
[2024-08-03 14:21:42,908] {result_logger:104} INFO - recall on REM: 0.991
[2024-08-03 14:21:43,378] {result_logger:107} INFO - F1-score on REM: 0.985
[2024-08-03 14:21:43,378] {result_logger:108} INFO - 
[2024-08-03 14:21:44,141] {result_logger:103} INFO - precision on Non REM: 0.977
[2024-08-03 14:21:44,619] {result_logger:104} INFO - recall on Non REM: 0.967
[2024-08-03 14:21:45,096] {result_logger:107} INFO - F1-score on Non REM: 0.972
[2024-08-03 14:21:45,096] {result_logger:108} INFO - 
[2024-08-03 14:21:45,214] {result_logger:111} INFO - average precision on sleep stages: 0.979
[2024-08-03 14:21:45,333] {result_logger:113} INFO - average recall on sleep stages: 0.980
[2024-08-03 14:21:45,454] {result_logger:115} INFO - average F1-score on sleep stages: 0.980
[2024-08-03 14:21:45,455] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-03 14:21:45,555] {result_logger:103} INFO - precision on Wake: 0.967
[2024-08-03 14:21:45,616] {result_logger:104} INFO - recall on Wake: 0.975
[2024-08-03 14:21:45,674] {result_logger:107} INFO - F1-score on Wake: 0.971
[2024-08-03 14:21:45,674] {result_logger:108} INFO - 
[2024-08-03 14:21:45,772] {result_logger:103} INFO - precision on REM: 0.789
[2024-08-03 14:21:45,829] {result_logger:104} INFO - recall on REM: 0.965
[2024-08-03 14:21:45,885] {result_logger:107} INFO - F1-score on REM: 0.868
[2024-08-03 14:21:45,885] {result_logger:108} INFO - 
[2024-08-03 14:21:45,984] {result_logger:103} INFO - precision on Non REM: 0.973
[2024-08-03 14:21:46,043] {result_logger:104} INFO - recall on Non REM: 0.936
[2024-08-03 14:21:46,100] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2024-08-03 14:21:46,101] {result_logger:108} INFO - 
[2024-08-03 14:21:46,112] {result_logger:111} INFO - average precision on sleep stages: 0.910
[2024-08-03 14:21:46,123] {result_logger:113} INFO - average recall on sleep stages: 0.959
[2024-08-03 14:21:46,135] {result_logger:115} INFO - average F1-score on sleep stages: 0.931
[2024-08-03 14:21:46,135] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-03 14:21:46,217] {result_logger:134} INFO - 
[[147532    295   2283]
 [   183  90745    603]
 [  2477   1649 120353]]
[2024-08-03 14:21:46,298] {result_logger:141} INFO - 
[[ 98.28%   0.20%   1.52%]
 [  0.20%  99.14%   0.66%]
 [  1.99%   1.32%  96.69%]]
[2024-08-03 14:21:46,380] {result_logger:145} INFO - 
[[ 98.23%   0.32%   1.85%]
 [  0.12%  97.90%   0.49%]
 [  1.65%   1.78%  97.66%]]
[2024-08-03 14:21:46,381] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-03 14:21:46,389] {result_logger:134} INFO - 
[[27674   250   458]
 [   18  2455    72]
 [  918   407 19378]]
[2024-08-03 14:21:46,397] {result_logger:141} INFO - 
[[ 97.51%   0.88%   1.61%]
 [  0.71%  96.46%   2.83%]
 [  4.43%   1.97%  93.60%]]
[2024-08-03 14:21:46,405] {result_logger:145} INFO - 
[[ 96.73%   8.03%   2.30%]
 [  0.06%  78.89%   0.36%]
 [  3.21%  13.08%  97.34%]]
[2024-08-03 14:21:46,513] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-03 14:21:46,513] {result_logger:77} INFO - actual:
[2024-08-03 14:21:46,513] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-03 14:21:46,513] {result_logger:79} INFO - predicted:
[2024-08-03 14:21:46,514] {result_logger:80} INFO - 
[[94.24%  0.53%  5.22%]
 [18.35% 76.22%  5.43%]
 [ 5.40%  2.95% 91.65%]]
[2024-08-03 14:21:46,514] {run_experiment:113} INFO - [epoch  21] execution time: 165.51s	 avg f1-score: 0.9311

[2024-08-03 14:21:46,514] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-03 14:21:46,534] {dataloader:147} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2024-08-03 14:22:06,171] {train_model:82} INFO - Train Epoch: 22 [36352/366120 (10%)]	lr:1.40e-04	Loss: 0.074733
[2024-08-03 14:22:19,276] {train_model:82} INFO - Train Epoch: 22 [72960/366120 (20%)]	lr:1.40e-04	Loss: 0.029138
[2024-08-03 14:22:32,537] {train_model:82} INFO - Train Epoch: 22 [109568/366120 (30%)]	lr:1.40e-04	Loss: 0.051536
[2024-08-03 14:22:50,580] {train_model:82} INFO - Train Epoch: 22 [146176/366120 (40%)]	lr:1.40e-04	Loss: 0.018499
[2024-08-03 14:23:11,376] {train_model:82} INFO - Train Epoch: 22 [182784/366120 (50%)]	lr:1.40e-04	Loss: 0.080430
[2024-08-03 14:23:24,748] {train_model:82} INFO - Train Epoch: 22 [219392/366120 (60%)]	lr:1.40e-04	Loss: 0.076215
[2024-08-03 14:23:38,101] {train_model:82} INFO - Train Epoch: 22 [256000/366120 (70%)]	lr:1.40e-04	Loss: 0.085507
[2024-08-03 14:23:51,497] {train_model:82} INFO - Train Epoch: 22 [292608/366120 (80%)]	lr:1.40e-04	Loss: 0.053746
[2024-08-03 14:24:04,901] {train_model:82} INFO - Train Epoch: 22 [329216/366120 (90%)]	lr:1.40e-04	Loss: 0.044653
[2024-08-03 14:24:18,245] {train_model:82} INFO - Train Epoch: 22 [365824/366120 (100%)]	lr:1.40e-04	Loss: 0.064825
[2024-08-03 14:24:25,859] {run_experiment:79} INFO - 
[2024-08-03 14:24:25,859] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-03 14:24:26,721] {result_logger:103} INFO - precision on Wake: 0.983
[2024-08-03 14:24:27,261] {result_logger:104} INFO - recall on Wake: 0.984
[2024-08-03 14:24:27,789] {result_logger:107} INFO - F1-score on Wake: 0.983
[2024-08-03 14:24:27,789] {result_logger:108} INFO - 
[2024-08-03 14:24:28,536] {result_logger:103} INFO - precision on REM: 0.981
[2024-08-03 14:24:29,004] {result_logger:104} INFO - recall on REM: 0.993
[2024-08-03 14:24:29,474] {result_logger:107} INFO - F1-score on REM: 0.987
[2024-08-03 14:24:29,474] {result_logger:108} INFO - 
[2024-08-03 14:24:30,226] {result_logger:103} INFO - precision on Non REM: 0.978
[2024-08-03 14:24:30,688] {result_logger:104} INFO - recall on Non REM: 0.969
[2024-08-03 14:24:31,145] {result_logger:107} INFO - F1-score on Non REM: 0.973
[2024-08-03 14:24:31,145] {result_logger:108} INFO - 
[2024-08-03 14:24:31,258] {result_logger:111} INFO - average precision on sleep stages: 0.981
[2024-08-03 14:24:31,369] {result_logger:113} INFO - average recall on sleep stages: 0.982
[2024-08-03 14:24:31,482] {result_logger:115} INFO - average F1-score on sleep stages: 0.981
[2024-08-03 14:24:31,483] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-03 14:24:31,582] {result_logger:103} INFO - precision on Wake: 0.963
[2024-08-03 14:24:31,642] {result_logger:104} INFO - recall on Wake: 0.986
[2024-08-03 14:24:31,700] {result_logger:107} INFO - F1-score on Wake: 0.974
[2024-08-03 14:24:31,700] {result_logger:108} INFO - 
[2024-08-03 14:24:31,792] {result_logger:103} INFO - precision on REM: 0.837
[2024-08-03 14:24:31,848] {result_logger:104} INFO - recall on REM: 0.964
[2024-08-03 14:24:31,905] {result_logger:107} INFO - F1-score on REM: 0.896
[2024-08-03 14:24:31,906] {result_logger:108} INFO - 
[2024-08-03 14:24:32,005] {result_logger:103} INFO - precision on Non REM: 0.980
[2024-08-03 14:24:32,064] {result_logger:104} INFO - recall on Non REM: 0.930
[2024-08-03 14:24:32,121] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2024-08-03 14:24:32,121] {result_logger:108} INFO - 
[2024-08-03 14:24:32,133] {result_logger:111} INFO - average precision on sleep stages: 0.926
[2024-08-03 14:24:32,144] {result_logger:113} INFO - average recall on sleep stages: 0.960
[2024-08-03 14:24:32,156] {result_logger:115} INFO - average F1-score on sleep stages: 0.941
[2024-08-03 14:24:32,156] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-03 14:24:32,234] {result_logger:134} INFO - 
[[147664    255   2188]
 [   166  90872    493]
 [  2393   1506 120583]]
[2024-08-03 14:24:32,311] {result_logger:141} INFO - 
[[ 98.37%   0.17%   1.46%]
 [  0.18%  99.28%   0.54%]
 [  1.92%   1.21%  96.87%]]
[2024-08-03 14:24:32,388] {result_logger:145} INFO - 
[[ 98.30%   0.28%   1.78%]
 [  0.11%  98.10%   0.40%]
 [  1.59%   1.63%  97.82%]]
[2024-08-03 14:24:32,388] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-03 14:24:32,397] {result_logger:134} INFO - 
[[27973   101   308]
 [   12  2453    80]
 [ 1077   378 19248]]
[2024-08-03 14:24:32,404] {result_logger:141} INFO - 
[[ 98.56%   0.36%   1.09%]
 [  0.47%  96.39%   3.14%]
 [  5.20%   1.83%  92.97%]]
[2024-08-03 14:24:32,412] {result_logger:145} INFO - 
[[ 96.25%   3.44%   1.57%]
 [  0.04%  83.66%   0.41%]
 [  3.71%  12.89%  98.02%]]
[2024-08-03 14:24:32,518] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-03 14:24:32,518] {result_logger:77} INFO - actual:
[2024-08-03 14:24:32,518] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-03 14:24:32,518] {result_logger:79} INFO - predicted:
[2024-08-03 14:24:32,518] {result_logger:80} INFO - 
[[94.70%  0.18%  5.11%]
 [17.22% 78.72%  4.06%]
 [ 5.27%  2.91% 91.83%]]
[2024-08-03 14:24:32,518] {run_experiment:113} INFO - [epoch  22] execution time: 166.00s	 avg f1-score: 0.9413

[2024-08-03 14:24:32,519] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-03 14:24:32,537] {dataloader:147} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2024-08-03 14:24:52,171] {train_model:82} INFO - Train Epoch: 23 [36352/366120 (10%)]	lr:1.32e-04	Loss: 0.048287
[2024-08-03 14:25:05,453] {train_model:82} INFO - Train Epoch: 23 [72960/366120 (20%)]	lr:1.32e-04	Loss: 0.031994
[2024-08-03 14:25:18,777] {train_model:82} INFO - Train Epoch: 23 [109568/366120 (30%)]	lr:1.32e-04	Loss: 0.095755
[2024-08-03 14:25:42,681] {train_model:82} INFO - Train Epoch: 23 [146176/366120 (40%)]	lr:1.32e-04	Loss: 0.070390
[2024-08-03 14:25:55,743] {train_model:82} INFO - Train Epoch: 23 [182784/366120 (50%)]	lr:1.32e-04	Loss: 0.045588
[2024-08-03 14:26:08,985] {train_model:82} INFO - Train Epoch: 23 [219392/366120 (60%)]	lr:1.32e-04	Loss: 0.067062
[2024-08-03 14:26:22,302] {train_model:82} INFO - Train Epoch: 23 [256000/366120 (70%)]	lr:1.32e-04	Loss: 0.043098
[2024-08-03 14:26:35,562] {train_model:82} INFO - Train Epoch: 23 [292608/366120 (80%)]	lr:1.32e-04	Loss: 0.064112
[2024-08-03 14:26:48,930] {train_model:82} INFO - Train Epoch: 23 [329216/366120 (90%)]	lr:1.32e-04	Loss: 0.043758
[2024-08-03 14:27:02,287] {train_model:82} INFO - Train Epoch: 23 [365824/366120 (100%)]	lr:1.32e-04	Loss: 0.110514
[2024-08-03 14:27:10,178] {run_experiment:79} INFO - 
[2024-08-03 14:27:10,178] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-03 14:27:11,025] {result_logger:103} INFO - precision on Wake: 0.985
[2024-08-03 14:27:11,570] {result_logger:104} INFO - recall on Wake: 0.985
[2024-08-03 14:27:12,092] {result_logger:107} INFO - F1-score on Wake: 0.985
[2024-08-03 14:27:12,092] {result_logger:108} INFO - 
[2024-08-03 14:27:12,849] {result_logger:103} INFO - precision on REM: 0.982
[2024-08-03 14:27:13,320] {result_logger:104} INFO - recall on REM: 0.993
[2024-08-03 14:27:13,800] {result_logger:107} INFO - F1-score on REM: 0.988
[2024-08-03 14:27:13,800] {result_logger:108} INFO - 
[2024-08-03 14:27:14,549] {result_logger:103} INFO - precision on Non REM: 0.980
[2024-08-03 14:27:15,016] {result_logger:104} INFO - recall on Non REM: 0.971
[2024-08-03 14:27:15,480] {result_logger:107} INFO - F1-score on Non REM: 0.976
[2024-08-03 14:27:15,480] {result_logger:108} INFO - 
[2024-08-03 14:27:15,596] {result_logger:111} INFO - average precision on sleep stages: 0.982
[2024-08-03 14:27:15,711] {result_logger:113} INFO - average recall on sleep stages: 0.983
[2024-08-03 14:27:15,824] {result_logger:115} INFO - average F1-score on sleep stages: 0.983
[2024-08-03 14:27:15,825] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-03 14:27:15,925] {result_logger:103} INFO - precision on Wake: 0.966
[2024-08-03 14:27:15,982] {result_logger:104} INFO - recall on Wake: 0.983
[2024-08-03 14:27:16,038] {result_logger:107} INFO - F1-score on Wake: 0.974
[2024-08-03 14:27:16,038] {result_logger:108} INFO - 
[2024-08-03 14:27:16,130] {result_logger:103} INFO - precision on REM: 0.826
[2024-08-03 14:27:16,183] {result_logger:104} INFO - recall on REM: 0.963
[2024-08-03 14:27:16,237] {result_logger:107} INFO - F1-score on REM: 0.889
[2024-08-03 14:27:16,237] {result_logger:108} INFO - 
[2024-08-03 14:27:16,334] {result_logger:103} INFO - precision on Non REM: 0.978
[2024-08-03 14:27:16,393] {result_logger:104} INFO - recall on Non REM: 0.935
[2024-08-03 14:27:16,451] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2024-08-03 14:27:16,451] {result_logger:108} INFO - 
[2024-08-03 14:27:16,463] {result_logger:111} INFO - average precision on sleep stages: 0.923
[2024-08-03 14:27:16,474] {result_logger:113} INFO - average recall on sleep stages: 0.960
[2024-08-03 14:27:16,485] {result_logger:115} INFO - average F1-score on sleep stages: 0.940
[2024-08-03 14:27:16,486] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-03 14:27:16,565] {result_logger:134} INFO - 
[[147831    244   2032]
 [   158  90924    449]
 [  2158   1427 120897]]
[2024-08-03 14:27:16,644] {result_logger:141} INFO - 
[[ 98.48%   0.16%   1.35%]
 [  0.17%  99.34%   0.49%]
 [  1.73%   1.15%  97.12%]]
[2024-08-03 14:27:16,722] {result_logger:145} INFO - 
[[ 98.46%   0.26%   1.65%]
 [  0.11%  98.20%   0.36%]
 [  1.44%   1.54%  97.99%]]
[2024-08-03 14:27:16,722] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-03 14:27:16,730] {result_logger:134} INFO - 
[[27888   142   352]
 [   19  2452    74]
 [  968   376 19359]]
[2024-08-03 14:27:16,738] {result_logger:141} INFO - 
[[ 98.26%   0.50%   1.24%]
 [  0.75%  96.35%   2.91%]
 [  4.68%   1.82%  93.51%]]
[2024-08-03 14:27:16,746] {result_logger:145} INFO - 
[[ 96.58%   4.78%   1.78%]
 [  0.07%  82.56%   0.37%]
 [  3.35%  12.66%  97.85%]]
[2024-08-03 14:27:16,850] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-03 14:27:16,850] {result_logger:77} INFO - actual:
[2024-08-03 14:27:16,850] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-03 14:27:16,850] {result_logger:79} INFO - predicted:
[2024-08-03 14:27:16,850] {result_logger:80} INFO - 
[[94.65%  0.24%  5.11%]
 [16.46% 78.79%  4.75%]
 [ 5.33%  2.84% 91.83%]]
[2024-08-03 14:27:16,850] {run_experiment:113} INFO - [epoch  23] execution time: 164.33s	 avg f1-score: 0.9399

[2024-08-03 14:27:16,851] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-03 14:27:16,873] {dataloader:147} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2024-08-03 14:27:36,560] {train_model:82} INFO - Train Epoch: 24 [36352/366120 (10%)]	lr:1.25e-04	Loss: 0.043928
[2024-08-03 14:27:49,841] {train_model:82} INFO - Train Epoch: 24 [72960/366120 (20%)]	lr:1.25e-04	Loss: 0.026432
[2024-08-03 14:28:03,607] {train_model:82} INFO - Train Epoch: 24 [109568/366120 (30%)]	lr:1.25e-04	Loss: 0.044147
[2024-08-03 14:28:26,649] {train_model:82} INFO - Train Epoch: 24 [146176/366120 (40%)]	lr:1.25e-04	Loss: 0.031567
[2024-08-03 14:28:39,886] {train_model:82} INFO - Train Epoch: 24 [182784/366120 (50%)]	lr:1.25e-04	Loss: 0.109715
[2024-08-03 14:28:53,202] {train_model:82} INFO - Train Epoch: 24 [219392/366120 (60%)]	lr:1.25e-04	Loss: 0.083266
[2024-08-03 14:29:06,545] {train_model:82} INFO - Train Epoch: 24 [256000/366120 (70%)]	lr:1.25e-04	Loss: 0.064929
[2024-08-03 14:29:19,944] {train_model:82} INFO - Train Epoch: 24 [292608/366120 (80%)]	lr:1.25e-04	Loss: 0.038861
[2024-08-03 14:29:33,467] {train_model:82} INFO - Train Epoch: 24 [329216/366120 (90%)]	lr:1.25e-04	Loss: 0.039094
[2024-08-03 14:29:46,936] {train_model:82} INFO - Train Epoch: 24 [365824/366120 (100%)]	lr:1.25e-04	Loss: 0.042277
[2024-08-03 14:29:54,179] {run_experiment:79} INFO - 
[2024-08-03 14:29:54,179] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-03 14:29:55,014] {result_logger:103} INFO - precision on Wake: 0.985
[2024-08-03 14:29:55,545] {result_logger:104} INFO - recall on Wake: 0.985
[2024-08-03 14:29:56,084] {result_logger:107} INFO - F1-score on Wake: 0.985
[2024-08-03 14:29:56,084] {result_logger:108} INFO - 
[2024-08-03 14:29:56,866] {result_logger:103} INFO - precision on REM: 0.984
[2024-08-03 14:29:57,345] {result_logger:104} INFO - recall on REM: 0.994
[2024-08-03 14:29:57,826] {result_logger:107} INFO - F1-score on REM: 0.989
[2024-08-03 14:29:57,826] {result_logger:108} INFO - 
[2024-08-03 14:29:58,606] {result_logger:103} INFO - precision on Non REM: 0.981
[2024-08-03 14:29:59,089] {result_logger:104} INFO - recall on Non REM: 0.973
[2024-08-03 14:29:59,563] {result_logger:107} INFO - F1-score on Non REM: 0.977
[2024-08-03 14:29:59,563] {result_logger:108} INFO - 
[2024-08-03 14:29:59,685] {result_logger:111} INFO - average precision on sleep stages: 0.983
[2024-08-03 14:29:59,804] {result_logger:113} INFO - average recall on sleep stages: 0.984
[2024-08-03 14:29:59,923] {result_logger:115} INFO - average F1-score on sleep stages: 0.984
[2024-08-03 14:29:59,925] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-03 14:30:00,026] {result_logger:103} INFO - precision on Wake: 0.975
[2024-08-03 14:30:00,084] {result_logger:104} INFO - recall on Wake: 0.974
[2024-08-03 14:30:00,144] {result_logger:107} INFO - F1-score on Wake: 0.975
[2024-08-03 14:30:00,144] {result_logger:108} INFO - 
[2024-08-03 14:30:00,235] {result_logger:103} INFO - precision on REM: 0.846
[2024-08-03 14:30:00,292] {result_logger:104} INFO - recall on REM: 0.949
[2024-08-03 14:30:00,350] {result_logger:107} INFO - F1-score on REM: 0.895
[2024-08-03 14:30:00,350] {result_logger:108} INFO - 
[2024-08-03 14:30:00,448] {result_logger:103} INFO - precision on Non REM: 0.965
[2024-08-03 14:30:00,508] {result_logger:104} INFO - recall on Non REM: 0.952
[2024-08-03 14:30:00,565] {result_logger:107} INFO - F1-score on Non REM: 0.958
[2024-08-03 14:30:00,565] {result_logger:108} INFO - 
[2024-08-03 14:30:00,577] {result_logger:111} INFO - average precision on sleep stages: 0.929
[2024-08-03 14:30:00,588] {result_logger:113} INFO - average recall on sleep stages: 0.958
[2024-08-03 14:30:00,600] {result_logger:115} INFO - average F1-score on sleep stages: 0.943
[2024-08-03 14:30:00,600] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-03 14:30:00,682] {result_logger:134} INFO - 
[[147917    222   1967]
 [   113  90977    440]
 [  2111   1254 121119]]
[2024-08-03 14:30:00,762] {result_logger:141} INFO - 
[[ 98.54%   0.15%   1.31%]
 [  0.12%  99.40%   0.48%]
 [  1.70%   1.01%  97.30%]]
[2024-08-03 14:30:00,844] {result_logger:145} INFO - 
[[ 98.52%   0.24%   1.59%]
 [  0.08%  98.40%   0.36%]
 [  1.41%   1.36%  98.05%]]
[2024-08-03 14:30:00,844] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-03 14:30:00,853] {result_logger:134} INFO - 
[[27648   129   605]
 [   16  2415   114]
 [  682   309 19712]]
[2024-08-03 14:30:00,861] {result_logger:141} INFO - 
[[ 97.41%   0.45%   2.13%]
 [  0.63%  94.89%   4.48%]
 [  3.29%   1.49%  95.21%]]
[2024-08-03 14:30:00,870] {result_logger:145} INFO - 
[[ 97.54%   4.52%   2.96%]
 [  0.06%  84.65%   0.56%]
 [  2.41%  10.83%  96.48%]]
[2024-08-03 14:30:00,980] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-03 14:30:00,980] {result_logger:77} INFO - actual:
[2024-08-03 14:30:00,981] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-03 14:30:00,981] {result_logger:79} INFO - predicted:
[2024-08-03 14:30:00,981] {result_logger:80} INFO - 
[[94.87%  0.25%  4.88%]
 [16.37% 78.76%  4.87%]
 [ 4.83%  2.62% 92.55%]]
[2024-08-03 14:30:00,981] {run_experiment:113} INFO - [epoch  24] execution time: 164.13s	 avg f1-score: 0.9427

[2024-08-03 14:30:00,981] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-03 14:30:01,002] {dataloader:147} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2024-08-03 14:30:20,580] {train_model:82} INFO - Train Epoch: 25 [36352/366120 (10%)]	lr:1.17e-04	Loss: 0.046222
[2024-08-03 14:30:33,868] {train_model:82} INFO - Train Epoch: 25 [72960/366120 (20%)]	lr:1.17e-04	Loss: 0.048336
[2024-08-03 14:30:52,139] {train_model:82} INFO - Train Epoch: 25 [109568/366120 (30%)]	lr:1.17e-04	Loss: 0.037874
[2024-08-03 14:31:12,175] {train_model:82} INFO - Train Epoch: 25 [146176/366120 (40%)]	lr:1.17e-04	Loss: 0.038004
[2024-08-03 14:31:25,466] {train_model:82} INFO - Train Epoch: 25 [182784/366120 (50%)]	lr:1.17e-04	Loss: 0.080419
[2024-08-03 14:31:38,840] {train_model:82} INFO - Train Epoch: 25 [219392/366120 (60%)]	lr:1.17e-04	Loss: 0.037748
[2024-08-03 14:31:52,197] {train_model:82} INFO - Train Epoch: 25 [256000/366120 (70%)]	lr:1.17e-04	Loss: 0.074480
[2024-08-03 14:32:05,820] {train_model:82} INFO - Train Epoch: 25 [292608/366120 (80%)]	lr:1.17e-04	Loss: 0.041031
[2024-08-03 14:32:19,329] {train_model:82} INFO - Train Epoch: 25 [329216/366120 (90%)]	lr:1.17e-04	Loss: 0.048318
[2024-08-03 14:32:32,789] {train_model:82} INFO - Train Epoch: 25 [365824/366120 (100%)]	lr:1.17e-04	Loss: 0.062574
[2024-08-03 14:32:40,394] {run_experiment:79} INFO - 
[2024-08-03 14:32:40,395] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-03 14:32:41,242] {result_logger:103} INFO - precision on Wake: 0.986
[2024-08-03 14:32:41,782] {result_logger:104} INFO - recall on Wake: 0.986
[2024-08-03 14:32:42,311] {result_logger:107} INFO - F1-score on Wake: 0.986
[2024-08-03 14:32:42,311] {result_logger:108} INFO - 
[2024-08-03 14:32:43,089] {result_logger:103} INFO - precision on REM: 0.985
[2024-08-03 14:32:43,561] {result_logger:104} INFO - recall on REM: 0.994
[2024-08-03 14:32:44,036] {result_logger:107} INFO - F1-score on REM: 0.990
[2024-08-03 14:32:44,037] {result_logger:108} INFO - 
[2024-08-03 14:32:44,806] {result_logger:103} INFO - precision on Non REM: 0.981
[2024-08-03 14:32:45,284] {result_logger:104} INFO - recall on Non REM: 0.975
[2024-08-03 14:32:45,753] {result_logger:107} INFO - F1-score on Non REM: 0.978
[2024-08-03 14:32:45,753] {result_logger:108} INFO - 
[2024-08-03 14:32:45,874] {result_logger:111} INFO - average precision on sleep stages: 0.984
[2024-08-03 14:32:45,993] {result_logger:113} INFO - average recall on sleep stages: 0.985
[2024-08-03 14:32:46,112] {result_logger:115} INFO - average F1-score on sleep stages: 0.984
[2024-08-03 14:32:46,113] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-03 14:32:46,211] {result_logger:103} INFO - precision on Wake: 0.973
[2024-08-03 14:32:46,273] {result_logger:104} INFO - recall on Wake: 0.983
[2024-08-03 14:32:46,332] {result_logger:107} INFO - F1-score on Wake: 0.978
[2024-08-03 14:32:46,332] {result_logger:108} INFO - 
[2024-08-03 14:32:46,425] {result_logger:103} INFO - precision on REM: 0.851
[2024-08-03 14:32:46,480] {result_logger:104} INFO - recall on REM: 0.959
[2024-08-03 14:32:46,538] {result_logger:107} INFO - F1-score on REM: 0.902
[2024-08-03 14:32:46,538] {result_logger:108} INFO - 
[2024-08-03 14:32:46,636] {result_logger:103} INFO - precision on Non REM: 0.975
[2024-08-03 14:32:46,696] {result_logger:104} INFO - recall on Non REM: 0.946
[2024-08-03 14:32:46,754] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2024-08-03 14:32:46,754] {result_logger:108} INFO - 
[2024-08-03 14:32:46,766] {result_logger:111} INFO - average precision on sleep stages: 0.933
[2024-08-03 14:32:46,779] {result_logger:113} INFO - average recall on sleep stages: 0.963
[2024-08-03 14:32:46,790] {result_logger:115} INFO - average F1-score on sleep stages: 0.947
[2024-08-03 14:32:46,790] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-03 14:32:46,875] {result_logger:134} INFO - 
[[147963    227   1921]
 [   116  91013    400]
 [  2037   1127 121316]]
[2024-08-03 14:32:46,955] {result_logger:141} INFO - 
[[ 98.57%   0.15%   1.28%]
 [  0.13%  99.44%   0.44%]
 [  1.64%   0.91%  97.46%]]
[2024-08-03 14:32:47,037] {result_logger:145} INFO - 
[[ 98.57%   0.25%   1.55%]
 [  0.08%  98.53%   0.32%]
 [  1.36%   1.22%  98.12%]]
[2024-08-03 14:32:47,037] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-03 14:32:47,045] {result_logger:134} INFO - 
[[27898    61   423]
 [   21  2441    83]
 [  750   366 19587]]
[2024-08-03 14:32:47,158] {result_logger:141} INFO - 
[[ 98.29%   0.21%   1.49%]
 [  0.83%  95.91%   3.26%]
 [  3.62%   1.77%  94.61%]]
[2024-08-03 14:32:47,262] {result_logger:145} INFO - 
[[ 97.31%   2.13%   2.11%]
 [  0.07%  85.11%   0.41%]
 [  2.62%  12.76%  97.48%]]
[2024-08-03 14:32:47,571] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-03 14:32:47,571] {result_logger:77} INFO - actual:
[2024-08-03 14:32:47,571] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-03 14:32:47,571] {result_logger:79} INFO - predicted:
[2024-08-03 14:32:47,572] {result_logger:80} INFO - 
[[95.12%  0.09%  4.79%]
 [15.73% 79.36%  4.92%]
 [ 4.72%  2.81% 92.47%]]
[2024-08-03 14:32:47,632] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_C/model_8conv_2fc-best.pth
[2024-08-03 14:32:47,632] {run_experiment:113} INFO - [epoch  25] execution time: 166.65s	 avg f1-score: 0.9467

[2024-08-03 14:32:47,632] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-03 14:32:47,653] {dataloader:147} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2024-08-03 14:33:07,195] {train_model:82} INFO - Train Epoch: 26 [36352/366120 (10%)]	lr:1.11e-04	Loss: 0.026795
[2024-08-03 14:33:20,392] {train_model:82} INFO - Train Epoch: 26 [72960/366120 (20%)]	lr:1.11e-04	Loss: 0.018539
[2024-08-03 14:33:44,112] {train_model:82} INFO - Train Epoch: 26 [109568/366120 (30%)]	lr:1.11e-04	Loss: 0.032910
[2024-08-03 14:33:57,292] {train_model:82} INFO - Train Epoch: 26 [146176/366120 (40%)]	lr:1.11e-04	Loss: 0.031940
[2024-08-03 14:34:10,518] {train_model:82} INFO - Train Epoch: 26 [182784/366120 (50%)]	lr:1.11e-04	Loss: 0.044105
[2024-08-03 14:34:23,806] {train_model:82} INFO - Train Epoch: 26 [219392/366120 (60%)]	lr:1.11e-04	Loss: 0.053872
[2024-08-03 14:34:37,243] {train_model:82} INFO - Train Epoch: 26 [256000/366120 (70%)]	lr:1.11e-04	Loss: 0.027806
[2024-08-03 14:34:50,564] {train_model:82} INFO - Train Epoch: 26 [292608/366120 (80%)]	lr:1.11e-04	Loss: 0.053303
[2024-08-03 14:35:03,894] {train_model:82} INFO - Train Epoch: 26 [329216/366120 (90%)]	lr:1.11e-04	Loss: 0.033063
[2024-08-03 14:35:17,230] {train_model:82} INFO - Train Epoch: 26 [365824/366120 (100%)]	lr:1.11e-04	Loss: 0.021252
[2024-08-03 14:35:24,261] {run_experiment:79} INFO - 
[2024-08-03 14:35:24,262] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-03 14:35:25,116] {result_logger:103} INFO - precision on Wake: 0.986
[2024-08-03 14:35:25,657] {result_logger:104} INFO - recall on Wake: 0.987
[2024-08-03 14:35:26,202] {result_logger:107} INFO - F1-score on Wake: 0.987
[2024-08-03 14:35:26,202] {result_logger:108} INFO - 
[2024-08-03 14:35:27,003] {result_logger:103} INFO - precision on REM: 0.986
[2024-08-03 14:35:27,491] {result_logger:104} INFO - recall on REM: 0.995
[2024-08-03 14:35:27,964] {result_logger:107} INFO - F1-score on REM: 0.991
[2024-08-03 14:35:27,964] {result_logger:108} INFO - 
[2024-08-03 14:35:28,726] {result_logger:103} INFO - precision on Non REM: 0.983
[2024-08-03 14:35:29,193] {result_logger:104} INFO - recall on Non REM: 0.976
[2024-08-03 14:35:29,664] {result_logger:107} INFO - F1-score on Non REM: 0.979
[2024-08-03 14:35:29,664] {result_logger:108} INFO - 
[2024-08-03 14:35:29,782] {result_logger:111} INFO - average precision on sleep stages: 0.985
[2024-08-03 14:35:29,900] {result_logger:113} INFO - average recall on sleep stages: 0.986
[2024-08-03 14:35:30,018] {result_logger:115} INFO - average F1-score on sleep stages: 0.985
[2024-08-03 14:35:30,019] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-03 14:35:30,119] {result_logger:103} INFO - precision on Wake: 0.979
[2024-08-03 14:35:30,176] {result_logger:104} INFO - recall on Wake: 0.978
[2024-08-03 14:35:30,234] {result_logger:107} INFO - F1-score on Wake: 0.979
[2024-08-03 14:35:30,234] {result_logger:108} INFO - 
[2024-08-03 14:35:30,328] {result_logger:103} INFO - precision on REM: 0.859
[2024-08-03 14:35:30,385] {result_logger:104} INFO - recall on REM: 0.952
[2024-08-03 14:35:30,444] {result_logger:107} INFO - F1-score on REM: 0.903
[2024-08-03 14:35:30,444] {result_logger:108} INFO - 
[2024-08-03 14:35:30,542] {result_logger:103} INFO - precision on Non REM: 0.968
[2024-08-03 14:35:30,602] {result_logger:104} INFO - recall on Non REM: 0.957
[2024-08-03 14:35:30,661] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2024-08-03 14:35:30,661] {result_logger:108} INFO - 
[2024-08-03 14:35:30,673] {result_logger:111} INFO - average precision on sleep stages: 0.935
[2024-08-03 14:35:30,685] {result_logger:113} INFO - average recall on sleep stages: 0.962
[2024-08-03 14:35:30,696] {result_logger:115} INFO - average F1-score on sleep stages: 0.948
[2024-08-03 14:35:30,697] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-03 14:35:30,777] {result_logger:134} INFO - 
[[148112    199   1799]
 [   121  91048    362]
 [  1931   1056 121492]]
[2024-08-03 14:35:30,856] {result_logger:141} INFO - 
[[ 98.67%   0.13%   1.20%]
 [  0.13%  99.47%   0.40%]
 [  1.55%   0.85%  97.60%]]
[2024-08-03 14:35:30,936] {result_logger:145} INFO - 
[[ 98.63%   0.22%   1.45%]
 [  0.08%  98.64%   0.29%]
 [  1.29%   1.14%  98.25%]]
[2024-08-03 14:35:30,937] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-03 14:35:30,945] {result_logger:134} INFO - 
[[27745    76   561]
 [   21  2423   101]
 [  560   321 19822]]
[2024-08-03 14:35:31,066] {result_logger:141} INFO - 
[[ 97.76%   0.27%   1.98%]
 [  0.83%  95.21%   3.97%]
 [  2.70%   1.55%  95.74%]]
[2024-08-03 14:35:31,173] {result_logger:145} INFO - 
[[ 97.95%   2.70%   2.74%]
 [  0.07%  85.92%   0.49%]
 [  1.98%  11.38%  96.77%]]
[2024-08-03 14:35:31,477] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-03 14:35:31,477] {result_logger:77} INFO - actual:
[2024-08-03 14:35:31,477] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-03 14:35:31,477] {result_logger:79} INFO - predicted:
[2024-08-03 14:35:31,478] {result_logger:80} INFO - 
[[95.18%  0.14%  4.67%]
 [15.71% 79.29%  5.00%]
 [ 4.50%  2.65% 92.85%]]
[2024-08-03 14:35:31,536] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_C/model_8conv_2fc-best.pth
[2024-08-03 14:35:31,537] {run_experiment:113} INFO - [epoch  26] execution time: 163.90s	 avg f1-score: 0.9481

[2024-08-03 14:35:31,537] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-03 14:35:31,557] {dataloader:147} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2024-08-03 14:35:51,062] {train_model:82} INFO - Train Epoch: 27 [36352/366120 (10%)]	lr:1.04e-04	Loss: 0.021651
[2024-08-03 14:36:04,332] {train_model:82} INFO - Train Epoch: 27 [72960/366120 (20%)]	lr:1.04e-04	Loss: 0.033830
[2024-08-03 14:36:28,756] {train_model:82} INFO - Train Epoch: 27 [109568/366120 (30%)]	lr:1.04e-04	Loss: 0.037383
[2024-08-03 14:36:41,832] {train_model:82} INFO - Train Epoch: 27 [146176/366120 (40%)]	lr:1.04e-04	Loss: 0.037498
[2024-08-03 14:36:55,177] {train_model:82} INFO - Train Epoch: 27 [182784/366120 (50%)]	lr:1.04e-04	Loss: 0.038093
[2024-08-03 14:37:08,564] {train_model:82} INFO - Train Epoch: 27 [219392/366120 (60%)]	lr:1.04e-04	Loss: 0.023430
[2024-08-03 14:37:21,966] {train_model:82} INFO - Train Epoch: 27 [256000/366120 (70%)]	lr:1.04e-04	Loss: 0.037319
[2024-08-03 14:37:35,396] {train_model:82} INFO - Train Epoch: 27 [292608/366120 (80%)]	lr:1.04e-04	Loss: 0.049308
[2024-08-03 14:37:48,855] {train_model:82} INFO - Train Epoch: 27 [329216/366120 (90%)]	lr:1.04e-04	Loss: 0.035744
[2024-08-03 14:38:02,182] {train_model:82} INFO - Train Epoch: 27 [365824/366120 (100%)]	lr:1.04e-04	Loss: 0.060520
[2024-08-03 14:38:09,179] {run_experiment:79} INFO - 
[2024-08-03 14:38:09,179] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-03 14:38:09,994] {result_logger:103} INFO - precision on Wake: 0.987
[2024-08-03 14:38:10,526] {result_logger:104} INFO - recall on Wake: 0.988
[2024-08-03 14:38:11,041] {result_logger:107} INFO - F1-score on Wake: 0.987
[2024-08-03 14:38:11,042] {result_logger:108} INFO - 
[2024-08-03 14:38:11,821] {result_logger:103} INFO - precision on REM: 0.988
[2024-08-03 14:38:12,301] {result_logger:104} INFO - recall on REM: 0.995
[2024-08-03 14:38:12,763] {result_logger:107} INFO - F1-score on REM: 0.992
[2024-08-03 14:38:12,763] {result_logger:108} INFO - 
[2024-08-03 14:38:13,516] {result_logger:103} INFO - precision on Non REM: 0.983
[2024-08-03 14:38:13,978] {result_logger:104} INFO - recall on Non REM: 0.977
[2024-08-03 14:38:14,439] {result_logger:107} INFO - F1-score on Non REM: 0.980
[2024-08-03 14:38:14,439] {result_logger:108} INFO - 
[2024-08-03 14:38:14,555] {result_logger:111} INFO - average precision on sleep stages: 0.986
[2024-08-03 14:38:14,669] {result_logger:113} INFO - average recall on sleep stages: 0.987
[2024-08-03 14:38:14,784] {result_logger:115} INFO - average F1-score on sleep stages: 0.986
[2024-08-03 14:38:14,785] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-03 14:38:14,880] {result_logger:103} INFO - precision on Wake: 0.963
[2024-08-03 14:38:14,936] {result_logger:104} INFO - recall on Wake: 0.986
[2024-08-03 14:38:14,993] {result_logger:107} INFO - F1-score on Wake: 0.974
[2024-08-03 14:38:14,993] {result_logger:108} INFO - 
[2024-08-03 14:38:15,083] {result_logger:103} INFO - precision on REM: 0.848
[2024-08-03 14:38:15,137] {result_logger:104} INFO - recall on REM: 0.957
[2024-08-03 14:38:15,192] {result_logger:107} INFO - F1-score on REM: 0.900
[2024-08-03 14:38:15,192] {result_logger:108} INFO - 
[2024-08-03 14:38:15,287] {result_logger:103} INFO - precision on Non REM: 0.978
[2024-08-03 14:38:15,342] {result_logger:104} INFO - recall on Non REM: 0.931
[2024-08-03 14:38:15,398] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2024-08-03 14:38:15,398] {result_logger:108} INFO - 
[2024-08-03 14:38:15,410] {result_logger:111} INFO - average precision on sleep stages: 0.930
[2024-08-03 14:38:15,420] {result_logger:113} INFO - average recall on sleep stages: 0.958
[2024-08-03 14:38:15,432] {result_logger:115} INFO - average F1-score on sleep stages: 0.943
[2024-08-03 14:38:15,432] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-03 14:38:15,509] {result_logger:134} INFO - 
[[148239    171   1702]
 [    83  91100    346]
 [  1876    952 121651]]
[2024-08-03 14:38:15,588] {result_logger:141} INFO - 
[[ 98.75%   0.11%   1.13%]
 [  0.09%  99.53%   0.38%]
 [  1.51%   0.76%  97.73%]]
[2024-08-03 14:38:15,665] {result_logger:145} INFO - 
[[ 98.70%   0.19%   1.38%]
 [  0.06%  98.78%   0.28%]
 [  1.25%   1.03%  98.34%]]
[2024-08-03 14:38:15,666] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-03 14:38:15,675] {result_logger:134} INFO - 
[[27972    74   336]
 [   15  2436    94]
 [ 1065   361 19277]]
[2024-08-03 14:38:15,683] {result_logger:141} INFO - 
[[ 98.56%   0.26%   1.18%]
 [  0.59%  95.72%   3.69%]
 [  5.14%   1.74%  93.11%]]
[2024-08-03 14:38:15,692] {result_logger:145} INFO - 
[[ 96.28%   2.58%   1.70%]
 [  0.05%  84.85%   0.48%]
 [  3.67%  12.57%  97.82%]]
[2024-08-03 14:38:15,793] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-03 14:38:15,793] {result_logger:77} INFO - actual:
[2024-08-03 14:38:15,794] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-03 14:38:15,794] {result_logger:79} INFO - predicted:
[2024-08-03 14:38:15,794] {result_logger:80} INFO - 
[[94.69%  0.12%  5.19%]
 [16.51% 78.40%  5.09%]
 [ 5.42%  2.97% 91.60%]]
[2024-08-03 14:38:15,794] {run_experiment:113} INFO - [epoch  27] execution time: 164.26s	 avg f1-score: 0.9426

[2024-08-03 14:38:15,794] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-03 14:38:15,817] {dataloader:147} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2024-08-03 14:38:35,375] {train_model:82} INFO - Train Epoch: 28 [36352/366120 (10%)]	lr:9.80e-05	Loss: 0.045408
[2024-08-03 14:38:53,148] {train_model:82} INFO - Train Epoch: 28 [72960/366120 (20%)]	lr:9.80e-05	Loss: 0.055837
[2024-08-03 14:39:12,291] {train_model:82} INFO - Train Epoch: 28 [109568/366120 (30%)]	lr:9.80e-05	Loss: 0.042040
[2024-08-03 14:39:25,376] {train_model:82} INFO - Train Epoch: 28 [146176/366120 (40%)]	lr:9.80e-05	Loss: 0.042880
[2024-08-03 14:39:38,796] {train_model:82} INFO - Train Epoch: 28 [182784/366120 (50%)]	lr:9.80e-05	Loss: 0.045310
[2024-08-03 14:39:52,073] {train_model:82} INFO - Train Epoch: 28 [219392/366120 (60%)]	lr:9.80e-05	Loss: 0.015250
[2024-08-03 14:40:05,576] {train_model:82} INFO - Train Epoch: 28 [256000/366120 (70%)]	lr:9.80e-05	Loss: 0.008921
[2024-08-03 14:40:19,077] {train_model:82} INFO - Train Epoch: 28 [292608/366120 (80%)]	lr:9.80e-05	Loss: 0.033348
[2024-08-03 14:40:32,387] {train_model:82} INFO - Train Epoch: 28 [329216/366120 (90%)]	lr:9.80e-05	Loss: 0.047994
[2024-08-03 14:40:45,678] {train_model:82} INFO - Train Epoch: 28 [365824/366120 (100%)]	lr:9.80e-05	Loss: 0.015998
[2024-08-03 14:40:52,831] {run_experiment:79} INFO - 
[2024-08-03 14:40:52,831] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-03 14:40:53,673] {result_logger:103} INFO - precision on Wake: 0.987
[2024-08-03 14:40:54,217] {result_logger:104} INFO - recall on Wake: 0.988
[2024-08-03 14:40:54,777] {result_logger:107} INFO - F1-score on Wake: 0.987
[2024-08-03 14:40:54,777] {result_logger:108} INFO - 
[2024-08-03 14:40:55,536] {result_logger:103} INFO - precision on REM: 0.989
[2024-08-03 14:40:56,013] {result_logger:104} INFO - recall on REM: 0.995
[2024-08-03 14:40:56,493] {result_logger:107} INFO - F1-score on REM: 0.992
[2024-08-03 14:40:56,493] {result_logger:108} INFO - 
[2024-08-03 14:40:57,210] {result_logger:103} INFO - precision on Non REM: 0.983
[2024-08-03 14:40:57,676] {result_logger:104} INFO - recall on Non REM: 0.979
[2024-08-03 14:40:58,145] {result_logger:107} INFO - F1-score on Non REM: 0.981
[2024-08-03 14:40:58,145] {result_logger:108} INFO - 
[2024-08-03 14:40:58,258] {result_logger:111} INFO - average precision on sleep stages: 0.987
[2024-08-03 14:40:58,371] {result_logger:113} INFO - average recall on sleep stages: 0.987
[2024-08-03 14:40:58,484] {result_logger:115} INFO - average F1-score on sleep stages: 0.987
[2024-08-03 14:40:58,485] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-03 14:40:58,579] {result_logger:103} INFO - precision on Wake: 0.979
[2024-08-03 14:40:58,636] {result_logger:104} INFO - recall on Wake: 0.979
[2024-08-03 14:40:58,694] {result_logger:107} INFO - F1-score on Wake: 0.979
[2024-08-03 14:40:58,694] {result_logger:108} INFO - 
[2024-08-03 14:40:58,784] {result_logger:103} INFO - precision on REM: 0.880
[2024-08-03 14:40:58,840] {result_logger:104} INFO - recall on REM: 0.943
[2024-08-03 14:40:58,896] {result_logger:107} INFO - F1-score on REM: 0.910
[2024-08-03 14:40:58,896] {result_logger:108} INFO - 
[2024-08-03 14:40:58,987] {result_logger:103} INFO - precision on Non REM: 0.966
[2024-08-03 14:40:59,045] {result_logger:104} INFO - recall on Non REM: 0.959
[2024-08-03 14:40:59,100] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2024-08-03 14:40:59,101] {result_logger:108} INFO - 
[2024-08-03 14:40:59,112] {result_logger:111} INFO - average precision on sleep stages: 0.942
[2024-08-03 14:40:59,123] {result_logger:113} INFO - average recall on sleep stages: 0.960
[2024-08-03 14:40:59,135] {result_logger:115} INFO - average F1-score on sleep stages: 0.951
[2024-08-03 14:40:59,135] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-03 14:40:59,212] {result_logger:134} INFO - 
[[148235    156   1720]
 [    88  91110    333]
 [  1822    854 121802]]
[2024-08-03 14:40:59,289] {result_logger:141} INFO - 
[[ 98.75%   0.10%   1.15%]
 [  0.10%  99.54%   0.36%]
 [  1.46%   0.69%  97.85%]]
[2024-08-03 14:40:59,366] {result_logger:145} INFO - 
[[ 98.73%   0.17%   1.39%]
 [  0.06%  98.90%   0.27%]
 [  1.21%   0.93%  98.34%]]
[2024-08-03 14:40:59,366] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-03 14:40:59,374] {result_logger:134} INFO - 
[[27774    39   569]
 [   25  2400   120]
 [  560   289 19854]]
[2024-08-03 14:40:59,486] {result_logger:141} INFO - 
[[ 97.86%   0.14%   2.00%]
 [  0.98%  94.30%   4.72%]
 [  2.70%   1.40%  95.90%]]
[2024-08-03 14:40:59,592] {result_logger:145} INFO - 
[[ 97.94%   1.43%   2.77%]
 [  0.09%  87.98%   0.58%]
 [  1.97%  10.59%  96.65%]]
[2024-08-03 14:40:59,891] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-03 14:40:59,891] {result_logger:77} INFO - actual:
[2024-08-03 14:40:59,892] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-03 14:40:59,892] {result_logger:79} INFO - predicted:
[2024-08-03 14:40:59,892] {result_logger:80} INFO - 
[[95.15%  0.06%  4.79%]
 [15.58% 79.40%  5.02%]
 [ 4.62%  2.65% 92.73%]]
[2024-08-03 14:40:59,952] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_C/model_8conv_2fc-best.pth
[2024-08-03 14:40:59,952] {run_experiment:113} INFO - [epoch  28] execution time: 164.16s	 avg f1-score: 0.9507

[2024-08-03 14:40:59,952] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-03 14:40:59,973] {dataloader:147} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2024-08-03 14:41:19,511] {train_model:82} INFO - Train Epoch: 29 [36352/366120 (10%)]	lr:9.23e-05	Loss: 0.029217
[2024-08-03 14:41:37,660] {train_model:82} INFO - Train Epoch: 29 [72960/366120 (20%)]	lr:9.23e-05	Loss: 0.031479
[2024-08-03 14:41:56,823] {train_model:82} INFO - Train Epoch: 29 [109568/366120 (30%)]	lr:9.23e-05	Loss: 0.032619
[2024-08-03 14:42:10,149] {train_model:82} INFO - Train Epoch: 29 [146176/366120 (40%)]	lr:9.23e-05	Loss: 0.040711
[2024-08-03 14:42:23,527] {train_model:82} INFO - Train Epoch: 29 [182784/366120 (50%)]	lr:9.23e-05	Loss: 0.058684
[2024-08-03 14:42:37,001] {train_model:82} INFO - Train Epoch: 29 [219392/366120 (60%)]	lr:9.23e-05	Loss: 0.041671
[2024-08-03 14:42:50,418] {train_model:82} INFO - Train Epoch: 29 [256000/366120 (70%)]	lr:9.23e-05	Loss: 0.029950
[2024-08-03 14:43:03,992] {train_model:82} INFO - Train Epoch: 29 [292608/366120 (80%)]	lr:9.23e-05	Loss: 0.033240
[2024-08-03 14:43:17,453] {train_model:82} INFO - Train Epoch: 29 [329216/366120 (90%)]	lr:9.23e-05	Loss: 0.035756
[2024-08-03 14:43:30,974] {train_model:82} INFO - Train Epoch: 29 [365824/366120 (100%)]	lr:9.23e-05	Loss: 0.034296
[2024-08-03 14:43:38,525] {run_experiment:79} INFO - 
[2024-08-03 14:43:38,526] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-03 14:43:39,384] {result_logger:103} INFO - precision on Wake: 0.988
[2024-08-03 14:43:39,923] {result_logger:104} INFO - recall on Wake: 0.988
[2024-08-03 14:43:40,467] {result_logger:107} INFO - F1-score on Wake: 0.988
[2024-08-03 14:43:40,467] {result_logger:108} INFO - 
[2024-08-03 14:43:41,228] {result_logger:103} INFO - precision on REM: 0.990
[2024-08-03 14:43:41,710] {result_logger:104} INFO - recall on REM: 0.996
[2024-08-03 14:43:42,193] {result_logger:107} INFO - F1-score on REM: 0.993
[2024-08-03 14:43:42,193] {result_logger:108} INFO - 
[2024-08-03 14:43:42,929] {result_logger:103} INFO - precision on Non REM: 0.984
[2024-08-03 14:43:43,390] {result_logger:104} INFO - recall on Non REM: 0.980
[2024-08-03 14:43:43,847] {result_logger:107} INFO - F1-score on Non REM: 0.982
[2024-08-03 14:43:43,847] {result_logger:108} INFO - 
[2024-08-03 14:43:43,959] {result_logger:111} INFO - average precision on sleep stages: 0.987
[2024-08-03 14:43:44,071] {result_logger:113} INFO - average recall on sleep stages: 0.988
[2024-08-03 14:43:44,184] {result_logger:115} INFO - average F1-score on sleep stages: 0.988
[2024-08-03 14:43:44,186] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-03 14:43:44,279] {result_logger:103} INFO - precision on Wake: 0.975
[2024-08-03 14:43:44,335] {result_logger:104} INFO - recall on Wake: 0.981
[2024-08-03 14:43:44,392] {result_logger:107} INFO - F1-score on Wake: 0.978
[2024-08-03 14:43:44,393] {result_logger:108} INFO - 
[2024-08-03 14:43:44,483] {result_logger:103} INFO - precision on REM: 0.844
[2024-08-03 14:43:44,538] {result_logger:104} INFO - recall on REM: 0.955
[2024-08-03 14:43:44,594] {result_logger:107} INFO - F1-score on REM: 0.896
[2024-08-03 14:43:44,594] {result_logger:108} INFO - 
[2024-08-03 14:43:44,687] {result_logger:103} INFO - precision on Non REM: 0.973
[2024-08-03 14:43:44,744] {result_logger:104} INFO - recall on Non REM: 0.950
[2024-08-03 14:43:44,801] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2024-08-03 14:43:44,801] {result_logger:108} INFO - 
[2024-08-03 14:43:44,813] {result_logger:111} INFO - average precision on sleep stages: 0.931
[2024-08-03 14:43:44,824] {result_logger:113} INFO - average recall on sleep stages: 0.962
[2024-08-03 14:43:44,836] {result_logger:115} INFO - average F1-score on sleep stages: 0.945
[2024-08-03 14:43:44,836] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-03 14:43:44,913] {result_logger:134} INFO - 
[[148295    157   1655]
 [    94  91140    297]
 [  1678    772 122032]]
[2024-08-03 14:43:44,988] {result_logger:141} INFO - 
[[ 98.79%   0.10%   1.10%]
 [  0.10%  99.57%   0.32%]
 [  1.35%   0.62%  98.03%]]
[2024-08-03 14:43:45,064] {result_logger:145} INFO - 
[[ 98.82%   0.17%   1.33%]
 [  0.06%  98.99%   0.24%]
 [  1.12%   0.84%  98.43%]]
[2024-08-03 14:43:45,064] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-03 14:43:45,072] {result_logger:134} INFO - 
[[27837   100   445]
 [   14  2431   100]
 [  688   349 19666]]
[2024-08-03 14:43:45,081] {result_logger:141} INFO - 
[[ 98.08%   0.35%   1.57%]
 [  0.55%  95.52%   3.93%]
 [  3.32%   1.69%  94.99%]]
[2024-08-03 14:43:45,089] {result_logger:145} INFO - 
[[ 97.54%   3.47%   2.20%]
 [  0.05%  84.41%   0.49%]
 [  2.41%  12.12%  97.30%]]
[2024-08-03 14:43:45,192] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-03 14:43:45,192] {result_logger:77} INFO - actual:
[2024-08-03 14:43:45,192] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-03 14:43:45,192] {result_logger:79} INFO - predicted:
[2024-08-03 14:43:45,193] {result_logger:80} INFO - 
[[95.04%  0.20%  4.76%]
 [16.60% 78.44%  4.97%]
 [ 4.64%  2.79% 92.57%]]
[2024-08-03 14:43:45,193] {run_experiment:113} INFO - [epoch  29] execution time: 165.24s	 avg f1-score: 0.9452

[2024-08-03 14:43:45,193] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-03 14:43:45,212] {dataloader:147} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2024-08-03 14:44:04,904] {train_model:82} INFO - Train Epoch: 30 [36352/366120 (10%)]	lr:8.69e-05	Loss: 0.059168
[2024-08-03 14:44:29,789] {train_model:82} INFO - Train Epoch: 30 [72960/366120 (20%)]	lr:8.69e-05	Loss: 0.031385
[2024-08-03 14:44:42,898] {train_model:82} INFO - Train Epoch: 30 [109568/366120 (30%)]	lr:8.69e-05	Loss: 0.023555
[2024-08-03 14:44:56,218] {train_model:82} INFO - Train Epoch: 30 [146176/366120 (40%)]	lr:8.69e-05	Loss: 0.026384
[2024-08-03 14:45:09,592] {train_model:82} INFO - Train Epoch: 30 [182784/366120 (50%)]	lr:8.69e-05	Loss: 0.050123
[2024-08-03 14:45:22,958] {train_model:82} INFO - Train Epoch: 30 [219392/366120 (60%)]	lr:8.69e-05	Loss: 0.027475
[2024-08-03 14:45:36,387] {train_model:82} INFO - Train Epoch: 30 [256000/366120 (70%)]	lr:8.69e-05	Loss: 0.079772
[2024-08-03 14:45:49,682] {train_model:82} INFO - Train Epoch: 30 [292608/366120 (80%)]	lr:8.69e-05	Loss: 0.024969
[2024-08-03 14:46:03,191] {train_model:82} INFO - Train Epoch: 30 [329216/366120 (90%)]	lr:8.69e-05	Loss: 0.027643
[2024-08-03 14:46:16,675] {train_model:82} INFO - Train Epoch: 30 [365824/366120 (100%)]	lr:8.69e-05	Loss: 0.029299
[2024-08-03 14:46:24,060] {run_experiment:79} INFO - 
[2024-08-03 14:46:24,060] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-03 14:46:24,874] {result_logger:103} INFO - precision on Wake: 0.989
[2024-08-03 14:46:25,414] {result_logger:104} INFO - recall on Wake: 0.989
[2024-08-03 14:46:25,949] {result_logger:107} INFO - F1-score on Wake: 0.989
[2024-08-03 14:46:25,949] {result_logger:108} INFO - 
[2024-08-03 14:46:26,703] {result_logger:103} INFO - precision on REM: 0.990
[2024-08-03 14:46:27,171] {result_logger:104} INFO - recall on REM: 0.996
[2024-08-03 14:46:27,636] {result_logger:107} INFO - F1-score on REM: 0.993
[2024-08-03 14:46:27,636] {result_logger:108} INFO - 
[2024-08-03 14:46:28,394] {result_logger:103} INFO - precision on Non REM: 0.985
[2024-08-03 14:46:28,869] {result_logger:104} INFO - recall on Non REM: 0.981
[2024-08-03 14:46:29,346] {result_logger:107} INFO - F1-score on Non REM: 0.983
[2024-08-03 14:46:29,346] {result_logger:108} INFO - 
[2024-08-03 14:46:29,463] {result_logger:111} INFO - average precision on sleep stages: 0.988
[2024-08-03 14:46:29,580] {result_logger:113} INFO - average recall on sleep stages: 0.988
[2024-08-03 14:46:29,699] {result_logger:115} INFO - average F1-score on sleep stages: 0.988
[2024-08-03 14:46:29,700] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-03 14:46:29,797] {result_logger:103} INFO - precision on Wake: 0.969
[2024-08-03 14:46:29,855] {result_logger:104} INFO - recall on Wake: 0.984
[2024-08-03 14:46:29,914] {result_logger:107} INFO - F1-score on Wake: 0.977
[2024-08-03 14:46:29,915] {result_logger:108} INFO - 
[2024-08-03 14:46:30,009] {result_logger:103} INFO - precision on REM: 0.862
[2024-08-03 14:46:30,065] {result_logger:104} INFO - recall on REM: 0.951
[2024-08-03 14:46:30,123] {result_logger:107} INFO - F1-score on REM: 0.905
[2024-08-03 14:46:30,123] {result_logger:108} INFO - 
[2024-08-03 14:46:30,218] {result_logger:103} INFO - precision on Non REM: 0.975
[2024-08-03 14:46:30,277] {result_logger:104} INFO - recall on Non REM: 0.943
[2024-08-03 14:46:30,335] {result_logger:107} INFO - F1-score on Non REM: 0.959
[2024-08-03 14:46:30,335] {result_logger:108} INFO - 
[2024-08-03 14:46:30,347] {result_logger:111} INFO - average precision on sleep stages: 0.936
[2024-08-03 14:46:30,359] {result_logger:113} INFO - average recall on sleep stages: 0.959
[2024-08-03 14:46:30,371] {result_logger:115} INFO - average F1-score on sleep stages: 0.947
[2024-08-03 14:46:30,371] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-03 14:46:30,450] {result_logger:134} INFO - 
[[148389    154   1565]
 [   110  91126    293]
 [  1600    732 122151]]
[2024-08-03 14:46:30,527] {result_logger:141} INFO - 
[[ 98.85%   0.10%   1.04%]
 [  0.12%  99.56%   0.32%]
 [  1.29%   0.59%  98.13%]]
[2024-08-03 14:46:30,606] {result_logger:145} INFO - 
[[ 98.86%   0.17%   1.26%]
 [  0.07%  99.04%   0.24%]
 [  1.07%   0.80%  98.50%]]
[2024-08-03 14:46:30,607] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-03 14:46:30,615] {result_logger:134} INFO - 
[[27924    60   398]
 [   23  2421   101]
 [  858   327 19518]]
[2024-08-03 14:46:30,623] {result_logger:141} INFO - 
[[ 98.39%   0.21%   1.40%]
 [  0.90%  95.13%   3.97%]
 [  4.14%   1.58%  94.28%]]
[2024-08-03 14:46:30,631] {result_logger:145} INFO - 
[[ 96.94%   2.14%   1.99%]
 [  0.08%  86.22%   0.50%]
 [  2.98%  11.65%  97.51%]]
[2024-08-03 14:46:30,739] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-03 14:46:30,739] {result_logger:77} INFO - actual:
[2024-08-03 14:46:30,740] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-03 14:46:30,740] {result_logger:79} INFO - predicted:
[2024-08-03 14:46:30,740] {result_logger:80} INFO - 
[[94.98%  0.11%  4.91%]
 [16.06% 79.31%  4.63%]
 [ 4.98%  2.74% 92.28%]]
[2024-08-03 14:46:30,740] {run_experiment:113} INFO - [epoch  30] execution time: 165.55s	 avg f1-score: 0.9466

[2024-08-03 14:46:30,740] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-03 14:46:30,760] {dataloader:147} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2024-08-03 14:46:55,139] {train_model:82} INFO - Train Epoch: 31 [36352/366120 (10%)]	lr:8.19e-05	Loss: 0.009521
[2024-08-03 14:47:13,711] {train_model:82} INFO - Train Epoch: 31 [72960/366120 (20%)]	lr:8.19e-05	Loss: 0.017347
[2024-08-03 14:47:26,794] {train_model:82} INFO - Train Epoch: 31 [109568/366120 (30%)]	lr:8.19e-05	Loss: 0.014231
[2024-08-03 14:47:40,197] {train_model:82} INFO - Train Epoch: 31 [146176/366120 (40%)]	lr:8.19e-05	Loss: 0.019832
[2024-08-03 14:47:53,484] {train_model:82} INFO - Train Epoch: 31 [182784/366120 (50%)]	lr:8.19e-05	Loss: 0.033215
[2024-08-03 14:48:06,731] {train_model:82} INFO - Train Epoch: 31 [219392/366120 (60%)]	lr:8.19e-05	Loss: 0.008931
[2024-08-03 14:48:20,072] {train_model:82} INFO - Train Epoch: 31 [256000/366120 (70%)]	lr:8.19e-05	Loss: 0.024259
[2024-08-03 14:48:33,367] {train_model:82} INFO - Train Epoch: 31 [292608/366120 (80%)]	lr:8.19e-05	Loss: 0.020737
[2024-08-03 14:48:46,665] {train_model:82} INFO - Train Epoch: 31 [329216/366120 (90%)]	lr:8.19e-05	Loss: 0.015005
[2024-08-03 14:49:00,010] {train_model:82} INFO - Train Epoch: 31 [365824/366120 (100%)]	lr:8.19e-05	Loss: 0.024708
[2024-08-03 14:49:07,444] {run_experiment:79} INFO - 
[2024-08-03 14:49:07,444] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-03 14:49:08,234] {result_logger:103} INFO - precision on Wake: 0.990
[2024-08-03 14:49:08,755] {result_logger:104} INFO - recall on Wake: 0.989
[2024-08-03 14:49:09,255] {result_logger:107} INFO - F1-score on Wake: 0.990
[2024-08-03 14:49:09,255] {result_logger:108} INFO - 
[2024-08-03 14:49:09,980] {result_logger:103} INFO - precision on REM: 0.991
[2024-08-03 14:49:10,428] {result_logger:104} INFO - recall on REM: 0.996
[2024-08-03 14:49:10,873] {result_logger:107} INFO - F1-score on REM: 0.994
[2024-08-03 14:49:10,873] {result_logger:108} INFO - 
[2024-08-03 14:49:11,583] {result_logger:103} INFO - precision on Non REM: 0.986
[2024-08-03 14:49:12,018] {result_logger:104} INFO - recall on Non REM: 0.983
[2024-08-03 14:49:12,453] {result_logger:107} INFO - F1-score on Non REM: 0.984
[2024-08-03 14:49:12,453] {result_logger:108} INFO - 
[2024-08-03 14:49:12,563] {result_logger:111} INFO - average precision on sleep stages: 0.989
[2024-08-03 14:49:12,674] {result_logger:113} INFO - average recall on sleep stages: 0.989
[2024-08-03 14:49:12,786] {result_logger:115} INFO - average F1-score on sleep stages: 0.989
[2024-08-03 14:49:12,789] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-03 14:49:12,878] {result_logger:103} INFO - precision on Wake: 0.978
[2024-08-03 14:49:12,932] {result_logger:104} INFO - recall on Wake: 0.981
[2024-08-03 14:49:12,986] {result_logger:107} INFO - F1-score on Wake: 0.979
[2024-08-03 14:49:12,986] {result_logger:108} INFO - 
[2024-08-03 14:49:13,077] {result_logger:103} INFO - precision on REM: 0.857
[2024-08-03 14:49:13,130] {result_logger:104} INFO - recall on REM: 0.956
[2024-08-03 14:49:13,182] {result_logger:107} INFO - F1-score on REM: 0.903
[2024-08-03 14:49:13,182] {result_logger:108} INFO - 
[2024-08-03 14:49:13,271] {result_logger:103} INFO - precision on Non REM: 0.971
[2024-08-03 14:49:13,326] {result_logger:104} INFO - recall on Non REM: 0.953
[2024-08-03 14:49:13,382] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2024-08-03 14:49:13,382] {result_logger:108} INFO - 
[2024-08-03 14:49:13,393] {result_logger:111} INFO - average precision on sleep stages: 0.935
[2024-08-03 14:49:13,404] {result_logger:113} INFO - average recall on sleep stages: 0.963
[2024-08-03 14:49:13,415] {result_logger:115} INFO - average F1-score on sleep stages: 0.948
[2024-08-03 14:49:13,415] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-03 14:49:13,491] {result_logger:134} INFO - 
[[148492    138   1479]
 [    82  91166    282]
 [  1449    665 122367]]
[2024-08-03 14:49:13,564] {result_logger:141} INFO - 
[[ 98.92%   0.09%   0.99%]
 [  0.09%  99.60%   0.31%]
 [  1.16%   0.53%  98.30%]]
[2024-08-03 14:49:13,634] {result_logger:145} INFO - 
[[ 98.98%   0.15%   1.19%]
 [  0.05%  99.13%   0.23%]
 [  0.97%   0.72%  98.58%]]
[2024-08-03 14:49:13,634] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-03 14:49:13,642] {result_logger:134} INFO - 
[[27842    56   484]
 [   17  2432    96]
 [  620   351 19732]]
[2024-08-03 14:49:13,649] {result_logger:141} INFO - 
[[ 98.10%   0.20%   1.71%]
 [  0.67%  95.56%   3.77%]
 [  2.99%   1.70%  95.31%]]
[2024-08-03 14:49:13,657] {result_logger:145} INFO - 
[[ 97.76%   1.97%   2.38%]
 [  0.06%  85.66%   0.47%]
 [  2.18%  12.36%  97.14%]]
[2024-08-03 14:49:13,757] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-03 14:49:13,757] {result_logger:77} INFO - actual:
[2024-08-03 14:49:13,758] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-03 14:49:13,758] {result_logger:79} INFO - predicted:
[2024-08-03 14:49:13,758] {result_logger:80} INFO - 
[[95.08%  0.11%  4.81%]
 [15.78% 79.15%  5.07%]
 [ 4.70%  2.76% 92.54%]]
[2024-08-03 14:49:13,758] {run_experiment:113} INFO - [epoch  31] execution time: 163.02s	 avg f1-score: 0.9483

[2024-08-03 14:49:13,758] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-03 14:49:13,778] {dataloader:147} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2024-08-03 14:49:40,925] {train_model:82} INFO - Train Epoch: 32 [36352/366120 (10%)]	lr:7.71e-05	Loss: 0.039279
[2024-08-03 14:49:55,125] {train_model:82} INFO - Train Epoch: 32 [72960/366120 (20%)]	lr:7.71e-05	Loss: 0.015567
[2024-08-03 14:50:08,141] {train_model:82} INFO - Train Epoch: 32 [109568/366120 (30%)]	lr:7.71e-05	Loss: 0.012974
[2024-08-03 14:50:21,375] {train_model:82} INFO - Train Epoch: 32 [146176/366120 (40%)]	lr:7.71e-05	Loss: 0.011817
[2024-08-03 14:50:34,499] {train_model:82} INFO - Train Epoch: 32 [182784/366120 (50%)]	lr:7.71e-05	Loss: 0.026145
[2024-08-03 14:50:47,684] {train_model:82} INFO - Train Epoch: 32 [219392/366120 (60%)]	lr:7.71e-05	Loss: 0.052439
[2024-08-03 14:51:00,795] {train_model:82} INFO - Train Epoch: 32 [256000/366120 (70%)]	lr:7.71e-05	Loss: 0.009381
[2024-08-03 14:51:14,129] {train_model:82} INFO - Train Epoch: 32 [292608/366120 (80%)]	lr:7.71e-05	Loss: 0.008991
[2024-08-03 14:51:27,380] {train_model:82} INFO - Train Epoch: 32 [329216/366120 (90%)]	lr:7.71e-05	Loss: 0.015510
[2024-08-03 14:51:40,498] {train_model:82} INFO - Train Epoch: 32 [365824/366120 (100%)]	lr:7.71e-05	Loss: 0.015315
[2024-08-03 14:51:47,769] {run_experiment:79} INFO - 
[2024-08-03 14:51:47,769] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-03 14:51:48,561] {result_logger:103} INFO - precision on Wake: 0.990
[2024-08-03 14:51:49,056] {result_logger:104} INFO - recall on Wake: 0.990
[2024-08-03 14:51:49,541] {result_logger:107} INFO - F1-score on Wake: 0.990
[2024-08-03 14:51:49,542] {result_logger:108} INFO - 
[2024-08-03 14:51:50,271] {result_logger:103} INFO - precision on REM: 0.992
[2024-08-03 14:51:50,720] {result_logger:104} INFO - recall on REM: 0.996
[2024-08-03 14:51:51,169] {result_logger:107} INFO - F1-score on REM: 0.994
[2024-08-03 14:51:51,169] {result_logger:108} INFO - 
[2024-08-03 14:51:51,877] {result_logger:103} INFO - precision on Non REM: 0.987
[2024-08-03 14:51:52,319] {result_logger:104} INFO - recall on Non REM: 0.983
[2024-08-03 14:51:52,761] {result_logger:107} INFO - F1-score on Non REM: 0.985
[2024-08-03 14:51:52,762] {result_logger:108} INFO - 
[2024-08-03 14:51:52,875] {result_logger:111} INFO - average precision on sleep stages: 0.989
[2024-08-03 14:51:52,986] {result_logger:113} INFO - average recall on sleep stages: 0.990
[2024-08-03 14:51:53,096] {result_logger:115} INFO - average F1-score on sleep stages: 0.990
[2024-08-03 14:51:53,097] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-03 14:51:53,188] {result_logger:103} INFO - precision on Wake: 0.973
[2024-08-03 14:51:53,241] {result_logger:104} INFO - recall on Wake: 0.978
[2024-08-03 14:51:53,294] {result_logger:107} INFO - F1-score on Wake: 0.976
[2024-08-03 14:51:53,294] {result_logger:108} INFO - 
[2024-08-03 14:51:53,383] {result_logger:103} INFO - precision on REM: 0.842
[2024-08-03 14:51:53,437] {result_logger:104} INFO - recall on REM: 0.956
[2024-08-03 14:51:53,491] {result_logger:107} INFO - F1-score on REM: 0.895
[2024-08-03 14:51:53,491] {result_logger:108} INFO - 
[2024-08-03 14:51:53,581] {result_logger:103} INFO - precision on Non REM: 0.972
[2024-08-03 14:51:53,633] {result_logger:104} INFO - recall on Non REM: 0.949
[2024-08-03 14:51:53,687] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2024-08-03 14:51:53,687] {result_logger:108} INFO - 
[2024-08-03 14:51:53,698] {result_logger:111} INFO - average precision on sleep stages: 0.929
[2024-08-03 14:51:53,709] {result_logger:113} INFO - average recall on sleep stages: 0.961
[2024-08-03 14:51:53,719] {result_logger:115} INFO - average F1-score on sleep stages: 0.944
[2024-08-03 14:51:53,720] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-03 14:51:53,796] {result_logger:134} INFO - 
[[148592    144   1375]
 [    90  91189    251]
 [  1436    625 122418]]
[2024-08-03 14:51:53,872] {result_logger:141} INFO - 
[[ 98.99%   0.10%   0.92%]
 [  0.10%  99.63%   0.27%]
 [  1.15%   0.50%  98.34%]]
[2024-08-03 14:51:53,945] {result_logger:145} INFO - 
[[ 98.98%   0.16%   1.11%]
 [  0.06%  99.16%   0.20%]
 [  0.96%   0.68%  98.69%]]
[2024-08-03 14:51:53,945] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-03 14:51:53,952] {result_logger:134} INFO - 
[[27763   160   459]
 [   15  2432    98]
 [  759   298 19646]]
[2024-08-03 14:51:53,960] {result_logger:141} INFO - 
[[ 97.82%   0.56%   1.62%]
 [  0.59%  95.56%   3.85%]
 [  3.67%   1.44%  94.89%]]
[2024-08-03 14:51:53,967] {result_logger:145} INFO - 
[[ 97.29%   5.54%   2.27%]
 [  0.05%  84.15%   0.49%]
 [  2.66%  10.31%  97.24%]]
[2024-08-03 14:51:54,070] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-03 14:51:54,070] {result_logger:77} INFO - actual:
[2024-08-03 14:51:54,071] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-03 14:51:54,071] {result_logger:79} INFO - predicted:
[2024-08-03 14:51:54,071] {result_logger:80} INFO - 
[[94.83%  0.32%  4.85%]
 [16.92% 78.17%  4.91%]
 [ 4.88%  2.68% 92.45%]]
[2024-08-03 14:51:54,071] {run_experiment:113} INFO - [epoch  32] execution time: 160.31s	 avg f1-score: 0.9437

[2024-08-03 14:51:54,071] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-03 14:51:54,089] {dataloader:147} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2024-08-03 14:52:20,602] {train_model:82} INFO - Train Epoch: 33 [36352/366120 (10%)]	lr:7.26e-05	Loss: 0.031863
[2024-08-03 14:52:33,549] {train_model:82} INFO - Train Epoch: 33 [72960/366120 (20%)]	lr:7.26e-05	Loss: 0.046150
[2024-08-03 14:52:46,591] {train_model:82} INFO - Train Epoch: 33 [109568/366120 (30%)]	lr:7.26e-05	Loss: 0.017608
[2024-08-03 14:52:59,915] {train_model:82} INFO - Train Epoch: 33 [146176/366120 (40%)]	lr:7.26e-05	Loss: 0.008419
[2024-08-03 14:53:13,058] {train_model:82} INFO - Train Epoch: 33 [182784/366120 (50%)]	lr:7.26e-05	Loss: 0.010614
[2024-08-03 14:53:26,131] {train_model:82} INFO - Train Epoch: 33 [219392/366120 (60%)]	lr:7.26e-05	Loss: 0.026845
[2024-08-03 14:53:39,247] {train_model:82} INFO - Train Epoch: 33 [256000/366120 (70%)]	lr:7.26e-05	Loss: 0.022002
[2024-08-03 14:53:52,353] {train_model:82} INFO - Train Epoch: 33 [292608/366120 (80%)]	lr:7.26e-05	Loss: 0.009862
[2024-08-03 14:54:05,457] {train_model:82} INFO - Train Epoch: 33 [329216/366120 (90%)]	lr:7.26e-05	Loss: 0.025420
[2024-08-03 14:54:18,554] {train_model:82} INFO - Train Epoch: 33 [365824/366120 (100%)]	lr:7.26e-05	Loss: 0.034432
[2024-08-03 14:54:25,726] {run_experiment:79} INFO - 
[2024-08-03 14:54:25,726] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-03 14:54:26,522] {result_logger:103} INFO - precision on Wake: 0.991
[2024-08-03 14:54:27,013] {result_logger:104} INFO - recall on Wake: 0.990
[2024-08-03 14:54:27,501] {result_logger:107} INFO - F1-score on Wake: 0.990
[2024-08-03 14:54:27,502] {result_logger:108} INFO - 
[2024-08-03 14:54:28,240] {result_logger:103} INFO - precision on REM: 0.993
[2024-08-03 14:54:28,695] {result_logger:104} INFO - recall on REM: 0.997
[2024-08-03 14:54:29,143] {result_logger:107} INFO - F1-score on REM: 0.995
[2024-08-03 14:54:29,143] {result_logger:108} INFO - 
[2024-08-03 14:54:29,812] {result_logger:103} INFO - precision on Non REM: 0.987
[2024-08-03 14:54:30,245] {result_logger:104} INFO - recall on Non REM: 0.985
[2024-08-03 14:54:30,700] {result_logger:107} INFO - F1-score on Non REM: 0.986
[2024-08-03 14:54:30,700] {result_logger:108} INFO - 
[2024-08-03 14:54:30,817] {result_logger:111} INFO - average precision on sleep stages: 0.990
[2024-08-03 14:54:30,933] {result_logger:113} INFO - average recall on sleep stages: 0.991
[2024-08-03 14:54:31,051] {result_logger:115} INFO - average F1-score on sleep stages: 0.990
[2024-08-03 14:54:31,053] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-03 14:54:31,148] {result_logger:103} INFO - precision on Wake: 0.974
[2024-08-03 14:54:31,207] {result_logger:104} INFO - recall on Wake: 0.978
[2024-08-03 14:54:31,266] {result_logger:107} INFO - F1-score on Wake: 0.976
[2024-08-03 14:54:31,266] {result_logger:108} INFO - 
[2024-08-03 14:54:31,362] {result_logger:103} INFO - precision on REM: 0.839
[2024-08-03 14:54:31,420] {result_logger:104} INFO - recall on REM: 0.942
[2024-08-03 14:54:31,476] {result_logger:107} INFO - F1-score on REM: 0.888
[2024-08-03 14:54:31,477] {result_logger:108} INFO - 
[2024-08-03 14:54:31,573] {result_logger:103} INFO - precision on Non REM: 0.972
[2024-08-03 14:54:31,632] {result_logger:104} INFO - recall on Non REM: 0.952
[2024-08-03 14:54:31,689] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2024-08-03 14:54:31,689] {result_logger:108} INFO - 
[2024-08-03 14:54:31,701] {result_logger:111} INFO - average precision on sleep stages: 0.928
[2024-08-03 14:54:31,712] {result_logger:113} INFO - average recall on sleep stages: 0.957
[2024-08-03 14:54:31,724] {result_logger:115} INFO - average F1-score on sleep stages: 0.942
[2024-08-03 14:54:31,724] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-03 14:54:31,804] {result_logger:134} INFO - 
[[148604    127   1379]
 [    60  91241    230]
 [  1354    545 122580]]
[2024-08-03 14:54:31,883] {result_logger:141} INFO - 
[[ 99.00%   0.08%   0.92%]
 [  0.07%  99.68%   0.25%]
 [  1.09%   0.44%  98.47%]]
[2024-08-03 14:54:31,961] {result_logger:145} INFO - 
[[ 99.06%   0.14%   1.11%]
 [  0.04%  99.27%   0.19%]
 [  0.90%   0.59%  98.70%]]
[2024-08-03 14:54:31,962] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-03 14:54:31,970] {result_logger:134} INFO - 
[[27744   199   439]
 [   17  2397   131]
 [  732   260 19711]]
[2024-08-03 14:54:31,978] {result_logger:141} INFO - 
[[ 97.75%   0.70%   1.55%]
 [  0.67%  94.18%   5.15%]
 [  3.54%   1.26%  95.21%]]
[2024-08-03 14:54:31,986] {result_logger:145} INFO - 
[[ 97.37%   6.97%   2.16%]
 [  0.06%  83.93%   0.65%]
 [  2.57%   9.10%  97.19%]]
[2024-08-03 14:54:32,094] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-03 14:54:32,094] {result_logger:77} INFO - actual:
[2024-08-03 14:54:32,094] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-03 14:54:32,094] {result_logger:79} INFO - predicted:
[2024-08-03 14:54:32,094] {result_logger:80} INFO - 
[[94.56%  0.41%  5.03%]
 [18.14% 77.38%  4.48%]
 [ 5.08%  2.61% 92.31%]]
[2024-08-03 14:54:32,094] {run_experiment:113} INFO - [epoch  33] execution time: 158.02s	 avg f1-score: 0.9417

[2024-08-03 14:54:32,094] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-03 14:54:32,113] {dataloader:147} INFO - data distribution after processing:
	Wake                : 150110
	REM                 : 91531
	Non REM             : 124481
[2024-08-03 14:54:54,906] {train_model:82} INFO - Train Epoch: 34 [36352/366120 (10%)]	lr:6.84e-05	Loss: 0.012974
[2024-08-03 14:55:07,868] {train_model:82} INFO - Train Epoch: 34 [72960/366120 (20%)]	lr:6.84e-05	Loss: 0.012991
[2024-08-03 14:55:21,033] {train_model:82} INFO - Train Epoch: 34 [109568/366120 (30%)]	lr:6.84e-05	Loss: 0.011012
[2024-08-03 14:55:34,135] {train_model:82} INFO - Train Epoch: 34 [146176/366120 (40%)]	lr:6.84e-05	Loss: 0.021294
[2024-08-03 14:55:47,140] {train_model:82} INFO - Train Epoch: 34 [182784/366120 (50%)]	lr:6.84e-05	Loss: 0.007335
[2024-08-03 14:56:00,179] {train_model:82} INFO - Train Epoch: 34 [219392/366120 (60%)]	lr:6.84e-05	Loss: 0.014062
[2024-08-03 14:56:13,292] {train_model:82} INFO - Train Epoch: 34 [256000/366120 (70%)]	lr:6.84e-05	Loss: 0.011352
[2024-08-03 14:56:26,488] {train_model:82} INFO - Train Epoch: 34 [292608/366120 (80%)]	lr:6.84e-05	Loss: 0.042091
[2024-08-03 14:56:39,547] {train_model:82} INFO - Train Epoch: 34 [329216/366120 (90%)]	lr:6.84e-05	Loss: 0.030673
[2024-08-03 14:56:52,621] {train_model:82} INFO - Train Epoch: 34 [365824/366120 (100%)]	lr:6.84e-05	Loss: 0.015206
[2024-08-03 14:56:59,877] {run_experiment:79} INFO - 
[2024-08-03 14:56:59,877] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-03 14:57:00,679] {result_logger:103} INFO - precision on Wake: 0.991
[2024-08-03 14:57:01,166] {result_logger:104} INFO - recall on Wake: 0.990
[2024-08-03 14:57:01,580] {result_logger:107} INFO - F1-score on Wake: 0.991
[2024-08-03 14:57:01,580] {result_logger:108} INFO - 
[2024-08-03 14:57:02,263] {result_logger:103} INFO - precision on REM: 0.993
[2024-08-03 14:57:02,697] {result_logger:104} INFO - recall on REM: 0.997
[2024-08-03 14:57:03,133] {result_logger:107} INFO - F1-score on REM: 0.995
[2024-08-03 14:57:03,133] {result_logger:108} INFO - 
[2024-08-03 14:57:03,840] {result_logger:103} INFO - precision on Non REM: 0.987
[2024-08-03 14:57:04,285] {result_logger:104} INFO - recall on Non REM: 0.985
[2024-08-03 14:57:04,725] {result_logger:107} INFO - F1-score on Non REM: 0.986
[2024-08-03 14:57:04,725] {result_logger:108} INFO - 
[2024-08-03 14:57:04,836] {result_logger:111} INFO - average precision on sleep stages: 0.990
[2024-08-03 14:57:04,948] {result_logger:113} INFO - average recall on sleep stages: 0.991
[2024-08-03 14:57:05,058] {result_logger:115} INFO - average F1-score on sleep stages: 0.991
[2024-08-03 14:57:05,060] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-03 14:57:05,153] {result_logger:103} INFO - precision on Wake: 0.976
[2024-08-03 14:57:05,208] {result_logger:104} INFO - recall on Wake: 0.980
[2024-08-03 14:57:05,265] {result_logger:107} INFO - F1-score on Wake: 0.978
[2024-08-03 14:57:05,265] {result_logger:108} INFO - 
[2024-08-03 14:57:05,356] {result_logger:103} INFO - precision on REM: 0.859
[2024-08-03 14:57:05,408] {result_logger:104} INFO - recall on REM: 0.949
[2024-08-03 14:57:05,463] {result_logger:107} INFO - F1-score on REM: 0.902
[2024-08-03 14:57:05,463] {result_logger:108} INFO - 
[2024-08-03 14:57:05,555] {result_logger:103} INFO - precision on Non REM: 0.971
[2024-08-03 14:57:05,608] {result_logger:104} INFO - recall on Non REM: 0.954
[2024-08-03 14:57:05,664] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2024-08-03 14:57:05,664] {result_logger:108} INFO - 
[2024-08-03 14:57:05,674] {result_logger:111} INFO - average precision on sleep stages: 0.935
[2024-08-03 14:57:05,686] {result_logger:113} INFO - average recall on sleep stages: 0.961
[2024-08-03 14:57:05,697] {result_logger:115} INFO - average F1-score on sleep stages: 0.947
[2024-08-03 14:57:05,697] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-03 14:57:05,771] {result_logger:134} INFO - 
[[148667    124   1323]
 [    55  91241    234]
 [  1308    530 122638]]
[2024-08-03 14:57:05,845] {result_logger:141} INFO - 
[[ 99.04%   0.08%   0.88%]
 [  0.06%  99.68%   0.26%]
 [  1.05%   0.43%  98.52%]]
[2024-08-03 14:57:05,921] {result_logger:145} INFO - 
[[ 99.09%   0.13%   1.07%]
 [  0.04%  99.29%   0.19%]
 [  0.87%   0.58%  98.75%]]
[2024-08-03 14:57:05,921] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-03 14:57:05,928] {result_logger:134} INFO - 
[[27802   102   478]
 [   18  2415   112]
 [  665   294 19744]]
[2024-08-03 14:57:05,936] {result_logger:141} INFO - 
[[ 97.96%   0.36%   1.68%]
 [  0.71%  94.89%   4.40%]
 [  3.21%   1.42%  95.37%]]
[2024-08-03 14:57:05,943] {result_logger:145} INFO - 
[[ 97.60%   3.63%   2.35%]
 [  0.06%  85.91%   0.55%]
 [  2.33%  10.46%  97.10%]]
[2024-08-03 14:57:06,045] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-03 14:57:06,045] {result_logger:77} INFO - actual:
[2024-08-03 14:57:06,046] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-03 14:57:06,046] {result_logger:79} INFO - predicted:
[2024-08-03 14:57:06,046] {result_logger:80} INFO - 
[[94.84%  0.21%  4.95%]
 [16.26% 78.51%  5.23%]
 [ 4.98%  2.68% 92.35%]]
[2024-08-03 14:57:06,046] {run_experiment:113} INFO - [epoch  34] execution time: 153.95s	 avg f1-score: 0.9473

[2024-08-03 14:57:06,291] {result_logger:56} INFO - final F1-scores on train:
	Wake                : [0.5367579534857232, 0.7438369347679131, 0.8100766621290328, 0.8511779459499679, 0.9052497543823363, 0.933102428777907, 0.9465756368505447, 0.9543263257293376, 0.9609487707568476, 0.9641554579877808, 0.9673406840339989, 0.9700095028608262, 0.9726730512708778, 0.97379703352595, 0.9751770808034095, 0.9777520332104918, 0.9786511579907521, 0.9795626173701104, 0.981135341524552, 0.9821812780186914, 0.9825575587242176, 0.9833449871807678, 0.9847062820145609, 0.9853021012699543, 0.9856741732089385, 0.9865123187488761, 0.9872398521527754, 0.9873907598848982, 0.988060258383471, 0.9885778812619294, 0.9895112817027175, 0.989857741923665, 0.990270817784412, 0.9906378271762887]
	REM                 : [0.4683209809290346, 0.73715110579668, 0.7859890390441502, 0.835877243775333, 0.8918812149395576, 0.9186350250400698, 0.9347343918132507, 0.9415725170782974, 0.9488131251192324, 0.9531930629802646, 0.9587087250070556, 0.9617031902246782, 0.9652694610778443, 0.9683339389239287, 0.9711003935196463, 0.9756303476044355, 0.9786162568431769, 0.9798328340745476, 0.9818816426298989, 0.9843461098429189, 0.985180762132233, 0.9868595382376577, 0.9876280373222684, 0.9889718071778372, 0.989831208944186, 0.9905458185101776, 0.9915538334276633, 0.99220804678439, 0.9928104575163399, 0.9929770460006211, 0.9936402923176693, 0.9939505580746425, 0.9947558928065241, 0.9948589341692791]
	Non REM             : [0.6446825301727521, 0.816882879590718, 0.8442494222396247, 0.8630178026642812, 0.9006033661479834, 0.9200309432867572, 0.9306820338654509, 0.9360733358359874, 0.9415242994887724, 0.9443868711239212, 0.9474702110011936, 0.95024265458858, 0.9521866880357447, 0.9551335162858748, 0.9575179809499126, 0.9618332969069995, 0.9643897465773377, 0.966102037597907, 0.9684629318152412, 0.9708886887186094, 0.9716936193574953, 0.9734405399078088, 0.975526506899056, 0.9767267448893191, 0.977893493795266, 0.9792529782535103, 0.9803528112886718, 0.9809570214188208, 0.9822832902690912, 0.983138290166283, 0.9844132754646855, 0.985164350985623, 0.9858928370357264, 0.9863474229001372]
	avg                 : [0.5499204881958366, 0.7659569733851037, 0.8134383744709358, 0.8500243307965274, 0.8992447784899591, 0.9239227990349113, 0.9373306875097488, 0.9439907262145408, 0.9504287317882841, 0.9539117973639888, 0.957839873347416, 0.9606517825580282, 0.9633764001281556, 0.9657548295785845, 0.9679318184243227, 0.9717385592406421, 0.9738857204704221, 0.9751658296808549, 0.9771599719898973, 0.9791386921934065, 0.9798106467379819, 0.9812150217754114, 0.9826202754119618, 0.9836668844457034, 0.9844662919827968, 0.9854370385041881, 0.9863821656230368, 0.9868519426960364, 0.9877180020563007, 0.9882310724762777, 0.9891882831616906, 0.9896575503279769, 0.9903065158755542, 0.9906147280819017]
[2024-08-03 14:57:06,291] {result_logger:56} INFO - final F1-scores on valid:
	Wake                : [0.7980060359454062, 0.8248358524655179, 0.7801526295415583, 0.7317765816003821, 0.785373254826631, 0.8715193117050518, 0.9069119921843197, 0.9443367676561597, 0.8823775346665739, 0.9401407816803788, 0.9545816463094411, 0.9565551040340443, 0.9690416130113425, 0.9746128947598635, 0.9725838779956427, 0.968687731283803, 0.9763269025215091, 0.9740874504716154, 0.9728988234466506, 0.976763732511513, 0.9711538461538461, 0.973922428800223, 0.9741341670014146, 0.974756733888027, 0.9780021384375384, 0.9785215489877972, 0.9740571786746526, 0.9789746391498212, 0.978092443913494, 0.976585587633553, 0.9793003992191484, 0.9755266255556142, 0.9756131868131868, 0.9777902825891994]
	REM                 : [0.5203352995963987, 0.6577622071381651, 0.7426334226251803, 0.4855687606112054, 0.7384087006296508, 0.7460745440126884, 0.7271933653426451, 0.7829383886255924, 0.5573552252052363, 0.6341955835962145, 0.8367278797996661, 0.7840427202764253, 0.8310640443772063, 0.8581290990680013, 0.8760155422112328, 0.8022489959839357, 0.8838211528101992, 0.861847807245623, 0.8595583160800553, 0.8981771312833733, 0.8679512108891638, 0.895745846266204, 0.8892112420670897, 0.8947758429047795, 0.9019028265287271, 0.9032618825722274, 0.8995568685376661, 0.9102977432201782, 0.896221198156682, 0.9045395105548291, 0.9034175334323923, 0.8949402023919043, 0.887613404925014, 0.9017923823749067]
	Non REM             : [0.6159446669093556, 0.6347422747762462, 0.40797698945349953, 0.13739497686121221, 0.41592176636870654, 0.7262621299594645, 0.8123641770559304, 0.9034949622166247, 0.8706367732479237, 0.9385744445561477, 0.9111686409874219, 0.9375063201537062, 0.9480084683176604, 0.9535362556126118, 0.9481639857792805, 0.9537805863766624, 0.955442863472995, 0.9528588732603268, 0.952392680343817, 0.9582023575638506, 0.9543227204451995, 0.9543122040705025, 0.9562833432128037, 0.9584285505907522, 0.9602412001176586, 0.9625367227523247, 0.9540707745607523, 0.9627115356640643, 0.9613335288654249, 0.9586444007858547, 0.9621845666219675, 0.9605436855229063, 0.9618875658793676, 0.9622535760411336]
	avg                 : [0.6447620008170535, 0.7057801114599765, 0.6435876805400793, 0.4515801063575999, 0.646567907274996, 0.7812853285590681, 0.8154898448609651, 0.8769233728327923, 0.7701231777065779, 0.8376369366109137, 0.9008260556988431, 0.8927013814880587, 0.9160380419020697, 0.9287594164801588, 0.9322544686620521, 0.9082391045481337, 0.9385303062682344, 0.9295980436591883, 0.9282832732901743, 0.9443810737862456, 0.9311425924960698, 0.9413268263789765, 0.939876250760436, 0.9426537091278528, 0.9467153883613081, 0.9481067181041164, 0.9425616072576903, 0.9506613060113546, 0.9452157236452003, 0.9465898329914122, 0.9483008330911694, 0.9436701711568083, 0.9417047192058562, 0.9472787470017465]
[2024-08-03 14:57:06,540] {logger:50} INFO - 
[2024-08-03 14:57:06,541] {logger:51} INFO - ================================================================================
[2024-08-03 14:57:06,541] {logger:52} INFO - finished training
[2024-08-03 14:57:06,541] {logger:53} INFO - ================================================================================
[2024-08-03 14:57:06,541] {logger:54} INFO - 
[2024-08-03 14:57:06,541] {logger:50} INFO - 
[2024-08-03 14:57:06,541] {logger:51} INFO - ================================================================================
[2024-08-03 14:57:06,541] {logger:52} INFO - best model on epoch: 28 	f1-score: 0.9507
[2024-08-03 14:57:06,541] {logger:53} INFO - ================================================================================
[2024-08-03 14:57:06,541] {logger:54} INFO - 
