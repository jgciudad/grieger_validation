[2024-03-30 12:54:43,859] {logger:43} INFO - run_experiment.py, args: Namespace(experiment='exp005')
================================================================================
[2024-03-30 12:54:43,860] {logger:44} INFO - config:
[2024-03-30 12:54:43,860] {logger:45} INFO - parameter name      | parameter value
[2024-03-30 12:54:43,860] {logger:46} INFO - experiment          : exp005
[2024-03-30 12:54:43,860] {logger:46} INFO - RUN_NAME            : exp005_2024-03-30_12-54-43
[2024-03-30 12:54:43,860] {logger:46} INFO - DEVICE              : cuda
[2024-03-30 12:54:43,860] {logger:46} INFO - EXPERIMENT_DIR      : /home/s202283/code/grieger_validation/results/exp005
[2024-03-30 12:54:43,860] {logger:46} INFO - MODELS_DIR          : /home/s202283/code/grieger_validation/results/exp005/models
[2024-03-30 12:54:43,860] {logger:46} INFO - VISUALS_DIR         : /home/s202283/code/grieger_validation/results/exp005/visuals/exp005_2024-03-30_12-54-43
[2024-03-30 12:54:43,860] {logger:46} INFO - DATA_DIR            : /scratch/s202283/data/mice-data-tuebingen/data
[2024-03-30 12:54:43,860] {logger:46} INFO - SAMPLE_DURATION     : 10
[2024-03-30 12:54:43,860] {logger:46} INFO - SAMPLING_RATE       : 64
[2024-03-30 12:54:43,860] {logger:46} INFO - SCORING_MAP         : {'Wake': [1, 17], 'REM': [3, 19], 'Non REM': [2, 18], 'Pre REM': [4, 20], 'Artifact': [8, 24]}
[2024-03-30 12:54:43,860] {logger:46} INFO - STAGE_MAP           : {'Wake': 'Wake', 'REM': 'REM', 'Non REM': 'Non REM', 'Pre REM': 'Non REM', 'Artifact': None}
[2024-03-30 12:54:43,860] {logger:46} INFO - DATA_SPLIT          : {'train': ['M19', 'M20', 'M21', 'M22', 'M23', 'M24', 'M25', 'M26', 'M27', 'M28', 'M29', 'M31', 'M32', 'M33'], 'valid': ['M34', 'M35'], 'test': ['M36', 'M37']}
[2024-03-30 12:54:43,860] {logger:46} INFO - DATA_FILE           : /home/s202283/code/grieger_validation/cache/dataset/data_tuebingen_main_stages.h5
[2024-03-30 12:54:43,860] {logger:46} INFO - STAGES              : ['Wake', 'Non REM', 'REM']
[2024-03-30 12:54:43,860] {logger:46} INFO - BALANCED_TRAINING   : False
[2024-03-30 12:54:43,860] {logger:46} INFO - BALANCING_WEIGHTS   : [0.3, 0.18, 0.24, 0.14, 0.14]
[2024-03-30 12:54:43,860] {logger:46} INFO - CHANNELS            : ['EEG_PR']
[2024-03-30 12:54:43,860] {logger:46} INFO - SAMPLES_LEFT        : 1
[2024-03-30 12:54:43,860] {logger:46} INFO - SAMPLES_RIGHT       : 1
[2024-03-30 12:54:43,860] {logger:46} INFO - LOG_INTERVAL        : 10
[2024-03-30 12:54:43,860] {logger:46} INFO - EXTRA_SAFE_MODELS   : False
[2024-03-30 12:54:43,860] {logger:46} INFO - BATCH_SIZE          : 256
[2024-03-30 12:54:43,860] {logger:46} INFO - DATA_FRACTION       : 1.0
[2024-03-30 12:54:43,860] {logger:46} INFO - DATA_FRACTION_STRAT : None
[2024-03-30 12:54:43,860] {logger:46} INFO - EPOCHS              : 50
[2024-03-30 12:54:43,860] {logger:46} INFO - WARMUP_EPOCHS       : 12
[2024-03-30 12:54:43,860] {logger:46} INFO - S_OPTIM_MODE        : exp
[2024-03-30 12:54:43,860] {logger:46} INFO - S_OPTIM_PARAS       : [0.06]
[2024-03-30 12:54:43,860] {logger:46} INFO - LEARNING_RATE       : 0.000256
[2024-03-30 12:54:43,860] {logger:46} INFO - OPTIMIZER           : <class 'torch.optim.adam.Adam'>
[2024-03-30 12:54:43,860] {logger:46} INFO - OPTIM_PARAS         : {}
[2024-03-30 12:54:43,860] {logger:46} INFO - L1_WEIGHT_DECAY     : 0
[2024-03-30 12:54:43,860] {logger:46} INFO - L2_WEIGHT_DECAY     : 0.0001
[2024-03-30 12:54:43,860] {logger:46} INFO - BATCH_SIZE_EVAL     : 512
[2024-03-30 12:54:43,860] {logger:46} INFO - FILTERS             : 96
[2024-03-30 12:54:43,860] {logger:46} INFO - CLASSIFIER_DROPOUT  : [0.2, 0.2]
[2024-03-30 12:54:43,860] {logger:46} INFO - FEATURE_EXTR_DROPOUT: [0.0, 0.2, 0.0, 0.2, 0.0, 0.2, 0.0, 0.2]
[2024-03-30 12:54:43,860] {logger:46} INFO - MODEL_NAME          : model_8conv_2fc
[2024-03-30 12:54:43,860] {logger:46} INFO - GAIN                : 0.0
[2024-03-30 12:54:43,860] {logger:46} INFO - FLIP                : 0.0
[2024-03-30 12:54:43,860] {logger:46} INFO - FLIP_ALL            : 0.0
[2024-03-30 12:54:43,860] {logger:46} INFO - WINDOW_WARP_SIZE    : 0.0
[2024-03-30 12:54:43,860] {logger:46} INFO - FLIP_HORI           : 0.0
[2024-03-30 12:54:43,861] {logger:46} INFO - TIME_SHIFT          : 0.0
[2024-03-30 12:54:43,861] {logger:50} INFO - 
[2024-03-30 12:54:43,861] {logger:51} INFO - ================================================================================
[2024-03-30 12:54:43,861] {logger:52} INFO - start training with model: model_8conv_2fc
[2024-03-30 12:54:43,861] {logger:53} INFO - ================================================================================
[2024-03-30 12:54:43,861] {logger:54} INFO - 
[2024-03-30 12:54:59,039] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 12:54:59,064] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 12:55:01,327] {dataloader:120} INFO - data distribution in database for dataset valid:
	Wake                : 28382
	Non REM             : 20704
	REM                 : 2544
[2024-03-30 12:55:01,329] {dataloader:147} INFO - data distribution after processing:
	Wake                : 28382
	Non REM             : 20704
	REM                 : 2544
[2024-03-30 12:55:02,034] {run_experiment:47} INFO - classifier:
Model(
  (feature_extractor): Sequential(
    (0): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): Conv1d(1, 96, kernel_size=(5,), stride=(1,))
    (2): ReLU(inplace=True)
    (3): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): Dropout(p=0.0, inplace=False)
    (5): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (6): ReLU(inplace=True)
    (7): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): Dropout(p=0.2, inplace=False)
    (9): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (10): ReLU(inplace=True)
    (11): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (12): Dropout(p=0.0, inplace=False)
    (13): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (14): ReLU(inplace=True)
    (15): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (16): Dropout(p=0.2, inplace=False)
    (17): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (18): ReLU(inplace=True)
    (19): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (20): Dropout(p=0.0, inplace=False)
    (21): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (22): ReLU(inplace=True)
    (23): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (24): Dropout(p=0.2, inplace=False)
    (25): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (26): ReLU(inplace=True)
    (27): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (28): Dropout(p=0.0, inplace=False)
    (29): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (30): ReLU(inplace=True)
    (31): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (32): Dropout(p=0.2, inplace=False)
  )
  (classifier): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=10848, out_features=80, bias=True)
    (2): ReLU(inplace=True)
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=80, out_features=3, bias=True)
  )
)
[2024-03-30 12:55:20,785] {train_model:82} INFO - Train Epoch: 1 [36352/366120 (10%)]	lr:2.56e-05	Loss: 87.330162
[2024-03-30 12:55:26,696] {train_model:82} INFO - Train Epoch: 1 [72960/366120 (20%)]	lr:2.56e-05	Loss: 83.323898
[2024-03-30 12:55:32,670] {train_model:82} INFO - Train Epoch: 1 [109568/366120 (30%)]	lr:2.56e-05	Loss: 54.066746
[2024-03-30 12:55:38,626] {train_model:82} INFO - Train Epoch: 1 [146176/366120 (40%)]	lr:2.56e-05	Loss: 37.173260
[2024-03-30 12:55:44,681] {train_model:82} INFO - Train Epoch: 1 [182784/366120 (50%)]	lr:2.56e-05	Loss: 58.809956
[2024-03-30 12:55:50,772] {train_model:82} INFO - Train Epoch: 1 [219392/366120 (60%)]	lr:2.56e-05	Loss: 44.777496
[2024-03-30 12:55:56,883] {train_model:82} INFO - Train Epoch: 1 [256000/366120 (70%)]	lr:2.56e-05	Loss: 60.768166
[2024-03-30 12:56:02,985] {train_model:82} INFO - Train Epoch: 1 [292608/366120 (80%)]	lr:2.56e-05	Loss: 30.774012
[2024-03-30 12:56:09,061] {train_model:82} INFO - Train Epoch: 1 [329216/366120 (90%)]	lr:2.56e-05	Loss: 20.918753
[2024-03-30 12:56:15,161] {train_model:82} INFO - Train Epoch: 1 [365824/366120 (100%)]	lr:2.56e-05	Loss: 29.651133
[2024-03-30 12:56:18,443] {run_experiment:78} INFO - 
[2024-03-30 12:56:18,443] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-30 12:56:18,903] {result_logger:103} INFO - precision on Wake: 0.696
[2024-03-30 12:56:19,239] {result_logger:104} INFO - recall on Wake: 0.483
[2024-03-30 12:56:19,581] {result_logger:107} INFO - F1-score on Wake: 0.570
[2024-03-30 12:56:19,581] {result_logger:108} INFO - 
[2024-03-30 12:56:20,037] {result_logger:103} INFO - precision on Non REM: 0.664
[2024-03-30 12:56:20,368] {result_logger:104} INFO - recall on Non REM: 0.554
[2024-03-30 12:56:20,699] {result_logger:107} INFO - F1-score on Non REM: 0.604
[2024-03-30 12:56:20,699] {result_logger:108} INFO - 
[2024-03-30 12:56:21,139] {result_logger:103} INFO - precision on REM: 0.093
[2024-03-30 12:56:21,451] {result_logger:104} INFO - recall on REM: 0.522
[2024-03-30 12:56:21,765] {result_logger:107} INFO - F1-score on REM: 0.157
[2024-03-30 12:56:21,765] {result_logger:108} INFO - 
[2024-03-30 12:56:21,837] {result_logger:111} INFO - average precision on sleep stages: 0.484
[2024-03-30 12:56:21,908] {result_logger:113} INFO - average recall on sleep stages: 0.520
[2024-03-30 12:56:21,979] {result_logger:115} INFO - average F1-score on sleep stages: 0.444
[2024-03-30 12:56:21,980] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-30 12:56:22,041] {result_logger:103} INFO - precision on Wake: 0.664
[2024-03-30 12:56:22,084] {result_logger:104} INFO - recall on Wake: 0.713
[2024-03-30 12:56:22,126] {result_logger:107} INFO - F1-score on Wake: 0.687
[2024-03-30 12:56:22,126] {result_logger:108} INFO - 
[2024-03-30 12:56:22,184] {result_logger:103} INFO - precision on Non REM: 0.988
[2024-03-30 12:56:22,226] {result_logger:104} INFO - recall on Non REM: 0.342
[2024-03-30 12:56:22,267] {result_logger:107} INFO - F1-score on Non REM: 0.508
[2024-03-30 12:56:22,267] {result_logger:108} INFO - 
[2024-03-30 12:56:22,326] {result_logger:103} INFO - precision on REM: 0.156
[2024-03-30 12:56:22,369] {result_logger:104} INFO - recall on REM: 0.858
[2024-03-30 12:56:22,411] {result_logger:107} INFO - F1-score on REM: 0.264
[2024-03-30 12:56:22,412] {result_logger:108} INFO - 
[2024-03-30 12:56:22,419] {result_logger:111} INFO - average precision on sleep stages: 0.602
[2024-03-30 12:56:22,426] {result_logger:113} INFO - average recall on sleep stages: 0.637
[2024-03-30 12:56:22,433] {result_logger:115} INFO - average F1-score on sleep stages: 0.487
[2024-03-30 12:56:22,433] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-30 12:56:22,481] {result_logger:134} INFO - 
[[98339 37275 68133]
 [37092 79659 27016]
 [ 5868  3024  9714]]
[2024-03-30 12:56:22,528] {result_logger:141} INFO - 
[[ 48.27%  18.29%  33.44%]
 [ 25.80%  55.41%  18.79%]
 [ 31.54%  16.25%  52.21%]]
[2024-03-30 12:56:22,577] {result_logger:145} INFO - 
[[ 69.60%  31.07%  64.97%]
 [ 26.25%  66.41%  25.76%]
 [  4.15%   2.52%   9.26%]]
[2024-03-30 12:56:22,577] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-30 12:56:22,582] {result_logger:134} INFO - 
[[20224    83  8075]
 [ 9899  7082  3722]
 [  357     5  2183]]
[2024-03-30 12:56:22,665] {result_logger:141} INFO - 
[[ 71.26%   0.29%  28.45%]
 [ 47.81%  34.21%  17.98%]
 [ 14.03%   0.20%  85.78%]]
[2024-03-30 12:56:22,717] {result_logger:145} INFO - 
[[ 66.35%   1.16%  57.76%]
 [ 32.48%  98.77%  26.62%]
 [  1.17%   0.07%  15.62%]]
[2024-03-30 12:56:22,860] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-30 12:56:22,860] {result_logger:77} INFO - actual:
[2024-03-30 12:56:22,861] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-03-30 12:56:22,861] {result_logger:79} INFO - predicted:
[2024-03-30 12:56:22,861] {result_logger:80} INFO - 
[[78.11%  3.96% 17.93%]
 [12.72% 74.74% 12.54%]
 [41.19%  4.32% 54.48%]]
[2024-03-30 12:56:22,912] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp005/model_8conv_2fc-best.pth
[2024-03-30 12:56:22,912] {run_experiment:112} INFO - [epoch   1] execution time: 80.88s	 avg f1-score: 0.4865

[2024-03-30 12:56:22,912] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 12:56:22,932] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 12:56:40,797] {train_model:82} INFO - Train Epoch: 2 [36352/366120 (10%)]	lr:4.65e-05	Loss: 15.873335
[2024-03-30 12:56:46,754] {train_model:82} INFO - Train Epoch: 2 [72960/366120 (20%)]	lr:4.65e-05	Loss: 21.960070
[2024-03-30 12:56:52,725] {train_model:82} INFO - Train Epoch: 2 [109568/366120 (30%)]	lr:4.65e-05	Loss: 21.588673
[2024-03-30 12:56:58,724] {train_model:82} INFO - Train Epoch: 2 [146176/366120 (40%)]	lr:4.65e-05	Loss: 12.371765
[2024-03-30 12:57:04,759] {train_model:82} INFO - Train Epoch: 2 [182784/366120 (50%)]	lr:4.65e-05	Loss: 13.246817
[2024-03-30 12:57:10,777] {train_model:82} INFO - Train Epoch: 2 [219392/366120 (60%)]	lr:4.65e-05	Loss: 7.439193
[2024-03-30 12:57:16,797] {train_model:82} INFO - Train Epoch: 2 [256000/366120 (70%)]	lr:4.65e-05	Loss: 11.023844
[2024-03-30 12:57:22,880] {train_model:82} INFO - Train Epoch: 2 [292608/366120 (80%)]	lr:4.65e-05	Loss: 7.510800
[2024-03-30 12:57:28,981] {train_model:82} INFO - Train Epoch: 2 [329216/366120 (90%)]	lr:4.65e-05	Loss: 4.781420
[2024-03-30 12:57:35,119] {train_model:82} INFO - Train Epoch: 2 [365824/366120 (100%)]	lr:4.65e-05	Loss: 7.044106
[2024-03-30 12:57:38,540] {run_experiment:78} INFO - 
[2024-03-30 12:57:38,540] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-30 12:57:39,013] {result_logger:103} INFO - precision on Wake: 0.867
[2024-03-30 12:57:39,355] {result_logger:104} INFO - recall on Wake: 0.697
[2024-03-30 12:57:39,689] {result_logger:107} INFO - F1-score on Wake: 0.773
[2024-03-30 12:57:39,689] {result_logger:108} INFO - 
[2024-03-30 12:57:40,138] {result_logger:103} INFO - precision on Non REM: 0.812
[2024-03-30 12:57:40,473] {result_logger:104} INFO - recall on Non REM: 0.818
[2024-03-30 12:57:40,809] {result_logger:107} INFO - F1-score on Non REM: 0.815
[2024-03-30 12:57:40,810] {result_logger:108} INFO - 
[2024-03-30 12:57:41,231] {result_logger:103} INFO - precision on REM: 0.252
[2024-03-30 12:57:41,524] {result_logger:104} INFO - recall on REM: 0.778
[2024-03-30 12:57:41,832] {result_logger:107} INFO - F1-score on REM: 0.381
[2024-03-30 12:57:41,832] {result_logger:108} INFO - 
[2024-03-30 12:57:41,908] {result_logger:111} INFO - average precision on sleep stages: 0.644
[2024-03-30 12:57:41,980] {result_logger:113} INFO - average recall on sleep stages: 0.765
[2024-03-30 12:57:42,052] {result_logger:115} INFO - average F1-score on sleep stages: 0.656
[2024-03-30 12:57:42,053] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-30 12:57:42,115] {result_logger:103} INFO - precision on Wake: 0.697
[2024-03-30 12:57:42,158] {result_logger:104} INFO - recall on Wake: 0.606
[2024-03-30 12:57:42,201] {result_logger:107} INFO - F1-score on Wake: 0.648
[2024-03-30 12:57:42,201] {result_logger:108} INFO - 
[2024-03-30 12:57:42,261] {result_logger:103} INFO - precision on Non REM: 0.865
[2024-03-30 12:57:42,303] {result_logger:104} INFO - recall on Non REM: 0.606
[2024-03-30 12:57:42,345] {result_logger:107} INFO - F1-score on Non REM: 0.713
[2024-03-30 12:57:42,345] {result_logger:108} INFO - 
[2024-03-30 12:57:42,404] {result_logger:103} INFO - precision on REM: 0.188
[2024-03-30 12:57:42,446] {result_logger:104} INFO - recall on REM: 0.917
[2024-03-30 12:57:42,488] {result_logger:107} INFO - F1-score on REM: 0.312
[2024-03-30 12:57:42,488] {result_logger:108} INFO - 
[2024-03-30 12:57:42,495] {result_logger:111} INFO - average precision on sleep stages: 0.583
[2024-03-30 12:57:42,503] {result_logger:113} INFO - average recall on sleep stages: 0.710
[2024-03-30 12:57:42,510] {result_logger:115} INFO - average F1-score on sleep stages: 0.558
[2024-03-30 12:57:42,510] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-30 12:57:42,560] {result_logger:134} INFO - 
[[142042  26250  35455]
 [ 18648 117653   7466]
 [  3148    978  14480]]
[2024-03-30 12:57:42,608] {result_logger:141} INFO - 
[[ 69.71%  12.88%  17.40%]
 [ 12.97%  81.84%   5.19%]
 [ 16.92%   5.26%  77.82%]]
[2024-03-30 12:57:42,657] {result_logger:145} INFO - 
[[ 86.70%  18.12%  61.77%]
 [ 11.38%  81.21%  13.01%]
 [  1.92%   0.68%  25.23%]]
[2024-03-30 12:57:42,657] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-30 12:57:42,662] {result_logger:134} INFO - 
[[17202  1950  9230]
 [ 7287 12556   860]
 [  195    17  2333]]
[2024-03-30 12:57:42,720] {result_logger:141} INFO - 
[[ 60.61%   6.87%  32.52%]
 [ 35.20%  60.65%   4.15%]
 [  7.66%   0.67%  91.67%]]
[2024-03-30 12:57:42,771] {result_logger:145} INFO - 
[[ 69.69%  13.43%  74.30%]
 [ 29.52%  86.46%   6.92%]
 [  0.79%   0.12%  18.78%]]
[2024-03-30 12:57:42,914] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-30 12:57:42,914] {result_logger:77} INFO - actual:
[2024-03-30 12:57:42,914] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-03-30 12:57:42,914] {result_logger:79} INFO - predicted:
[2024-03-30 12:57:42,914] {result_logger:80} INFO - 
[[65.84% 15.64% 18.51%]
 [25.06% 70.67%  4.27%]
 [38.57%  3.21% 58.22%]]
[2024-03-30 12:57:42,967] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp005/model_8conv_2fc-best.pth
[2024-03-30 12:57:42,968] {run_experiment:112} INFO - [epoch   2] execution time: 80.06s	 avg f1-score: 0.5576

[2024-03-30 12:57:42,968] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 12:57:42,988] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 12:58:05,171] {train_model:82} INFO - Train Epoch: 3 [36352/366120 (10%)]	lr:6.75e-05	Loss: 8.578151
[2024-03-30 12:58:11,116] {train_model:82} INFO - Train Epoch: 3 [72960/366120 (20%)]	lr:6.75e-05	Loss: 4.070441
[2024-03-30 12:58:17,086] {train_model:82} INFO - Train Epoch: 3 [109568/366120 (30%)]	lr:6.75e-05	Loss: 3.065217
[2024-03-30 12:58:23,055] {train_model:82} INFO - Train Epoch: 3 [146176/366120 (40%)]	lr:6.75e-05	Loss: 1.721159
[2024-03-30 12:58:29,027] {train_model:82} INFO - Train Epoch: 3 [182784/366120 (50%)]	lr:6.75e-05	Loss: 8.384127
[2024-03-30 12:58:35,040] {train_model:82} INFO - Train Epoch: 3 [219392/366120 (60%)]	lr:6.75e-05	Loss: 3.424088
[2024-03-30 12:58:41,084] {train_model:82} INFO - Train Epoch: 3 [256000/366120 (70%)]	lr:6.75e-05	Loss: 1.506971
[2024-03-30 12:58:47,174] {train_model:82} INFO - Train Epoch: 3 [292608/366120 (80%)]	lr:6.75e-05	Loss: 1.263700
[2024-03-30 12:58:53,275] {train_model:82} INFO - Train Epoch: 3 [329216/366120 (90%)]	lr:6.75e-05	Loss: 0.810059
[2024-03-30 12:58:59,391] {train_model:82} INFO - Train Epoch: 3 [365824/366120 (100%)]	lr:6.75e-05	Loss: 2.155494
[2024-03-30 12:59:02,719] {run_experiment:78} INFO - 
[2024-03-30 12:59:02,720] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-30 12:59:03,174] {result_logger:103} INFO - precision on Wake: 0.892
[2024-03-30 12:59:03,501] {result_logger:104} INFO - recall on Wake: 0.792
[2024-03-30 12:59:03,838] {result_logger:107} INFO - F1-score on Wake: 0.839
[2024-03-30 12:59:03,838] {result_logger:108} INFO - 
[2024-03-30 12:59:04,283] {result_logger:103} INFO - precision on Non REM: 0.848
[2024-03-30 12:59:04,608] {result_logger:104} INFO - recall on Non REM: 0.853
[2024-03-30 12:59:04,934] {result_logger:107} INFO - F1-score on Non REM: 0.850
[2024-03-30 12:59:04,935] {result_logger:108} INFO - 
[2024-03-30 12:59:05,344] {result_logger:103} INFO - precision on REM: 0.359
[2024-03-30 12:59:05,626] {result_logger:104} INFO - recall on REM: 0.786
[2024-03-30 12:59:05,915] {result_logger:107} INFO - F1-score on REM: 0.493
[2024-03-30 12:59:05,915] {result_logger:108} INFO - 
[2024-03-30 12:59:05,986] {result_logger:111} INFO - average precision on sleep stages: 0.700
[2024-03-30 12:59:06,058] {result_logger:113} INFO - average recall on sleep stages: 0.810
[2024-03-30 12:59:06,128] {result_logger:115} INFO - average F1-score on sleep stages: 0.727
[2024-03-30 12:59:06,129] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-30 12:59:06,188] {result_logger:103} INFO - precision on Wake: 0.732
[2024-03-30 12:59:06,227] {result_logger:104} INFO - recall on Wake: 0.908
[2024-03-30 12:59:06,267] {result_logger:107} INFO - F1-score on Wake: 0.811
[2024-03-30 12:59:06,267] {result_logger:108} INFO - 
[2024-03-30 12:59:06,325] {result_logger:103} INFO - precision on Non REM: 0.867
[2024-03-30 12:59:06,366] {result_logger:104} INFO - recall on Non REM: 0.546
[2024-03-30 12:59:06,407] {result_logger:107} INFO - F1-score on Non REM: 0.670
[2024-03-30 12:59:06,407] {result_logger:108} INFO - 
[2024-03-30 12:59:06,464] {result_logger:103} INFO - precision on REM: 0.581
[2024-03-30 12:59:06,503] {result_logger:104} INFO - recall on REM: 0.773
[2024-03-30 12:59:06,543] {result_logger:107} INFO - F1-score on REM: 0.664
[2024-03-30 12:59:06,543] {result_logger:108} INFO - 
[2024-03-30 12:59:06,550] {result_logger:111} INFO - average precision on sleep stages: 0.727
[2024-03-30 12:59:06,556] {result_logger:113} INFO - average recall on sleep stages: 0.743
[2024-03-30 12:59:06,563] {result_logger:115} INFO - average F1-score on sleep stages: 0.715
[2024-03-30 12:59:06,563] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-30 12:59:06,611] {result_logger:134} INFO - 
[[161360  20948  21439]
 [ 16509 122583   4675]
 [  2954   1027  14625]]
[2024-03-30 12:59:06,658] {result_logger:141} INFO - 
[[ 79.20%  10.28%  10.52%]
 [ 11.48%  85.27%   3.25%]
 [ 15.88%   5.52%  78.60%]]
[2024-03-30 12:59:06,706] {result_logger:145} INFO - 
[[ 89.24%  14.49%  52.63%]
 [  9.13%  84.80%  11.48%]
 [  1.63%   0.71%  35.90%]]
[2024-03-30 12:59:06,706] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-30 12:59:06,711] {result_logger:134} INFO - 
[[25774  1680   928]
 [ 8901 11312   490]
 [  529    48  1968]]
[2024-03-30 12:59:06,769] {result_logger:141} INFO - 
[[ 90.81%   5.92%   3.27%]
 [ 42.99%  54.64%   2.37%]
 [ 20.79%   1.89%  77.33%]]
[2024-03-30 12:59:06,819] {result_logger:145} INFO - 
[[ 73.21%  12.88%  27.41%]
 [ 25.28%  86.75%  14.47%]
 [  1.50%   0.37%  58.12%]]
[2024-03-30 12:59:06,961] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-30 12:59:06,961] {result_logger:77} INFO - actual:
[2024-03-30 12:59:06,961] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-03-30 12:59:06,961] {result_logger:79} INFO - predicted:
[2024-03-30 12:59:06,961] {result_logger:80} INFO - 
[[88.93%  8.37%  2.71%]
 [20.83% 75.57%  3.60%]
 [34.91%  7.12% 57.97%]]
[2024-03-30 12:59:07,014] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp005/model_8conv_2fc-best.pth
[2024-03-30 12:59:07,014] {run_experiment:112} INFO - [epoch   3] execution time: 84.05s	 avg f1-score: 0.7149

[2024-03-30 12:59:07,014] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 12:59:07,035] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 12:59:24,730] {train_model:82} INFO - Train Epoch: 4 [36352/366120 (10%)]	lr:8.84e-05	Loss: 2.964229
[2024-03-30 12:59:30,772] {train_model:82} INFO - Train Epoch: 4 [72960/366120 (20%)]	lr:8.84e-05	Loss: 1.467484
[2024-03-30 12:59:36,835] {train_model:82} INFO - Train Epoch: 4 [109568/366120 (30%)]	lr:8.84e-05	Loss: 1.537692
[2024-03-30 12:59:42,859] {train_model:82} INFO - Train Epoch: 4 [146176/366120 (40%)]	lr:8.84e-05	Loss: 1.518004
[2024-03-30 12:59:48,941] {train_model:82} INFO - Train Epoch: 4 [182784/366120 (50%)]	lr:8.84e-05	Loss: 1.050180
[2024-03-30 12:59:55,034] {train_model:82} INFO - Train Epoch: 4 [219392/366120 (60%)]	lr:8.84e-05	Loss: 1.009357
[2024-03-30 13:00:01,133] {train_model:82} INFO - Train Epoch: 4 [256000/366120 (70%)]	lr:8.84e-05	Loss: 0.848043
[2024-03-30 13:00:07,246] {train_model:82} INFO - Train Epoch: 4 [292608/366120 (80%)]	lr:8.84e-05	Loss: 1.583537
[2024-03-30 13:00:13,399] {train_model:82} INFO - Train Epoch: 4 [329216/366120 (90%)]	lr:8.84e-05	Loss: 2.394261
[2024-03-30 13:00:19,543] {train_model:82} INFO - Train Epoch: 4 [365824/366120 (100%)]	lr:8.84e-05	Loss: 0.438988
[2024-03-30 13:00:23,059] {run_experiment:78} INFO - 
[2024-03-30 13:00:23,059] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-30 13:00:23,515] {result_logger:103} INFO - precision on Wake: 0.912
[2024-03-30 13:00:23,848] {result_logger:104} INFO - recall on Wake: 0.867
[2024-03-30 13:00:24,180] {result_logger:107} INFO - F1-score on Wake: 0.889
[2024-03-30 13:00:24,181] {result_logger:108} INFO - 
[2024-03-30 13:00:24,624] {result_logger:103} INFO - precision on Non REM: 0.875
[2024-03-30 13:00:24,947] {result_logger:104} INFO - recall on Non REM: 0.873
[2024-03-30 13:00:25,272] {result_logger:107} INFO - F1-score on Non REM: 0.874
[2024-03-30 13:00:25,272] {result_logger:108} INFO - 
[2024-03-30 13:00:25,685] {result_logger:103} INFO - precision on REM: 0.517
[2024-03-30 13:00:25,974] {result_logger:104} INFO - recall on REM: 0.808
[2024-03-30 13:00:26,265] {result_logger:107} INFO - F1-score on REM: 0.631
[2024-03-30 13:00:26,265] {result_logger:108} INFO - 
[2024-03-30 13:00:26,333] {result_logger:111} INFO - average precision on sleep stages: 0.768
[2024-03-30 13:00:26,400] {result_logger:113} INFO - average recall on sleep stages: 0.849
[2024-03-30 13:00:26,467] {result_logger:115} INFO - average F1-score on sleep stages: 0.798
[2024-03-30 13:00:26,469] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-30 13:00:26,526] {result_logger:103} INFO - precision on Wake: 0.695
[2024-03-30 13:00:26,567] {result_logger:104} INFO - recall on Wake: 0.900
[2024-03-30 13:00:26,607] {result_logger:107} INFO - F1-score on Wake: 0.784
[2024-03-30 13:00:26,607] {result_logger:108} INFO - 
[2024-03-30 13:00:26,665] {result_logger:103} INFO - precision on Non REM: 0.983
[2024-03-30 13:00:26,705] {result_logger:104} INFO - recall on Non REM: 0.451
[2024-03-30 13:00:26,744] {result_logger:107} INFO - F1-score on Non REM: 0.619
[2024-03-30 13:00:26,744] {result_logger:108} INFO - 
[2024-03-30 13:00:26,801] {result_logger:103} INFO - precision on REM: 0.407
[2024-03-30 13:00:26,840] {result_logger:104} INFO - recall on REM: 0.853
[2024-03-30 13:00:26,879] {result_logger:107} INFO - F1-score on REM: 0.551
[2024-03-30 13:00:26,879] {result_logger:108} INFO - 
[2024-03-30 13:00:26,886] {result_logger:111} INFO - average precision on sleep stages: 0.695
[2024-03-30 13:00:26,892] {result_logger:113} INFO - average recall on sleep stages: 0.735
[2024-03-30 13:00:26,899] {result_logger:115} INFO - average F1-score on sleep stages: 0.651
[2024-03-30 13:00:26,899] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-30 13:00:26,945] {result_logger:134} INFO - 
[[176568  16824  10355]
 [ 14568 125519   3680]
 [  2492   1073  15041]]
[2024-03-30 13:00:26,991] {result_logger:141} INFO - 
[[ 86.66%   8.26%   5.08%]
 [ 10.13%  87.31%   2.56%]
 [ 13.39%   5.77%  80.84%]]
[2024-03-30 13:00:27,037] {result_logger:145} INFO - 
[[ 91.19%  11.73%  35.61%]
 [  7.52%  87.52%  12.66%]
 [  1.29%   0.75%  51.73%]]
[2024-03-30 13:00:27,037] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-30 13:00:27,042] {result_logger:134} INFO - 
[[25554   143  2685]
 [10876  9343   484]
 [  356    18  2171]]
[2024-03-30 13:00:27,047] {result_logger:141} INFO - 
[[ 90.04%   0.50%   9.46%]
 [ 52.53%  45.13%   2.34%]
 [ 13.99%   0.71%  85.30%]]
[2024-03-30 13:00:27,051] {result_logger:145} INFO - 
[[ 69.47%   1.50%  50.28%]
 [ 29.57%  98.31%   9.06%]
 [  0.97%   0.19%  40.66%]]
[2024-03-30 13:00:27,104] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-30 13:00:27,104] {result_logger:77} INFO - actual:
[2024-03-30 13:00:27,104] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-03-30 13:00:27,104] {result_logger:79} INFO - predicted:
[2024-03-30 13:00:27,104] {result_logger:80} INFO - 
[[91.64%  4.69%  3.66%]
 [15.96% 80.78%  3.26%]
 [29.16%  1.89% 68.95%]]
[2024-03-30 13:00:27,104] {run_experiment:112} INFO - [epoch   4] execution time: 80.09s	 avg f1-score: 0.6512

[2024-03-30 13:00:27,104] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:00:27,125] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:00:49,095] {train_model:82} INFO - Train Epoch: 5 [36352/366120 (10%)]	lr:1.09e-04	Loss: 1.789019
[2024-03-30 13:00:55,085] {train_model:82} INFO - Train Epoch: 5 [72960/366120 (20%)]	lr:1.09e-04	Loss: 0.353350
[2024-03-30 13:01:01,080] {train_model:82} INFO - Train Epoch: 5 [109568/366120 (30%)]	lr:1.09e-04	Loss: 0.875866
[2024-03-30 13:01:07,098] {train_model:82} INFO - Train Epoch: 5 [146176/366120 (40%)]	lr:1.09e-04	Loss: 3.707835
[2024-03-30 13:01:13,157] {train_model:82} INFO - Train Epoch: 5 [182784/366120 (50%)]	lr:1.09e-04	Loss: 0.376830
[2024-03-30 13:01:19,286] {train_model:82} INFO - Train Epoch: 5 [219392/366120 (60%)]	lr:1.09e-04	Loss: 2.752904
[2024-03-30 13:01:25,377] {train_model:82} INFO - Train Epoch: 5 [256000/366120 (70%)]	lr:1.09e-04	Loss: 0.230666
[2024-03-30 13:01:31,476] {train_model:82} INFO - Train Epoch: 5 [292608/366120 (80%)]	lr:1.09e-04	Loss: 0.774344
[2024-03-30 13:01:37,598] {train_model:82} INFO - Train Epoch: 5 [329216/366120 (90%)]	lr:1.09e-04	Loss: 0.359381
[2024-03-30 13:01:43,722] {train_model:82} INFO - Train Epoch: 5 [365824/366120 (100%)]	lr:1.09e-04	Loss: 1.826180
[2024-03-30 13:01:47,465] {run_experiment:78} INFO - 
[2024-03-30 13:01:47,465] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-30 13:01:47,926] {result_logger:103} INFO - precision on Wake: 0.949
[2024-03-30 13:01:48,248] {result_logger:104} INFO - recall on Wake: 0.901
[2024-03-30 13:01:48,579] {result_logger:107} INFO - F1-score on Wake: 0.924
[2024-03-30 13:01:48,579] {result_logger:108} INFO - 
[2024-03-30 13:01:49,035] {result_logger:103} INFO - precision on Non REM: 0.892
[2024-03-30 13:01:49,355] {result_logger:104} INFO - recall on Non REM: 0.917
[2024-03-30 13:01:49,680] {result_logger:107} INFO - F1-score on Non REM: 0.904
[2024-03-30 13:01:49,680] {result_logger:108} INFO - 
[2024-03-30 13:01:50,091] {result_logger:103} INFO - precision on REM: 0.637
[2024-03-30 13:01:50,380] {result_logger:104} INFO - recall on REM: 0.850
[2024-03-30 13:01:50,670] {result_logger:107} INFO - F1-score on REM: 0.729
[2024-03-30 13:01:50,671] {result_logger:108} INFO - 
[2024-03-30 13:01:50,743] {result_logger:111} INFO - average precision on sleep stages: 0.826
[2024-03-30 13:01:50,813] {result_logger:113} INFO - average recall on sleep stages: 0.889
[2024-03-30 13:01:50,883] {result_logger:115} INFO - average F1-score on sleep stages: 0.852
[2024-03-30 13:01:50,884] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-30 13:01:50,946] {result_logger:103} INFO - precision on Wake: 0.752
[2024-03-30 13:01:50,988] {result_logger:104} INFO - recall on Wake: 0.935
[2024-03-30 13:01:51,030] {result_logger:107} INFO - F1-score on Wake: 0.833
[2024-03-30 13:01:51,030] {result_logger:108} INFO - 
[2024-03-30 13:01:51,089] {result_logger:103} INFO - precision on Non REM: 0.984
[2024-03-30 13:01:51,131] {result_logger:104} INFO - recall on Non REM: 0.541
[2024-03-30 13:01:51,173] {result_logger:107} INFO - F1-score on Non REM: 0.698
[2024-03-30 13:01:51,173] {result_logger:108} INFO - 
[2024-03-30 13:01:51,233] {result_logger:103} INFO - precision on REM: 0.460
[2024-03-30 13:01:51,274] {result_logger:104} INFO - recall on REM: 0.897
[2024-03-30 13:01:51,316] {result_logger:107} INFO - F1-score on REM: 0.608
[2024-03-30 13:01:51,316] {result_logger:108} INFO - 
[2024-03-30 13:01:51,323] {result_logger:111} INFO - average precision on sleep stages: 0.732
[2024-03-30 13:01:51,329] {result_logger:113} INFO - average recall on sleep stages: 0.791
[2024-03-30 13:01:51,336] {result_logger:115} INFO - average F1-score on sleep stages: 0.713
[2024-03-30 13:01:51,336] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-30 13:01:51,384] {result_logger:134} INFO - 
[[183542  15030   5175]
 [  8123 131816   3828]
 [  1834    952  15820]]
[2024-03-30 13:01:51,431] {result_logger:141} INFO - 
[[ 90.08%   7.38%   2.54%]
 [  5.65%  91.69%   2.66%]
 [  9.86%   5.12%  85.03%]]
[2024-03-30 13:01:51,479] {result_logger:145} INFO - 
[[ 94.85%  10.17%  20.85%]
 [  4.20%  89.19%  15.42%]
 [  0.95%   0.64%  63.73%]]
[2024-03-30 13:01:51,479] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-30 13:01:51,484] {result_logger:134} INFO - 
[[26536   170  1676]
 [ 8505 11195  1003]
 [  253     9  2283]]
[2024-03-30 13:01:51,488] {result_logger:141} INFO - 
[[ 93.50%   0.60%   5.91%]
 [ 41.08%  54.07%   4.84%]
 [  9.94%   0.35%  89.71%]]
[2024-03-30 13:01:51,493] {result_logger:145} INFO - 
[[ 75.19%   1.49%  33.78%]
 [ 24.10%  98.43%  20.21%]
 [  0.72%   0.08%  46.01%]]
[2024-03-30 13:01:51,545] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-30 13:01:51,546] {result_logger:77} INFO - actual:
[2024-03-30 13:01:51,546] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-03-30 13:01:51,546] {result_logger:79} INFO - predicted:
[2024-03-30 13:01:51,546] {result_logger:80} INFO - 
[[91.71%  5.43%  2.86%]
 [13.05% 82.39%  4.56%]
 [29.08%  1.75% 69.17%]]
[2024-03-30 13:01:51,546] {run_experiment:112} INFO - [epoch   5] execution time: 84.44s	 avg f1-score: 0.7132

[2024-03-30 13:01:51,546] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:01:51,566] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:02:15,657] {train_model:82} INFO - Train Epoch: 6 [36352/366120 (10%)]	lr:1.30e-04	Loss: 0.711862
[2024-03-30 13:02:21,602] {train_model:82} INFO - Train Epoch: 6 [72960/366120 (20%)]	lr:1.30e-04	Loss: 0.225331
[2024-03-30 13:02:27,541] {train_model:82} INFO - Train Epoch: 6 [109568/366120 (30%)]	lr:1.30e-04	Loss: 0.294091
[2024-03-30 13:02:33,598] {train_model:82} INFO - Train Epoch: 6 [146176/366120 (40%)]	lr:1.30e-04	Loss: 0.186052
[2024-03-30 13:02:39,657] {train_model:82} INFO - Train Epoch: 6 [182784/366120 (50%)]	lr:1.30e-04	Loss: 0.202714
[2024-03-30 13:02:45,773] {train_model:82} INFO - Train Epoch: 6 [219392/366120 (60%)]	lr:1.30e-04	Loss: 4.681002
[2024-03-30 13:02:51,846] {train_model:82} INFO - Train Epoch: 6 [256000/366120 (70%)]	lr:1.30e-04	Loss: 0.538166
[2024-03-30 13:02:57,844] {train_model:82} INFO - Train Epoch: 6 [292608/366120 (80%)]	lr:1.30e-04	Loss: 0.141553
[2024-03-30 13:03:03,847] {train_model:82} INFO - Train Epoch: 6 [329216/366120 (90%)]	lr:1.30e-04	Loss: 0.168475
[2024-03-30 13:03:09,891] {train_model:82} INFO - Train Epoch: 6 [365824/366120 (100%)]	lr:1.30e-04	Loss: 0.444753
[2024-03-30 13:03:13,521] {run_experiment:78} INFO - 
[2024-03-30 13:03:13,522] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-30 13:03:13,969] {result_logger:103} INFO - precision on Wake: 0.962
[2024-03-30 13:03:14,299] {result_logger:104} INFO - recall on Wake: 0.927
[2024-03-30 13:03:14,630] {result_logger:107} INFO - F1-score on Wake: 0.944
[2024-03-30 13:03:14,630] {result_logger:108} INFO - 
[2024-03-30 13:03:15,079] {result_logger:103} INFO - precision on Non REM: 0.922
[2024-03-30 13:03:15,405] {result_logger:104} INFO - recall on Non REM: 0.924
[2024-03-30 13:03:15,719] {result_logger:107} INFO - F1-score on Non REM: 0.923
[2024-03-30 13:03:15,719] {result_logger:108} INFO - 
[2024-03-30 13:03:16,140] {result_logger:103} INFO - precision on REM: 0.659
[2024-03-30 13:03:16,433] {result_logger:104} INFO - recall on REM: 0.901
[2024-03-30 13:03:16,726] {result_logger:107} INFO - F1-score on REM: 0.761
[2024-03-30 13:03:16,727] {result_logger:108} INFO - 
[2024-03-30 13:03:16,795] {result_logger:111} INFO - average precision on sleep stages: 0.847
[2024-03-30 13:03:16,864] {result_logger:113} INFO - average recall on sleep stages: 0.918
[2024-03-30 13:03:16,932] {result_logger:115} INFO - average F1-score on sleep stages: 0.876
[2024-03-30 13:03:16,933] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-30 13:03:16,992] {result_logger:103} INFO - precision on Wake: 0.907
[2024-03-30 13:03:17,032] {result_logger:104} INFO - recall on Wake: 0.969
[2024-03-30 13:03:17,072] {result_logger:107} INFO - F1-score on Wake: 0.937
[2024-03-30 13:03:17,072] {result_logger:108} INFO - 
[2024-03-30 13:03:17,130] {result_logger:103} INFO - precision on Non REM: 0.978
[2024-03-30 13:03:17,170] {result_logger:104} INFO - recall on Non REM: 0.797
[2024-03-30 13:03:17,210] {result_logger:107} INFO - F1-score on Non REM: 0.878
[2024-03-30 13:03:17,210] {result_logger:108} INFO - 
[2024-03-30 13:03:17,267] {result_logger:103} INFO - precision on REM: 0.558
[2024-03-30 13:03:17,307] {result_logger:104} INFO - recall on REM: 0.973
[2024-03-30 13:03:17,347] {result_logger:107} INFO - F1-score on REM: 0.709
[2024-03-30 13:03:17,347] {result_logger:108} INFO - 
[2024-03-30 13:03:17,353] {result_logger:111} INFO - average precision on sleep stages: 0.814
[2024-03-30 13:03:17,360] {result_logger:113} INFO - average recall on sleep stages: 0.913
[2024-03-30 13:03:17,366] {result_logger:115} INFO - average F1-score on sleep stages: 0.841
[2024-03-30 13:03:17,366] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-30 13:03:17,413] {result_logger:134} INFO - 
[[188934  10577   4236]
 [  6404 132909   4454]
 [  1151    694  16761]]
[2024-03-30 13:03:17,459] {result_logger:141} INFO - 
[[ 92.73%   5.19%   2.08%]
 [  4.45%  92.45%   3.10%]
 [  6.19%   3.73%  90.08%]]
[2024-03-30 13:03:17,505] {result_logger:145} INFO - 
[[ 96.16%   7.34%  16.64%]
 [  3.26%  92.18%  17.50%]
 [  0.59%   0.48%  65.86%]]
[2024-03-30 13:03:17,505] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-30 13:03:17,510] {result_logger:134} INFO - 
[[27499   355   528]
 [ 2762 16503  1438]
 [   55    13  2477]]
[2024-03-30 13:03:17,567] {result_logger:141} INFO - 
[[ 96.89%   1.25%   1.86%]
 [ 13.34%  79.71%   6.95%]
 [  2.16%   0.51%  97.33%]]
[2024-03-30 13:03:17,619] {result_logger:145} INFO - 
[[ 90.71%   2.10%  11.88%]
 [  9.11%  97.82%  32.37%]
 [  0.18%   0.08%  55.75%]]
[2024-03-30 13:03:17,766] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-30 13:03:17,766] {result_logger:77} INFO - actual:
[2024-03-30 13:03:17,766] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-03-30 13:03:17,766] {result_logger:79} INFO - predicted:
[2024-03-30 13:03:17,766] {result_logger:80} INFO - 
[[93.12%  5.51%  1.37%]
 [ 6.59% 88.50%  4.91%]
 [21.90%  6.05% 72.05%]]
[2024-03-30 13:03:17,820] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp005/model_8conv_2fc-best.pth
[2024-03-30 13:03:17,820] {run_experiment:112} INFO - [epoch   6] execution time: 86.27s	 avg f1-score: 0.8414

[2024-03-30 13:03:17,820] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:03:17,840] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:03:35,758] {train_model:82} INFO - Train Epoch: 7 [36352/366120 (10%)]	lr:1.51e-04	Loss: 1.119944
[2024-03-30 13:03:41,748] {train_model:82} INFO - Train Epoch: 7 [72960/366120 (20%)]	lr:1.51e-04	Loss: 0.417262
[2024-03-30 13:03:47,796] {train_model:82} INFO - Train Epoch: 7 [109568/366120 (30%)]	lr:1.51e-04	Loss: 0.111147
[2024-03-30 13:03:53,824] {train_model:82} INFO - Train Epoch: 7 [146176/366120 (40%)]	lr:1.51e-04	Loss: 0.090207
[2024-03-30 13:03:59,869] {train_model:82} INFO - Train Epoch: 7 [182784/366120 (50%)]	lr:1.51e-04	Loss: 0.233646
[2024-03-30 13:04:05,922] {train_model:82} INFO - Train Epoch: 7 [219392/366120 (60%)]	lr:1.51e-04	Loss: 0.241582
[2024-03-30 13:04:11,978] {train_model:82} INFO - Train Epoch: 7 [256000/366120 (70%)]	lr:1.51e-04	Loss: 1.075420
[2024-03-30 13:04:18,027] {train_model:82} INFO - Train Epoch: 7 [292608/366120 (80%)]	lr:1.51e-04	Loss: 0.227503
[2024-03-30 13:04:24,064] {train_model:82} INFO - Train Epoch: 7 [329216/366120 (90%)]	lr:1.51e-04	Loss: 0.133846
[2024-03-30 13:04:30,152] {train_model:82} INFO - Train Epoch: 7 [365824/366120 (100%)]	lr:1.51e-04	Loss: 0.618027
[2024-03-30 13:04:33,986] {run_experiment:78} INFO - 
[2024-03-30 13:04:33,987] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-30 13:04:34,445] {result_logger:103} INFO - precision on Wake: 0.968
[2024-03-30 13:04:34,778] {result_logger:104} INFO - recall on Wake: 0.939
[2024-03-30 13:04:35,128] {result_logger:107} INFO - F1-score on Wake: 0.953
[2024-03-30 13:04:35,128] {result_logger:108} INFO - 
[2024-03-30 13:04:35,589] {result_logger:103} INFO - precision on Non REM: 0.934
[2024-03-30 13:04:35,927] {result_logger:104} INFO - recall on Non REM: 0.927
[2024-03-30 13:04:36,263] {result_logger:107} INFO - F1-score on Non REM: 0.931
[2024-03-30 13:04:36,264] {result_logger:108} INFO - 
[2024-03-30 13:04:36,682] {result_logger:103} INFO - precision on REM: 0.668
[2024-03-30 13:04:36,988] {result_logger:104} INFO - recall on REM: 0.921
[2024-03-30 13:04:37,277] {result_logger:107} INFO - F1-score on REM: 0.774
[2024-03-30 13:04:37,277] {result_logger:108} INFO - 
[2024-03-30 13:04:37,348] {result_logger:111} INFO - average precision on sleep stages: 0.857
[2024-03-30 13:04:37,416] {result_logger:113} INFO - average recall on sleep stages: 0.929
[2024-03-30 13:04:37,485] {result_logger:115} INFO - average F1-score on sleep stages: 0.886
[2024-03-30 13:04:37,487] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-30 13:04:37,547] {result_logger:103} INFO - precision on Wake: 0.959
[2024-03-30 13:04:37,589] {result_logger:104} INFO - recall on Wake: 0.959
[2024-03-30 13:04:37,630] {result_logger:107} INFO - F1-score on Wake: 0.959
[2024-03-30 13:04:37,630] {result_logger:108} INFO - 
[2024-03-30 13:04:37,689] {result_logger:103} INFO - precision on Non REM: 0.968
[2024-03-30 13:04:37,730] {result_logger:104} INFO - recall on Non REM: 0.900
[2024-03-30 13:04:37,771] {result_logger:107} INFO - F1-score on Non REM: 0.933
[2024-03-30 13:04:37,771] {result_logger:108} INFO - 
[2024-03-30 13:04:37,829] {result_logger:103} INFO - precision on REM: 0.625
[2024-03-30 13:04:37,868] {result_logger:104} INFO - recall on REM: 0.980
[2024-03-30 13:04:37,909] {result_logger:107} INFO - F1-score on REM: 0.763
[2024-03-30 13:04:37,909] {result_logger:108} INFO - 
[2024-03-30 13:04:37,915] {result_logger:111} INFO - average precision on sleep stages: 0.851
[2024-03-30 13:04:37,922] {result_logger:113} INFO - average recall on sleep stages: 0.947
[2024-03-30 13:04:37,928] {result_logger:115} INFO - average F1-score on sleep stages: 0.885
[2024-03-30 13:04:37,928] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-30 13:04:37,977] {result_logger:134} INFO - 
[[191365   8838   3544]
 [  5484 133329   4954]
 [   909    568  17129]]
[2024-03-30 13:04:38,024] {result_logger:141} INFO - 
[[ 93.92%   4.34%   1.74%]
 [  3.81%  92.74%   3.45%]
 [  4.89%   3.05%  92.06%]]
[2024-03-30 13:04:38,071] {result_logger:145} INFO - 
[[ 96.77%   6.19%  13.83%]
 [  2.77%  93.41%  19.33%]
 [  0.46%   0.40%  66.84%]]
[2024-03-30 13:04:38,071] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-30 13:04:38,075] {result_logger:134} INFO - 
[[27229   591   562]
 [ 1131 18638   934]
 [   29    21  2495]]
[2024-03-30 13:04:38,131] {result_logger:141} INFO - 
[[ 95.94%   2.08%   1.98%]
 [  5.46%  90.03%   4.51%]
 [  1.14%   0.83%  98.04%]]
[2024-03-30 13:04:38,180] {result_logger:145} INFO - 
[[ 95.91%   3.07%  14.08%]
 [  3.98%  96.82%  23.40%]
 [  0.10%   0.11%  62.52%]]
[2024-03-30 13:04:38,329] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-30 13:04:38,329] {result_logger:77} INFO - actual:
[2024-03-30 13:04:38,329] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-03-30 13:04:38,329] {result_logger:79} INFO - predicted:
[2024-03-30 13:04:38,329] {result_logger:80} INFO - 
[[94.37%  4.57%  1.05%]
 [ 4.18% 92.12%  3.70%]
 [19.87%  5.49% 74.64%]]
[2024-03-30 13:04:38,383] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp005/model_8conv_2fc-best.pth
[2024-03-30 13:04:38,383] {run_experiment:112} INFO - [epoch   7] execution time: 80.56s	 avg f1-score: 0.8852

[2024-03-30 13:04:38,384] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:04:38,405] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:04:58,770] {train_model:82} INFO - Train Epoch: 8 [36352/366120 (10%)]	lr:1.72e-04	Loss: 0.250699
[2024-03-30 13:05:04,717] {train_model:82} INFO - Train Epoch: 8 [72960/366120 (20%)]	lr:1.72e-04	Loss: 0.232669
[2024-03-30 13:05:10,667] {train_model:82} INFO - Train Epoch: 8 [109568/366120 (30%)]	lr:1.72e-04	Loss: 1.094789
[2024-03-30 13:05:16,635] {train_model:82} INFO - Train Epoch: 8 [146176/366120 (40%)]	lr:1.72e-04	Loss: 0.406799
[2024-03-30 13:05:22,650] {train_model:82} INFO - Train Epoch: 8 [182784/366120 (50%)]	lr:1.72e-04	Loss: 0.111065
[2024-03-30 13:05:28,622] {train_model:82} INFO - Train Epoch: 8 [219392/366120 (60%)]	lr:1.72e-04	Loss: 0.182029
[2024-03-30 13:05:34,629] {train_model:82} INFO - Train Epoch: 8 [256000/366120 (70%)]	lr:1.72e-04	Loss: 0.152744
[2024-03-30 13:05:40,664] {train_model:82} INFO - Train Epoch: 8 [292608/366120 (80%)]	lr:1.72e-04	Loss: 0.221384
[2024-03-30 13:05:46,667] {train_model:82} INFO - Train Epoch: 8 [329216/366120 (90%)]	lr:1.72e-04	Loss: 0.065160
[2024-03-30 13:05:52,764] {train_model:82} INFO - Train Epoch: 8 [365824/366120 (100%)]	lr:1.72e-04	Loss: 0.253691
[2024-03-30 13:05:56,178] {run_experiment:78} INFO - 
[2024-03-30 13:05:56,178] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-30 13:05:56,649] {result_logger:103} INFO - precision on Wake: 0.972
[2024-03-30 13:05:56,983] {result_logger:104} INFO - recall on Wake: 0.946
[2024-03-30 13:05:57,317] {result_logger:107} INFO - F1-score on Wake: 0.958
[2024-03-30 13:05:57,317] {result_logger:108} INFO - 
[2024-03-30 13:05:57,780] {result_logger:103} INFO - precision on Non REM: 0.941
[2024-03-30 13:05:58,106] {result_logger:104} INFO - recall on Non REM: 0.933
[2024-03-30 13:05:58,437] {result_logger:107} INFO - F1-score on Non REM: 0.937
[2024-03-30 13:05:58,437] {result_logger:108} INFO - 
[2024-03-30 13:05:58,855] {result_logger:103} INFO - precision on REM: 0.686
[2024-03-30 13:05:59,156] {result_logger:104} INFO - recall on REM: 0.934
[2024-03-30 13:05:59,454] {result_logger:107} INFO - F1-score on REM: 0.791
[2024-03-30 13:05:59,454] {result_logger:108} INFO - 
[2024-03-30 13:05:59,521] {result_logger:111} INFO - average precision on sleep stages: 0.866
[2024-03-30 13:05:59,587] {result_logger:113} INFO - average recall on sleep stages: 0.937
[2024-03-30 13:05:59,653] {result_logger:115} INFO - average F1-score on sleep stages: 0.895
[2024-03-30 13:05:59,655] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-30 13:05:59,715] {result_logger:103} INFO - precision on Wake: 0.983
[2024-03-30 13:05:59,756] {result_logger:104} INFO - recall on Wake: 0.918
[2024-03-30 13:05:59,797] {result_logger:107} INFO - F1-score on Wake: 0.949
[2024-03-30 13:05:59,797] {result_logger:108} INFO - 
[2024-03-30 13:05:59,856] {result_logger:103} INFO - precision on Non REM: 0.956
[2024-03-30 13:05:59,897] {result_logger:104} INFO - recall on Non REM: 0.929
[2024-03-30 13:05:59,938] {result_logger:107} INFO - F1-score on Non REM: 0.943
[2024-03-30 13:05:59,938] {result_logger:108} INFO - 
[2024-03-30 13:05:59,996] {result_logger:103} INFO - precision on REM: 0.503
[2024-03-30 13:06:00,036] {result_logger:104} INFO - recall on REM: 0.988
[2024-03-30 13:06:00,078] {result_logger:107} INFO - F1-score on REM: 0.667
[2024-03-30 13:06:00,078] {result_logger:108} INFO - 
[2024-03-30 13:06:00,084] {result_logger:111} INFO - average precision on sleep stages: 0.814
[2024-03-30 13:06:00,090] {result_logger:113} INFO - average recall on sleep stages: 0.945
[2024-03-30 13:06:00,096] {result_logger:115} INFO - average F1-score on sleep stages: 0.853
[2024-03-30 13:06:00,096] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-30 13:06:00,142] {result_logger:134} INFO - 
[[192686   7880   3181]
 [  4894 134087   4786]
 [   746    489  17371]]
[2024-03-30 13:06:00,186] {result_logger:141} INFO - 
[[ 94.57%   3.87%   1.56%]
 [  3.40%  93.27%   3.33%]
 [  4.01%   2.63%  93.36%]]
[2024-03-30 13:06:00,232] {result_logger:145} INFO - 
[[ 97.16%   5.53%  12.55%]
 [  2.47%  94.13%  18.89%]
 [  0.38%   0.34%  68.56%]]
[2024-03-30 13:06:00,232] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-30 13:06:00,237] {result_logger:134} INFO - 
[[26053   858  1471]
 [  449 19241  1013]
 [    6    25  2514]]
[2024-03-30 13:06:00,241] {result_logger:141} INFO - 
[[ 91.79%   3.02%   5.18%]
 [  2.17%  92.94%   4.89%]
 [  0.24%   0.98%  98.78%]]
[2024-03-30 13:06:00,245] {result_logger:145} INFO - 
[[ 98.28%   4.26%  29.43%]
 [  1.69%  95.61%  20.27%]
 [  0.02%   0.12%  50.30%]]
[2024-03-30 13:06:00,299] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-30 13:06:00,299] {result_logger:77} INFO - actual:
[2024-03-30 13:06:00,299] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-03-30 13:06:00,299] {result_logger:79} INFO - predicted:
[2024-03-30 13:06:00,299] {result_logger:80} INFO - 
[[93.36%  4.16%  2.48%]
 [ 3.36% 92.65%  3.99%]
 [21.67%  7.54% 70.79%]]
[2024-03-30 13:06:00,299] {run_experiment:112} INFO - [epoch   8] execution time: 81.92s	 avg f1-score: 0.8528

[2024-03-30 13:06:00,300] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:06:00,320] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:06:20,857] {train_model:82} INFO - Train Epoch: 9 [36352/366120 (10%)]	lr:1.93e-04	Loss: 0.154695
[2024-03-30 13:06:26,809] {train_model:82} INFO - Train Epoch: 9 [72960/366120 (20%)]	lr:1.93e-04	Loss: 0.107297
[2024-03-30 13:06:32,810] {train_model:82} INFO - Train Epoch: 9 [109568/366120 (30%)]	lr:1.93e-04	Loss: 0.148434
[2024-03-30 13:06:38,776] {train_model:82} INFO - Train Epoch: 9 [146176/366120 (40%)]	lr:1.93e-04	Loss: 0.310305
[2024-03-30 13:06:44,781] {train_model:82} INFO - Train Epoch: 9 [182784/366120 (50%)]	lr:1.93e-04	Loss: 0.132438
[2024-03-30 13:06:50,791] {train_model:82} INFO - Train Epoch: 9 [219392/366120 (60%)]	lr:1.93e-04	Loss: 0.178808
[2024-03-30 13:06:56,817] {train_model:82} INFO - Train Epoch: 9 [256000/366120 (70%)]	lr:1.93e-04	Loss: 0.155549
[2024-03-30 13:07:02,847] {train_model:82} INFO - Train Epoch: 9 [292608/366120 (80%)]	lr:1.93e-04	Loss: 0.121271
[2024-03-30 13:07:08,964] {train_model:82} INFO - Train Epoch: 9 [329216/366120 (90%)]	lr:1.93e-04	Loss: 0.138733
[2024-03-30 13:07:15,113] {train_model:82} INFO - Train Epoch: 9 [365824/366120 (100%)]	lr:1.93e-04	Loss: 0.373678
[2024-03-30 13:07:18,717] {run_experiment:78} INFO - 
[2024-03-30 13:07:18,717] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-30 13:07:19,175] {result_logger:103} INFO - precision on Wake: 0.975
[2024-03-30 13:07:19,503] {result_logger:104} INFO - recall on Wake: 0.952
[2024-03-30 13:07:19,831] {result_logger:107} INFO - F1-score on Wake: 0.963
[2024-03-30 13:07:19,831] {result_logger:108} INFO - 
[2024-03-30 13:07:20,286] {result_logger:103} INFO - precision on Non REM: 0.947
[2024-03-30 13:07:20,615] {result_logger:104} INFO - recall on Non REM: 0.936
[2024-03-30 13:07:20,941] {result_logger:107} INFO - F1-score on Non REM: 0.942
[2024-03-30 13:07:20,941] {result_logger:108} INFO - 
[2024-03-30 13:07:21,361] {result_logger:103} INFO - precision on REM: 0.701
[2024-03-30 13:07:21,652] {result_logger:104} INFO - recall on REM: 0.945
[2024-03-30 13:07:21,940] {result_logger:107} INFO - F1-score on REM: 0.805
[2024-03-30 13:07:21,940] {result_logger:108} INFO - 
[2024-03-30 13:07:22,010] {result_logger:111} INFO - average precision on sleep stages: 0.874
[2024-03-30 13:07:22,078] {result_logger:113} INFO - average recall on sleep stages: 0.944
[2024-03-30 13:07:22,146] {result_logger:115} INFO - average F1-score on sleep stages: 0.903
[2024-03-30 13:07:22,147] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-30 13:07:22,206] {result_logger:103} INFO - precision on Wake: 0.964
[2024-03-30 13:07:22,245] {result_logger:104} INFO - recall on Wake: 0.895
[2024-03-30 13:07:22,284] {result_logger:107} INFO - F1-score on Wake: 0.928
[2024-03-30 13:07:22,284] {result_logger:108} INFO - 
[2024-03-30 13:07:22,341] {result_logger:103} INFO - precision on Non REM: 0.970
[2024-03-30 13:07:22,381] {result_logger:104} INFO - recall on Non REM: 0.915
[2024-03-30 13:07:22,423] {result_logger:107} INFO - F1-score on Non REM: 0.942
[2024-03-30 13:07:22,423] {result_logger:108} INFO - 
[2024-03-30 13:07:22,480] {result_logger:103} INFO - precision on REM: 0.436
[2024-03-30 13:07:22,520] {result_logger:104} INFO - recall on REM: 0.988
[2024-03-30 13:07:22,560] {result_logger:107} INFO - F1-score on REM: 0.605
[2024-03-30 13:07:22,560] {result_logger:108} INFO - 
[2024-03-30 13:07:22,567] {result_logger:111} INFO - average precision on sleep stages: 0.790
[2024-03-30 13:07:22,573] {result_logger:113} INFO - average recall on sleep stages: 0.933
[2024-03-30 13:07:22,580] {result_logger:115} INFO - average F1-score on sleep stages: 0.825
[2024-03-30 13:07:22,580] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-30 13:07:22,627] {result_logger:134} INFO - 
[[193929   7070   2748]
 [  4432 134570   4765]
 [   583    438  17585]]
[2024-03-30 13:07:22,674] {result_logger:141} INFO - 
[[ 95.18%   3.47%   1.35%]
 [  3.08%  93.60%   3.31%]
 [  3.13%   2.35%  94.51%]]
[2024-03-30 13:07:22,721] {result_logger:145} INFO - 
[[ 97.48%   4.98%  10.95%]
 [  2.23%  94.72%  18.99%]
 [  0.29%   0.31%  70.07%]]
[2024-03-30 13:07:22,721] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-30 13:07:22,725] {result_logger:134} INFO - 
[[25388   559  2435]
 [  935 18947   821]
 [    4    27  2514]]
[2024-03-30 13:07:22,730] {result_logger:141} INFO - 
[[ 89.45%   1.97%   8.58%]
 [  4.52%  91.52%   3.97%]
 [  0.16%   1.06%  98.78%]]
[2024-03-30 13:07:22,735] {result_logger:145} INFO - 
[[ 96.43%   2.86%  42.20%]
 [  3.55%  97.00%  14.23%]
 [  0.02%   0.14%  43.57%]]
[2024-03-30 13:07:22,788] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-30 13:07:22,789] {result_logger:77} INFO - actual:
[2024-03-30 13:07:22,789] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-03-30 13:07:22,789] {result_logger:79} INFO - predicted:
[2024-03-30 13:07:22,789] {result_logger:80} INFO - 
[[90.78%  5.43%  3.79%]
 [ 5.21% 90.81%  3.98%]
 [24.45%  6.33% 69.22%]]
[2024-03-30 13:07:22,789] {run_experiment:112} INFO - [epoch   9] execution time: 82.49s	 avg f1-score: 0.8249

[2024-03-30 13:07:22,789] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:07:22,810] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:07:45,389] {train_model:82} INFO - Train Epoch: 10 [36352/366120 (10%)]	lr:2.14e-04	Loss: 0.144144
[2024-03-30 13:07:51,442] {train_model:82} INFO - Train Epoch: 10 [72960/366120 (20%)]	lr:2.14e-04	Loss: 0.116392
[2024-03-30 13:07:57,462] {train_model:82} INFO - Train Epoch: 10 [109568/366120 (30%)]	lr:2.14e-04	Loss: 0.142503
[2024-03-30 13:08:03,503] {train_model:82} INFO - Train Epoch: 10 [146176/366120 (40%)]	lr:2.14e-04	Loss: 0.084679
[2024-03-30 13:08:09,579] {train_model:82} INFO - Train Epoch: 10 [182784/366120 (50%)]	lr:2.14e-04	Loss: 0.115691
[2024-03-30 13:08:15,651] {train_model:82} INFO - Train Epoch: 10 [219392/366120 (60%)]	lr:2.14e-04	Loss: 0.207778
[2024-03-30 13:08:21,729] {train_model:82} INFO - Train Epoch: 10 [256000/366120 (70%)]	lr:2.14e-04	Loss: 0.102131
[2024-03-30 13:08:27,817] {train_model:82} INFO - Train Epoch: 10 [292608/366120 (80%)]	lr:2.14e-04	Loss: 0.143083
[2024-03-30 13:08:33,877] {train_model:82} INFO - Train Epoch: 10 [329216/366120 (90%)]	lr:2.14e-04	Loss: 0.439196
[2024-03-30 13:08:39,898] {train_model:82} INFO - Train Epoch: 10 [365824/366120 (100%)]	lr:2.14e-04	Loss: 0.138614
[2024-03-30 13:08:43,464] {run_experiment:78} INFO - 
[2024-03-30 13:08:43,464] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-30 13:08:43,919] {result_logger:103} INFO - precision on Wake: 0.977
[2024-03-30 13:08:44,236] {result_logger:104} INFO - recall on Wake: 0.959
[2024-03-30 13:08:44,563] {result_logger:107} INFO - F1-score on Wake: 0.968
[2024-03-30 13:08:44,563] {result_logger:108} INFO - 
[2024-03-30 13:08:45,010] {result_logger:103} INFO - precision on Non REM: 0.953
[2024-03-30 13:08:45,331] {result_logger:104} INFO - recall on Non REM: 0.941
[2024-03-30 13:08:45,661] {result_logger:107} INFO - F1-score on Non REM: 0.947
[2024-03-30 13:08:45,662] {result_logger:108} INFO - 
[2024-03-30 13:08:46,070] {result_logger:103} INFO - precision on REM: 0.729
[2024-03-30 13:08:46,356] {result_logger:104} INFO - recall on REM: 0.949
[2024-03-30 13:08:46,642] {result_logger:107} INFO - F1-score on REM: 0.825
[2024-03-30 13:08:46,642] {result_logger:108} INFO - 
[2024-03-30 13:08:46,709] {result_logger:111} INFO - average precision on sleep stages: 0.886
[2024-03-30 13:08:46,776] {result_logger:113} INFO - average recall on sleep stages: 0.950
[2024-03-30 13:08:46,844] {result_logger:115} INFO - average F1-score on sleep stages: 0.913
[2024-03-30 13:08:46,845] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-30 13:08:46,903] {result_logger:103} INFO - precision on Wake: 0.949
[2024-03-30 13:08:46,942] {result_logger:104} INFO - recall on Wake: 0.983
[2024-03-30 13:08:46,981] {result_logger:107} INFO - F1-score on Wake: 0.966
[2024-03-30 13:08:46,981] {result_logger:108} INFO - 
[2024-03-30 13:08:47,038] {result_logger:103} INFO - precision on Non REM: 0.986
[2024-03-30 13:08:47,079] {result_logger:104} INFO - recall on Non REM: 0.888
[2024-03-30 13:08:47,118] {result_logger:107} INFO - F1-score on Non REM: 0.934
[2024-03-30 13:08:47,118] {result_logger:108} INFO - 
[2024-03-30 13:08:47,175] {result_logger:103} INFO - precision on REM: 0.691
[2024-03-30 13:08:47,215] {result_logger:104} INFO - recall on REM: 0.983
[2024-03-30 13:08:47,254] {result_logger:107} INFO - F1-score on REM: 0.811
[2024-03-30 13:08:47,254] {result_logger:108} INFO - 
[2024-03-30 13:08:47,260] {result_logger:111} INFO - average precision on sleep stages: 0.875
[2024-03-30 13:08:47,267] {result_logger:113} INFO - average recall on sleep stages: 0.951
[2024-03-30 13:08:47,273] {result_logger:115} INFO - average F1-score on sleep stages: 0.904
[2024-03-30 13:08:47,273] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-30 13:08:47,318] {result_logger:134} INFO - 
[[195483   6123   2141]
 [  4130 135213   4424]
 [   464    484  17658]]
[2024-03-30 13:08:47,363] {result_logger:141} INFO - 
[[ 95.94%   3.01%   1.05%]
 [  2.87%  94.05%   3.08%]
 [  2.49%   2.60%  94.90%]]
[2024-03-30 13:08:47,407] {result_logger:145} INFO - 
[[ 97.70%   4.32%   8.84%]
 [  2.06%  95.34%  18.26%]
 [  0.23%   0.34%  72.90%]]
[2024-03-30 13:08:47,407] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-30 13:08:47,412] {result_logger:134} INFO - 
[[27892   228   262]
 [ 1465 18379   859]
 [   19    25  2501]]
[2024-03-30 13:08:47,468] {result_logger:141} INFO - 
[[ 98.27%   0.80%   0.92%]
 [  7.08%  88.77%   4.15%]
 [  0.75%   0.98%  98.27%]]
[2024-03-30 13:08:47,518] {result_logger:145} INFO - 
[[ 94.95%   1.22%   7.23%]
 [  4.99%  98.64%  23.72%]
 [  0.06%   0.13%  69.05%]]
[2024-03-30 13:08:47,754] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-30 13:08:47,754] {result_logger:77} INFO - actual:
[2024-03-30 13:08:47,754] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-03-30 13:08:47,754] {result_logger:79} INFO - predicted:
[2024-03-30 13:08:47,754] {result_logger:80} INFO - 
[[94.40%  5.01%  0.60%]
 [ 5.10% 91.19%  3.71%]
 [19.22%  4.72% 76.06%]]
[2024-03-30 13:08:47,806] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp005/model_8conv_2fc-best.pth
[2024-03-30 13:08:47,806] {run_experiment:112} INFO - [epoch  10] execution time: 85.02s	 avg f1-score: 0.9038

[2024-03-30 13:08:47,806] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:08:47,829] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:09:05,467] {train_model:82} INFO - Train Epoch: 11 [36352/366120 (10%)]	lr:2.35e-04	Loss: 0.103252
[2024-03-30 13:09:11,400] {train_model:82} INFO - Train Epoch: 11 [72960/366120 (20%)]	lr:2.35e-04	Loss: 0.280737
[2024-03-30 13:09:17,398] {train_model:82} INFO - Train Epoch: 11 [109568/366120 (30%)]	lr:2.35e-04	Loss: 0.132762
[2024-03-30 13:09:23,411] {train_model:82} INFO - Train Epoch: 11 [146176/366120 (40%)]	lr:2.35e-04	Loss: 0.091342
[2024-03-30 13:09:29,415] {train_model:82} INFO - Train Epoch: 11 [182784/366120 (50%)]	lr:2.35e-04	Loss: 0.078343
[2024-03-30 13:09:35,445] {train_model:82} INFO - Train Epoch: 11 [219392/366120 (60%)]	lr:2.35e-04	Loss: 0.063477
[2024-03-30 13:09:41,474] {train_model:82} INFO - Train Epoch: 11 [256000/366120 (70%)]	lr:2.35e-04	Loss: 0.116474
[2024-03-30 13:09:47,488] {train_model:82} INFO - Train Epoch: 11 [292608/366120 (80%)]	lr:2.35e-04	Loss: 0.044484
[2024-03-30 13:09:53,502] {train_model:82} INFO - Train Epoch: 11 [329216/366120 (90%)]	lr:2.35e-04	Loss: 0.054325
[2024-03-30 13:09:59,547] {train_model:82} INFO - Train Epoch: 11 [365824/366120 (100%)]	lr:2.35e-04	Loss: 0.106268
[2024-03-30 13:10:03,174] {run_experiment:78} INFO - 
[2024-03-30 13:10:03,174] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-30 13:10:03,626] {result_logger:103} INFO - precision on Wake: 0.977
[2024-03-30 13:10:03,957] {result_logger:104} INFO - recall on Wake: 0.964
[2024-03-30 13:10:04,288] {result_logger:107} INFO - F1-score on Wake: 0.971
[2024-03-30 13:10:04,288] {result_logger:108} INFO - 
[2024-03-30 13:10:04,753] {result_logger:103} INFO - precision on Non REM: 0.958
[2024-03-30 13:10:05,084] {result_logger:104} INFO - recall on Non REM: 0.943
[2024-03-30 13:10:05,418] {result_logger:107} INFO - F1-score on Non REM: 0.950
[2024-03-30 13:10:05,418] {result_logger:108} INFO - 
[2024-03-30 13:10:05,844] {result_logger:103} INFO - precision on REM: 0.751
[2024-03-30 13:10:06,135] {result_logger:104} INFO - recall on REM: 0.956
[2024-03-30 13:10:06,421] {result_logger:107} INFO - F1-score on REM: 0.841
[2024-03-30 13:10:06,421] {result_logger:108} INFO - 
[2024-03-30 13:10:06,490] {result_logger:111} INFO - average precision on sleep stages: 0.895
[2024-03-30 13:10:06,559] {result_logger:113} INFO - average recall on sleep stages: 0.954
[2024-03-30 13:10:06,628] {result_logger:115} INFO - average F1-score on sleep stages: 0.921
[2024-03-30 13:10:06,629] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-30 13:10:06,688] {result_logger:103} INFO - precision on Wake: 0.981
[2024-03-30 13:10:06,727] {result_logger:104} INFO - recall on Wake: 0.970
[2024-03-30 13:10:06,767] {result_logger:107} INFO - F1-score on Wake: 0.975
[2024-03-30 13:10:06,767] {result_logger:108} INFO - 
[2024-03-30 13:10:06,825] {result_logger:103} INFO - precision on Non REM: 0.965
[2024-03-30 13:10:06,865] {result_logger:104} INFO - recall on Non REM: 0.937
[2024-03-30 13:10:06,905] {result_logger:107} INFO - F1-score on Non REM: 0.951
[2024-03-30 13:10:06,905] {result_logger:108} INFO - 
[2024-03-30 13:10:06,963] {result_logger:103} INFO - precision on REM: 0.729
[2024-03-30 13:10:07,002] {result_logger:104} INFO - recall on REM: 0.982
[2024-03-30 13:10:07,041] {result_logger:107} INFO - F1-score on REM: 0.837
[2024-03-30 13:10:07,041] {result_logger:108} INFO - 
[2024-03-30 13:10:07,047] {result_logger:111} INFO - average precision on sleep stages: 0.891
[2024-03-30 13:10:07,054] {result_logger:113} INFO - average recall on sleep stages: 0.963
[2024-03-30 13:10:07,060] {result_logger:115} INFO - average F1-score on sleep stages: 0.921
[2024-03-30 13:10:07,060] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-30 13:10:07,108] {result_logger:134} INFO - 
[[196360   5566   1821]
 [  4150 135549   4068]
 [   374    450  17782]]
[2024-03-30 13:10:07,155] {result_logger:141} INFO - 
[[ 96.37%   2.73%   0.89%]
 [  2.89%  94.28%   2.83%]
 [  2.01%   2.42%  95.57%]]
[2024-03-30 13:10:07,202] {result_logger:145} INFO - 
[[ 97.75%   3.93%   7.69%]
 [  2.07%  95.75%  17.19%]
 [  0.19%   0.32%  75.12%]]
[2024-03-30 13:10:07,202] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-30 13:10:07,207] {result_logger:134} INFO - 
[[27542   676   164]
 [  535 19404   764]
 [   11    36  2498]]
[2024-03-30 13:10:07,263] {result_logger:141} INFO - 
[[ 97.04%   2.38%   0.58%]
 [  2.58%  93.73%   3.69%]
 [  0.43%   1.41%  98.15%]]
[2024-03-30 13:10:07,313] {result_logger:145} INFO - 
[[ 98.06%   3.36%   4.79%]
 [  1.90%  96.46%  22.30%]
 [  0.04%   0.18%  72.91%]]
[2024-03-30 13:10:07,455] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-30 13:10:07,455] {result_logger:77} INFO - actual:
[2024-03-30 13:10:07,456] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-03-30 13:10:07,456] {result_logger:79} INFO - predicted:
[2024-03-30 13:10:07,456] {result_logger:80} INFO - 
[[95.19%  4.47%  0.34%]
 [ 3.88% 92.73%  3.39%]
 [16.67%  6.04% 77.29%]]
[2024-03-30 13:10:07,509] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp005/model_8conv_2fc-best.pth
[2024-03-30 13:10:07,509] {run_experiment:112} INFO - [epoch  11] execution time: 79.70s	 avg f1-score: 0.9210

[2024-03-30 13:10:07,509] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:10:07,530] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:10:27,483] {train_model:82} INFO - Train Epoch: 12 [36352/366120 (10%)]	lr:2.56e-04	Loss: 0.104470
[2024-03-30 13:10:33,453] {train_model:82} INFO - Train Epoch: 12 [72960/366120 (20%)]	lr:2.56e-04	Loss: 0.079181
[2024-03-30 13:10:39,392] {train_model:82} INFO - Train Epoch: 12 [109568/366120 (30%)]	lr:2.56e-04	Loss: 0.187253
[2024-03-30 13:10:45,357] {train_model:82} INFO - Train Epoch: 12 [146176/366120 (40%)]	lr:2.56e-04	Loss: 0.084229
[2024-03-30 13:10:51,336] {train_model:82} INFO - Train Epoch: 12 [182784/366120 (50%)]	lr:2.56e-04	Loss: 0.084755
[2024-03-30 13:10:57,312] {train_model:82} INFO - Train Epoch: 12 [219392/366120 (60%)]	lr:2.56e-04	Loss: 0.111890
[2024-03-30 13:11:03,319] {train_model:82} INFO - Train Epoch: 12 [256000/366120 (70%)]	lr:2.56e-04	Loss: 0.113047
[2024-03-30 13:11:09,306] {train_model:82} INFO - Train Epoch: 12 [292608/366120 (80%)]	lr:2.56e-04	Loss: 0.104893
[2024-03-30 13:11:15,350] {train_model:82} INFO - Train Epoch: 12 [329216/366120 (90%)]	lr:2.56e-04	Loss: 0.184321
[2024-03-30 13:11:21,426] {train_model:82} INFO - Train Epoch: 12 [365824/366120 (100%)]	lr:2.56e-04	Loss: 0.104940
[2024-03-30 13:11:24,764] {run_experiment:78} INFO - 
[2024-03-30 13:11:24,764] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-30 13:11:25,207] {result_logger:103} INFO - precision on Wake: 0.978
[2024-03-30 13:11:25,537] {result_logger:104} INFO - recall on Wake: 0.965
[2024-03-30 13:11:25,869] {result_logger:107} INFO - F1-score on Wake: 0.972
[2024-03-30 13:11:25,869] {result_logger:108} INFO - 
[2024-03-30 13:11:26,319] {result_logger:103} INFO - precision on Non REM: 0.960
[2024-03-30 13:11:26,657] {result_logger:104} INFO - recall on Non REM: 0.944
[2024-03-30 13:11:26,982] {result_logger:107} INFO - F1-score on Non REM: 0.952
[2024-03-30 13:11:26,982] {result_logger:108} INFO - 
[2024-03-30 13:11:27,395] {result_logger:103} INFO - precision on REM: 0.753
[2024-03-30 13:11:27,686] {result_logger:104} INFO - recall on REM: 0.956
[2024-03-30 13:11:27,979] {result_logger:107} INFO - F1-score on REM: 0.842
[2024-03-30 13:11:27,979] {result_logger:108} INFO - 
[2024-03-30 13:11:28,049] {result_logger:111} INFO - average precision on sleep stages: 0.897
[2024-03-30 13:11:28,118] {result_logger:113} INFO - average recall on sleep stages: 0.955
[2024-03-30 13:11:28,188] {result_logger:115} INFO - average F1-score on sleep stages: 0.922
[2024-03-30 13:11:28,190] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-30 13:11:28,247] {result_logger:103} INFO - precision on Wake: 0.953
[2024-03-30 13:11:28,287] {result_logger:104} INFO - recall on Wake: 0.981
[2024-03-30 13:11:28,327] {result_logger:107} INFO - F1-score on Wake: 0.967
[2024-03-30 13:11:28,327] {result_logger:108} INFO - 
[2024-03-30 13:11:28,384] {result_logger:103} INFO - precision on Non REM: 0.982
[2024-03-30 13:11:28,425] {result_logger:104} INFO - recall on Non REM: 0.897
[2024-03-30 13:11:28,466] {result_logger:107} INFO - F1-score on Non REM: 0.937
[2024-03-30 13:11:28,466] {result_logger:108} INFO - 
[2024-03-30 13:11:28,522] {result_logger:103} INFO - precision on REM: 0.716
[2024-03-30 13:11:28,562] {result_logger:104} INFO - recall on REM: 0.982
[2024-03-30 13:11:28,602] {result_logger:107} INFO - F1-score on REM: 0.828
[2024-03-30 13:11:28,602] {result_logger:108} INFO - 
[2024-03-30 13:11:28,608] {result_logger:111} INFO - average precision on sleep stages: 0.884
[2024-03-30 13:11:28,615] {result_logger:113} INFO - average recall on sleep stages: 0.953
[2024-03-30 13:11:28,621] {result_logger:115} INFO - average F1-score on sleep stages: 0.911
[2024-03-30 13:11:28,621] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-30 13:11:28,670] {result_logger:134} INFO - 
[[196715   5294   1738]
 [  3944 135716   4107]
 [   394    426  17786]]
[2024-03-30 13:11:28,718] {result_logger:141} INFO - 
[[ 96.55%   2.60%   0.85%]
 [  2.74%  94.40%   2.86%]
 [  2.12%   2.29%  95.59%]]
[2024-03-30 13:11:28,766] {result_logger:145} INFO - 
[[ 97.84%   3.74%   7.35%]
 [  1.96%  95.96%  17.38%]
 [  0.20%   0.30%  75.27%]]
[2024-03-30 13:11:28,766] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-30 13:11:28,771] {result_logger:134} INFO - 
[[27853   311   218]
 [ 1366 18565   772]
 [   13    34  2498]]
[2024-03-30 13:11:28,775] {result_logger:141} INFO - 
[[ 98.14%   1.10%   0.77%]
 [  6.60%  89.67%   3.73%]
 [  0.51%   1.34%  98.15%]]
[2024-03-30 13:11:28,780] {result_logger:145} INFO - 
[[ 95.28%   1.64%   6.25%]
 [  4.67%  98.18%  22.13%]
 [  0.04%   0.18%  71.62%]]
[2024-03-30 13:11:28,831] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-30 13:11:28,831] {result_logger:77} INFO - actual:
[2024-03-30 13:11:28,831] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-03-30 13:11:28,831] {result_logger:79} INFO - predicted:
[2024-03-30 13:11:28,831] {result_logger:80} INFO - 
[[93.52%  6.01%  0.47%]
 [ 6.25% 89.77%  3.99%]
 [20.47%  5.10% 74.43%]]
[2024-03-30 13:11:28,831] {run_experiment:112} INFO - [epoch  12] execution time: 81.32s	 avg f1-score: 0.9108

[2024-03-30 13:11:28,831] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:11:28,852] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:11:46,902] {train_model:82} INFO - Train Epoch: 13 [36352/366120 (10%)]	lr:2.41e-04	Loss: 0.101763
[2024-03-30 13:11:52,997] {train_model:82} INFO - Train Epoch: 13 [72960/366120 (20%)]	lr:2.41e-04	Loss: 0.153443
[2024-03-30 13:11:59,027] {train_model:82} INFO - Train Epoch: 13 [109568/366120 (30%)]	lr:2.41e-04	Loss: 0.153890
[2024-03-30 13:12:05,050] {train_model:82} INFO - Train Epoch: 13 [146176/366120 (40%)]	lr:2.41e-04	Loss: 0.062404
[2024-03-30 13:12:11,036] {train_model:82} INFO - Train Epoch: 13 [182784/366120 (50%)]	lr:2.41e-04	Loss: 0.086049
[2024-03-30 13:12:17,016] {train_model:82} INFO - Train Epoch: 13 [219392/366120 (60%)]	lr:2.41e-04	Loss: 0.119931
[2024-03-30 13:12:23,014] {train_model:82} INFO - Train Epoch: 13 [256000/366120 (70%)]	lr:2.41e-04	Loss: 0.229338
[2024-03-30 13:12:28,999] {train_model:82} INFO - Train Epoch: 13 [292608/366120 (80%)]	lr:2.41e-04	Loss: 0.112166
[2024-03-30 13:12:35,002] {train_model:82} INFO - Train Epoch: 13 [329216/366120 (90%)]	lr:2.41e-04	Loss: 0.068288
[2024-03-30 13:12:41,099] {train_model:82} INFO - Train Epoch: 13 [365824/366120 (100%)]	lr:2.41e-04	Loss: 0.100304
[2024-03-30 13:12:44,817] {run_experiment:78} INFO - 
[2024-03-30 13:12:44,818] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-30 13:12:45,265] {result_logger:103} INFO - precision on Wake: 0.980
[2024-03-30 13:12:45,587] {result_logger:104} INFO - recall on Wake: 0.968
[2024-03-30 13:12:45,917] {result_logger:107} INFO - F1-score on Wake: 0.974
[2024-03-30 13:12:45,917] {result_logger:108} INFO - 
[2024-03-30 13:12:46,372] {result_logger:103} INFO - precision on Non REM: 0.962
[2024-03-30 13:12:46,699] {result_logger:104} INFO - recall on Non REM: 0.948
[2024-03-30 13:12:47,024] {result_logger:107} INFO - F1-score on Non REM: 0.955
[2024-03-30 13:12:47,024] {result_logger:108} INFO - 
[2024-03-30 13:12:47,440] {result_logger:103} INFO - precision on REM: 0.775
[2024-03-30 13:12:47,733] {result_logger:104} INFO - recall on REM: 0.960
[2024-03-30 13:12:48,027] {result_logger:107} INFO - F1-score on REM: 0.858
[2024-03-30 13:12:48,027] {result_logger:108} INFO - 
[2024-03-30 13:12:48,093] {result_logger:111} INFO - average precision on sleep stages: 0.905
[2024-03-30 13:12:48,160] {result_logger:113} INFO - average recall on sleep stages: 0.959
[2024-03-30 13:12:48,227] {result_logger:115} INFO - average F1-score on sleep stages: 0.929
[2024-03-30 13:12:48,229] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-30 13:12:48,286] {result_logger:103} INFO - precision on Wake: 0.944
[2024-03-30 13:12:48,327] {result_logger:104} INFO - recall on Wake: 0.986
[2024-03-30 13:12:48,368] {result_logger:107} INFO - F1-score on Wake: 0.964
[2024-03-30 13:12:48,368] {result_logger:108} INFO - 
[2024-03-30 13:12:48,429] {result_logger:103} INFO - precision on Non REM: 0.987
[2024-03-30 13:12:48,471] {result_logger:104} INFO - recall on Non REM: 0.890
[2024-03-30 13:12:48,510] {result_logger:107} INFO - F1-score on Non REM: 0.936
[2024-03-30 13:12:48,511] {result_logger:108} INFO - 
[2024-03-30 13:12:48,567] {result_logger:103} INFO - precision on REM: 0.754
[2024-03-30 13:12:48,607] {result_logger:104} INFO - recall on REM: 0.975
[2024-03-30 13:12:48,646] {result_logger:107} INFO - F1-score on REM: 0.850
[2024-03-30 13:12:48,646] {result_logger:108} INFO - 
[2024-03-30 13:12:48,652] {result_logger:111} INFO - average precision on sleep stages: 0.895
[2024-03-30 13:12:48,658] {result_logger:113} INFO - average recall on sleep stages: 0.950
[2024-03-30 13:12:48,664] {result_logger:115} INFO - average F1-score on sleep stages: 0.917
[2024-03-30 13:12:48,664] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-30 13:12:48,711] {result_logger:134} INFO - 
[[197248   5016   1483]
 [  3749 136319   3699]
 [   307    441  17858]]
[2024-03-30 13:12:48,758] {result_logger:141} INFO - 
[[ 96.81%   2.46%   0.73%]
 [  2.61%  94.82%   2.57%]
 [  1.65%   2.37%  95.98%]]
[2024-03-30 13:12:48,803] {result_logger:145} INFO - 
[[ 97.99%   3.54%   6.44%]
 [  1.86%  96.15%  16.05%]
 [  0.15%   0.31%  77.51%]]
[2024-03-30 13:12:48,804] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-30 13:12:48,808] {result_logger:134} INFO - 
[[27985   190   207]
 [ 1665 18435   603]
 [    9    55  2481]]
[2024-03-30 13:12:48,813] {result_logger:141} INFO - 
[[ 98.60%   0.67%   0.73%]
 [  8.04%  89.05%   2.91%]
 [  0.35%   2.16%  97.49%]]
[2024-03-30 13:12:48,817] {result_logger:145} INFO - 
[[ 94.36%   1.02%   6.29%]
 [  5.61%  98.69%  18.32%]
 [  0.03%   0.29%  75.39%]]
[2024-03-30 13:12:48,867] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-30 13:12:48,867] {result_logger:77} INFO - actual:
[2024-03-30 13:12:48,867] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-03-30 13:12:48,867] {result_logger:79} INFO - predicted:
[2024-03-30 13:12:48,867] {result_logger:80} INFO - 
[[93.76%  5.89%  0.35%]
 [ 6.60% 90.01%  3.39%]
 [18.75%  3.68% 77.58%]]
[2024-03-30 13:12:48,868] {run_experiment:112} INFO - [epoch  13] execution time: 80.04s	 avg f1-score: 0.9169

[2024-03-30 13:12:48,868] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:12:48,888] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:13:07,055] {train_model:82} INFO - Train Epoch: 14 [36352/366120 (10%)]	lr:2.27e-04	Loss: 0.116168
[2024-03-30 13:13:12,985] {train_model:82} INFO - Train Epoch: 14 [72960/366120 (20%)]	lr:2.27e-04	Loss: 0.163185
[2024-03-30 13:13:18,940] {train_model:82} INFO - Train Epoch: 14 [109568/366120 (30%)]	lr:2.27e-04	Loss: 0.121897
[2024-03-30 13:13:25,014] {train_model:82} INFO - Train Epoch: 14 [146176/366120 (40%)]	lr:2.27e-04	Loss: 0.054898
[2024-03-30 13:13:31,064] {train_model:82} INFO - Train Epoch: 14 [182784/366120 (50%)]	lr:2.27e-04	Loss: 0.296737
[2024-03-30 13:13:37,126] {train_model:82} INFO - Train Epoch: 14 [219392/366120 (60%)]	lr:2.27e-04	Loss: 0.095763
[2024-03-30 13:13:43,184] {train_model:82} INFO - Train Epoch: 14 [256000/366120 (70%)]	lr:2.27e-04	Loss: 0.237996
[2024-03-30 13:13:49,157] {train_model:82} INFO - Train Epoch: 14 [292608/366120 (80%)]	lr:2.27e-04	Loss: 0.096651
[2024-03-30 13:13:55,153] {train_model:82} INFO - Train Epoch: 14 [329216/366120 (90%)]	lr:2.27e-04	Loss: 0.314368
[2024-03-30 13:14:01,203] {train_model:82} INFO - Train Epoch: 14 [365824/366120 (100%)]	lr:2.27e-04	Loss: 0.042117
[2024-03-30 13:14:04,666] {run_experiment:78} INFO - 
[2024-03-30 13:14:04,666] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-30 13:14:05,109] {result_logger:103} INFO - precision on Wake: 0.981
[2024-03-30 13:14:05,445] {result_logger:104} INFO - recall on Wake: 0.972
[2024-03-30 13:14:05,766] {result_logger:107} INFO - F1-score on Wake: 0.976
[2024-03-30 13:14:05,766] {result_logger:108} INFO - 
[2024-03-30 13:14:06,223] {result_logger:103} INFO - precision on Non REM: 0.964
[2024-03-30 13:14:06,550] {result_logger:104} INFO - recall on Non REM: 0.951
[2024-03-30 13:14:06,878] {result_logger:107} INFO - F1-score on Non REM: 0.957
[2024-03-30 13:14:06,878] {result_logger:108} INFO - 
[2024-03-30 13:14:07,290] {result_logger:103} INFO - precision on REM: 0.795
[2024-03-30 13:14:07,584] {result_logger:104} INFO - recall on REM: 0.965
[2024-03-30 13:14:07,866] {result_logger:107} INFO - F1-score on REM: 0.872
[2024-03-30 13:14:07,866] {result_logger:108} INFO - 
[2024-03-30 13:14:07,933] {result_logger:111} INFO - average precision on sleep stages: 0.914
[2024-03-30 13:14:07,998] {result_logger:113} INFO - average recall on sleep stages: 0.963
[2024-03-30 13:14:08,063] {result_logger:115} INFO - average F1-score on sleep stages: 0.935
[2024-03-30 13:14:08,065] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-30 13:14:08,123] {result_logger:103} INFO - precision on Wake: 0.984
[2024-03-30 13:14:08,162] {result_logger:104} INFO - recall on Wake: 0.971
[2024-03-30 13:14:08,202] {result_logger:107} INFO - F1-score on Wake: 0.977
[2024-03-30 13:14:08,202] {result_logger:108} INFO - 
[2024-03-30 13:14:08,259] {result_logger:103} INFO - precision on Non REM: 0.963
[2024-03-30 13:14:08,299] {result_logger:104} INFO - recall on Non REM: 0.946
[2024-03-30 13:14:08,338] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2024-03-30 13:14:08,338] {result_logger:108} INFO - 
[2024-03-30 13:14:08,395] {result_logger:103} INFO - precision on REM: 0.760
[2024-03-30 13:14:08,435] {result_logger:104} INFO - recall on REM: 0.979
[2024-03-30 13:14:08,476] {result_logger:107} INFO - F1-score on REM: 0.856
[2024-03-30 13:14:08,476] {result_logger:108} INFO - 
[2024-03-30 13:14:08,482] {result_logger:111} INFO - average precision on sleep stages: 0.902
[2024-03-30 13:14:08,488] {result_logger:113} INFO - average recall on sleep stages: 0.965
[2024-03-30 13:14:08,494] {result_logger:115} INFO - average F1-score on sleep stages: 0.929
[2024-03-30 13:14:08,494] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-30 13:14:08,540] {result_logger:134} INFO - 
[[197958   4684   1105]
 [  3534 136717   3516]
 [   233    414  17959]]
[2024-03-30 13:14:08,585] {result_logger:141} INFO - 
[[ 97.16%   2.30%   0.54%]
 [  2.46%  95.10%   2.45%]
 [  1.25%   2.23%  96.52%]]
[2024-03-30 13:14:08,630] {result_logger:145} INFO - 
[[ 98.13%   3.30%   4.89%]
 [  1.75%  96.41%  15.57%]
 [  0.12%   0.29%  79.53%]]
[2024-03-30 13:14:08,630] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-30 13:14:08,634] {result_logger:134} INFO - 
[[27564   708   110]
 [  449 19578   676]
 [   13    40  2492]]
[2024-03-30 13:14:08,690] {result_logger:141} INFO - 
[[ 97.12%   2.49%   0.39%]
 [  2.17%  94.57%   3.27%]
 [  0.51%   1.57%  97.92%]]
[2024-03-30 13:14:08,740] {result_logger:145} INFO - 
[[ 98.35%   3.48%   3.36%]
 [  1.60%  96.32%  20.62%]
 [  0.05%   0.20%  76.02%]]
[2024-03-30 13:14:08,883] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-30 13:14:08,883] {result_logger:77} INFO - actual:
[2024-03-30 13:14:08,883] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-03-30 13:14:08,883] {result_logger:79} INFO - predicted:
[2024-03-30 13:14:08,884] {result_logger:80} INFO - 
[[95.49%  4.36%  0.15%]
 [ 3.80% 92.93%  3.27%]
 [15.04%  6.56% 78.40%]]
[2024-03-30 13:14:08,936] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp005/model_8conv_2fc-best.pth
[2024-03-30 13:14:08,937] {run_experiment:112} INFO - [epoch  14] execution time: 80.07s	 avg f1-score: 0.9292

[2024-03-30 13:14:08,937] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:14:08,957] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:14:27,315] {train_model:82} INFO - Train Epoch: 15 [36352/366120 (10%)]	lr:2.14e-04	Loss: 0.062403
[2024-03-30 13:14:33,358] {train_model:82} INFO - Train Epoch: 15 [72960/366120 (20%)]	lr:2.14e-04	Loss: 0.121313
[2024-03-30 13:14:39,361] {train_model:82} INFO - Train Epoch: 15 [109568/366120 (30%)]	lr:2.14e-04	Loss: 0.125350
[2024-03-30 13:14:45,422] {train_model:82} INFO - Train Epoch: 15 [146176/366120 (40%)]	lr:2.14e-04	Loss: 0.141329
[2024-03-30 13:14:51,489] {train_model:82} INFO - Train Epoch: 15 [182784/366120 (50%)]	lr:2.14e-04	Loss: 0.069481
[2024-03-30 13:14:57,542] {train_model:82} INFO - Train Epoch: 15 [219392/366120 (60%)]	lr:2.14e-04	Loss: 0.038142
[2024-03-30 13:15:03,568] {train_model:82} INFO - Train Epoch: 15 [256000/366120 (70%)]	lr:2.14e-04	Loss: 0.051724
[2024-03-30 13:15:09,638] {train_model:82} INFO - Train Epoch: 15 [292608/366120 (80%)]	lr:2.14e-04	Loss: 0.140887
[2024-03-30 13:15:15,733] {train_model:82} INFO - Train Epoch: 15 [329216/366120 (90%)]	lr:2.14e-04	Loss: 0.057247
[2024-03-30 13:15:21,883] {train_model:82} INFO - Train Epoch: 15 [365824/366120 (100%)]	lr:2.14e-04	Loss: 0.091585
[2024-03-30 13:15:25,323] {run_experiment:78} INFO - 
[2024-03-30 13:15:25,323] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-30 13:15:25,772] {result_logger:103} INFO - precision on Wake: 0.982
[2024-03-30 13:15:26,101] {result_logger:104} INFO - recall on Wake: 0.974
[2024-03-30 13:15:26,429] {result_logger:107} INFO - F1-score on Wake: 0.978
[2024-03-30 13:15:26,429] {result_logger:108} INFO - 
[2024-03-30 13:15:26,883] {result_logger:103} INFO - precision on Non REM: 0.966
[2024-03-30 13:15:27,211] {result_logger:104} INFO - recall on Non REM: 0.954
[2024-03-30 13:15:27,541] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2024-03-30 13:15:27,541] {result_logger:108} INFO - 
[2024-03-30 13:15:27,956] {result_logger:103} INFO - precision on REM: 0.809
[2024-03-30 13:15:28,252] {result_logger:104} INFO - recall on REM: 0.966
[2024-03-30 13:15:28,540] {result_logger:107} INFO - F1-score on REM: 0.881
[2024-03-30 13:15:28,540] {result_logger:108} INFO - 
[2024-03-30 13:15:28,608] {result_logger:111} INFO - average precision on sleep stages: 0.919
[2024-03-30 13:15:28,676] {result_logger:113} INFO - average recall on sleep stages: 0.965
[2024-03-30 13:15:28,744] {result_logger:115} INFO - average F1-score on sleep stages: 0.939
[2024-03-30 13:15:28,745] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-30 13:15:28,807] {result_logger:103} INFO - precision on Wake: 0.978
[2024-03-30 13:15:28,851] {result_logger:104} INFO - recall on Wake: 0.943
[2024-03-30 13:15:28,893] {result_logger:107} INFO - F1-score on Wake: 0.960
[2024-03-30 13:15:28,893] {result_logger:108} INFO - 
[2024-03-30 13:15:28,954] {result_logger:103} INFO - precision on Non REM: 0.959
[2024-03-30 13:15:28,994] {result_logger:104} INFO - recall on Non REM: 0.936
[2024-03-30 13:15:29,034] {result_logger:107} INFO - F1-score on Non REM: 0.948
[2024-03-30 13:15:29,034] {result_logger:108} INFO - 
[2024-03-30 13:15:29,092] {result_logger:103} INFO - precision on REM: 0.618
[2024-03-30 13:15:29,131] {result_logger:104} INFO - recall on REM: 0.985
[2024-03-30 13:15:29,170] {result_logger:107} INFO - F1-score on REM: 0.760
[2024-03-30 13:15:29,171] {result_logger:108} INFO - 
[2024-03-30 13:15:29,177] {result_logger:111} INFO - average precision on sleep stages: 0.852
[2024-03-30 13:15:29,183] {result_logger:113} INFO - average recall on sleep stages: 0.955
[2024-03-30 13:15:29,189] {result_logger:115} INFO - average F1-score on sleep stages: 0.889
[2024-03-30 13:15:29,190] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-30 13:15:29,236] {result_logger:134} INFO - 
[[198382   4418    947]
 [  3331 137133   3303]
 [   208    421  17977]]
[2024-03-30 13:15:29,282] {result_logger:141} INFO - 
[[ 97.37%   2.17%   0.46%]
 [  2.32%  95.39%   2.30%]
 [  1.12%   2.26%  96.62%]]
[2024-03-30 13:15:29,328] {result_logger:145} INFO - 
[[ 98.25%   3.11%   4.26%]
 [  1.65%  96.59%  14.86%]
 [  0.10%   0.30%  80.88%]]
[2024-03-30 13:15:29,328] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-30 13:15:29,333] {result_logger:134} INFO - 
[[26767   790   825]
 [  599 19381   723]
 [    5    32  2508]]
[2024-03-30 13:15:29,337] {result_logger:141} INFO - 
[[ 94.31%   2.78%   2.91%]
 [  2.89%  93.61%   3.49%]
 [  0.20%   1.26%  98.55%]]
[2024-03-30 13:15:29,342] {result_logger:145} INFO - 
[[ 97.79%   3.91%  20.34%]
 [  2.19%  95.93%  17.83%]
 [  0.02%   0.16%  61.83%]]
[2024-03-30 13:15:29,395] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-30 13:15:29,396] {result_logger:77} INFO - actual:
[2024-03-30 13:15:29,396] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-03-30 13:15:29,396] {result_logger:79} INFO - predicted:
[2024-03-30 13:15:29,396] {result_logger:80} INFO - 
[[93.34%  5.12%  1.54%]
 [ 4.95% 91.75%  3.30%]
 [20.29%  6.56% 73.15%]]
[2024-03-30 13:15:29,396] {run_experiment:112} INFO - [epoch  15] execution time: 80.46s	 avg f1-score: 0.8892

[2024-03-30 13:15:29,396] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:15:29,417] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:15:47,326] {train_model:82} INFO - Train Epoch: 16 [36352/366120 (10%)]	lr:2.01e-04	Loss: 0.122247
[2024-03-30 13:15:53,333] {train_model:82} INFO - Train Epoch: 16 [72960/366120 (20%)]	lr:2.01e-04	Loss: 0.043328
[2024-03-30 13:15:59,339] {train_model:82} INFO - Train Epoch: 16 [109568/366120 (30%)]	lr:2.01e-04	Loss: 0.075560
[2024-03-30 13:16:05,382] {train_model:82} INFO - Train Epoch: 16 [146176/366120 (40%)]	lr:2.01e-04	Loss: 0.078559
[2024-03-30 13:16:11,458] {train_model:82} INFO - Train Epoch: 16 [182784/366120 (50%)]	lr:2.01e-04	Loss: 0.043873
[2024-03-30 13:16:17,497] {train_model:82} INFO - Train Epoch: 16 [219392/366120 (60%)]	lr:2.01e-04	Loss: 0.100059
[2024-03-30 13:16:23,540] {train_model:82} INFO - Train Epoch: 16 [256000/366120 (70%)]	lr:2.01e-04	Loss: 0.108970
[2024-03-30 13:16:29,620] {train_model:82} INFO - Train Epoch: 16 [292608/366120 (80%)]	lr:2.01e-04	Loss: 0.150823
[2024-03-30 13:16:35,721] {train_model:82} INFO - Train Epoch: 16 [329216/366120 (90%)]	lr:2.01e-04	Loss: 0.186622
[2024-03-30 13:16:41,858] {train_model:82} INFO - Train Epoch: 16 [365824/366120 (100%)]	lr:2.01e-04	Loss: 0.129468
[2024-03-30 13:16:45,141] {run_experiment:78} INFO - 
[2024-03-30 13:16:45,142] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-30 13:16:45,600] {result_logger:103} INFO - precision on Wake: 0.983
[2024-03-30 13:16:45,932] {result_logger:104} INFO - recall on Wake: 0.974
[2024-03-30 13:16:46,264] {result_logger:107} INFO - F1-score on Wake: 0.979
[2024-03-30 13:16:46,264] {result_logger:108} INFO - 
[2024-03-30 13:16:46,715] {result_logger:103} INFO - precision on Non REM: 0.967
[2024-03-30 13:16:47,040] {result_logger:104} INFO - recall on Non REM: 0.955
[2024-03-30 13:16:47,364] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2024-03-30 13:16:47,364] {result_logger:108} INFO - 
[2024-03-30 13:16:47,771] {result_logger:103} INFO - precision on REM: 0.816
[2024-03-30 13:16:48,053] {result_logger:104} INFO - recall on REM: 0.970
[2024-03-30 13:16:48,347] {result_logger:107} INFO - F1-score on REM: 0.886
[2024-03-30 13:16:48,347] {result_logger:108} INFO - 
[2024-03-30 13:16:48,417] {result_logger:111} INFO - average precision on sleep stages: 0.922
[2024-03-30 13:16:48,484] {result_logger:113} INFO - average recall on sleep stages: 0.966
[2024-03-30 13:16:48,551] {result_logger:115} INFO - average F1-score on sleep stages: 0.942
[2024-03-30 13:16:48,552] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-30 13:16:48,612] {result_logger:103} INFO - precision on Wake: 0.979
[2024-03-30 13:16:48,652] {result_logger:104} INFO - recall on Wake: 0.974
[2024-03-30 13:16:48,691] {result_logger:107} INFO - F1-score on Wake: 0.976
[2024-03-30 13:16:48,692] {result_logger:108} INFO - 
[2024-03-30 13:16:48,750] {result_logger:103} INFO - precision on Non REM: 0.967
[2024-03-30 13:16:48,789] {result_logger:104} INFO - recall on Non REM: 0.934
[2024-03-30 13:16:48,829] {result_logger:107} INFO - F1-score on Non REM: 0.950
[2024-03-30 13:16:48,830] {result_logger:108} INFO - 
[2024-03-30 13:16:48,887] {result_logger:103} INFO - precision on REM: 0.736
[2024-03-30 13:16:48,925] {result_logger:104} INFO - recall on REM: 0.982
[2024-03-30 13:16:48,965] {result_logger:107} INFO - F1-score on REM: 0.841
[2024-03-30 13:16:48,965] {result_logger:108} INFO - 
[2024-03-30 13:16:48,972] {result_logger:111} INFO - average precision on sleep stages: 0.894
[2024-03-30 13:16:48,978] {result_logger:113} INFO - average recall on sleep stages: 0.963
[2024-03-30 13:16:48,984] {result_logger:115} INFO - average F1-score on sleep stages: 0.923
[2024-03-30 13:16:48,984] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-30 13:16:49,031] {result_logger:134} INFO - 
[[198496   4371    880]
 [  3225 137350   3192]
 [   180    386  18040]]
[2024-03-30 13:16:49,076] {result_logger:141} INFO - 
[[ 97.42%   2.15%   0.43%]
 [  2.24%  95.54%   2.22%]
 [  0.97%   2.07%  96.96%]]
[2024-03-30 13:16:49,123] {result_logger:145} INFO - 
[[ 98.31%   3.08%   3.98%]
 [  1.60%  96.65%  14.44%]
 [  0.09%   0.27%  81.58%]]
[2024-03-30 13:16:49,123] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-30 13:16:49,128] {result_logger:134} INFO - 
[[27646   616   120]
 [  595 19330   778]
 [    9    37  2499]]
[2024-03-30 13:16:49,132] {result_logger:141} INFO - 
[[ 97.41%   2.17%   0.42%]
 [  2.87%  93.37%   3.76%]
 [  0.35%   1.45%  98.19%]]
[2024-03-30 13:16:49,136] {result_logger:145} INFO - 
[[ 97.86%   3.08%   3.53%]
 [  2.11%  96.73%  22.90%]
 [  0.03%   0.19%  73.56%]]
[2024-03-30 13:16:49,186] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-30 13:16:49,186] {result_logger:77} INFO - actual:
[2024-03-30 13:16:49,186] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-03-30 13:16:49,187] {result_logger:79} INFO - predicted:
[2024-03-30 13:16:49,187] {result_logger:80} INFO - 
[[95.16%  4.69%  0.15%]
 [ 4.38% 92.07%  3.54%]
 [14.48%  7.59% 77.92%]]
[2024-03-30 13:16:49,187] {run_experiment:112} INFO - [epoch  16] execution time: 79.79s	 avg f1-score: 0.9226

[2024-03-30 13:16:49,187] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:16:49,208] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:17:07,363] {train_model:82} INFO - Train Epoch: 17 [36352/366120 (10%)]	lr:1.90e-04	Loss: 0.032744
[2024-03-30 13:17:13,293] {train_model:82} INFO - Train Epoch: 17 [72960/366120 (20%)]	lr:1.90e-04	Loss: 0.079179
[2024-03-30 13:17:19,250] {train_model:82} INFO - Train Epoch: 17 [109568/366120 (30%)]	lr:1.90e-04	Loss: 0.053240
[2024-03-30 13:17:25,197] {train_model:82} INFO - Train Epoch: 17 [146176/366120 (40%)]	lr:1.90e-04	Loss: 0.085382
[2024-03-30 13:17:31,169] {train_model:82} INFO - Train Epoch: 17 [182784/366120 (50%)]	lr:1.90e-04	Loss: 0.076038
[2024-03-30 13:17:37,246] {train_model:82} INFO - Train Epoch: 17 [219392/366120 (60%)]	lr:1.90e-04	Loss: 0.040976
[2024-03-30 13:17:43,230] {train_model:82} INFO - Train Epoch: 17 [256000/366120 (70%)]	lr:1.90e-04	Loss: 0.093912
[2024-03-30 13:17:49,356] {train_model:82} INFO - Train Epoch: 17 [292608/366120 (80%)]	lr:1.90e-04	Loss: 0.118031
[2024-03-30 13:17:55,488] {train_model:82} INFO - Train Epoch: 17 [329216/366120 (90%)]	lr:1.90e-04	Loss: 0.223467
[2024-03-30 13:18:01,615] {train_model:82} INFO - Train Epoch: 17 [365824/366120 (100%)]	lr:1.90e-04	Loss: 0.067669
[2024-03-30 13:18:04,951] {run_experiment:78} INFO - 
[2024-03-30 13:18:04,952] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-30 13:18:05,402] {result_logger:103} INFO - precision on Wake: 0.984
[2024-03-30 13:18:05,739] {result_logger:104} INFO - recall on Wake: 0.977
[2024-03-30 13:18:06,065] {result_logger:107} INFO - F1-score on Wake: 0.980
[2024-03-30 13:18:06,065] {result_logger:108} INFO - 
[2024-03-30 13:18:06,510] {result_logger:103} INFO - precision on Non REM: 0.969
[2024-03-30 13:18:06,833] {result_logger:104} INFO - recall on Non REM: 0.956
[2024-03-30 13:18:07,156] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2024-03-30 13:18:07,156] {result_logger:108} INFO - 
[2024-03-30 13:18:07,580] {result_logger:103} INFO - precision on REM: 0.824
[2024-03-30 13:18:07,862] {result_logger:104} INFO - recall on REM: 0.973
[2024-03-30 13:18:08,146] {result_logger:107} INFO - F1-score on REM: 0.892
[2024-03-30 13:18:08,146] {result_logger:108} INFO - 
[2024-03-30 13:18:08,216] {result_logger:111} INFO - average precision on sleep stages: 0.926
[2024-03-30 13:18:08,287] {result_logger:113} INFO - average recall on sleep stages: 0.968
[2024-03-30 13:18:08,355] {result_logger:115} INFO - average F1-score on sleep stages: 0.945
[2024-03-30 13:18:08,356] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-30 13:18:08,414] {result_logger:103} INFO - precision on Wake: 0.982
[2024-03-30 13:18:08,454] {result_logger:104} INFO - recall on Wake: 0.970
[2024-03-30 13:18:08,493] {result_logger:107} INFO - F1-score on Wake: 0.976
[2024-03-30 13:18:08,493] {result_logger:108} INFO - 
[2024-03-30 13:18:08,551] {result_logger:103} INFO - precision on Non REM: 0.963
[2024-03-30 13:18:08,591] {result_logger:104} INFO - recall on Non REM: 0.950
[2024-03-30 13:18:08,631] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2024-03-30 13:18:08,631] {result_logger:108} INFO - 
[2024-03-30 13:18:08,688] {result_logger:103} INFO - precision on REM: 0.781
[2024-03-30 13:18:08,727] {result_logger:104} INFO - recall on REM: 0.972
[2024-03-30 13:18:08,766] {result_logger:107} INFO - F1-score on REM: 0.866
[2024-03-30 13:18:08,766] {result_logger:108} INFO - 
[2024-03-30 13:18:08,773] {result_logger:111} INFO - average precision on sleep stages: 0.909
[2024-03-30 13:18:08,779] {result_logger:113} INFO - average recall on sleep stages: 0.964
[2024-03-30 13:18:08,785] {result_logger:115} INFO - average F1-score on sleep stages: 0.933
[2024-03-30 13:18:08,786] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-30 13:18:08,835] {result_logger:134} INFO - 
[[198998   4043    706]
 [  3146 137461   3160]
 [   160    351  18095]]
[2024-03-30 13:18:08,885] {result_logger:141} INFO - 
[[ 97.67%   1.98%   0.35%]
 [  2.19%  95.61%   2.20%]
 [  0.86%   1.89%  97.25%]]
[2024-03-30 13:18:08,934] {result_logger:145} INFO - 
[[ 98.37%   2.85%   3.21%]
 [  1.56%  96.90%  14.39%]
 [  0.08%   0.25%  82.40%]]
[2024-03-30 13:18:08,934] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-30 13:18:08,938] {result_logger:134} INFO - 
[[27540   703   139]
 [  482 19664   557]
 [   18    52  2475]]
[2024-03-30 13:18:08,995] {result_logger:141} INFO - 
[[ 97.03%   2.48%   0.49%]
 [  2.33%  94.98%   2.69%]
 [  0.71%   2.04%  97.25%]]
[2024-03-30 13:18:09,045] {result_logger:145} INFO - 
[[ 98.22%   3.44%   4.38%]
 [  1.72%  96.30%  17.57%]
 [  0.06%   0.25%  78.05%]]
[2024-03-30 13:18:09,188] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-30 13:18:09,188] {result_logger:77} INFO - actual:
[2024-03-30 13:18:09,188] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-03-30 13:18:09,188] {result_logger:79} INFO - predicted:
[2024-03-30 13:18:09,188] {result_logger:80} INFO - 
[[95.01%  4.68%  0.31%]
 [ 4.16% 92.82%  3.02%]
 [17.31%  4.86% 77.83%]]
[2024-03-30 13:18:09,241] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp005/model_8conv_2fc-best.pth
[2024-03-30 13:18:09,242] {run_experiment:112} INFO - [epoch  17] execution time: 80.05s	 avg f1-score: 0.9329

[2024-03-30 13:18:09,242] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:18:09,262] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:18:27,060] {train_model:82} INFO - Train Epoch: 18 [36352/366120 (10%)]	lr:1.79e-04	Loss: 0.187680
[2024-03-30 13:18:33,092] {train_model:82} INFO - Train Epoch: 18 [72960/366120 (20%)]	lr:1.79e-04	Loss: 0.060966
[2024-03-30 13:18:39,087] {train_model:82} INFO - Train Epoch: 18 [109568/366120 (30%)]	lr:1.79e-04	Loss: 0.043545
[2024-03-30 13:18:45,121] {train_model:82} INFO - Train Epoch: 18 [146176/366120 (40%)]	lr:1.79e-04	Loss: 0.127226
[2024-03-30 13:18:51,220] {train_model:82} INFO - Train Epoch: 18 [182784/366120 (50%)]	lr:1.79e-04	Loss: 0.131435
[2024-03-30 13:18:57,241] {train_model:82} INFO - Train Epoch: 18 [219392/366120 (60%)]	lr:1.79e-04	Loss: 0.119302
[2024-03-30 13:19:03,249] {train_model:82} INFO - Train Epoch: 18 [256000/366120 (70%)]	lr:1.79e-04	Loss: 0.112338
[2024-03-30 13:19:09,243] {train_model:82} INFO - Train Epoch: 18 [292608/366120 (80%)]	lr:1.79e-04	Loss: 0.049501
[2024-03-30 13:19:15,236] {train_model:82} INFO - Train Epoch: 18 [329216/366120 (90%)]	lr:1.79e-04	Loss: 0.098323
[2024-03-30 13:19:21,228] {train_model:82} INFO - Train Epoch: 18 [365824/366120 (100%)]	lr:1.79e-04	Loss: 0.137225
[2024-03-30 13:19:24,773] {run_experiment:78} INFO - 
[2024-03-30 13:19:24,773] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-30 13:19:25,238] {result_logger:103} INFO - precision on Wake: 0.984
[2024-03-30 13:19:25,571] {result_logger:104} INFO - recall on Wake: 0.977
[2024-03-30 13:19:25,901] {result_logger:107} INFO - F1-score on Wake: 0.981
[2024-03-30 13:19:25,901] {result_logger:108} INFO - 
[2024-03-30 13:19:26,350] {result_logger:103} INFO - precision on Non REM: 0.970
[2024-03-30 13:19:26,675] {result_logger:104} INFO - recall on Non REM: 0.959
[2024-03-30 13:19:27,009] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2024-03-30 13:19:27,009] {result_logger:108} INFO - 
[2024-03-30 13:19:27,427] {result_logger:103} INFO - precision on REM: 0.830
[2024-03-30 13:19:27,714] {result_logger:104} INFO - recall on REM: 0.973
[2024-03-30 13:19:28,000] {result_logger:107} INFO - F1-score on REM: 0.896
[2024-03-30 13:19:28,000] {result_logger:108} INFO - 
[2024-03-30 13:19:28,069] {result_logger:111} INFO - average precision on sleep stages: 0.928
[2024-03-30 13:19:28,138] {result_logger:113} INFO - average recall on sleep stages: 0.969
[2024-03-30 13:19:28,206] {result_logger:115} INFO - average F1-score on sleep stages: 0.947
[2024-03-30 13:19:28,208] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-30 13:19:28,265] {result_logger:103} INFO - precision on Wake: 0.985
[2024-03-30 13:19:28,304] {result_logger:104} INFO - recall on Wake: 0.956
[2024-03-30 13:19:28,342] {result_logger:107} INFO - F1-score on Wake: 0.971
[2024-03-30 13:19:28,343] {result_logger:108} INFO - 
[2024-03-30 13:19:28,399] {result_logger:103} INFO - precision on Non REM: 0.958
[2024-03-30 13:19:28,438] {result_logger:104} INFO - recall on Non REM: 0.951
[2024-03-30 13:19:28,476] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2024-03-30 13:19:28,476] {result_logger:108} INFO - 
[2024-03-30 13:19:28,533] {result_logger:103} INFO - precision on REM: 0.703
[2024-03-30 13:19:28,573] {result_logger:104} INFO - recall on REM: 0.973
[2024-03-30 13:19:28,612] {result_logger:107} INFO - F1-score on REM: 0.816
[2024-03-30 13:19:28,612] {result_logger:108} INFO - 
[2024-03-30 13:19:28,619] {result_logger:111} INFO - average precision on sleep stages: 0.882
[2024-03-30 13:19:28,625] {result_logger:113} INFO - average recall on sleep stages: 0.960
[2024-03-30 13:19:28,631] {result_logger:115} INFO - average F1-score on sleep stages: 0.914
[2024-03-30 13:19:28,631] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-30 13:19:28,679] {result_logger:134} INFO - 
[[199056   3966    725]
 [  2981 137811   2975]
 [   159    346  18101]]
[2024-03-30 13:19:28,725] {result_logger:141} INFO - 
[[ 97.70%   1.95%   0.36%]
 [  2.07%  95.86%   2.07%]
 [  0.85%   1.86%  97.29%]]
[2024-03-30 13:19:28,772] {result_logger:145} INFO - 
[[ 98.45%   2.79%   3.33%]
 [  1.47%  96.97%  13.65%]
 [  0.08%   0.24%  83.03%]]
[2024-03-30 13:19:28,772] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-30 13:19:28,777] {result_logger:134} INFO - 
[[27147   816   419]
 [  392 19684   627]
 [   19    49  2477]]
[2024-03-30 13:19:28,781] {result_logger:141} INFO - 
[[ 95.65%   2.88%   1.48%]
 [  1.89%  95.08%   3.03%]
 [  0.75%   1.93%  97.33%]]
[2024-03-30 13:19:28,785] {result_logger:145} INFO - 
[[ 98.51%   3.97%  11.89%]
 [  1.42%  95.79%  17.80%]
 [  0.07%   0.24%  70.31%]]
[2024-03-30 13:19:28,836] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-30 13:19:28,836] {result_logger:77} INFO - actual:
[2024-03-30 13:19:28,836] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-03-30 13:19:28,836] {result_logger:79} INFO - predicted:
[2024-03-30 13:19:28,836] {result_logger:80} INFO - 
[[94.43%  4.68%  0.89%]
 [ 4.39% 92.50%  3.10%]
 [17.91%  7.12% 74.96%]]
[2024-03-30 13:19:28,836] {run_experiment:112} INFO - [epoch  18] execution time: 79.59s	 avg f1-score: 0.9138

[2024-03-30 13:19:28,836] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:19:28,857] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:19:46,969] {train_model:82} INFO - Train Epoch: 19 [36352/366120 (10%)]	lr:1.68e-04	Loss: 0.065616
[2024-03-30 13:19:52,909] {train_model:82} INFO - Train Epoch: 19 [72960/366120 (20%)]	lr:1.68e-04	Loss: 0.060690
[2024-03-30 13:19:58,948] {train_model:82} INFO - Train Epoch: 19 [109568/366120 (30%)]	lr:1.68e-04	Loss: 0.091882
[2024-03-30 13:20:04,997] {train_model:82} INFO - Train Epoch: 19 [146176/366120 (40%)]	lr:1.68e-04	Loss: 0.349903
[2024-03-30 13:20:11,047] {train_model:82} INFO - Train Epoch: 19 [182784/366120 (50%)]	lr:1.68e-04	Loss: 0.051184
[2024-03-30 13:20:17,101] {train_model:82} INFO - Train Epoch: 19 [219392/366120 (60%)]	lr:1.68e-04	Loss: 0.052225
[2024-03-30 13:20:23,163] {train_model:82} INFO - Train Epoch: 19 [256000/366120 (70%)]	lr:1.68e-04	Loss: 0.054360
[2024-03-30 13:20:29,240] {train_model:82} INFO - Train Epoch: 19 [292608/366120 (80%)]	lr:1.68e-04	Loss: 0.037220
[2024-03-30 13:20:35,326] {train_model:82} INFO - Train Epoch: 19 [329216/366120 (90%)]	lr:1.68e-04	Loss: 0.058625
[2024-03-30 13:20:41,408] {train_model:82} INFO - Train Epoch: 19 [365824/366120 (100%)]	lr:1.68e-04	Loss: 0.083134
[2024-03-30 13:20:44,770] {run_experiment:78} INFO - 
[2024-03-30 13:20:44,771] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-30 13:20:45,224] {result_logger:103} INFO - precision on Wake: 0.985
[2024-03-30 13:20:45,557] {result_logger:104} INFO - recall on Wake: 0.977
[2024-03-30 13:20:45,883] {result_logger:107} INFO - F1-score on Wake: 0.981
[2024-03-30 13:20:45,883] {result_logger:108} INFO - 
[2024-03-30 13:20:46,335] {result_logger:103} INFO - precision on Non REM: 0.970
[2024-03-30 13:20:46,662] {result_logger:104} INFO - recall on Non REM: 0.959
[2024-03-30 13:20:46,984] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2024-03-30 13:20:46,984] {result_logger:108} INFO - 
[2024-03-30 13:20:47,400] {result_logger:103} INFO - precision on REM: 0.831
[2024-03-30 13:20:47,687] {result_logger:104} INFO - recall on REM: 0.975
[2024-03-30 13:20:47,974] {result_logger:107} INFO - F1-score on REM: 0.897
[2024-03-30 13:20:47,974] {result_logger:108} INFO - 
[2024-03-30 13:20:48,042] {result_logger:111} INFO - average precision on sleep stages: 0.928
[2024-03-30 13:20:48,109] {result_logger:113} INFO - average recall on sleep stages: 0.970
[2024-03-30 13:20:48,176] {result_logger:115} INFO - average F1-score on sleep stages: 0.947
[2024-03-30 13:20:48,177] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-30 13:20:48,236] {result_logger:103} INFO - precision on Wake: 0.976
[2024-03-30 13:20:48,277] {result_logger:104} INFO - recall on Wake: 0.978
[2024-03-30 13:20:48,318] {result_logger:107} INFO - F1-score on Wake: 0.977
[2024-03-30 13:20:48,318] {result_logger:108} INFO - 
[2024-03-30 13:20:48,376] {result_logger:103} INFO - precision on Non REM: 0.971
[2024-03-30 13:20:48,417] {result_logger:104} INFO - recall on Non REM: 0.949
[2024-03-30 13:20:48,458] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2024-03-30 13:20:48,458] {result_logger:108} INFO - 
[2024-03-30 13:20:48,516] {result_logger:103} INFO - precision on REM: 0.828
[2024-03-30 13:20:48,557] {result_logger:104} INFO - recall on REM: 0.962
[2024-03-30 13:20:48,598] {result_logger:107} INFO - F1-score on REM: 0.890
[2024-03-30 13:20:48,598] {result_logger:108} INFO - 
[2024-03-30 13:20:48,605] {result_logger:111} INFO - average precision on sleep stages: 0.925
[2024-03-30 13:20:48,611] {result_logger:113} INFO - average recall on sleep stages: 0.963
[2024-03-30 13:20:48,617] {result_logger:115} INFO - average F1-score on sleep stages: 0.942
[2024-03-30 13:20:48,617] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-30 13:20:48,663] {result_logger:134} INFO - 
[[199078   3962    707]
 [  2974 137808   2985]
 [   145    328  18133]]
[2024-03-30 13:20:48,708] {result_logger:141} INFO - 
[[ 97.71%   1.94%   0.35%]
 [  2.07%  95.86%   2.08%]
 [  0.78%   1.76%  97.46%]]
[2024-03-30 13:20:48,753] {result_logger:145} INFO - 
[[ 98.46%   2.79%   3.24%]
 [  1.47%  96.98%  13.68%]
 [  0.07%   0.23%  83.08%]]
[2024-03-30 13:20:48,753] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-30 13:20:48,758] {result_logger:134} INFO - 
[[27761   490   131]
 [  678 19646   379]
 [    8    89  2448]]
[2024-03-30 13:20:48,814] {result_logger:141} INFO - 
[[ 97.81%   1.73%   0.46%]
 [  3.27%  94.89%   1.83%]
 [  0.31%   3.50%  96.19%]]
[2024-03-30 13:20:48,864] {result_logger:145} INFO - 
[[ 97.59%   2.42%   4.43%]
 [  2.38%  97.14%  12.81%]
 [  0.03%   0.44%  82.76%]]
[2024-03-30 13:20:49,005] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-30 13:20:49,005] {result_logger:77} INFO - actual:
[2024-03-30 13:20:49,005] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-03-30 13:20:49,005] {result_logger:79} INFO - predicted:
[2024-03-30 13:20:49,005] {result_logger:80} INFO - 
[[95.14%  4.62%  0.24%]
 [ 4.55% 92.79%  2.66%]
 [15.62%  4.90% 79.48%]]
[2024-03-30 13:20:49,056] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp005/model_8conv_2fc-best.pth
[2024-03-30 13:20:49,056] {run_experiment:112} INFO - [epoch  19] execution time: 80.22s	 avg f1-score: 0.9422

[2024-03-30 13:20:49,056] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:20:49,076] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:21:07,042] {train_model:82} INFO - Train Epoch: 20 [36352/366120 (10%)]	lr:1.58e-04	Loss: 0.137604
[2024-03-30 13:21:12,936] {train_model:82} INFO - Train Epoch: 20 [72960/366120 (20%)]	lr:1.58e-04	Loss: 0.135240
[2024-03-30 13:21:18,834] {train_model:82} INFO - Train Epoch: 20 [109568/366120 (30%)]	lr:1.58e-04	Loss: 0.045287
[2024-03-30 13:21:24,772] {train_model:82} INFO - Train Epoch: 20 [146176/366120 (40%)]	lr:1.58e-04	Loss: 0.149365
[2024-03-30 13:21:30,840] {train_model:82} INFO - Train Epoch: 20 [182784/366120 (50%)]	lr:1.58e-04	Loss: 0.096773
[2024-03-30 13:21:36,900] {train_model:82} INFO - Train Epoch: 20 [219392/366120 (60%)]	lr:1.58e-04	Loss: 0.037872
[2024-03-30 13:21:42,903] {train_model:82} INFO - Train Epoch: 20 [256000/366120 (70%)]	lr:1.58e-04	Loss: 0.058604
[2024-03-30 13:21:48,921] {train_model:82} INFO - Train Epoch: 20 [292608/366120 (80%)]	lr:1.58e-04	Loss: 0.078579
[2024-03-30 13:21:54,973] {train_model:82} INFO - Train Epoch: 20 [329216/366120 (90%)]	lr:1.58e-04	Loss: 0.106862
[2024-03-30 13:22:00,969] {train_model:82} INFO - Train Epoch: 20 [365824/366120 (100%)]	lr:1.58e-04	Loss: 0.079645
[2024-03-30 13:22:04,259] {run_experiment:78} INFO - 
[2024-03-30 13:22:04,259] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-30 13:22:04,706] {result_logger:103} INFO - precision on Wake: 0.985
[2024-03-30 13:22:05,030] {result_logger:104} INFO - recall on Wake: 0.978
[2024-03-30 13:22:05,352] {result_logger:107} INFO - F1-score on Wake: 0.982
[2024-03-30 13:22:05,352] {result_logger:108} INFO - 
[2024-03-30 13:22:05,791] {result_logger:103} INFO - precision on Non REM: 0.971
[2024-03-30 13:22:06,120] {result_logger:104} INFO - recall on Non REM: 0.961
[2024-03-30 13:22:06,450] {result_logger:107} INFO - F1-score on Non REM: 0.966
[2024-03-30 13:22:06,450] {result_logger:108} INFO - 
[2024-03-30 13:22:06,868] {result_logger:103} INFO - precision on REM: 0.845
[2024-03-30 13:22:07,156] {result_logger:104} INFO - recall on REM: 0.977
[2024-03-30 13:22:07,440] {result_logger:107} INFO - F1-score on REM: 0.907
[2024-03-30 13:22:07,440] {result_logger:108} INFO - 
[2024-03-30 13:22:07,513] {result_logger:111} INFO - average precision on sleep stages: 0.934
[2024-03-30 13:22:07,583] {result_logger:113} INFO - average recall on sleep stages: 0.972
[2024-03-30 13:22:07,653] {result_logger:115} INFO - average F1-score on sleep stages: 0.951
[2024-03-30 13:22:07,654] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-30 13:22:07,713] {result_logger:103} INFO - precision on Wake: 0.986
[2024-03-30 13:22:07,752] {result_logger:104} INFO - recall on Wake: 0.961
[2024-03-30 13:22:07,792] {result_logger:107} INFO - F1-score on Wake: 0.973
[2024-03-30 13:22:07,792] {result_logger:108} INFO - 
[2024-03-30 13:22:07,849] {result_logger:103} INFO - precision on Non REM: 0.952
[2024-03-30 13:22:07,889] {result_logger:104} INFO - recall on Non REM: 0.960
[2024-03-30 13:22:07,929] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2024-03-30 13:22:07,929] {result_logger:108} INFO - 
[2024-03-30 13:22:07,989] {result_logger:103} INFO - precision on REM: 0.800
[2024-03-30 13:22:08,030] {result_logger:104} INFO - recall on REM: 0.972
[2024-03-30 13:22:08,068] {result_logger:107} INFO - F1-score on REM: 0.878
[2024-03-30 13:22:08,069] {result_logger:108} INFO - 
[2024-03-30 13:22:08,075] {result_logger:111} INFO - average precision on sleep stages: 0.913
[2024-03-30 13:22:08,081] {result_logger:113} INFO - average recall on sleep stages: 0.964
[2024-03-30 13:22:08,087] {result_logger:115} INFO - average F1-score on sleep stages: 0.936
[2024-03-30 13:22:08,087] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-30 13:22:08,135] {result_logger:134} INFO - 
[[199313   3861    573]
 [  2836 138179   2752]
 [   130    293  18183]]
[2024-03-30 13:22:08,183] {result_logger:141} INFO - 
[[ 97.82%   1.89%   0.28%]
 [  1.97%  96.11%   1.91%]
 [  0.70%   1.57%  97.73%]]
[2024-03-30 13:22:08,230] {result_logger:145} INFO - 
[[ 98.53%   2.71%   2.66%]
 [  1.40%  97.08%  12.80%]
 [  0.06%   0.21%  84.54%]]
[2024-03-30 13:22:08,230] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-30 13:22:08,235] {result_logger:134} INFO - 
[[27279   940   163]
 [  383 19865   455]
 [    4    67  2474]]
[2024-03-30 13:22:08,239] {result_logger:141} INFO - 
[[ 96.11%   3.31%   0.57%]
 [  1.85%  95.95%   2.20%]
 [  0.16%   2.63%  97.21%]]
[2024-03-30 13:22:08,244] {result_logger:145} INFO - 
[[ 98.60%   4.50%   5.27%]
 [  1.38%  95.18%  14.72%]
 [  0.01%   0.32%  80.01%]]
[2024-03-30 13:22:08,292] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-30 13:22:08,293] {result_logger:77} INFO - actual:
[2024-03-30 13:22:08,293] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-03-30 13:22:08,293] {result_logger:79} INFO - predicted:
[2024-03-30 13:22:08,293] {result_logger:80} INFO - 
[[95.12%  4.65%  0.23%]
 [ 4.23% 92.81%  2.96%]
 [15.14%  6.95% 77.91%]]
[2024-03-30 13:22:08,293] {run_experiment:112} INFO - [epoch  20] execution time: 79.24s	 avg f1-score: 0.9356

[2024-03-30 13:22:08,293] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:22:08,313] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:22:26,330] {train_model:82} INFO - Train Epoch: 21 [36352/366120 (10%)]	lr:1.49e-04	Loss: 0.045740
[2024-03-30 13:22:32,277] {train_model:82} INFO - Train Epoch: 21 [72960/366120 (20%)]	lr:1.49e-04	Loss: 0.061556
[2024-03-30 13:22:38,240] {train_model:82} INFO - Train Epoch: 21 [109568/366120 (30%)]	lr:1.49e-04	Loss: 0.062530
[2024-03-30 13:22:44,294] {train_model:82} INFO - Train Epoch: 21 [146176/366120 (40%)]	lr:1.49e-04	Loss: 0.059253
[2024-03-30 13:22:50,350] {train_model:82} INFO - Train Epoch: 21 [182784/366120 (50%)]	lr:1.49e-04	Loss: 0.029443
[2024-03-30 13:22:56,358] {train_model:82} INFO - Train Epoch: 21 [219392/366120 (60%)]	lr:1.49e-04	Loss: 0.024304
[2024-03-30 13:23:02,353] {train_model:82} INFO - Train Epoch: 21 [256000/366120 (70%)]	lr:1.49e-04	Loss: 0.094671
[2024-03-30 13:23:08,346] {train_model:82} INFO - Train Epoch: 21 [292608/366120 (80%)]	lr:1.49e-04	Loss: 0.065219
[2024-03-30 13:23:14,411] {train_model:82} INFO - Train Epoch: 21 [329216/366120 (90%)]	lr:1.49e-04	Loss: 0.109497
[2024-03-30 13:23:20,452] {train_model:82} INFO - Train Epoch: 21 [365824/366120 (100%)]	lr:1.49e-04	Loss: 0.035292
[2024-03-30 13:23:24,295] {run_experiment:78} INFO - 
[2024-03-30 13:23:24,295] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-30 13:23:24,735] {result_logger:103} INFO - precision on Wake: 0.986
[2024-03-30 13:23:25,075] {result_logger:104} INFO - recall on Wake: 0.979
[2024-03-30 13:23:25,406] {result_logger:107} INFO - F1-score on Wake: 0.982
[2024-03-30 13:23:25,406] {result_logger:108} INFO - 
[2024-03-30 13:23:25,858] {result_logger:103} INFO - precision on Non REM: 0.971
[2024-03-30 13:23:26,186] {result_logger:104} INFO - recall on Non REM: 0.962
[2024-03-30 13:23:26,514] {result_logger:107} INFO - F1-score on Non REM: 0.967
[2024-03-30 13:23:26,514] {result_logger:108} INFO - 
[2024-03-30 13:23:26,920] {result_logger:103} INFO - precision on REM: 0.850
[2024-03-30 13:23:27,216] {result_logger:104} INFO - recall on REM: 0.980
[2024-03-30 13:23:27,506] {result_logger:107} INFO - F1-score on REM: 0.910
[2024-03-30 13:23:27,506] {result_logger:108} INFO - 
[2024-03-30 13:23:27,575] {result_logger:111} INFO - average precision on sleep stages: 0.936
[2024-03-30 13:23:27,645] {result_logger:113} INFO - average recall on sleep stages: 0.973
[2024-03-30 13:23:27,716] {result_logger:115} INFO - average F1-score on sleep stages: 0.953
[2024-03-30 13:23:27,717] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-30 13:23:27,776] {result_logger:103} INFO - precision on Wake: 0.985
[2024-03-30 13:23:27,815] {result_logger:104} INFO - recall on Wake: 0.979
[2024-03-30 13:23:27,855] {result_logger:107} INFO - F1-score on Wake: 0.982
[2024-03-30 13:23:27,855] {result_logger:108} INFO - 
[2024-03-30 13:23:27,912] {result_logger:103} INFO - precision on Non REM: 0.972
[2024-03-30 13:23:27,954] {result_logger:104} INFO - recall on Non REM: 0.955
[2024-03-30 13:23:27,994] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2024-03-30 13:23:27,994] {result_logger:108} INFO - 
[2024-03-30 13:23:28,052] {result_logger:103} INFO - precision on REM: 0.805
[2024-03-30 13:23:28,091] {result_logger:104} INFO - recall on REM: 0.977
[2024-03-30 13:23:28,130] {result_logger:107} INFO - F1-score on REM: 0.883
[2024-03-30 13:23:28,130] {result_logger:108} INFO - 
[2024-03-30 13:23:28,136] {result_logger:111} INFO - average precision on sleep stages: 0.921
[2024-03-30 13:23:28,142] {result_logger:113} INFO - average recall on sleep stages: 0.970
[2024-03-30 13:23:28,148] {result_logger:115} INFO - average F1-score on sleep stages: 0.943
[2024-03-30 13:23:28,149] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-30 13:23:28,196] {result_logger:134} INFO - 
[[199432   3793    522]
 [  2779 138295   2693]
 [   103    278  18225]]
[2024-03-30 13:23:28,243] {result_logger:141} INFO - 
[[ 97.88%   1.86%   0.26%]
 [  1.93%  96.19%   1.87%]
 [  0.55%   1.49%  97.95%]]
[2024-03-30 13:23:28,290] {result_logger:145} INFO - 
[[ 98.58%   2.66%   2.43%]
 [  1.37%  97.14%  12.56%]
 [  0.05%   0.20%  85.00%]]
[2024-03-30 13:23:28,290] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-30 13:23:28,295] {result_logger:134} INFO - 
[[27780   517    85]
 [  407 19777   519]
 [    7    51  2487]]
[2024-03-30 13:23:28,353] {result_logger:141} INFO - 
[[ 97.88%   1.82%   0.30%]
 [  1.97%  95.53%   2.51%]
 [  0.28%   2.00%  97.72%]]
[2024-03-30 13:23:28,405] {result_logger:145} INFO - 
[[ 98.53%   2.54%   2.75%]
 [  1.44%  97.21%  16.79%]
 [  0.02%   0.25%  80.46%]]
[2024-03-30 13:23:28,547] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-30 13:23:28,548] {result_logger:77} INFO - actual:
[2024-03-30 13:23:28,548] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-03-30 13:23:28,548] {result_logger:79} INFO - predicted:
[2024-03-30 13:23:28,548] {result_logger:80} INFO - 
[[95.39%  4.50%  0.11%]
 [ 4.11% 92.91%  2.98%]
 [15.01%  5.60% 79.39%]]
[2024-03-30 13:23:28,602] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp005/model_8conv_2fc-best.pth
[2024-03-30 13:23:28,602] {run_experiment:112} INFO - [epoch  21] execution time: 80.31s	 avg f1-score: 0.9427

[2024-03-30 13:23:28,602] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:23:28,622] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:23:46,718] {train_model:82} INFO - Train Epoch: 22 [36352/366120 (10%)]	lr:1.40e-04	Loss: 0.059111
[2024-03-30 13:23:52,670] {train_model:82} INFO - Train Epoch: 22 [72960/366120 (20%)]	lr:1.40e-04	Loss: 0.063692
[2024-03-30 13:23:58,603] {train_model:82} INFO - Train Epoch: 22 [109568/366120 (30%)]	lr:1.40e-04	Loss: 0.070013
[2024-03-30 13:24:04,544] {train_model:82} INFO - Train Epoch: 22 [146176/366120 (40%)]	lr:1.40e-04	Loss: 0.107561
[2024-03-30 13:24:10,491] {train_model:82} INFO - Train Epoch: 22 [182784/366120 (50%)]	lr:1.40e-04	Loss: 0.040276
[2024-03-30 13:24:16,540] {train_model:82} INFO - Train Epoch: 22 [219392/366120 (60%)]	lr:1.40e-04	Loss: 0.063862
[2024-03-30 13:24:22,535] {train_model:82} INFO - Train Epoch: 22 [256000/366120 (70%)]	lr:1.40e-04	Loss: 0.065974
[2024-03-30 13:24:28,512] {train_model:82} INFO - Train Epoch: 22 [292608/366120 (80%)]	lr:1.40e-04	Loss: 0.039102
[2024-03-30 13:24:34,489] {train_model:82} INFO - Train Epoch: 22 [329216/366120 (90%)]	lr:1.40e-04	Loss: 0.077077
[2024-03-30 13:24:40,489] {train_model:82} INFO - Train Epoch: 22 [365824/366120 (100%)]	lr:1.40e-04	Loss: 0.049081
[2024-03-30 13:24:44,120] {run_experiment:78} INFO - 
[2024-03-30 13:24:44,121] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-30 13:24:44,573] {result_logger:103} INFO - precision on Wake: 0.986
[2024-03-30 13:24:44,905] {result_logger:104} INFO - recall on Wake: 0.980
[2024-03-30 13:24:45,237] {result_logger:107} INFO - F1-score on Wake: 0.983
[2024-03-30 13:24:45,237] {result_logger:108} INFO - 
[2024-03-30 13:24:45,688] {result_logger:103} INFO - precision on Non REM: 0.973
[2024-03-30 13:24:46,008] {result_logger:104} INFO - recall on Non REM: 0.963
[2024-03-30 13:24:46,340] {result_logger:107} INFO - F1-score on Non REM: 0.968
[2024-03-30 13:24:46,340] {result_logger:108} INFO - 
[2024-03-30 13:24:46,746] {result_logger:103} INFO - precision on REM: 0.858
[2024-03-30 13:24:47,025] {result_logger:104} INFO - recall on REM: 0.979
[2024-03-30 13:24:47,310] {result_logger:107} INFO - F1-score on REM: 0.915
[2024-03-30 13:24:47,310] {result_logger:108} INFO - 
[2024-03-30 13:24:47,379] {result_logger:111} INFO - average precision on sleep stages: 0.939
[2024-03-30 13:24:47,448] {result_logger:113} INFO - average recall on sleep stages: 0.974
[2024-03-30 13:24:47,517] {result_logger:115} INFO - average F1-score on sleep stages: 0.955
[2024-03-30 13:24:47,518] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-30 13:24:47,576] {result_logger:103} INFO - precision on Wake: 0.977
[2024-03-30 13:24:47,616] {result_logger:104} INFO - recall on Wake: 0.968
[2024-03-30 13:24:47,655] {result_logger:107} INFO - F1-score on Wake: 0.973
[2024-03-30 13:24:47,655] {result_logger:108} INFO - 
[2024-03-30 13:24:47,713] {result_logger:103} INFO - precision on Non REM: 0.968
[2024-03-30 13:24:47,753] {result_logger:104} INFO - recall on Non REM: 0.951
[2024-03-30 13:24:47,793] {result_logger:107} INFO - F1-score on Non REM: 0.959
[2024-03-30 13:24:47,793] {result_logger:108} INFO - 
[2024-03-30 13:24:47,851] {result_logger:103} INFO - precision on REM: 0.776
[2024-03-30 13:24:47,890] {result_logger:104} INFO - recall on REM: 0.969
[2024-03-30 13:24:47,929] {result_logger:107} INFO - F1-score on REM: 0.861
[2024-03-30 13:24:47,929] {result_logger:108} INFO - 
[2024-03-30 13:24:47,935] {result_logger:111} INFO - average precision on sleep stages: 0.907
[2024-03-30 13:24:47,942] {result_logger:113} INFO - average recall on sleep stages: 0.962
[2024-03-30 13:24:47,948] {result_logger:115} INFO - average F1-score on sleep stages: 0.931
[2024-03-30 13:24:47,948] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-30 13:24:47,996] {result_logger:134} INFO - 
[[199656   3593    498]
 [  2763 138480   2524]
 [   103    281  18222]]
[2024-03-30 13:24:48,043] {result_logger:141} INFO - 
[[ 97.99%   1.76%   0.24%]
 [  1.92%  96.32%   1.76%]
 [  0.55%   1.51%  97.94%]]
[2024-03-30 13:24:48,090] {result_logger:145} INFO - 
[[ 98.58%   2.52%   2.34%]
 [  1.36%  97.28%  11.88%]
 [  0.05%   0.20%  85.77%]]
[2024-03-30 13:24:48,090] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-30 13:24:48,095] {result_logger:134} INFO - 
[[27482   586   314]
 [  625 19679   399]
 [    9    71  2465]]
[2024-03-30 13:24:48,099] {result_logger:141} INFO - 
[[ 96.83%   2.06%   1.11%]
 [  3.02%  95.05%   1.93%]
 [  0.35%   2.79%  96.86%]]
[2024-03-30 13:24:48,104] {result_logger:145} INFO - 
[[ 97.75%   2.88%   9.88%]
 [  2.22%  96.77%  12.56%]
 [  0.03%   0.35%  77.56%]]
[2024-03-30 13:24:48,154] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-30 13:24:48,154] {result_logger:77} INFO - actual:
[2024-03-30 13:24:48,154] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-03-30 13:24:48,154] {result_logger:79} INFO - predicted:
[2024-03-30 13:24:48,154] {result_logger:80} INFO - 
[[94.67%  4.70%  0.63%]
 [ 4.51% 92.66%  2.83%]
 [18.25%  5.41% 76.34%]]
[2024-03-30 13:24:48,154] {run_experiment:112} INFO - [epoch  22] execution time: 79.55s	 avg f1-score: 0.9311

[2024-03-30 13:24:48,155] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:24:48,175] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:25:06,402] {train_model:82} INFO - Train Epoch: 23 [36352/366120 (10%)]	lr:1.32e-04	Loss: 0.064344
[2024-03-30 13:25:12,389] {train_model:82} INFO - Train Epoch: 23 [72960/366120 (20%)]	lr:1.32e-04	Loss: 0.100579
[2024-03-30 13:25:18,407] {train_model:82} INFO - Train Epoch: 23 [109568/366120 (30%)]	lr:1.32e-04	Loss: 0.039918
[2024-03-30 13:25:24,432] {train_model:82} INFO - Train Epoch: 23 [146176/366120 (40%)]	lr:1.32e-04	Loss: 0.144066
[2024-03-30 13:25:30,387] {train_model:82} INFO - Train Epoch: 23 [182784/366120 (50%)]	lr:1.32e-04	Loss: 0.085692
[2024-03-30 13:25:36,359] {train_model:82} INFO - Train Epoch: 23 [219392/366120 (60%)]	lr:1.32e-04	Loss: 0.042400
[2024-03-30 13:25:42,343] {train_model:82} INFO - Train Epoch: 23 [256000/366120 (70%)]	lr:1.32e-04	Loss: 0.042384
[2024-03-30 13:25:48,318] {train_model:82} INFO - Train Epoch: 23 [292608/366120 (80%)]	lr:1.32e-04	Loss: 0.063039
[2024-03-30 13:25:54,297] {train_model:82} INFO - Train Epoch: 23 [329216/366120 (90%)]	lr:1.32e-04	Loss: 0.073398
[2024-03-30 13:26:00,317] {train_model:82} INFO - Train Epoch: 23 [365824/366120 (100%)]	lr:1.32e-04	Loss: 0.076281
[2024-03-30 13:26:04,001] {run_experiment:78} INFO - 
[2024-03-30 13:26:04,001] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-30 13:26:04,447] {result_logger:103} INFO - precision on Wake: 0.987
[2024-03-30 13:26:04,771] {result_logger:104} INFO - recall on Wake: 0.980
[2024-03-30 13:26:05,098] {result_logger:107} INFO - F1-score on Wake: 0.983
[2024-03-30 13:26:05,098] {result_logger:108} INFO - 
[2024-03-30 13:26:05,553] {result_logger:103} INFO - precision on Non REM: 0.972
[2024-03-30 13:26:05,873] {result_logger:104} INFO - recall on Non REM: 0.965
[2024-03-30 13:26:06,200] {result_logger:107} INFO - F1-score on Non REM: 0.969
[2024-03-30 13:26:06,200] {result_logger:108} INFO - 
[2024-03-30 13:26:06,606] {result_logger:103} INFO - precision on REM: 0.865
[2024-03-30 13:26:06,891] {result_logger:104} INFO - recall on REM: 0.980
[2024-03-30 13:26:07,180] {result_logger:107} INFO - F1-score on REM: 0.919
[2024-03-30 13:26:07,181] {result_logger:108} INFO - 
[2024-03-30 13:26:07,250] {result_logger:111} INFO - average precision on sleep stages: 0.941
[2024-03-30 13:26:07,319] {result_logger:113} INFO - average recall on sleep stages: 0.975
[2024-03-30 13:26:07,387] {result_logger:115} INFO - average F1-score on sleep stages: 0.957
[2024-03-30 13:26:07,389] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-30 13:26:07,446] {result_logger:103} INFO - precision on Wake: 0.986
[2024-03-30 13:26:07,485] {result_logger:104} INFO - recall on Wake: 0.949
[2024-03-30 13:26:07,524] {result_logger:107} INFO - F1-score on Wake: 0.967
[2024-03-30 13:26:07,525] {result_logger:108} INFO - 
[2024-03-30 13:26:07,583] {result_logger:103} INFO - precision on Non REM: 0.962
[2024-03-30 13:26:07,623] {result_logger:104} INFO - recall on Non REM: 0.966
[2024-03-30 13:26:07,664] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2024-03-30 13:26:07,664] {result_logger:108} INFO - 
[2024-03-30 13:26:07,721] {result_logger:103} INFO - precision on REM: 0.689
[2024-03-30 13:26:07,760] {result_logger:104} INFO - recall on REM: 0.960
[2024-03-30 13:26:07,800] {result_logger:107} INFO - F1-score on REM: 0.802
[2024-03-30 13:26:07,800] {result_logger:108} INFO - 
[2024-03-30 13:26:07,806] {result_logger:111} INFO - average precision on sleep stages: 0.879
[2024-03-30 13:26:07,812] {result_logger:113} INFO - average recall on sleep stages: 0.958
[2024-03-30 13:26:07,818] {result_logger:115} INFO - average F1-score on sleep stages: 0.911
[2024-03-30 13:26:07,818] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-30 13:26:07,866] {result_logger:134} INFO - 
[[199622   3659    466]
 [  2621 138762   2384]
 [   100    274  18232]]
[2024-03-30 13:26:07,913] {result_logger:141} INFO - 
[[ 97.98%   1.80%   0.23%]
 [  1.82%  96.52%   1.66%]
 [  0.54%   1.47%  97.99%]]
[2024-03-30 13:26:07,960] {result_logger:145} INFO - 
[[ 98.66%   2.56%   2.21%]
 [  1.30%  97.24%  11.31%]
 [  0.05%   0.19%  86.48%]]
[2024-03-30 13:26:07,960] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-30 13:26:07,964] {result_logger:134} INFO - 
[[26924   699   759]
 [  364 19995   344]
 [    6    97  2442]]
[2024-03-30 13:26:07,969] {result_logger:141} INFO - 
[[ 94.86%   2.46%   2.67%]
 [  1.76%  96.58%   1.66%]
 [  0.24%   3.81%  95.95%]]
[2024-03-30 13:26:07,973] {result_logger:145} INFO - 
[[ 98.64%   3.36%  21.41%]
 [  1.33%  96.17%   9.70%]
 [  0.02%   0.47%  68.89%]]
[2024-03-30 13:26:08,023] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-30 13:26:08,023] {result_logger:77} INFO - actual:
[2024-03-30 13:26:08,024] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-03-30 13:26:08,024] {result_logger:79} INFO - predicted:
[2024-03-30 13:26:08,024] {result_logger:80} INFO - 
[[93.92%  4.65%  1.43%]
 [ 4.29% 93.07%  2.64%]
 [21.66%  4.82% 73.51%]]
[2024-03-30 13:26:08,024] {run_experiment:112} INFO - [epoch  23] execution time: 79.87s	 avg f1-score: 0.9110

[2024-03-30 13:26:08,024] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:26:08,045] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:26:32,261] {train_model:82} INFO - Train Epoch: 24 [36352/366120 (10%)]	lr:1.25e-04	Loss: 0.067092
[2024-03-30 13:26:38,187] {train_model:82} INFO - Train Epoch: 24 [72960/366120 (20%)]	lr:1.25e-04	Loss: 0.052761
[2024-03-30 13:26:44,139] {train_model:82} INFO - Train Epoch: 24 [109568/366120 (30%)]	lr:1.25e-04	Loss: 0.137257
[2024-03-30 13:26:50,092] {train_model:82} INFO - Train Epoch: 24 [146176/366120 (40%)]	lr:1.25e-04	Loss: 0.102704
[2024-03-30 13:26:56,055] {train_model:82} INFO - Train Epoch: 24 [182784/366120 (50%)]	lr:1.25e-04	Loss: 0.066290
[2024-03-30 13:27:02,022] {train_model:82} INFO - Train Epoch: 24 [219392/366120 (60%)]	lr:1.25e-04	Loss: 0.050105
[2024-03-30 13:27:07,999] {train_model:82} INFO - Train Epoch: 24 [256000/366120 (70%)]	lr:1.25e-04	Loss: 0.051678
[2024-03-30 13:27:13,970] {train_model:82} INFO - Train Epoch: 24 [292608/366120 (80%)]	lr:1.25e-04	Loss: 0.061364
[2024-03-30 13:27:20,052] {train_model:82} INFO - Train Epoch: 24 [329216/366120 (90%)]	lr:1.25e-04	Loss: 0.058336
[2024-03-30 13:27:26,107] {train_model:82} INFO - Train Epoch: 24 [365824/366120 (100%)]	lr:1.25e-04	Loss: 0.061294
[2024-03-30 13:27:29,756] {run_experiment:78} INFO - 
[2024-03-30 13:27:29,756] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-30 13:27:30,210] {result_logger:103} INFO - precision on Wake: 0.987
[2024-03-30 13:27:30,536] {result_logger:104} INFO - recall on Wake: 0.981
[2024-03-30 13:27:30,862] {result_logger:107} INFO - F1-score on Wake: 0.984
[2024-03-30 13:27:30,862] {result_logger:108} INFO - 
[2024-03-30 13:27:31,308] {result_logger:103} INFO - precision on Non REM: 0.975
[2024-03-30 13:27:31,635] {result_logger:104} INFO - recall on Non REM: 0.967
[2024-03-30 13:27:31,967] {result_logger:107} INFO - F1-score on Non REM: 0.971
[2024-03-30 13:27:31,967] {result_logger:108} INFO - 
[2024-03-30 13:27:32,373] {result_logger:103} INFO - precision on REM: 0.875
[2024-03-30 13:27:32,666] {result_logger:104} INFO - recall on REM: 0.982
[2024-03-30 13:27:32,955] {result_logger:107} INFO - F1-score on REM: 0.925
[2024-03-30 13:27:32,955] {result_logger:108} INFO - 
[2024-03-30 13:27:33,021] {result_logger:111} INFO - average precision on sleep stages: 0.945
[2024-03-30 13:27:33,087] {result_logger:113} INFO - average recall on sleep stages: 0.977
[2024-03-30 13:27:33,154] {result_logger:115} INFO - average F1-score on sleep stages: 0.960
[2024-03-30 13:27:33,155] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-30 13:27:33,215] {result_logger:103} INFO - precision on Wake: 0.977
[2024-03-30 13:27:33,255] {result_logger:104} INFO - recall on Wake: 0.981
[2024-03-30 13:27:33,296] {result_logger:107} INFO - F1-score on Wake: 0.979
[2024-03-30 13:27:33,296] {result_logger:108} INFO - 
[2024-03-30 13:27:33,355] {result_logger:103} INFO - precision on Non REM: 0.975
[2024-03-30 13:27:33,396] {result_logger:104} INFO - recall on Non REM: 0.947
[2024-03-30 13:27:33,437] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2024-03-30 13:27:33,437] {result_logger:108} INFO - 
[2024-03-30 13:27:33,495] {result_logger:103} INFO - precision on REM: 0.816
[2024-03-30 13:27:33,535] {result_logger:104} INFO - recall on REM: 0.969
[2024-03-30 13:27:33,575] {result_logger:107} INFO - F1-score on REM: 0.886
[2024-03-30 13:27:33,575] {result_logger:108} INFO - 
[2024-03-30 13:27:33,581] {result_logger:111} INFO - average precision on sleep stages: 0.923
[2024-03-30 13:27:33,587] {result_logger:113} INFO - average recall on sleep stages: 0.966
[2024-03-30 13:27:33,593] {result_logger:115} INFO - average F1-score on sleep stages: 0.942
[2024-03-30 13:27:33,594] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-30 13:27:33,640] {result_logger:134} INFO - 
[[199971   3369    407]
 [  2590 138975   2202]
 [    91    245  18270]]
[2024-03-30 13:27:33,685] {result_logger:141} INFO - 
[[ 98.15%   1.65%   0.20%]
 [  1.80%  96.67%   1.53%]
 [  0.49%   1.32%  98.19%]]
[2024-03-30 13:27:33,731] {result_logger:145} INFO - 
[[ 98.68%   2.36%   1.95%]
 [  1.28%  97.47%  10.55%]
 [  0.04%   0.17%  87.50%]]
[2024-03-30 13:27:33,731] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-30 13:27:33,735] {result_logger:134} INFO - 
[[27851   446    85]
 [  632 19598   473]
 [   18    60  2467]]
[2024-03-30 13:27:33,740] {result_logger:141} INFO - 
[[ 98.13%   1.57%   0.30%]
 [  3.05%  94.66%   2.28%]
 [  0.71%   2.36%  96.94%]]
[2024-03-30 13:27:33,745] {result_logger:145} INFO - 
[[ 97.72%   2.22%   2.81%]
 [  2.22%  97.48%  15.64%]
 [  0.06%   0.30%  81.55%]]
[2024-03-30 13:27:33,795] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-30 13:27:33,795] {result_logger:77} INFO - actual:
[2024-03-30 13:27:33,795] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-03-30 13:27:33,795] {result_logger:79} INFO - predicted:
[2024-03-30 13:27:33,795] {result_logger:80} INFO - 
[[95.13%  4.73%  0.14%]
 [ 4.60% 92.46%  2.93%]
 [15.27%  5.55% 79.17%]]
[2024-03-30 13:27:33,795] {run_experiment:112} INFO - [epoch  24] execution time: 85.77s	 avg f1-score: 0.9419

[2024-03-30 13:27:33,796] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:27:33,818] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:27:51,740] {train_model:82} INFO - Train Epoch: 25 [36352/366120 (10%)]	lr:1.17e-04	Loss: 0.041026
[2024-03-30 13:27:57,676] {train_model:82} INFO - Train Epoch: 25 [72960/366120 (20%)]	lr:1.17e-04	Loss: 0.055222
[2024-03-30 13:28:03,632] {train_model:82} INFO - Train Epoch: 25 [109568/366120 (30%)]	lr:1.17e-04	Loss: 0.044345
[2024-03-30 13:28:09,561] {train_model:82} INFO - Train Epoch: 25 [146176/366120 (40%)]	lr:1.17e-04	Loss: 0.059703
[2024-03-30 13:28:15,527] {train_model:82} INFO - Train Epoch: 25 [182784/366120 (50%)]	lr:1.17e-04	Loss: 0.030868
[2024-03-30 13:28:21,475] {train_model:82} INFO - Train Epoch: 25 [219392/366120 (60%)]	lr:1.17e-04	Loss: 0.069397
[2024-03-30 13:28:27,430] {train_model:82} INFO - Train Epoch: 25 [256000/366120 (70%)]	lr:1.17e-04	Loss: 0.035447
[2024-03-30 13:28:33,391] {train_model:82} INFO - Train Epoch: 25 [292608/366120 (80%)]	lr:1.17e-04	Loss: 0.038109
[2024-03-30 13:28:39,356] {train_model:82} INFO - Train Epoch: 25 [329216/366120 (90%)]	lr:1.17e-04	Loss: 0.054683
[2024-03-30 13:28:45,364] {train_model:82} INFO - Train Epoch: 25 [365824/366120 (100%)]	lr:1.17e-04	Loss: 0.030090
[2024-03-30 13:28:48,671] {run_experiment:78} INFO - 
[2024-03-30 13:28:48,671] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-30 13:28:49,125] {result_logger:103} INFO - precision on Wake: 0.987
[2024-03-30 13:28:49,448] {result_logger:104} INFO - recall on Wake: 0.982
[2024-03-30 13:28:49,776] {result_logger:107} INFO - F1-score on Wake: 0.985
[2024-03-30 13:28:49,776] {result_logger:108} INFO - 
[2024-03-30 13:28:50,233] {result_logger:103} INFO - precision on Non REM: 0.975
[2024-03-30 13:28:50,554] {result_logger:104} INFO - recall on Non REM: 0.968
[2024-03-30 13:28:50,873] {result_logger:107} INFO - F1-score on Non REM: 0.972
[2024-03-30 13:28:50,873] {result_logger:108} INFO - 
[2024-03-30 13:28:51,273] {result_logger:103} INFO - precision on REM: 0.879
[2024-03-30 13:28:51,551] {result_logger:104} INFO - recall on REM: 0.985
[2024-03-30 13:28:51,832] {result_logger:107} INFO - F1-score on REM: 0.929
[2024-03-30 13:28:51,832] {result_logger:108} INFO - 
[2024-03-30 13:28:51,898] {result_logger:111} INFO - average precision on sleep stages: 0.947
[2024-03-30 13:28:51,966] {result_logger:113} INFO - average recall on sleep stages: 0.978
[2024-03-30 13:28:52,032] {result_logger:115} INFO - average F1-score on sleep stages: 0.962
[2024-03-30 13:28:52,033] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-30 13:28:52,091] {result_logger:103} INFO - precision on Wake: 0.980
[2024-03-30 13:28:52,130] {result_logger:104} INFO - recall on Wake: 0.973
[2024-03-30 13:28:52,170] {result_logger:107} INFO - F1-score on Wake: 0.976
[2024-03-30 13:28:52,171] {result_logger:108} INFO - 
[2024-03-30 13:28:52,229] {result_logger:103} INFO - precision on Non REM: 0.969
[2024-03-30 13:28:52,270] {result_logger:104} INFO - recall on Non REM: 0.951
[2024-03-30 13:28:52,310] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2024-03-30 13:28:52,311] {result_logger:108} INFO - 
[2024-03-30 13:28:52,368] {result_logger:103} INFO - precision on REM: 0.783
[2024-03-30 13:28:52,407] {result_logger:104} INFO - recall on REM: 0.961
[2024-03-30 13:28:52,447] {result_logger:107} INFO - F1-score on REM: 0.863
[2024-03-30 13:28:52,447] {result_logger:108} INFO - 
[2024-03-30 13:28:52,453] {result_logger:111} INFO - average precision on sleep stages: 0.911
[2024-03-30 13:28:52,459] {result_logger:113} INFO - average recall on sleep stages: 0.962
[2024-03-30 13:28:52,465] {result_logger:115} INFO - average F1-score on sleep stages: 0.933
[2024-03-30 13:28:52,466] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-30 13:28:52,511] {result_logger:134} INFO - 
[[200074   3293    380]
 [  2472 139164   2131]
 [    67    218  18321]]
[2024-03-30 13:28:52,557] {result_logger:141} INFO - 
[[ 98.20%   1.62%   0.19%]
 [  1.72%  96.80%   1.48%]
 [  0.36%   1.17%  98.47%]]
[2024-03-30 13:28:52,604] {result_logger:145} INFO - 
[[ 98.75%   2.31%   1.82%]
 [  1.22%  97.54%  10.23%]
 [  0.03%   0.15%  87.95%]]
[2024-03-30 13:28:52,604] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-30 13:28:52,608] {result_logger:134} INFO - 
[[27614   527   241]
 [  570 19696   437]
 [    7    93  2445]]
[2024-03-30 13:28:52,613] {result_logger:141} INFO - 
[[ 97.29%   1.86%   0.85%]
 [  2.75%  95.14%   2.11%]
 [  0.28%   3.65%  96.07%]]
[2024-03-30 13:28:52,617] {result_logger:145} INFO - 
[[ 97.95%   2.59%   7.72%]
 [  2.02%  96.95%  13.99%]
 [  0.02%   0.46%  78.29%]]
[2024-03-30 13:28:52,668] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-30 13:28:52,668] {result_logger:77} INFO - actual:
[2024-03-30 13:28:52,668] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-03-30 13:28:52,668] {result_logger:79} INFO - predicted:
[2024-03-30 13:28:52,668] {result_logger:80} INFO - 
[[94.68%  4.79%  0.53%]
 [ 4.60% 92.48%  2.92%]
 [18.09%  5.67% 76.24%]]
[2024-03-30 13:28:52,668] {run_experiment:112} INFO - [epoch  25] execution time: 78.87s	 avg f1-score: 0.9331

[2024-03-30 13:28:52,668] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:28:52,689] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:29:12,928] {train_model:82} INFO - Train Epoch: 26 [36352/366120 (10%)]	lr:1.11e-04	Loss: 0.028411
[2024-03-30 13:29:18,908] {train_model:82} INFO - Train Epoch: 26 [72960/366120 (20%)]	lr:1.11e-04	Loss: 0.020960
[2024-03-30 13:29:24,864] {train_model:82} INFO - Train Epoch: 26 [109568/366120 (30%)]	lr:1.11e-04	Loss: 0.060088
[2024-03-30 13:29:30,845] {train_model:82} INFO - Train Epoch: 26 [146176/366120 (40%)]	lr:1.11e-04	Loss: 0.087379
[2024-03-30 13:29:36,806] {train_model:82} INFO - Train Epoch: 26 [182784/366120 (50%)]	lr:1.11e-04	Loss: 0.064783
[2024-03-30 13:29:42,845] {train_model:82} INFO - Train Epoch: 26 [219392/366120 (60%)]	lr:1.11e-04	Loss: 0.047323
[2024-03-30 13:29:48,930] {train_model:82} INFO - Train Epoch: 26 [256000/366120 (70%)]	lr:1.11e-04	Loss: 0.051883
[2024-03-30 13:29:54,947] {train_model:82} INFO - Train Epoch: 26 [292608/366120 (80%)]	lr:1.11e-04	Loss: 0.040499
[2024-03-30 13:30:00,946] {train_model:82} INFO - Train Epoch: 26 [329216/366120 (90%)]	lr:1.11e-04	Loss: 0.055986
[2024-03-30 13:30:06,995] {train_model:82} INFO - Train Epoch: 26 [365824/366120 (100%)]	lr:1.11e-04	Loss: 0.095800
[2024-03-30 13:30:10,448] {run_experiment:78} INFO - 
[2024-03-30 13:30:10,449] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-30 13:30:10,892] {result_logger:103} INFO - precision on Wake: 0.988
[2024-03-30 13:30:11,217] {result_logger:104} INFO - recall on Wake: 0.982
[2024-03-30 13:30:11,544] {result_logger:107} INFO - F1-score on Wake: 0.985
[2024-03-30 13:30:11,544] {result_logger:108} INFO - 
[2024-03-30 13:30:11,995] {result_logger:103} INFO - precision on Non REM: 0.976
[2024-03-30 13:30:12,322] {result_logger:104} INFO - recall on Non REM: 0.970
[2024-03-30 13:30:12,648] {result_logger:107} INFO - F1-score on Non REM: 0.973
[2024-03-30 13:30:12,648] {result_logger:108} INFO - 
[2024-03-30 13:30:13,061] {result_logger:103} INFO - precision on REM: 0.889
[2024-03-30 13:30:13,348] {result_logger:104} INFO - recall on REM: 0.986
[2024-03-30 13:30:13,635] {result_logger:107} INFO - F1-score on REM: 0.935
[2024-03-30 13:30:13,635] {result_logger:108} INFO - 
[2024-03-30 13:30:13,703] {result_logger:111} INFO - average precision on sleep stages: 0.951
[2024-03-30 13:30:13,770] {result_logger:113} INFO - average recall on sleep stages: 0.979
[2024-03-30 13:30:13,838] {result_logger:115} INFO - average F1-score on sleep stages: 0.964
[2024-03-30 13:30:13,839] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-30 13:30:13,896] {result_logger:103} INFO - precision on Wake: 0.983
[2024-03-30 13:30:13,934] {result_logger:104} INFO - recall on Wake: 0.972
[2024-03-30 13:30:13,973] {result_logger:107} INFO - F1-score on Wake: 0.977
[2024-03-30 13:30:13,973] {result_logger:108} INFO - 
[2024-03-30 13:30:14,029] {result_logger:103} INFO - precision on Non REM: 0.964
[2024-03-30 13:30:14,068] {result_logger:104} INFO - recall on Non REM: 0.956
[2024-03-30 13:30:14,109] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2024-03-30 13:30:14,109] {result_logger:108} INFO - 
[2024-03-30 13:30:14,166] {result_logger:103} INFO - precision on REM: 0.812
[2024-03-30 13:30:14,205] {result_logger:104} INFO - recall on REM: 0.965
[2024-03-30 13:30:14,244] {result_logger:107} INFO - F1-score on REM: 0.882
[2024-03-30 13:30:14,244] {result_logger:108} INFO - 
[2024-03-30 13:30:14,250] {result_logger:111} INFO - average precision on sleep stages: 0.920
[2024-03-30 13:30:14,256] {result_logger:113} INFO - average recall on sleep stages: 0.964
[2024-03-30 13:30:14,262] {result_logger:115} INFO - average F1-score on sleep stages: 0.940
[2024-03-30 13:30:14,262] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-30 13:30:14,308] {result_logger:134} INFO - 
[[200096   3260    391]
 [  2342 139518   1907]
 [    71    195  18340]]
[2024-03-30 13:30:14,354] {result_logger:141} INFO - 
[[ 98.21%   1.60%   0.19%]
 [  1.63%  97.04%   1.33%]
 [  0.38%   1.05%  98.57%]]
[2024-03-30 13:30:14,399] {result_logger:145} INFO - 
[[ 98.81%   2.28%   1.89%]
 [  1.16%  97.58%   9.24%]
 [  0.04%   0.14%  88.87%]]
[2024-03-30 13:30:14,400] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-30 13:30:14,404] {result_logger:134} INFO - 
[[27584   662   136]
 [  473 19796   434]
 [   15    73  2457]]
[2024-03-30 13:30:14,408] {result_logger:141} INFO - 
[[ 97.19%   2.33%   0.48%]
 [  2.28%  95.62%   2.10%]
 [  0.59%   2.87%  96.54%]]
[2024-03-30 13:30:14,413] {result_logger:145} INFO - 
[[ 98.26%   3.22%   4.49%]
 [  1.68%  96.42%  14.34%]
 [  0.05%   0.36%  81.17%]]
[2024-03-30 13:30:14,463] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-30 13:30:14,463] {result_logger:77} INFO - actual:
[2024-03-30 13:30:14,463] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-03-30 13:30:14,463] {result_logger:79} INFO - predicted:
[2024-03-30 13:30:14,464] {result_logger:80} INFO - 
[[94.91%  4.76%  0.33%]
 [ 4.50% 92.65%  2.85%]
 [16.65%  5.78% 77.57%]]
[2024-03-30 13:30:14,464] {run_experiment:112} INFO - [epoch  26] execution time: 81.80s	 avg f1-score: 0.9398

[2024-03-30 13:30:14,464] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:30:14,485] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-03-30 13:30:32,698] {train_model:82} INFO - Train Epoch: 27 [36352/366120 (10%)]	lr:1.04e-04	Loss: 0.040527
[2024-03-30 13:30:38,746] {train_model:82} INFO - Train Epoch: 27 [72960/366120 (20%)]	lr:1.04e-04	Loss: 0.041560
[2024-03-30 13:30:44,754] {train_model:82} INFO - Train Epoch: 27 [109568/366120 (30%)]	lr:1.04e-04	Loss: 0.049174
[2024-03-30 13:30:50,730] {train_model:82} INFO - Train Epoch: 27 [146176/366120 (40%)]	lr:1.04e-04	Loss: 0.050868
[2024-03-30 13:30:56,784] {train_model:82} INFO - Train Epoch: 27 [182784/366120 (50%)]	lr:1.04e-04	Loss: 0.035528
[2024-03-30 13:31:02,888] {train_model:82} INFO - Train Epoch: 27 [219392/366120 (60%)]	lr:1.04e-04	Loss: 0.034227
[2024-03-30 13:31:08,932] {train_model:82} INFO - Train Epoch: 27 [256000/366120 (70%)]	lr:1.04e-04	Loss: 0.099353
[2024-03-30 13:31:15,010] {train_model:82} INFO - Train Epoch: 27 [292608/366120 (80%)]	lr:1.04e-04	Loss: 0.024484
[2024-03-30 13:31:21,086] {train_model:82} INFO - Train Epoch: 27 [329216/366120 (90%)]	lr:1.04e-04	Loss: 0.051803
[2024-03-30 13:31:27,224] {train_model:82} INFO - Train Epoch: 27 [365824/366120 (100%)]	lr:1.04e-04	Loss: 0.045616
[2024-03-30 13:31:30,864] {run_experiment:78} INFO - 
[2024-03-30 13:31:30,864] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-30 13:31:31,318] {result_logger:103} INFO - precision on Wake: 0.988
[2024-03-30 13:31:31,643] {result_logger:104} INFO - recall on Wake: 0.983
[2024-03-30 13:31:31,971] {result_logger:107} INFO - F1-score on Wake: 0.985
[2024-03-30 13:31:31,971] {result_logger:108} INFO - 
[2024-03-30 13:31:32,420] {result_logger:103} INFO - precision on Non REM: 0.976
[2024-03-30 13:31:32,741] {result_logger:104} INFO - recall on Non REM: 0.972
[2024-03-30 13:31:33,062] {result_logger:107} INFO - F1-score on Non REM: 0.974
[2024-03-30 13:31:33,062] {result_logger:108} INFO - 
[2024-03-30 13:31:33,480] {result_logger:103} INFO - precision on REM: 0.897
[2024-03-30 13:31:33,769] {result_logger:104} INFO - recall on REM: 0.987
[2024-03-30 13:31:34,056] {result_logger:107} INFO - F1-score on REM: 0.940
[2024-03-30 13:31:34,056] {result_logger:108} INFO - 
[2024-03-30 13:31:34,127] {result_logger:111} INFO - average precision on sleep stages: 0.954
[2024-03-30 13:31:34,194] {result_logger:113} INFO - average recall on sleep stages: 0.980
[2024-03-30 13:31:34,264] {result_logger:115} INFO - average F1-score on sleep stages: 0.966
[2024-03-30 13:31:34,266] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-30 13:31:34,329] {result_logger:103} INFO - precision on Wake: 0.980
[2024-03-30 13:31:34,372] {result_logger:104} INFO - recall on Wake: 0.968
[2024-03-30 13:31:34,412] {result_logger:107} INFO - F1-score on Wake: 0.974
[2024-03-30 13:31:34,412] {result_logger:108} INFO - 
[2024-03-30 13:31:34,472] {result_logger:103} INFO - precision on Non REM: 0.966
[2024-03-30 13:31:34,513] {result_logger:104} INFO - recall on Non REM: 0.956
[2024-03-30 13:31:34,556] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2024-03-30 13:31:34,556] {result_logger:108} INFO - 
[2024-03-30 13:31:34,617] {result_logger:103} INFO - precision on REM: 0.786
[2024-03-30 13:31:34,656] {result_logger:104} INFO - recall on REM: 0.961
[2024-03-30 13:31:34,696] {result_logger:107} INFO - F1-score on REM: 0.865
[2024-03-30 13:31:34,697] {result_logger:108} INFO - 
[2024-03-30 13:31:34,703] {result_logger:111} INFO - average precision on sleep stages: 0.911
[2024-03-30 13:31:34,709] {result_logger:113} INFO - average recall on sleep stages: 0.962
[2024-03-30 13:31:34,715] {result_logger:115} INFO - average F1-score on sleep stages: 0.933
[2024-03-30 13:31:34,715] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-30 13:31:34,763] {result_logger:134} INFO - 
[[200189   3232    326]
 [  2304 139672   1791]
 [    60    174  18372]]
[2024-03-30 13:31:34,810] {result_logger:141} INFO - 
[[ 98.25%   1.59%   0.16%]
 [  1.60%  97.15%   1.25%]
 [  0.32%   0.94%  98.74%]]
[2024-03-30 13:31:34,856] {result_logger:145} INFO - 
[[ 98.83%   2.26%   1.59%]
 [  1.14%  97.62%   8.74%]
 [  0.03%   0.12%  89.67%]]
[2024-03-30 13:31:34,856] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-30 13:31:34,861] {result_logger:134} INFO - 
[[27477   614   291]
 [  536 19791   376]
 [   11    87  2447]]
[2024-03-30 13:31:34,865] {result_logger:141} INFO - 
[[ 96.81%   2.16%   1.03%]
 [  2.59%  95.59%   1.82%]
 [  0.43%   3.42%  96.15%]]
[2024-03-30 13:31:34,869] {result_logger:145} INFO - 
[[ 98.05%   3.00%   9.34%]
 [  1.91%  96.58%  12.07%]
 [  0.04%   0.42%  78.58%]]
[2024-03-30 13:31:34,920] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-30 13:31:34,920] {result_logger:77} INFO - actual:
[2024-03-30 13:31:34,920] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-03-30 13:31:34,920] {result_logger:79} INFO - predicted:
[2024-03-30 13:31:34,920] {result_logger:80} INFO - 
[[94.58%  4.77%  0.65%]
 [ 4.62% 92.67%  2.71%]
 [18.37%  5.30% 76.33%]]
[2024-03-30 13:31:34,920] {run_experiment:112} INFO - [epoch  27] execution time: 80.46s	 avg f1-score: 0.9333

[2024-03-30 13:31:35,038] {result_logger:56} INFO - final F1-scores on train:
	Wake                : [0.5700051587324589, 0.7728389352122639, 0.8391710221806173, 0.8886719094054735, 0.9240722373541836, 0.944112973345726, 0.953238440368115, 0.9584627667115175, 0.9631653054078686, 0.96815939617259, 0.9705633033554029, 0.9719120553359684, 0.973941553039, 0.9764324047036541, 0.9780510170878649, 0.9786613024099712, 0.9801625904135196, 0.9807091143337859, 0.980815087795361, 0.9817745661607877, 0.9822760619709846, 0.9828758778050996, 0.9831416681031298, 0.9841116735031337, 0.9847130623092825, 0.9850734512228743, 0.9854245631306916]
	Non REM             : [0.6041065503839227, 0.8152005210498601, 0.8503112806728518, 0.874139485972359, 0.9041963198600655, 0.9231490517352152, 0.9307369582062256, 0.9369407769466465, 0.941559236649233, 0.94691284967453, 0.9501142528703406, 0.951715094161001, 0.9548054058408015, 0.9574623050472368, 0.9598479731503224, 0.9609128497170082, 0.9625378997416164, 0.9640840882857042, 0.9641474122400433, 0.9659489688919958, 0.9666483768037939, 0.9679820775126606, 0.9687986539226844, 0.9706449314838872, 0.9716731484907939, 0.9731324544883866, 0.9738499886698391]
	REM                 : [0.1573512379625655, 0.3810175378583551, 0.4928806133625411, 0.6308879661088042, 0.72854544198577, 0.7608779535601607, 0.7744896344358284, 0.7905971236118696, 0.8047318323265604, 0.8245814751686941, 0.8412138988102279, 0.8421999668537065, 0.8576093742496279, 0.8720924586024378, 0.8805133103127372, 0.8860946018959674, 0.8921044198486454, 0.8959338728438142, 0.8969849867675794, 0.9065662860846587, 0.9102032662438196, 0.9145294855708909, 0.9187663777464221, 0.9254147144485249, 0.929103909934581, 0.9346651717459994, 0.9398644327919172]
	avg                 : [0.443820982359649, 0.656352331373493, 0.7274543054053367, 0.7978997871622121, 0.852271333066673, 0.876046659547034, 0.8861550110033897, 0.895333555756678, 0.9031521247945541, 0.9132179070052713, 0.9206304850119905, 0.9219423721168919, 0.9287854443764765, 0.9353290561177762, 0.9394707668503082, 0.9418895846743155, 0.9449349700012605, 0.9469090251544348, 0.947315828934328, 0.9514299403791474, 0.9530425683395327, 0.9551291469628836, 0.956902233257412, 0.9600571064785153, 0.9618300402448857, 0.96429035915242, 0.9663796615308161]
[2024-03-30 13:31:35,038] {result_logger:56} INFO - final F1-scores on valid:
	Wake                : [0.6871665930481465, 0.6483247276975841, 0.810681596577863, 0.7842499386201817, 0.8334694390351154, 0.9369654843435893, 0.9592573673178206, 0.9492803789396975, 0.9281105485386317, 0.9658229163059664, 0.9754559943332743, 0.9668830492588607, 0.9643183267000912, 0.9773081832364203, 0.9601994511506108, 0.976338465885012, 0.9762149516146185, 0.9705756167322132, 0.9770011789755231, 0.9734156437339424, 0.98204185520362, 0.9728485964104924, 0.9671671815503988, 0.9792380851924125, 0.9762254078800842, 0.9772203918234315, 0.9742580576534411]
	Non REM             : [0.5081620205934058, 0.7128825299494692, 0.6704798032184452, 0.6185983381335451, 0.6980079184462387, 0.8784265715654442, 0.9329962706179762, 0.942562519901046, 0.9417934188289094, 0.9344858268717428, 0.9507337269408854, 0.9373185570393557, 0.9361907421984105, 0.9543493626459333, 0.9475871510291888, 0.9502040013763948, 0.9563737172316521, 0.9543294870551731, 0.9600273651290071, 0.9556223692122671, 0.963603586045605, 0.9590389629376934, 0.963753795729503, 0.9605214791579876, 0.960335454301665, 0.9601784934762575, 0.9608447627139216]
	REM                 : [0.2642057488653555, 0.31173169428113306, 0.6636317653009611, 0.5506658211794546, 0.6082323165045957, 0.7089295935890096, 0.7634638922888617, 0.6665782845021875, 0.6046903187011425, 0.811091292362575, 0.8367107687154581, 0.8281120503895242, 0.8502398903358465, 0.8559161944015112, 0.7598848659294047, 0.8411309323460113, 0.8659902029391183, 0.8164139749505603, 0.8896965291659096, 0.8777718644669151, 0.8825408090844571, 0.8614363096278176, 0.8019704433497536, 0.8858168761220825, 0.8627381792519407, 0.8819095477386936, 0.8648171054956705]
	avg                 : [0.48651145416896924, 0.5576463173093954, 0.714931055032423, 0.6511713659777271, 0.7132365579953165, 0.8414405498326811, 0.8852391767415528, 0.8528070611143104, 0.8248647620228945, 0.9038000118467613, 0.9209668299965393, 0.9107712188959135, 0.9169163197447827, 0.9291912467612882, 0.8892238227030681, 0.9225577998691393, 0.9328596239284629, 0.9137730262459822, 0.9422416910901465, 0.9356032924710416, 0.9427287501112275, 0.9311079563253344, 0.9109638068765519, 0.9418588134908276, 0.9330996804778966, 0.9397694776794608, 0.9333066419543443]
[2024-03-30 13:31:35,088] {logger:50} INFO - 
[2024-03-30 13:31:35,088] {logger:51} INFO - ================================================================================
[2024-03-30 13:31:35,088] {logger:52} INFO - finished training
[2024-03-30 13:31:35,088] {logger:53} INFO - ================================================================================
[2024-03-30 13:31:35,088] {logger:54} INFO - 
[2024-03-30 13:31:35,088] {logger:50} INFO - 
[2024-03-30 13:31:35,088] {logger:51} INFO - ================================================================================
[2024-03-30 13:31:35,088] {logger:52} INFO - best model on epoch: 21 	f1-score: 0.9427
[2024-03-30 13:31:35,088] {logger:53} INFO - ================================================================================
[2024-03-30 13:31:35,088] {logger:54} INFO - 
