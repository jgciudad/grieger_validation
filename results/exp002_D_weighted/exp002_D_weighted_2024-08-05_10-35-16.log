[2024-08-05 10:35:16,116] {logger:43} INFO - run_experiment.py, args: Namespace(experiment='exp002_D_weighted')
================================================================================
[2024-08-05 10:35:16,116] {logger:44} INFO - config:
[2024-08-05 10:35:16,116] {logger:45} INFO - parameter name      | parameter value
[2024-08-05 10:35:16,116] {logger:46} INFO - experiment          : exp002_D_weighted
[2024-08-05 10:35:16,116] {logger:46} INFO - RUN_NAME            : exp002_D_weighted_2024-08-05_10-35-16
[2024-08-05 10:35:16,116] {logger:46} INFO - DEVICE              : cuda
[2024-08-05 10:35:16,116] {logger:46} INFO - EXPERIMENT_DIR      : /home/s202283/code/grieger_validation/results/exp002_D_weighted
[2024-08-05 10:35:16,116] {logger:46} INFO - MODELS_DIR          : /home/s202283/code/grieger_validation/results/exp002_D_weighted/models
[2024-08-05 10:35:16,116] {logger:46} INFO - VISUALS_DIR         : /home/s202283/code/grieger_validation/results/exp002_D_weighted/visuals/exp002_D_weighted_2024-08-05_10-35-16
[2024-08-05 10:35:16,116] {logger:46} INFO - DATA_DIR            : /scratch/s202283/data/mice-data-tuebingen/data
[2024-08-05 10:35:16,116] {logger:46} INFO - SAMPLE_DURATION     : 10
[2024-08-05 10:35:16,116] {logger:46} INFO - SAMPLING_RATE       : 64
[2024-08-05 10:35:16,116] {logger:46} INFO - SCORING_MAP         : {'Wake': [1, 17], 'REM': [3, 19], 'Non REM': [2, 18], 'Pre REM': [4, 20], 'Artifact': [8, 24]}
[2024-08-05 10:35:16,116] {logger:46} INFO - STAGE_MAP           : {'Wake': 'Wake', 'REM': 'REM', 'Non REM': 'Non REM', 'Pre REM': 'Non REM', 'Artifact': None}
[2024-08-05 10:35:16,117] {logger:46} INFO - DATA_SPLIT          : {'train': ['M19', 'M20', 'M21', 'M22', 'M23', 'M24', 'M25', 'M26', 'M27', 'M28', 'M29', 'M31', 'M32', 'M33'], 'valid': ['M34', 'M35'], 'test': ['M36', 'M37']}
[2024-08-05 10:35:16,117] {logger:46} INFO - DATA_FILE           : /home/s202283/code/grieger_validation/cache/dataset/data_tuebingen_main_stages.h5
[2024-08-05 10:35:16,117] {logger:46} INFO - STAGES              : ['Wake', 'REM', 'Non REM']
[2024-08-05 10:35:16,117] {logger:46} INFO - BALANCED_TRAINING   : False
[2024-08-05 10:35:16,117] {logger:46} INFO - BALANCING_WEIGHTS   : [0.3, 0.18, 0.24, 0.14, 0.14]
[2024-08-05 10:35:16,117] {logger:46} INFO - CHANNELS            : ['EEG_PR']
[2024-08-05 10:35:16,117] {logger:46} INFO - SAMPLES_LEFT        : 1
[2024-08-05 10:35:16,117] {logger:46} INFO - SAMPLES_RIGHT       : 1
[2024-08-05 10:35:16,117] {logger:46} INFO - LOG_INTERVAL        : 10
[2024-08-05 10:35:16,117] {logger:46} INFO - EXTRA_SAFE_MODELS   : False
[2024-08-05 10:35:16,117] {logger:46} INFO - BATCH_SIZE          : 256
[2024-08-05 10:35:16,117] {logger:46} INFO - DATA_FRACTION       : 1.0
[2024-08-05 10:35:16,117] {logger:46} INFO - DATA_FRACTION_STRAT : None
[2024-08-05 10:35:16,117] {logger:46} INFO - EPOCHS              : 50
[2024-08-05 10:35:16,117] {logger:46} INFO - WARMUP_EPOCHS       : 12
[2024-08-05 10:35:16,117] {logger:46} INFO - S_OPTIM_MODE        : exp
[2024-08-05 10:35:16,117] {logger:46} INFO - S_OPTIM_PARAS       : [0.06]
[2024-08-05 10:35:16,117] {logger:46} INFO - LEARNING_RATE       : 0.000256
[2024-08-05 10:35:16,117] {logger:46} INFO - OPTIMIZER           : <class 'torch.optim.adam.Adam'>
[2024-08-05 10:35:16,117] {logger:46} INFO - OPTIM_PARAS         : {}
[2024-08-05 10:35:16,117] {logger:46} INFO - L1_WEIGHT_DECAY     : 0
[2024-08-05 10:35:16,117] {logger:46} INFO - L2_WEIGHT_DECAY     : 0.0001
[2024-08-05 10:35:16,117] {logger:46} INFO - BATCH_SIZE_EVAL     : 512
[2024-08-05 10:35:16,117] {logger:46} INFO - FILTERS             : 96
[2024-08-05 10:35:16,117] {logger:46} INFO - CLASSIFIER_DROPOUT  : [0.2, 0.2]
[2024-08-05 10:35:16,117] {logger:46} INFO - FEATURE_EXTR_DROPOUT: [0.0, 0.2, 0.0, 0.2, 0.0, 0.2, 0.0, 0.2]
[2024-08-05 10:35:16,117] {logger:46} INFO - MODEL_NAME          : model_8conv_2fc
[2024-08-05 10:35:16,117] {logger:46} INFO - GAIN                : 0.0
[2024-08-05 10:35:16,117] {logger:46} INFO - FLIP                : 0.0
[2024-08-05 10:35:16,117] {logger:46} INFO - FLIP_ALL            : 0.0
[2024-08-05 10:35:16,117] {logger:46} INFO - WINDOW_WARP_SIZE    : 0.0
[2024-08-05 10:35:16,117] {logger:46} INFO - FLIP_HORI           : 0.0
[2024-08-05 10:35:16,117] {logger:46} INFO - TIME_SHIFT          : 0.0
[2024-08-05 10:35:16,117] {logger:50} INFO - 
[2024-08-05 10:35:16,117] {logger:51} INFO - ================================================================================
[2024-08-05 10:35:16,117] {logger:52} INFO - start training with model: model_8conv_2fc
[2024-08-05 10:35:16,117] {logger:53} INFO - ================================================================================
[2024-08-05 10:35:16,117] {logger:54} INFO - 
[2024-08-05 10:35:37,892] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:35:37,915] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:35:40,772] {dataloader:120} INFO - data distribution in database for dataset valid:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 20704
[2024-08-05 10:35:40,775] {dataloader:147} INFO - data distribution after processing:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 20704
[2024-08-05 10:35:41,616] {run_experiment:48} INFO - classifier:
Model(
  (feature_extractor): Sequential(
    (0): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): Conv1d(1, 96, kernel_size=(5,), stride=(1,))
    (2): ReLU(inplace=True)
    (3): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): Dropout(p=0.0, inplace=False)
    (5): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (6): ReLU(inplace=True)
    (7): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): Dropout(p=0.2, inplace=False)
    (9): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (10): ReLU(inplace=True)
    (11): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (12): Dropout(p=0.0, inplace=False)
    (13): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (14): ReLU(inplace=True)
    (15): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (16): Dropout(p=0.2, inplace=False)
    (17): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (18): ReLU(inplace=True)
    (19): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (20): Dropout(p=0.0, inplace=False)
    (21): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (22): ReLU(inplace=True)
    (23): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (24): Dropout(p=0.2, inplace=False)
    (25): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (26): ReLU(inplace=True)
    (27): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (28): Dropout(p=0.0, inplace=False)
    (29): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (30): ReLU(inplace=True)
    (31): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (32): Dropout(p=0.2, inplace=False)
  )
  (classifier): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=10848, out_features=80, bias=True)
    (2): ReLU(inplace=True)
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=80, out_features=3, bias=True)
  )
)
[2024-08-05 10:36:04,736] {train_model:82} INFO - Train Epoch: 1 [36352/366120 (10%)]	lr:2.56e-05	Loss: 77.169281
[2024-08-05 10:36:10,600] {train_model:82} INFO - Train Epoch: 1 [72960/366120 (20%)]	lr:2.56e-05	Loss: 51.268223
[2024-08-05 10:36:16,486] {train_model:82} INFO - Train Epoch: 1 [109568/366120 (30%)]	lr:2.56e-05	Loss: 71.557068
[2024-08-05 10:36:22,389] {train_model:82} INFO - Train Epoch: 1 [146176/366120 (40%)]	lr:2.56e-05	Loss: 60.066635
[2024-08-05 10:36:28,314] {train_model:82} INFO - Train Epoch: 1 [182784/366120 (50%)]	lr:2.56e-05	Loss: 47.414452
[2024-08-05 10:36:34,238] {train_model:82} INFO - Train Epoch: 1 [219392/366120 (60%)]	lr:2.56e-05	Loss: 53.375782
[2024-08-05 10:36:40,161] {train_model:82} INFO - Train Epoch: 1 [256000/366120 (70%)]	lr:2.56e-05	Loss: 41.710602
[2024-08-05 10:36:46,094] {train_model:82} INFO - Train Epoch: 1 [292608/366120 (80%)]	lr:2.56e-05	Loss: 32.496548
[2024-08-05 10:36:52,041] {train_model:82} INFO - Train Epoch: 1 [329216/366120 (90%)]	lr:2.56e-05	Loss: 21.960867
[2024-08-05 10:36:58,017] {train_model:82} INFO - Train Epoch: 1 [365824/366120 (100%)]	lr:2.56e-05	Loss: 27.172300
[2024-08-05 10:37:03,459] {run_experiment:79} INFO - 
[2024-08-05 10:37:03,459] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 10:37:03,904] {result_logger:103} INFO - precision on Wake: 0.711
[2024-08-05 10:37:04,229] {result_logger:104} INFO - recall on Wake: 0.433
[2024-08-05 10:37:04,557] {result_logger:107} INFO - F1-score on Wake: 0.538
[2024-08-05 10:37:04,557] {result_logger:108} INFO - 
[2024-08-05 10:37:04,976] {result_logger:103} INFO - precision on REM: 0.095
[2024-08-05 10:37:05,274] {result_logger:104} INFO - recall on REM: 0.461
[2024-08-05 10:37:05,565] {result_logger:107} INFO - F1-score on REM: 0.157
[2024-08-05 10:37:05,566] {result_logger:108} INFO - 
[2024-08-05 10:37:06,011] {result_logger:103} INFO - precision on Non REM: 0.609
[2024-08-05 10:37:06,334] {result_logger:104} INFO - recall on Non REM: 0.642
[2024-08-05 10:37:06,658] {result_logger:107} INFO - F1-score on Non REM: 0.625
[2024-08-05 10:37:06,658] {result_logger:108} INFO - 
[2024-08-05 10:37:06,727] {result_logger:111} INFO - average precision on sleep stages: 0.471
[2024-08-05 10:37:06,796] {result_logger:113} INFO - average recall on sleep stages: 0.512
[2024-08-05 10:37:06,865] {result_logger:115} INFO - average F1-score on sleep stages: 0.440
[2024-08-05 10:37:06,866] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 10:37:06,924] {result_logger:103} INFO - precision on Wake: 0.681
[2024-08-05 10:37:06,965] {result_logger:104} INFO - recall on Wake: 0.929
[2024-08-05 10:37:07,005] {result_logger:107} INFO - F1-score on Wake: 0.786
[2024-08-05 10:37:07,005] {result_logger:108} INFO - 
[2024-08-05 10:37:07,063] {result_logger:103} INFO - precision on REM: 0.292
[2024-08-05 10:37:07,102] {result_logger:104} INFO - recall on REM: 0.633
[2024-08-05 10:37:07,141] {result_logger:107} INFO - F1-score on REM: 0.400
[2024-08-05 10:37:07,141] {result_logger:108} INFO - 
[2024-08-05 10:37:07,198] {result_logger:103} INFO - precision on Non REM: 0.977
[2024-08-05 10:37:07,238] {result_logger:104} INFO - recall on Non REM: 0.349
[2024-08-05 10:37:07,278] {result_logger:107} INFO - F1-score on Non REM: 0.515
[2024-08-05 10:37:07,278] {result_logger:108} INFO - 
[2024-08-05 10:37:07,284] {result_logger:111} INFO - average precision on sleep stages: 0.650
[2024-08-05 10:37:07,291] {result_logger:113} INFO - average recall on sleep stages: 0.637
[2024-08-05 10:37:07,298] {result_logger:115} INFO - average F1-score on sleep stages: 0.567
[2024-08-05 10:37:07,298] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 10:37:07,344] {result_logger:134} INFO - 
[[88250 60724 54773]
 [ 5513  8584  4509]
 [30408 21117 92242]]
[2024-08-05 10:37:07,390] {result_logger:141} INFO - 
[[ 43.31%  29.80%  26.88%]
 [ 29.63%  46.14%  24.23%]
 [ 21.15%  14.69%  64.16%]]
[2024-08-05 10:37:07,436] {result_logger:145} INFO - 
[[ 71.07%  67.15%  36.15%]
 [  4.44%   9.49%   2.98%]
 [ 24.49%  23.35%  60.88%]]
[2024-08-05 10:37:07,436] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 10:37:07,441] {result_logger:134} INFO - 
[[26368  1854   160]
 [  927  1611     7]
 [11426  2043  7234]]
[2024-08-05 10:37:07,675] {result_logger:141} INFO - 
[[ 92.90%   6.53%   0.56%]
 [ 36.42%  63.30%   0.28%]
 [ 55.19%   9.87%  34.94%]]
[2024-08-05 10:37:07,737] {result_logger:145} INFO - 
[[ 68.10%  33.66%   2.16%]
 [  2.39%  29.25%   0.09%]
 [ 29.51%  37.09%  97.74%]]
[2024-08-05 10:37:07,895] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 10:37:07,895] {result_logger:77} INFO - actual:
[2024-08-05 10:37:07,896] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 10:37:07,896] {result_logger:79} INFO - predicted:
[2024-08-05 10:37:07,896] {result_logger:80} INFO - 
[[87.44%  7.69%  4.87%]
 [57.36% 34.66%  7.97%]
 [23.01%  8.40% 68.59%]]
[2024-08-05 10:37:07,994] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_D_weighted/model_8conv_2fc-best.pth
[2024-08-05 10:37:07,995] {run_experiment:113} INFO - [epoch   1] execution time: 86.38s	 avg f1-score: 0.5669

[2024-08-05 10:37:07,995] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:37:08,014] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:37:37,139] {train_model:82} INFO - Train Epoch: 2 [36352/366120 (10%)]	lr:4.65e-05	Loss: 23.543900
[2024-08-05 10:37:43,016] {train_model:82} INFO - Train Epoch: 2 [72960/366120 (20%)]	lr:4.65e-05	Loss: 16.287102
[2024-08-05 10:37:48,903] {train_model:82} INFO - Train Epoch: 2 [109568/366120 (30%)]	lr:4.65e-05	Loss: 23.082960
[2024-08-05 10:37:54,809] {train_model:82} INFO - Train Epoch: 2 [146176/366120 (40%)]	lr:4.65e-05	Loss: 10.771303
[2024-08-05 10:38:00,735] {train_model:82} INFO - Train Epoch: 2 [182784/366120 (50%)]	lr:4.65e-05	Loss: 27.195705
[2024-08-05 10:38:06,661] {train_model:82} INFO - Train Epoch: 2 [219392/366120 (60%)]	lr:4.65e-05	Loss: 17.982626
[2024-08-05 10:38:12,626] {train_model:82} INFO - Train Epoch: 2 [256000/366120 (70%)]	lr:4.65e-05	Loss: 7.475910
[2024-08-05 10:38:18,588] {train_model:82} INFO - Train Epoch: 2 [292608/366120 (80%)]	lr:4.65e-05	Loss: 17.876740
[2024-08-05 10:38:24,543] {train_model:82} INFO - Train Epoch: 2 [329216/366120 (90%)]	lr:4.65e-05	Loss: 13.791124
[2024-08-05 10:38:30,533] {train_model:82} INFO - Train Epoch: 2 [365824/366120 (100%)]	lr:4.65e-05	Loss: 6.982338
[2024-08-05 10:38:34,167] {run_experiment:79} INFO - 
[2024-08-05 10:38:34,168] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 10:38:34,618] {result_logger:103} INFO - precision on Wake: 0.873
[2024-08-05 10:38:34,941] {result_logger:104} INFO - recall on Wake: 0.691
[2024-08-05 10:38:35,270] {result_logger:107} INFO - F1-score on Wake: 0.772
[2024-08-05 10:38:35,270] {result_logger:108} INFO - 
[2024-08-05 10:38:35,691] {result_logger:103} INFO - precision on REM: 0.236
[2024-08-05 10:38:35,987] {result_logger:104} INFO - recall on REM: 0.770
[2024-08-05 10:38:36,285] {result_logger:107} INFO - F1-score on REM: 0.361
[2024-08-05 10:38:36,286] {result_logger:108} INFO - 
[2024-08-05 10:38:36,739] {result_logger:103} INFO - precision on Non REM: 0.827
[2024-08-05 10:38:37,059] {result_logger:104} INFO - recall on Non REM: 0.829
[2024-08-05 10:38:37,386] {result_logger:107} INFO - F1-score on Non REM: 0.828
[2024-08-05 10:38:37,387] {result_logger:108} INFO - 
[2024-08-05 10:38:37,456] {result_logger:111} INFO - average precision on sleep stages: 0.645
[2024-08-05 10:38:37,525] {result_logger:113} INFO - average recall on sleep stages: 0.763
[2024-08-05 10:38:37,595] {result_logger:115} INFO - average F1-score on sleep stages: 0.654
[2024-08-05 10:38:37,595] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 10:38:37,653] {result_logger:103} INFO - precision on Wake: 0.729
[2024-08-05 10:38:37,694] {result_logger:104} INFO - recall on Wake: 0.902
[2024-08-05 10:38:37,734] {result_logger:107} INFO - F1-score on Wake: 0.806
[2024-08-05 10:38:37,734] {result_logger:108} INFO - 
[2024-08-05 10:38:37,791] {result_logger:103} INFO - precision on REM: 0.435
[2024-08-05 10:38:37,830] {result_logger:104} INFO - recall on REM: 0.697
[2024-08-05 10:38:37,869] {result_logger:107} INFO - F1-score on REM: 0.535
[2024-08-05 10:38:37,869] {result_logger:108} INFO - 
[2024-08-05 10:38:37,927] {result_logger:103} INFO - precision on Non REM: 0.917
[2024-08-05 10:38:37,967] {result_logger:104} INFO - recall on Non REM: 0.550
[2024-08-05 10:38:38,007] {result_logger:107} INFO - F1-score on Non REM: 0.688
[2024-08-05 10:38:38,007] {result_logger:108} INFO - 
[2024-08-05 10:38:38,014] {result_logger:111} INFO - average precision on sleep stages: 0.694
[2024-08-05 10:38:38,020] {result_logger:113} INFO - average recall on sleep stages: 0.716
[2024-08-05 10:38:38,027] {result_logger:115} INFO - average F1-score on sleep stages: 0.677
[2024-08-05 10:38:38,027] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 10:38:38,074] {result_logger:134} INFO - 
[[140872  39024  23851]
 [  3262  14326   1018]
 [ 17241   7371 119155]]
[2024-08-05 10:38:38,121] {result_logger:141} INFO - 
[[ 69.14%  19.15%  11.71%]
 [ 17.53%  77.00%   5.47%]
 [ 11.99%   5.13%  82.88%]]
[2024-08-05 10:38:38,167] {result_logger:145} INFO - 
[[ 87.29%  64.27%  16.56%]
 [  2.02%  23.59%   0.71%]
 [ 10.68%  12.14%  82.73%]]
[2024-08-05 10:38:38,167] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 10:38:38,172] {result_logger:134} INFO - 
[[25605  1760  1017]
 [  760  1773    12]
 [ 8769   544 11390]]
[2024-08-05 10:38:38,225] {result_logger:141} INFO - 
[[ 90.22%   6.20%   3.58%]
 [ 29.86%  69.67%   0.47%]
 [ 42.36%   2.63%  55.02%]]
[2024-08-05 10:38:38,274] {result_logger:145} INFO - 
[[ 72.88%  43.17%   8.19%]
 [  2.16%  43.49%   0.10%]
 [ 24.96%  13.34%  91.71%]]
[2024-08-05 10:38:38,414] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 10:38:38,414] {result_logger:77} INFO - actual:
[2024-08-05 10:38:38,414] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 10:38:38,414] {result_logger:79} INFO - predicted:
[2024-08-05 10:38:38,414] {result_logger:80} INFO - 
[[87.86%  4.00%  8.14%]
 [40.10% 57.03%  2.87%]
 [21.17%  2.79% 76.04%]]
[2024-08-05 10:38:38,500] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_D_weighted/model_8conv_2fc-best.pth
[2024-08-05 10:38:38,500] {run_experiment:113} INFO - [epoch   2] execution time: 90.51s	 avg f1-score: 0.6765

[2024-08-05 10:38:38,500] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:38:38,520] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:39:01,299] {train_model:82} INFO - Train Epoch: 3 [36352/366120 (10%)]	lr:6.75e-05	Loss: 5.206800
[2024-08-05 10:39:07,108] {train_model:82} INFO - Train Epoch: 3 [72960/366120 (20%)]	lr:6.75e-05	Loss: 2.610712
[2024-08-05 10:39:12,930] {train_model:82} INFO - Train Epoch: 3 [109568/366120 (30%)]	lr:6.75e-05	Loss: 3.422003
[2024-08-05 10:39:18,763] {train_model:82} INFO - Train Epoch: 3 [146176/366120 (40%)]	lr:6.75e-05	Loss: 1.704629
[2024-08-05 10:39:24,606] {train_model:82} INFO - Train Epoch: 3 [182784/366120 (50%)]	lr:6.75e-05	Loss: 6.294556
[2024-08-05 10:39:30,448] {train_model:82} INFO - Train Epoch: 3 [219392/366120 (60%)]	lr:6.75e-05	Loss: 5.609242
[2024-08-05 10:39:36,300] {train_model:82} INFO - Train Epoch: 3 [256000/366120 (70%)]	lr:6.75e-05	Loss: 2.979295
[2024-08-05 10:39:42,159] {train_model:82} INFO - Train Epoch: 3 [292608/366120 (80%)]	lr:6.75e-05	Loss: 3.809968
[2024-08-05 10:39:48,027] {train_model:82} INFO - Train Epoch: 3 [329216/366120 (90%)]	lr:6.75e-05	Loss: 4.491682
[2024-08-05 10:39:53,930] {train_model:82} INFO - Train Epoch: 3 [365824/366120 (100%)]	lr:6.75e-05	Loss: 10.924604
[2024-08-05 10:39:57,828] {run_experiment:79} INFO - 
[2024-08-05 10:39:57,828] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 10:39:58,285] {result_logger:103} INFO - precision on Wake: 0.895
[2024-08-05 10:39:58,612] {result_logger:104} INFO - recall on Wake: 0.807
[2024-08-05 10:39:58,941] {result_logger:107} INFO - F1-score on Wake: 0.849
[2024-08-05 10:39:58,941] {result_logger:108} INFO - 
[2024-08-05 10:39:59,359] {result_logger:103} INFO - precision on REM: 0.365
[2024-08-05 10:39:59,652] {result_logger:104} INFO - recall on REM: 0.788
[2024-08-05 10:39:59,943] {result_logger:107} INFO - F1-score on REM: 0.499
[2024-08-05 10:39:59,943] {result_logger:108} INFO - 
[2024-08-05 10:40:00,386] {result_logger:103} INFO - precision on Non REM: 0.859
[2024-08-05 10:40:00,703] {result_logger:104} INFO - recall on Non REM: 0.850
[2024-08-05 10:40:01,023] {result_logger:107} INFO - F1-score on Non REM: 0.855
[2024-08-05 10:40:01,023] {result_logger:108} INFO - 
[2024-08-05 10:40:01,090] {result_logger:111} INFO - average precision on sleep stages: 0.706
[2024-08-05 10:40:01,156] {result_logger:113} INFO - average recall on sleep stages: 0.815
[2024-08-05 10:40:01,223] {result_logger:115} INFO - average F1-score on sleep stages: 0.734
[2024-08-05 10:40:01,224] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 10:40:01,282] {result_logger:103} INFO - precision on Wake: 0.722
[2024-08-05 10:40:01,323] {result_logger:104} INFO - recall on Wake: 0.943
[2024-08-05 10:40:01,363] {result_logger:107} INFO - F1-score on Wake: 0.818
[2024-08-05 10:40:01,363] {result_logger:108} INFO - 
[2024-08-05 10:40:01,420] {result_logger:103} INFO - precision on REM: 0.507
[2024-08-05 10:40:01,460] {result_logger:104} INFO - recall on REM: 0.761
[2024-08-05 10:40:01,499] {result_logger:107} INFO - F1-score on REM: 0.609
[2024-08-05 10:40:01,499] {result_logger:108} INFO - 
[2024-08-05 10:40:01,557] {result_logger:103} INFO - precision on Non REM: 0.981
[2024-08-05 10:40:01,597] {result_logger:104} INFO - recall on Non REM: 0.508
[2024-08-05 10:40:01,637] {result_logger:107} INFO - F1-score on Non REM: 0.670
[2024-08-05 10:40:01,637] {result_logger:108} INFO - 
[2024-08-05 10:40:01,644] {result_logger:111} INFO - average precision on sleep stages: 0.737
[2024-08-05 10:40:01,650] {result_logger:113} INFO - average recall on sleep stages: 0.738
[2024-08-05 10:40:01,657] {result_logger:115} INFO - average F1-score on sleep stages: 0.699
[2024-08-05 10:40:01,657] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 10:40:01,702] {result_logger:134} INFO - 
[[164328  20281  19138]
 [  2981  14658    967]
 [ 16252   5245 122270]]
[2024-08-05 10:40:01,747] {result_logger:141} INFO - 
[[ 80.65%   9.95%   9.39%]
 [ 16.02%  78.78%   5.20%]
 [ 11.30%   3.65%  85.05%]]
[2024-08-05 10:40:01,792] {result_logger:145} INFO - 
[[ 89.52%  50.47%  13.44%]
 [  1.62%  36.48%   0.68%]
 [  8.85%  13.05%  85.88%]]
[2024-08-05 10:40:01,792] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 10:40:01,797] {result_logger:134} INFO - 
[[26776  1422   184]
 [  592  1937    16]
 [ 9722   458 10523]]
[2024-08-05 10:40:01,849] {result_logger:141} INFO - 
[[ 94.34%   5.01%   0.65%]
 [ 23.26%  76.11%   0.63%]
 [ 46.96%   2.21%  50.83%]]
[2024-08-05 10:40:01,898] {result_logger:145} INFO - 
[[ 72.19%  37.25%   1.72%]
 [  1.60%  50.75%   0.15%]
 [ 26.21%  12.00%  98.13%]]
[2024-08-05 10:40:02,036] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 10:40:02,036] {result_logger:77} INFO - actual:
[2024-08-05 10:40:02,037] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 10:40:02,037] {result_logger:79} INFO - predicted:
[2024-08-05 10:40:02,037] {result_logger:80} INFO - 
[[91.48%  2.62%  5.90%]
 [31.67% 67.38%  0.94%]
 [18.19%  2.55% 79.27%]]
[2024-08-05 10:40:02,089] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_D_weighted/model_8conv_2fc-best.pth
[2024-08-05 10:40:02,089] {run_experiment:113} INFO - [epoch   3] execution time: 83.59s	 avg f1-score: 0.6989

[2024-08-05 10:40:02,089] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:40:02,108] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:40:25,536] {train_model:82} INFO - Train Epoch: 4 [36352/366120 (10%)]	lr:8.84e-05	Loss: 1.917472
[2024-08-05 10:40:31,436] {train_model:82} INFO - Train Epoch: 4 [72960/366120 (20%)]	lr:8.84e-05	Loss: 1.877273
[2024-08-05 10:40:37,346] {train_model:82} INFO - Train Epoch: 4 [109568/366120 (30%)]	lr:8.84e-05	Loss: 11.446558
[2024-08-05 10:40:43,267] {train_model:82} INFO - Train Epoch: 4 [146176/366120 (40%)]	lr:8.84e-05	Loss: 8.109489
[2024-08-05 10:40:49,201] {train_model:82} INFO - Train Epoch: 4 [182784/366120 (50%)]	lr:8.84e-05	Loss: 1.226378
[2024-08-05 10:40:55,140] {train_model:82} INFO - Train Epoch: 4 [219392/366120 (60%)]	lr:8.84e-05	Loss: 2.049047
[2024-08-05 10:41:01,080] {train_model:82} INFO - Train Epoch: 4 [256000/366120 (70%)]	lr:8.84e-05	Loss: 0.399102
[2024-08-05 10:41:07,032] {train_model:82} INFO - Train Epoch: 4 [292608/366120 (80%)]	lr:8.84e-05	Loss: 0.224347
[2024-08-05 10:41:12,992] {train_model:82} INFO - Train Epoch: 4 [329216/366120 (90%)]	lr:8.84e-05	Loss: 0.492408
[2024-08-05 10:41:18,978] {train_model:82} INFO - Train Epoch: 4 [365824/366120 (100%)]	lr:8.84e-05	Loss: 0.464281
[2024-08-05 10:41:22,258] {run_experiment:79} INFO - 
[2024-08-05 10:41:22,258] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 10:41:22,706] {result_logger:103} INFO - precision on Wake: 0.926
[2024-08-05 10:41:23,033] {result_logger:104} INFO - recall on Wake: 0.885
[2024-08-05 10:41:23,360] {result_logger:107} INFO - F1-score on Wake: 0.905
[2024-08-05 10:41:23,360] {result_logger:108} INFO - 
[2024-08-05 10:41:23,772] {result_logger:103} INFO - precision on REM: 0.523
[2024-08-05 10:41:24,061] {result_logger:104} INFO - recall on REM: 0.841
[2024-08-05 10:41:24,348] {result_logger:107} INFO - F1-score on REM: 0.645
[2024-08-05 10:41:24,348] {result_logger:108} INFO - 
[2024-08-05 10:41:24,801] {result_logger:103} INFO - precision on Non REM: 0.896
[2024-08-05 10:41:25,123] {result_logger:104} INFO - recall on Non REM: 0.882
[2024-08-05 10:41:25,448] {result_logger:107} INFO - F1-score on Non REM: 0.889
[2024-08-05 10:41:25,448] {result_logger:108} INFO - 
[2024-08-05 10:41:25,512] {result_logger:111} INFO - average precision on sleep stages: 0.782
[2024-08-05 10:41:25,577] {result_logger:113} INFO - average recall on sleep stages: 0.869
[2024-08-05 10:41:25,642] {result_logger:115} INFO - average F1-score on sleep stages: 0.813
[2024-08-05 10:41:25,643] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 10:41:25,701] {result_logger:103} INFO - precision on Wake: 0.656
[2024-08-05 10:41:25,742] {result_logger:104} INFO - recall on Wake: 0.963
[2024-08-05 10:41:25,782] {result_logger:107} INFO - F1-score on Wake: 0.781
[2024-08-05 10:41:25,782] {result_logger:108} INFO - 
[2024-08-05 10:41:25,839] {result_logger:103} INFO - precision on REM: 0.561
[2024-08-05 10:41:25,879] {result_logger:104} INFO - recall on REM: 0.715
[2024-08-05 10:41:25,918] {result_logger:107} INFO - F1-score on REM: 0.629
[2024-08-05 10:41:25,918] {result_logger:108} INFO - 
[2024-08-05 10:41:25,976] {result_logger:103} INFO - precision on Non REM: 0.996
[2024-08-05 10:41:26,017] {result_logger:104} INFO - recall on Non REM: 0.324
[2024-08-05 10:41:26,057] {result_logger:107} INFO - F1-score on Non REM: 0.488
[2024-08-05 10:41:26,057] {result_logger:108} INFO - 
[2024-08-05 10:41:26,063] {result_logger:111} INFO - average precision on sleep stages: 0.738
[2024-08-05 10:41:26,070] {result_logger:113} INFO - average recall on sleep stages: 0.667
[2024-08-05 10:41:26,076] {result_logger:115} INFO - average F1-score on sleep stages: 0.633
[2024-08-05 10:41:26,076] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 10:41:26,120] {result_logger:134} INFO - 
[[180241   9714  13792]
 [  2023  15642    941]
 [ 12455   4525 126787]]
[2024-08-05 10:41:26,164] {result_logger:141} INFO - 
[[ 88.46%   4.77%   6.77%]
 [ 10.87%  84.07%   5.06%]
 [  8.66%   3.15%  88.19%]]
[2024-08-05 10:41:26,208] {result_logger:145} INFO - 
[[ 92.56%  32.51%   9.75%]
 [  1.04%  52.35%   0.66%]
 [  6.40%  15.14%  89.59%]]
[2024-08-05 10:41:26,208] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 10:41:26,213] {result_logger:134} INFO - 
[[27338  1025    19]
 [  716  1820     9]
 [13608   397  6698]]
[2024-08-05 10:41:26,217] {result_logger:141} INFO - 
[[ 96.32%   3.61%   0.07%]
 [ 28.13%  71.51%   0.35%]
 [ 65.73%   1.92%  32.35%]]
[2024-08-05 10:41:26,222] {result_logger:145} INFO - 
[[ 65.62%  31.62%   0.28%]
 [  1.72%  56.14%   0.13%]
 [ 32.66%  12.25%  99.58%]]
[2024-08-05 10:41:26,274] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 10:41:26,274] {result_logger:77} INFO - actual:
[2024-08-05 10:41:26,274] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 10:41:26,274] {result_logger:79} INFO - predicted:
[2024-08-05 10:41:26,274] {result_logger:80} INFO - 
[[93.77%  1.93%  4.30%]
 [28.66% 71.25%  0.09%]
 [24.77%  1.93% 73.30%]]
[2024-08-05 10:41:26,274] {run_experiment:113} INFO - [epoch   4] execution time: 84.19s	 avg f1-score: 0.6327

[2024-08-05 10:41:26,274] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:41:26,294] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:41:49,646] {train_model:82} INFO - Train Epoch: 5 [36352/366120 (10%)]	lr:1.09e-04	Loss: 0.233892
[2024-08-05 10:41:55,551] {train_model:82} INFO - Train Epoch: 5 [72960/366120 (20%)]	lr:1.09e-04	Loss: 0.362189
[2024-08-05 10:42:01,464] {train_model:82} INFO - Train Epoch: 5 [109568/366120 (30%)]	lr:1.09e-04	Loss: 0.305634
[2024-08-05 10:42:07,393] {train_model:82} INFO - Train Epoch: 5 [146176/366120 (40%)]	lr:1.09e-04	Loss: 0.494828
[2024-08-05 10:42:13,329] {train_model:82} INFO - Train Epoch: 5 [182784/366120 (50%)]	lr:1.09e-04	Loss: 0.151459
[2024-08-05 10:42:19,284] {train_model:82} INFO - Train Epoch: 5 [219392/366120 (60%)]	lr:1.09e-04	Loss: 8.593293
[2024-08-05 10:42:25,245] {train_model:82} INFO - Train Epoch: 5 [256000/366120 (70%)]	lr:1.09e-04	Loss: 17.347597
[2024-08-05 10:42:31,219] {train_model:82} INFO - Train Epoch: 5 [292608/366120 (80%)]	lr:1.09e-04	Loss: 1.165174
[2024-08-05 10:42:37,200] {train_model:82} INFO - Train Epoch: 5 [329216/366120 (90%)]	lr:1.09e-04	Loss: 0.276541
[2024-08-05 10:42:43,210] {train_model:82} INFO - Train Epoch: 5 [365824/366120 (100%)]	lr:1.09e-04	Loss: 0.225267
[2024-08-05 10:42:47,378] {run_experiment:79} INFO - 
[2024-08-05 10:42:47,378] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 10:42:47,829] {result_logger:103} INFO - precision on Wake: 0.950
[2024-08-05 10:42:48,157] {result_logger:104} INFO - recall on Wake: 0.925
[2024-08-05 10:42:48,487] {result_logger:107} INFO - F1-score on Wake: 0.937
[2024-08-05 10:42:48,487] {result_logger:108} INFO - 
[2024-08-05 10:42:48,894] {result_logger:103} INFO - precision on REM: 0.634
[2024-08-05 10:42:49,176] {result_logger:104} INFO - recall on REM: 0.883
[2024-08-05 10:42:49,456] {result_logger:107} INFO - F1-score on REM: 0.738
[2024-08-05 10:42:49,456] {result_logger:108} INFO - 
[2024-08-05 10:42:49,910] {result_logger:103} INFO - precision on Non REM: 0.922
[2024-08-05 10:42:50,237] {result_logger:104} INFO - recall on Non REM: 0.910
[2024-08-05 10:42:50,565] {result_logger:107} INFO - F1-score on Non REM: 0.916
[2024-08-05 10:42:50,565] {result_logger:108} INFO - 
[2024-08-05 10:42:50,634] {result_logger:111} INFO - average precision on sleep stages: 0.835
[2024-08-05 10:42:50,703] {result_logger:113} INFO - average recall on sleep stages: 0.906
[2024-08-05 10:42:50,773] {result_logger:115} INFO - average F1-score on sleep stages: 0.864
[2024-08-05 10:42:50,773] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 10:42:50,830] {result_logger:103} INFO - precision on Wake: 0.718
[2024-08-05 10:42:50,870] {result_logger:104} INFO - recall on Wake: 0.984
[2024-08-05 10:42:50,910] {result_logger:107} INFO - F1-score on Wake: 0.830
[2024-08-05 10:42:50,910] {result_logger:108} INFO - 
[2024-08-05 10:42:50,966] {result_logger:103} INFO - precision on REM: 0.598
[2024-08-05 10:42:51,005] {result_logger:104} INFO - recall on REM: 0.855
[2024-08-05 10:42:51,045] {result_logger:107} INFO - F1-score on REM: 0.704
[2024-08-05 10:42:51,045] {result_logger:108} INFO - 
[2024-08-05 10:42:51,102] {result_logger:103} INFO - precision on Non REM: 0.997
[2024-08-05 10:42:51,142] {result_logger:104} INFO - recall on Non REM: 0.439
[2024-08-05 10:42:51,182] {result_logger:107} INFO - F1-score on Non REM: 0.610
[2024-08-05 10:42:51,182] {result_logger:108} INFO - 
[2024-08-05 10:42:51,188] {result_logger:111} INFO - average precision on sleep stages: 0.771
[2024-08-05 10:42:51,195] {result_logger:113} INFO - average recall on sleep stages: 0.759
[2024-08-05 10:42:51,201] {result_logger:115} INFO - average F1-score on sleep stages: 0.715
[2024-08-05 10:42:51,201] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 10:42:51,249] {result_logger:134} INFO - 
[[188369   5042  10336]
 [  1383  16426    797]
 [  8448   4454 130865]]
[2024-08-05 10:42:51,296] {result_logger:141} INFO - 
[[ 92.45%   2.47%   5.07%]
 [  7.43%  88.28%   4.28%]
 [  5.88%   3.10%  91.03%]]
[2024-08-05 10:42:51,343] {result_logger:145} INFO - 
[[ 95.04%  19.45%   7.28%]
 [  0.70%  63.37%   0.56%]
 [  4.26%  17.18%  92.16%]]
[2024-08-05 10:42:51,343] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 10:42:51,348] {result_logger:134} INFO - 
[[27926   442    14]
 [  358  2177    10]
 [10593  1021  9089]]
[2024-08-05 10:42:51,399] {result_logger:141} INFO - 
[[ 98.39%   1.56%   0.05%]
 [ 14.07%  85.54%   0.39%]
 [ 51.17%   4.93%  43.90%]]
[2024-08-05 10:42:51,448] {result_logger:145} INFO - 
[[ 71.83%  12.14%   0.15%]
 [  0.92%  59.81%   0.11%]
 [ 27.25%  28.05%  99.74%]]
[2024-08-05 10:42:51,624] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 10:42:51,624] {result_logger:77} INFO - actual:
[2024-08-05 10:42:51,624] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 10:42:51,624] {result_logger:79} INFO - predicted:
[2024-08-05 10:42:51,624] {result_logger:80} INFO - 
[[93.46%  1.28%  5.26%]
 [25.52% 73.32%  1.15%]
 [17.69%  5.21% 77.10%]]
[2024-08-05 10:42:51,676] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_D_weighted/model_8conv_2fc-best.pth
[2024-08-05 10:42:51,676] {run_experiment:113} INFO - [epoch   5] execution time: 85.40s	 avg f1-score: 0.7147

[2024-08-05 10:42:51,676] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:42:51,695] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:43:20,761] {train_model:82} INFO - Train Epoch: 6 [36352/366120 (10%)]	lr:1.30e-04	Loss: 0.198835
[2024-08-05 10:43:26,569] {train_model:82} INFO - Train Epoch: 6 [72960/366120 (20%)]	lr:1.30e-04	Loss: 0.377617
[2024-08-05 10:43:32,376] {train_model:82} INFO - Train Epoch: 6 [109568/366120 (30%)]	lr:1.30e-04	Loss: 0.289611
[2024-08-05 10:43:38,193] {train_model:82} INFO - Train Epoch: 6 [146176/366120 (40%)]	lr:1.30e-04	Loss: 0.176181
[2024-08-05 10:43:44,022] {train_model:82} INFO - Train Epoch: 6 [182784/366120 (50%)]	lr:1.30e-04	Loss: 2.438404
[2024-08-05 10:43:49,858] {train_model:82} INFO - Train Epoch: 6 [219392/366120 (60%)]	lr:1.30e-04	Loss: 0.728011
[2024-08-05 10:43:55,705] {train_model:82} INFO - Train Epoch: 6 [256000/366120 (70%)]	lr:1.30e-04	Loss: 0.126927
[2024-08-05 10:44:01,566] {train_model:82} INFO - Train Epoch: 6 [292608/366120 (80%)]	lr:1.30e-04	Loss: 0.178748
[2024-08-05 10:44:07,439] {train_model:82} INFO - Train Epoch: 6 [329216/366120 (90%)]	lr:1.30e-04	Loss: 0.508485
[2024-08-05 10:44:13,341] {train_model:82} INFO - Train Epoch: 6 [365824/366120 (100%)]	lr:1.30e-04	Loss: 0.225815
[2024-08-05 10:44:22,225] {run_experiment:79} INFO - 
[2024-08-05 10:44:22,225] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 10:44:22,672] {result_logger:103} INFO - precision on Wake: 0.962
[2024-08-05 10:44:22,997] {result_logger:104} INFO - recall on Wake: 0.940
[2024-08-05 10:44:23,326] {result_logger:107} INFO - F1-score on Wake: 0.951
[2024-08-05 10:44:23,326] {result_logger:108} INFO - 
[2024-08-05 10:44:23,739] {result_logger:103} INFO - precision on REM: 0.666
[2024-08-05 10:44:24,026] {result_logger:104} INFO - recall on REM: 0.911
[2024-08-05 10:44:24,315] {result_logger:107} INFO - F1-score on REM: 0.770
[2024-08-05 10:44:24,315] {result_logger:108} INFO - 
[2024-08-05 10:44:24,765] {result_logger:103} INFO - precision on Non REM: 0.936
[2024-08-05 10:44:25,093] {result_logger:104} INFO - recall on Non REM: 0.923
[2024-08-05 10:44:25,419] {result_logger:107} INFO - F1-score on Non REM: 0.930
[2024-08-05 10:44:25,419] {result_logger:108} INFO - 
[2024-08-05 10:44:25,487] {result_logger:111} INFO - average precision on sleep stages: 0.855
[2024-08-05 10:44:25,555] {result_logger:113} INFO - average recall on sleep stages: 0.925
[2024-08-05 10:44:25,622] {result_logger:115} INFO - average F1-score on sleep stages: 0.883
[2024-08-05 10:44:25,623] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 10:44:25,680] {result_logger:103} INFO - precision on Wake: 0.904
[2024-08-05 10:44:25,720] {result_logger:104} INFO - recall on Wake: 0.961
[2024-08-05 10:44:25,760] {result_logger:107} INFO - F1-score on Wake: 0.932
[2024-08-05 10:44:25,760] {result_logger:108} INFO - 
[2024-08-05 10:44:25,817] {result_logger:103} INFO - precision on REM: 0.543
[2024-08-05 10:44:25,857] {result_logger:104} INFO - recall on REM: 0.950
[2024-08-05 10:44:25,897] {result_logger:107} INFO - F1-score on REM: 0.691
[2024-08-05 10:44:25,897] {result_logger:108} INFO - 
[2024-08-05 10:44:25,955] {result_logger:103} INFO - precision on Non REM: 0.988
[2024-08-05 10:44:25,994] {result_logger:104} INFO - recall on Non REM: 0.812
[2024-08-05 10:44:26,033] {result_logger:107} INFO - F1-score on Non REM: 0.891
[2024-08-05 10:44:26,033] {result_logger:108} INFO - 
[2024-08-05 10:44:26,039] {result_logger:111} INFO - average precision on sleep stages: 0.812
[2024-08-05 10:44:26,046] {result_logger:113} INFO - average recall on sleep stages: 0.907
[2024-08-05 10:44:26,052] {result_logger:115} INFO - average F1-score on sleep stages: 0.838
[2024-08-05 10:44:26,052] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 10:44:26,099] {result_logger:134} INFO - 
[[191478   3977   8292]
 [   950  16951    705]
 [  6571   4523 132673]]
[2024-08-05 10:44:26,145] {result_logger:141} INFO - 
[[ 93.98%   1.95%   4.07%]
 [  5.11%  91.11%   3.79%]
 [  4.57%   3.15%  92.28%]]
[2024-08-05 10:44:26,192] {result_logger:145} INFO - 
[[ 96.22%  15.63%   5.85%]
 [  0.48%  66.60%   0.50%]
 [  3.30%  17.77%  93.65%]]
[2024-08-05 10:44:26,192] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 10:44:26,196] {result_logger:134} INFO - 
[[27276   914   192]
 [  112  2417    16]
 [ 2776  1123 16804]]
[2024-08-05 10:44:26,476] {result_logger:141} INFO - 
[[ 96.10%   3.22%   0.68%]
 [  4.40%  94.97%   0.63%]
 [ 13.41%   5.42%  81.17%]]
[2024-08-05 10:44:26,611] {result_logger:145} INFO - 
[[ 90.43%  20.52%   1.13%]
 [  0.37%  54.27%   0.09%]
 [  9.20%  25.21%  98.78%]]
[2024-08-05 10:44:26,909] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 10:44:26,909] {result_logger:77} INFO - actual:
[2024-08-05 10:44:26,909] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 10:44:26,909] {result_logger:79} INFO - predicted:
[2024-08-05 10:44:26,910] {result_logger:80} INFO - 
[[93.26%  1.46%  5.28%]
 [21.73% 73.04%  5.23%]
 [ 6.25%  4.48% 89.27%]]
[2024-08-05 10:44:27,055] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_D_weighted/model_8conv_2fc-best.pth
[2024-08-05 10:44:27,055] {run_experiment:113} INFO - [epoch   6] execution time: 95.38s	 avg f1-score: 0.8379

[2024-08-05 10:44:27,055] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:44:27,075] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:45:16,082] {train_model:82} INFO - Train Epoch: 7 [36352/366120 (10%)]	lr:1.51e-04	Loss: 0.106052
[2024-08-05 10:45:21,940] {train_model:82} INFO - Train Epoch: 7 [72960/366120 (20%)]	lr:1.51e-04	Loss: 0.106660
[2024-08-05 10:45:27,841] {train_model:82} INFO - Train Epoch: 7 [109568/366120 (30%)]	lr:1.51e-04	Loss: 0.130198
[2024-08-05 10:45:33,758] {train_model:82} INFO - Train Epoch: 7 [146176/366120 (40%)]	lr:1.51e-04	Loss: 2.572457
[2024-08-05 10:45:39,701] {train_model:82} INFO - Train Epoch: 7 [182784/366120 (50%)]	lr:1.51e-04	Loss: 0.263445
[2024-08-05 10:45:45,660] {train_model:82} INFO - Train Epoch: 7 [219392/366120 (60%)]	lr:1.51e-04	Loss: 0.069988
[2024-08-05 10:45:51,629] {train_model:82} INFO - Train Epoch: 7 [256000/366120 (70%)]	lr:1.51e-04	Loss: 0.147866
[2024-08-05 10:45:57,611] {train_model:82} INFO - Train Epoch: 7 [292608/366120 (80%)]	lr:1.51e-04	Loss: 0.171928
[2024-08-05 10:46:03,600] {train_model:82} INFO - Train Epoch: 7 [329216/366120 (90%)]	lr:1.51e-04	Loss: 0.506886
[2024-08-05 10:46:09,616] {train_model:82} INFO - Train Epoch: 7 [365824/366120 (100%)]	lr:1.51e-04	Loss: 0.433737
[2024-08-05 10:46:15,982] {run_experiment:79} INFO - 
[2024-08-05 10:46:15,983] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 10:46:16,430] {result_logger:103} INFO - precision on Wake: 0.969
[2024-08-05 10:46:16,752] {result_logger:104} INFO - recall on Wake: 0.946
[2024-08-05 10:46:17,073] {result_logger:107} INFO - F1-score on Wake: 0.957
[2024-08-05 10:46:17,073] {result_logger:108} INFO - 
[2024-08-05 10:46:17,477] {result_logger:103} INFO - precision on REM: 0.696
[2024-08-05 10:46:17,761] {result_logger:104} INFO - recall on REM: 0.921
[2024-08-05 10:46:18,040] {result_logger:107} INFO - F1-score on REM: 0.793
[2024-08-05 10:46:18,041] {result_logger:108} INFO - 
[2024-08-05 10:46:18,479] {result_logger:103} INFO - precision on Non REM: 0.940
[2024-08-05 10:46:18,800] {result_logger:104} INFO - recall on Non REM: 0.932
[2024-08-05 10:46:19,120] {result_logger:107} INFO - F1-score on Non REM: 0.936
[2024-08-05 10:46:19,120] {result_logger:108} INFO - 
[2024-08-05 10:46:19,188] {result_logger:111} INFO - average precision on sleep stages: 0.868
[2024-08-05 10:46:19,256] {result_logger:113} INFO - average recall on sleep stages: 0.933
[2024-08-05 10:46:19,324] {result_logger:115} INFO - average F1-score on sleep stages: 0.896
[2024-08-05 10:46:19,325] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 10:46:19,382] {result_logger:103} INFO - precision on Wake: 0.892
[2024-08-05 10:46:19,421] {result_logger:104} INFO - recall on Wake: 0.984
[2024-08-05 10:46:19,461] {result_logger:107} INFO - F1-score on Wake: 0.936
[2024-08-05 10:46:19,461] {result_logger:108} INFO - 
[2024-08-05 10:46:19,517] {result_logger:103} INFO - precision on REM: 0.721
[2024-08-05 10:46:19,556] {result_logger:104} INFO - recall on REM: 0.969
[2024-08-05 10:46:19,595] {result_logger:107} INFO - F1-score on REM: 0.827
[2024-08-05 10:46:19,595] {result_logger:108} INFO - 
[2024-08-05 10:46:19,652] {result_logger:103} INFO - precision on Non REM: 0.984
[2024-08-05 10:46:19,691] {result_logger:104} INFO - recall on Non REM: 0.804
[2024-08-05 10:46:19,731] {result_logger:107} INFO - F1-score on Non REM: 0.885
[2024-08-05 10:46:19,731] {result_logger:108} INFO - 
[2024-08-05 10:46:19,738] {result_logger:111} INFO - average precision on sleep stages: 0.866
[2024-08-05 10:46:19,744] {result_logger:113} INFO - average recall on sleep stages: 0.919
[2024-08-05 10:46:19,750] {result_logger:115} INFO - average F1-score on sleep stages: 0.883
[2024-08-05 10:46:19,750] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 10:46:19,797] {result_logger:134} INFO - 
[[192758   3152   7837]
 [   818  17141    647]
 [  5366   4339 134062]]
[2024-08-05 10:46:19,843] {result_logger:141} INFO - 
[[ 94.61%   1.55%   3.85%]
 [  4.40%  92.13%   3.48%]
 [  3.73%   3.02%  93.25%]]
[2024-08-05 10:46:19,889] {result_logger:145} INFO - 
[[ 96.89%  12.80%   5.50%]
 [  0.41%  69.59%   0.45%]
 [  2.70%  17.62%  94.05%]]
[2024-08-05 10:46:19,889] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 10:46:19,894] {result_logger:134} INFO - 
[[27918   222   242]
 [   53  2466    26]
 [ 3318   730 16655]]
[2024-08-05 10:46:20,030] {result_logger:141} INFO - 
[[ 98.37%   0.78%   0.85%]
 [  2.08%  96.90%   1.02%]
 [ 16.03%   3.53%  80.45%]]
[2024-08-05 10:46:20,134] {result_logger:145} INFO - 
[[ 89.23%   6.50%   1.43%]
 [  0.17%  72.15%   0.15%]
 [ 10.60%  21.36%  98.42%]]
[2024-08-05 10:46:20,425] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 10:46:20,426] {result_logger:77} INFO - actual:
[2024-08-05 10:46:20,426] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 10:46:20,426] {result_logger:79} INFO - predicted:
[2024-08-05 10:46:20,426] {result_logger:80} INFO - 
[[93.45%  0.50%  6.05%]
 [19.40% 77.65%  2.95%]
 [ 8.20%  3.59% 88.21%]]
[2024-08-05 10:46:20,519] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_D_weighted/model_8conv_2fc-best.pth
[2024-08-05 10:46:20,519] {run_experiment:113} INFO - [epoch   7] execution time: 113.46s	 avg f1-score: 0.8827

[2024-08-05 10:46:20,519] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:46:20,539] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:47:10,897] {train_model:82} INFO - Train Epoch: 8 [36352/366120 (10%)]	lr:1.72e-04	Loss: 0.162157
[2024-08-05 10:47:16,795] {train_model:82} INFO - Train Epoch: 8 [72960/366120 (20%)]	lr:1.72e-04	Loss: 0.141347
[2024-08-05 10:47:22,712] {train_model:82} INFO - Train Epoch: 8 [109568/366120 (30%)]	lr:1.72e-04	Loss: 0.075168
[2024-08-05 10:47:28,645] {train_model:82} INFO - Train Epoch: 8 [146176/366120 (40%)]	lr:1.72e-04	Loss: 0.987407
[2024-08-05 10:47:34,593] {train_model:82} INFO - Train Epoch: 8 [182784/366120 (50%)]	lr:1.72e-04	Loss: 0.439758
[2024-08-05 10:47:40,545] {train_model:82} INFO - Train Epoch: 8 [219392/366120 (60%)]	lr:1.72e-04	Loss: 0.108655
[2024-08-05 10:47:46,506] {train_model:82} INFO - Train Epoch: 8 [256000/366120 (70%)]	lr:1.72e-04	Loss: 0.072019
[2024-08-05 10:47:52,474] {train_model:82} INFO - Train Epoch: 8 [292608/366120 (80%)]	lr:1.72e-04	Loss: 0.090274
[2024-08-05 10:47:58,461] {train_model:82} INFO - Train Epoch: 8 [329216/366120 (90%)]	lr:1.72e-04	Loss: 0.107416
[2024-08-05 10:48:04,469] {train_model:82} INFO - Train Epoch: 8 [365824/366120 (100%)]	lr:1.72e-04	Loss: 0.075976
[2024-08-05 10:48:09,223] {run_experiment:79} INFO - 
[2024-08-05 10:48:09,223] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 10:48:09,668] {result_logger:103} INFO - precision on Wake: 0.974
[2024-08-05 10:48:09,988] {result_logger:104} INFO - recall on Wake: 0.951
[2024-08-05 10:48:10,308] {result_logger:107} INFO - F1-score on Wake: 0.962
[2024-08-05 10:48:10,308] {result_logger:108} INFO - 
[2024-08-05 10:48:10,706] {result_logger:103} INFO - precision on REM: 0.715
[2024-08-05 10:48:10,989] {result_logger:104} INFO - recall on REM: 0.934
[2024-08-05 10:48:11,271] {result_logger:107} INFO - F1-score on REM: 0.810
[2024-08-05 10:48:11,271] {result_logger:108} INFO - 
[2024-08-05 10:48:11,719] {result_logger:103} INFO - precision on Non REM: 0.945
[2024-08-05 10:48:12,034] {result_logger:104} INFO - recall on Non REM: 0.938
[2024-08-05 10:48:12,351] {result_logger:107} INFO - F1-score on Non REM: 0.941
[2024-08-05 10:48:12,351] {result_logger:108} INFO - 
[2024-08-05 10:48:12,421] {result_logger:111} INFO - average precision on sleep stages: 0.878
[2024-08-05 10:48:12,490] {result_logger:113} INFO - average recall on sleep stages: 0.941
[2024-08-05 10:48:12,560] {result_logger:115} INFO - average F1-score on sleep stages: 0.905
[2024-08-05 10:48:12,561] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 10:48:12,618] {result_logger:103} INFO - precision on Wake: 0.931
[2024-08-05 10:48:12,659] {result_logger:104} INFO - recall on Wake: 0.874
[2024-08-05 10:48:12,699] {result_logger:107} INFO - F1-score on Wake: 0.902
[2024-08-05 10:48:12,699] {result_logger:108} INFO - 
[2024-08-05 10:48:12,757] {result_logger:103} INFO - precision on REM: 0.378
[2024-08-05 10:48:12,797] {result_logger:104} INFO - recall on REM: 0.989
[2024-08-05 10:48:12,837] {result_logger:107} INFO - F1-score on REM: 0.547
[2024-08-05 10:48:12,837] {result_logger:108} INFO - 
[2024-08-05 10:48:12,895] {result_logger:103} INFO - precision on Non REM: 0.979
[2024-08-05 10:48:12,935] {result_logger:104} INFO - recall on Non REM: 0.866
[2024-08-05 10:48:12,975] {result_logger:107} INFO - F1-score on Non REM: 0.919
[2024-08-05 10:48:12,975] {result_logger:108} INFO - 
[2024-08-05 10:48:12,982] {result_logger:111} INFO - average precision on sleep stages: 0.763
[2024-08-05 10:48:12,988] {result_logger:113} INFO - average recall on sleep stages: 0.910
[2024-08-05 10:48:12,995] {result_logger:115} INFO - average F1-score on sleep stages: 0.789
[2024-08-05 10:48:12,995] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 10:48:13,042] {result_logger:134} INFO - 
[[193770   2678   7299]
 [   620  17377    609]
 [  4611   4255 134901]]
[2024-08-05 10:48:13,089] {result_logger:141} INFO - 
[[ 95.10%   1.31%   3.58%]
 [  3.33%  93.39%   3.27%]
 [  3.21%   2.96%  93.83%]]
[2024-08-05 10:48:13,136] {result_logger:145} INFO - 
[[ 97.37%  11.02%   5.11%]
 [  0.31%  71.48%   0.43%]
 [  2.32%  17.50%  94.46%]]
[2024-08-05 10:48:13,137] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 10:48:13,141] {result_logger:134} INFO - 
[[24808  3199   375]
 [   10  2517    18]
 [ 1823   943 17937]]
[2024-08-05 10:48:13,146] {result_logger:141} INFO - 
[[ 87.41%  11.27%   1.32%]
 [  0.39%  98.90%   0.71%]
 [  8.81%   4.55%  86.64%]]
[2024-08-05 10:48:13,150] {result_logger:145} INFO - 
[[ 93.12%  48.04%   2.05%]
 [  0.04%  37.80%   0.10%]
 [  6.84%  14.16%  97.86%]]
[2024-08-05 10:48:13,202] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 10:48:13,202] {result_logger:77} INFO - actual:
[2024-08-05 10:48:13,203] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 10:48:13,203] {result_logger:79} INFO - predicted:
[2024-08-05 10:48:13,203] {result_logger:80} INFO - 
[[88.99%  4.16%  6.85%]
 [24.37% 71.80%  3.83%]
 [ 7.15%  4.21% 88.65%]]
[2024-08-05 10:48:13,203] {run_experiment:113} INFO - [epoch   8] execution time: 112.68s	 avg f1-score: 0.7892

[2024-08-05 10:48:13,203] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:48:13,223] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:48:40,194] {train_model:82} INFO - Train Epoch: 9 [36352/366120 (10%)]	lr:1.93e-04	Loss: 0.198088
[2024-08-05 10:48:45,988] {train_model:82} INFO - Train Epoch: 9 [72960/366120 (20%)]	lr:1.93e-04	Loss: 0.198645
[2024-08-05 10:48:51,797] {train_model:82} INFO - Train Epoch: 9 [109568/366120 (30%)]	lr:1.93e-04	Loss: 2.479162
[2024-08-05 10:48:57,618] {train_model:82} INFO - Train Epoch: 9 [146176/366120 (40%)]	lr:1.93e-04	Loss: 0.087574
[2024-08-05 10:49:03,446] {train_model:82} INFO - Train Epoch: 9 [182784/366120 (50%)]	lr:1.93e-04	Loss: 0.194889
[2024-08-05 10:49:09,280] {train_model:82} INFO - Train Epoch: 9 [219392/366120 (60%)]	lr:1.93e-04	Loss: 0.172753
[2024-08-05 10:49:15,124] {train_model:82} INFO - Train Epoch: 9 [256000/366120 (70%)]	lr:1.93e-04	Loss: 0.349777
[2024-08-05 10:49:20,976] {train_model:82} INFO - Train Epoch: 9 [292608/366120 (80%)]	lr:1.93e-04	Loss: 2.588380
[2024-08-05 10:49:26,843] {train_model:82} INFO - Train Epoch: 9 [329216/366120 (90%)]	lr:1.93e-04	Loss: 0.144712
[2024-08-05 10:49:32,733] {train_model:82} INFO - Train Epoch: 9 [365824/366120 (100%)]	lr:1.93e-04	Loss: 1.738224
[2024-08-05 10:49:40,527] {run_experiment:79} INFO - 
[2024-08-05 10:49:40,527] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 10:49:40,974] {result_logger:103} INFO - precision on Wake: 0.975
[2024-08-05 10:49:41,296] {result_logger:104} INFO - recall on Wake: 0.957
[2024-08-05 10:49:41,625] {result_logger:107} INFO - F1-score on Wake: 0.966
[2024-08-05 10:49:41,625] {result_logger:108} INFO - 
[2024-08-05 10:49:42,037] {result_logger:103} INFO - precision on REM: 0.733
[2024-08-05 10:49:42,320] {result_logger:104} INFO - recall on REM: 0.940
[2024-08-05 10:49:42,610] {result_logger:107} INFO - F1-score on REM: 0.824
[2024-08-05 10:49:42,611] {result_logger:108} INFO - 
[2024-08-05 10:49:43,054] {result_logger:103} INFO - precision on Non REM: 0.950
[2024-08-05 10:49:43,378] {result_logger:104} INFO - recall on Non REM: 0.940
[2024-08-05 10:49:43,696] {result_logger:107} INFO - F1-score on Non REM: 0.945
[2024-08-05 10:49:43,696] {result_logger:108} INFO - 
[2024-08-05 10:49:43,762] {result_logger:111} INFO - average precision on sleep stages: 0.886
[2024-08-05 10:49:43,828] {result_logger:113} INFO - average recall on sleep stages: 0.946
[2024-08-05 10:49:43,894] {result_logger:115} INFO - average F1-score on sleep stages: 0.911
[2024-08-05 10:49:43,895] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 10:49:43,951] {result_logger:103} INFO - precision on Wake: 0.974
[2024-08-05 10:49:43,990] {result_logger:104} INFO - recall on Wake: 0.954
[2024-08-05 10:49:44,030] {result_logger:107} INFO - F1-score on Wake: 0.964
[2024-08-05 10:49:44,030] {result_logger:108} INFO - 
[2024-08-05 10:49:44,086] {result_logger:103} INFO - precision on REM: 0.655
[2024-08-05 10:49:44,124] {result_logger:104} INFO - recall on REM: 0.969
[2024-08-05 10:49:44,163] {result_logger:107} INFO - F1-score on REM: 0.782
[2024-08-05 10:49:44,163] {result_logger:108} INFO - 
[2024-08-05 10:49:44,220] {result_logger:103} INFO - precision on Non REM: 0.966
[2024-08-05 10:49:44,260] {result_logger:104} INFO - recall on Non REM: 0.936
[2024-08-05 10:49:44,300] {result_logger:107} INFO - F1-score on Non REM: 0.951
[2024-08-05 10:49:44,300] {result_logger:108} INFO - 
[2024-08-05 10:49:44,306] {result_logger:111} INFO - average precision on sleep stages: 0.865
[2024-08-05 10:49:44,312] {result_logger:113} INFO - average recall on sleep stages: 0.953
[2024-08-05 10:49:44,318] {result_logger:115} INFO - average F1-score on sleep stages: 0.899
[2024-08-05 10:49:44,318] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 10:49:44,363] {result_logger:134} INFO - 
[[195027   2226   6494]
 [   527  17492    587]
 [  4542   4151 135074]]
[2024-08-05 10:49:44,408] {result_logger:141} INFO - 
[[ 95.72%   1.09%   3.19%]
 [  2.83%  94.01%   3.15%]
 [  3.16%   2.89%  93.95%]]
[2024-08-05 10:49:44,453] {result_logger:145} INFO - 
[[ 97.47%   9.33%   4.57%]
 [  0.26%  73.28%   0.41%]
 [  2.27%  17.39%  95.02%]]
[2024-08-05 10:49:44,453] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 10:49:44,458] {result_logger:134} INFO - 
[[27066   666   650]
 [   37  2466    42]
 [  693   632 19378]]
[2024-08-05 10:49:44,716] {result_logger:141} INFO - 
[[ 95.36%   2.35%   2.29%]
 [  1.45%  96.90%   1.65%]
 [  3.35%   3.05%  93.60%]]
[2024-08-05 10:49:44,840] {result_logger:145} INFO - 
[[ 97.37%  17.69%   3.24%]
 [  0.13%  65.52%   0.21%]
 [  2.49%  16.79%  96.55%]]
[2024-08-05 10:49:45,121] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 10:49:45,122] {result_logger:77} INFO - actual:
[2024-08-05 10:49:45,122] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 10:49:45,122] {result_logger:79} INFO - predicted:
[2024-08-05 10:49:45,122] {result_logger:80} INFO - 
[[94.03%  1.18%  4.79%]
 [20.59% 74.47%  4.94%]
 [ 4.40%  3.15% 92.45%]]
[2024-08-05 10:49:45,252] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_D_weighted/model_8conv_2fc-best.pth
[2024-08-05 10:49:45,252] {run_experiment:113} INFO - [epoch   9] execution time: 92.05s	 avg f1-score: 0.8986

[2024-08-05 10:49:45,252] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:49:45,272] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:50:46,559] {train_model:82} INFO - Train Epoch: 10 [36352/366120 (10%)]	lr:2.14e-04	Loss: 0.183463
[2024-08-05 10:50:52,460] {train_model:82} INFO - Train Epoch: 10 [72960/366120 (20%)]	lr:2.14e-04	Loss: 0.289740
[2024-08-05 10:50:58,377] {train_model:82} INFO - Train Epoch: 10 [109568/366120 (30%)]	lr:2.14e-04	Loss: 0.083111
[2024-08-05 10:51:04,305] {train_model:82} INFO - Train Epoch: 10 [146176/366120 (40%)]	lr:2.14e-04	Loss: 0.124912
[2024-08-05 10:51:10,248] {train_model:82} INFO - Train Epoch: 10 [182784/366120 (50%)]	lr:2.14e-04	Loss: 0.243372
[2024-08-05 10:51:16,200] {train_model:82} INFO - Train Epoch: 10 [219392/366120 (60%)]	lr:2.14e-04	Loss: 0.096598
[2024-08-05 10:51:22,164] {train_model:82} INFO - Train Epoch: 10 [256000/366120 (70%)]	lr:2.14e-04	Loss: 0.129766
[2024-08-05 10:51:28,136] {train_model:82} INFO - Train Epoch: 10 [292608/366120 (80%)]	lr:2.14e-04	Loss: 2.693208
[2024-08-05 10:51:34,117] {train_model:82} INFO - Train Epoch: 10 [329216/366120 (90%)]	lr:2.14e-04	Loss: 0.082903
[2024-08-05 10:51:40,129] {train_model:82} INFO - Train Epoch: 10 [365824/366120 (100%)]	lr:2.14e-04	Loss: 0.411395
[2024-08-05 10:51:46,121] {run_experiment:79} INFO - 
[2024-08-05 10:51:46,121] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 10:51:46,583] {result_logger:103} INFO - precision on Wake: 0.977
[2024-08-05 10:51:46,906] {result_logger:104} INFO - recall on Wake: 0.959
[2024-08-05 10:51:47,230] {result_logger:107} INFO - F1-score on Wake: 0.968
[2024-08-05 10:51:47,230] {result_logger:108} INFO - 
[2024-08-05 10:51:47,635] {result_logger:103} INFO - precision on REM: 0.748
[2024-08-05 10:51:47,916] {result_logger:104} INFO - recall on REM: 0.945
[2024-08-05 10:51:48,190] {result_logger:107} INFO - F1-score on REM: 0.835
[2024-08-05 10:51:48,190] {result_logger:108} INFO - 
[2024-08-05 10:51:48,642] {result_logger:103} INFO - precision on Non REM: 0.951
[2024-08-05 10:51:48,961] {result_logger:104} INFO - recall on Non REM: 0.943
[2024-08-05 10:51:49,277] {result_logger:107} INFO - F1-score on Non REM: 0.947
[2024-08-05 10:51:49,277] {result_logger:108} INFO - 
[2024-08-05 10:51:49,342] {result_logger:111} INFO - average precision on sleep stages: 0.892
[2024-08-05 10:51:49,407] {result_logger:113} INFO - average recall on sleep stages: 0.949
[2024-08-05 10:51:49,471] {result_logger:115} INFO - average F1-score on sleep stages: 0.916
[2024-08-05 10:51:49,472] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 10:51:49,531] {result_logger:103} INFO - precision on Wake: 0.946
[2024-08-05 10:51:49,571] {result_logger:104} INFO - recall on Wake: 0.975
[2024-08-05 10:51:49,611] {result_logger:107} INFO - F1-score on Wake: 0.960
[2024-08-05 10:51:49,611] {result_logger:108} INFO - 
[2024-08-05 10:51:49,668] {result_logger:103} INFO - precision on REM: 0.698
[2024-08-05 10:51:49,708] {result_logger:104} INFO - recall on REM: 0.982
[2024-08-05 10:51:49,748] {result_logger:107} INFO - F1-score on REM: 0.816
[2024-08-05 10:51:49,748] {result_logger:108} INFO - 
[2024-08-05 10:51:49,806] {result_logger:103} INFO - precision on Non REM: 0.969
[2024-08-05 10:51:49,846] {result_logger:104} INFO - recall on Non REM: 0.880
[2024-08-05 10:51:49,886] {result_logger:107} INFO - F1-score on Non REM: 0.922
[2024-08-05 10:51:49,886] {result_logger:108} INFO - 
[2024-08-05 10:51:49,893] {result_logger:111} INFO - average precision on sleep stages: 0.871
[2024-08-05 10:51:49,899] {result_logger:113} INFO - average recall on sleep stages: 0.945
[2024-08-05 10:51:49,906] {result_logger:115} INFO - average F1-score on sleep stages: 0.899
[2024-08-05 10:51:49,906] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 10:51:49,950] {result_logger:134} INFO - 
[[195442   1884   6421]
 [   433  17581    592]
 [  4204   4048 135515]]
[2024-08-05 10:51:49,994] {result_logger:141} INFO - 
[[ 95.92%   0.92%   3.15%]
 [  2.33%  94.49%   3.18%]
 [  2.92%   2.82%  94.26%]]
[2024-08-05 10:51:50,038] {result_logger:145} INFO - 
[[ 97.68%   8.01%   4.51%]
 [  0.22%  74.77%   0.42%]
 [  2.10%  17.22%  95.08%]]
[2024-08-05 10:51:50,039] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 10:51:50,043] {result_logger:134} INFO - 
[[27679   162   541]
 [   14  2498    33]
 [ 1573   920 18210]]
[2024-08-05 10:51:50,182] {result_logger:141} INFO - 
[[ 97.52%   0.57%   1.91%]
 [  0.55%  98.15%   1.30%]
 [  7.60%   4.44%  87.96%]]
[2024-08-05 10:51:50,272] {result_logger:145} INFO - 
[[ 94.58%   4.53%   2.88%]
 [  0.05%  69.78%   0.18%]
 [  5.37%  25.70%  96.94%]]
[2024-08-05 10:51:50,493] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 10:51:50,493] {result_logger:77} INFO - actual:
[2024-08-05 10:51:50,493] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 10:51:50,493] {result_logger:79} INFO - predicted:
[2024-08-05 10:51:50,493] {result_logger:80} INFO - 
[[93.46%  0.27%  6.27%]
 [16.34% 78.02%  5.64%]
 [ 7.07%  3.77% 89.16%]]
[2024-08-05 10:51:50,570] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_D_weighted/model_8conv_2fc-best.pth
[2024-08-05 10:51:50,570] {run_experiment:113} INFO - [epoch  10] execution time: 125.32s	 avg f1-score: 0.8994

[2024-08-05 10:51:50,570] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:51:50,589] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:52:41,097] {train_model:82} INFO - Train Epoch: 11 [36352/366120 (10%)]	lr:2.35e-04	Loss: 0.112395
[2024-08-05 10:52:47,012] {train_model:82} INFO - Train Epoch: 11 [72960/366120 (20%)]	lr:2.35e-04	Loss: 0.239386
[2024-08-05 10:52:52,930] {train_model:82} INFO - Train Epoch: 11 [109568/366120 (30%)]	lr:2.35e-04	Loss: 0.124628
[2024-08-05 10:52:58,866] {train_model:82} INFO - Train Epoch: 11 [146176/366120 (40%)]	lr:2.35e-04	Loss: 0.702875
[2024-08-05 10:53:04,812] {train_model:82} INFO - Train Epoch: 11 [182784/366120 (50%)]	lr:2.35e-04	Loss: 0.171677
[2024-08-05 10:53:10,765] {train_model:82} INFO - Train Epoch: 11 [219392/366120 (60%)]	lr:2.35e-04	Loss: 0.142293
[2024-08-05 10:53:16,730] {train_model:82} INFO - Train Epoch: 11 [256000/366120 (70%)]	lr:2.35e-04	Loss: 0.085619
[2024-08-05 10:53:22,703] {train_model:82} INFO - Train Epoch: 11 [292608/366120 (80%)]	lr:2.35e-04	Loss: 0.570693
[2024-08-05 10:53:28,685] {train_model:82} INFO - Train Epoch: 11 [329216/366120 (90%)]	lr:2.35e-04	Loss: 0.075710
[2024-08-05 10:53:34,699] {train_model:82} INFO - Train Epoch: 11 [365824/366120 (100%)]	lr:2.35e-04	Loss: 0.414923
[2024-08-05 10:53:38,925] {run_experiment:79} INFO - 
[2024-08-05 10:53:38,925] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 10:53:39,376] {result_logger:103} INFO - precision on Wake: 0.977
[2024-08-05 10:53:39,705] {result_logger:104} INFO - recall on Wake: 0.964
[2024-08-05 10:53:40,032] {result_logger:107} INFO - F1-score on Wake: 0.971
[2024-08-05 10:53:40,032] {result_logger:108} INFO - 
[2024-08-05 10:53:40,446] {result_logger:103} INFO - precision on REM: 0.756
[2024-08-05 10:53:40,729] {result_logger:104} INFO - recall on REM: 0.950
[2024-08-05 10:53:41,009] {result_logger:107} INFO - F1-score on REM: 0.842
[2024-08-05 10:53:41,009] {result_logger:108} INFO - 
[2024-08-05 10:53:41,451] {result_logger:103} INFO - precision on Non REM: 0.957
[2024-08-05 10:53:41,772] {result_logger:104} INFO - recall on Non REM: 0.943
[2024-08-05 10:53:42,093] {result_logger:107} INFO - F1-score on Non REM: 0.950
[2024-08-05 10:53:42,093] {result_logger:108} INFO - 
[2024-08-05 10:53:42,162] {result_logger:111} INFO - average precision on sleep stages: 0.897
[2024-08-05 10:53:42,232] {result_logger:113} INFO - average recall on sleep stages: 0.952
[2024-08-05 10:53:42,301] {result_logger:115} INFO - average F1-score on sleep stages: 0.921
[2024-08-05 10:53:42,302] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 10:53:42,359] {result_logger:103} INFO - precision on Wake: 0.960
[2024-08-05 10:53:42,397] {result_logger:104} INFO - recall on Wake: 0.976
[2024-08-05 10:53:42,443] {result_logger:107} INFO - F1-score on Wake: 0.968
[2024-08-05 10:53:42,443] {result_logger:108} INFO - 
[2024-08-05 10:53:42,501] {result_logger:103} INFO - precision on REM: 0.699
[2024-08-05 10:53:42,540] {result_logger:104} INFO - recall on REM: 0.980
[2024-08-05 10:53:42,580] {result_logger:107} INFO - F1-score on REM: 0.816
[2024-08-05 10:53:42,580] {result_logger:108} INFO - 
[2024-08-05 10:53:42,637] {result_logger:103} INFO - precision on Non REM: 0.973
[2024-08-05 10:53:42,677] {result_logger:104} INFO - recall on Non REM: 0.903
[2024-08-05 10:53:42,717] {result_logger:107} INFO - F1-score on Non REM: 0.937
[2024-08-05 10:53:42,717] {result_logger:108} INFO - 
[2024-08-05 10:53:42,723] {result_logger:111} INFO - average precision on sleep stages: 0.877
[2024-08-05 10:53:42,729] {result_logger:113} INFO - average recall on sleep stages: 0.953
[2024-08-05 10:53:42,735] {result_logger:115} INFO - average F1-score on sleep stages: 0.907
[2024-08-05 10:53:42,735] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 10:53:42,782] {result_logger:134} INFO - 
[[196470   1752   5525]
 [   385  17677    544]
 [  4234   3962 135571]]
[2024-08-05 10:53:42,828] {result_logger:141} INFO - 
[[ 96.43%   0.86%   2.71%]
 [  2.07%  95.01%   2.92%]
 [  2.95%   2.76%  94.30%]]
[2024-08-05 10:53:42,875] {result_logger:145} INFO - 
[[ 97.70%   7.49%   3.90%]
 [  0.19%  75.57%   0.38%]
 [  2.11%  16.94%  95.72%]]
[2024-08-05 10:53:42,875] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 10:53:42,879] {result_logger:134} INFO - 
[[27687   206   489]
 [   19  2493    33]
 [ 1133   865 18705]]
[2024-08-05 10:53:42,931] {result_logger:141} INFO - 
[[ 97.55%   0.73%   1.72%]
 [  0.75%  97.96%   1.30%]
 [  5.47%   4.18%  90.35%]]
[2024-08-05 10:53:42,980] {result_logger:145} INFO - 
[[ 96.01%   5.78%   2.54%]
 [  0.07%  69.95%   0.17%]
 [  3.93%  24.27%  97.29%]]
[2024-08-05 10:53:43,139] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 10:53:43,139] {result_logger:77} INFO - actual:
[2024-08-05 10:53:43,140] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 10:53:43,140] {result_logger:79} INFO - predicted:
[2024-08-05 10:53:43,140] {result_logger:80} INFO - 
[[94.20%  0.39%  5.42%]
 [17.48% 77.58%  4.94%]
 [ 5.47%  3.57% 90.96%]]
[2024-08-05 10:53:43,194] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_D_weighted/model_8conv_2fc-best.pth
[2024-08-05 10:53:43,194] {run_experiment:113} INFO - [epoch  11] execution time: 112.62s	 avg f1-score: 0.9069

[2024-08-05 10:53:43,194] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:53:43,214] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:54:10,817] {train_model:82} INFO - Train Epoch: 12 [36352/366120 (10%)]	lr:2.56e-04	Loss: 0.247998
[2024-08-05 10:54:16,716] {train_model:82} INFO - Train Epoch: 12 [72960/366120 (20%)]	lr:2.56e-04	Loss: 0.100299
[2024-08-05 10:54:22,632] {train_model:82} INFO - Train Epoch: 12 [109568/366120 (30%)]	lr:2.56e-04	Loss: 1.605401
[2024-08-05 10:54:28,554] {train_model:82} INFO - Train Epoch: 12 [146176/366120 (40%)]	lr:2.56e-04	Loss: 0.666678
[2024-08-05 10:54:34,491] {train_model:82} INFO - Train Epoch: 12 [182784/366120 (50%)]	lr:2.56e-04	Loss: 0.155151
[2024-08-05 10:54:40,537] {train_model:82} INFO - Train Epoch: 12 [219392/366120 (60%)]	lr:2.56e-04	Loss: 0.045334
[2024-08-05 10:54:46,492] {train_model:82} INFO - Train Epoch: 12 [256000/366120 (70%)]	lr:2.56e-04	Loss: 0.120906
[2024-08-05 10:54:52,460] {train_model:82} INFO - Train Epoch: 12 [292608/366120 (80%)]	lr:2.56e-04	Loss: 0.090082
[2024-08-05 10:54:58,435] {train_model:82} INFO - Train Epoch: 12 [329216/366120 (90%)]	lr:2.56e-04	Loss: 0.094988
[2024-08-05 10:55:07,445] {train_model:82} INFO - Train Epoch: 12 [365824/366120 (100%)]	lr:2.56e-04	Loss: 0.104154
[2024-08-05 10:55:13,076] {run_experiment:79} INFO - 
[2024-08-05 10:55:13,076] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 10:55:13,522] {result_logger:103} INFO - precision on Wake: 0.978
[2024-08-05 10:55:13,850] {result_logger:104} INFO - recall on Wake: 0.965
[2024-08-05 10:55:14,179] {result_logger:107} INFO - F1-score on Wake: 0.972
[2024-08-05 10:55:14,179] {result_logger:108} INFO - 
[2024-08-05 10:55:14,592] {result_logger:103} INFO - precision on REM: 0.764
[2024-08-05 10:55:14,883] {result_logger:104} INFO - recall on REM: 0.952
[2024-08-05 10:55:15,164] {result_logger:107} INFO - F1-score on REM: 0.848
[2024-08-05 10:55:15,164] {result_logger:108} INFO - 
[2024-08-05 10:55:15,609] {result_logger:103} INFO - precision on Non REM: 0.958
[2024-08-05 10:55:15,933] {result_logger:104} INFO - recall on Non REM: 0.945
[2024-08-05 10:55:16,260] {result_logger:107} INFO - F1-score on Non REM: 0.952
[2024-08-05 10:55:16,260] {result_logger:108} INFO - 
[2024-08-05 10:55:16,326] {result_logger:111} INFO - average precision on sleep stages: 0.900
[2024-08-05 10:55:16,392] {result_logger:113} INFO - average recall on sleep stages: 0.954
[2024-08-05 10:55:16,458] {result_logger:115} INFO - average F1-score on sleep stages: 0.924
[2024-08-05 10:55:16,459] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 10:55:16,515] {result_logger:103} INFO - precision on Wake: 0.981
[2024-08-05 10:55:16,555] {result_logger:104} INFO - recall on Wake: 0.971
[2024-08-05 10:55:16,595] {result_logger:107} INFO - F1-score on Wake: 0.976
[2024-08-05 10:55:16,596] {result_logger:108} INFO - 
[2024-08-05 10:55:16,653] {result_logger:103} INFO - precision on REM: 0.773
[2024-08-05 10:55:16,693] {result_logger:104} INFO - recall on REM: 0.956
[2024-08-05 10:55:16,733] {result_logger:107} INFO - F1-score on REM: 0.855
[2024-08-05 10:55:16,733] {result_logger:108} INFO - 
[2024-08-05 10:55:16,791] {result_logger:103} INFO - precision on Non REM: 0.961
[2024-08-05 10:55:16,831] {result_logger:104} INFO - recall on Non REM: 0.946
[2024-08-05 10:55:16,871] {result_logger:107} INFO - F1-score on Non REM: 0.953
[2024-08-05 10:55:16,871] {result_logger:108} INFO - 
[2024-08-05 10:55:16,878] {result_logger:111} INFO - average precision on sleep stages: 0.905
[2024-08-05 10:55:16,884] {result_logger:113} INFO - average recall on sleep stages: 0.958
[2024-08-05 10:55:16,890] {result_logger:115} INFO - average F1-score on sleep stages: 0.928
[2024-08-05 10:55:16,890] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 10:55:16,936] {result_logger:134} INFO - 
[[196673   1614   5460]
 [   355  17706    545]
 [  3997   3847 135923]]
[2024-08-05 10:55:16,982] {result_logger:141} INFO - 
[[ 96.53%   0.79%   2.68%]
 [  1.91%  95.16%   2.93%]
 [  2.78%   2.68%  94.54%]]
[2024-08-05 10:55:17,026] {result_logger:145} INFO - 
[[ 97.84%   6.97%   3.85%]
 [  0.18%  76.43%   0.38%]
 [  1.99%  16.61%  95.77%]]
[2024-08-05 10:55:17,026] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 10:55:17,031] {result_logger:134} INFO - 
[[27554   111   717]
 [   33  2434    78]
 [  514   602 19587]]
[2024-08-05 10:55:17,262] {result_logger:141} INFO - 
[[ 97.08%   0.39%   2.53%]
 [  1.30%  95.64%   3.06%]
 [  2.48%   2.91%  94.61%]]
[2024-08-05 10:55:17,380] {result_logger:145} INFO - 
[[ 98.05%   3.53%   3.52%]
 [  0.12%  77.34%   0.38%]
 [  1.83%  19.13%  96.10%]]
[2024-08-05 10:55:17,676] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 10:55:17,677] {result_logger:77} INFO - actual:
[2024-08-05 10:55:17,677] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 10:55:17,677] {result_logger:79} INFO - predicted:
[2024-08-05 10:55:17,677] {result_logger:80} INFO - 
[[95.07%  0.21%  4.72%]
 [15.57% 78.27%  6.16%]
 [ 4.39%  3.07% 92.54%]]
[2024-08-05 10:55:17,811] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_D_weighted/model_8conv_2fc-best.pth
[2024-08-05 10:55:17,811] {run_experiment:113} INFO - [epoch  12] execution time: 94.62s	 avg f1-score: 0.9281

[2024-08-05 10:55:17,812] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:55:17,831] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:56:06,404] {train_model:82} INFO - Train Epoch: 13 [36352/366120 (10%)]	lr:2.41e-04	Loss: 0.095170
[2024-08-05 10:56:12,191] {train_model:82} INFO - Train Epoch: 13 [72960/366120 (20%)]	lr:2.41e-04	Loss: 0.525561
[2024-08-05 10:56:18,000] {train_model:82} INFO - Train Epoch: 13 [109568/366120 (30%)]	lr:2.41e-04	Loss: 0.049915
[2024-08-05 10:56:23,819] {train_model:82} INFO - Train Epoch: 13 [146176/366120 (40%)]	lr:2.41e-04	Loss: 0.087954
[2024-08-05 10:56:29,641] {train_model:82} INFO - Train Epoch: 13 [182784/366120 (50%)]	lr:2.41e-04	Loss: 0.086613
[2024-08-05 10:56:35,491] {train_model:82} INFO - Train Epoch: 13 [219392/366120 (60%)]	lr:2.41e-04	Loss: 0.098263
[2024-08-05 10:56:41,353] {train_model:82} INFO - Train Epoch: 13 [256000/366120 (70%)]	lr:2.41e-04	Loss: 0.128490
[2024-08-05 10:56:47,226] {train_model:82} INFO - Train Epoch: 13 [292608/366120 (80%)]	lr:2.41e-04	Loss: 0.113126
[2024-08-05 10:56:53,109] {train_model:82} INFO - Train Epoch: 13 [329216/366120 (90%)]	lr:2.41e-04	Loss: 0.163031
[2024-08-05 10:56:59,026] {train_model:82} INFO - Train Epoch: 13 [365824/366120 (100%)]	lr:2.41e-04	Loss: 0.137636
[2024-08-05 10:57:07,343] {run_experiment:79} INFO - 
[2024-08-05 10:57:07,344] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 10:57:07,791] {result_logger:103} INFO - precision on Wake: 0.979
[2024-08-05 10:57:08,110] {result_logger:104} INFO - recall on Wake: 0.969
[2024-08-05 10:57:08,430] {result_logger:107} INFO - F1-score on Wake: 0.974
[2024-08-05 10:57:08,430] {result_logger:108} INFO - 
[2024-08-05 10:57:08,825] {result_logger:103} INFO - precision on REM: 0.778
[2024-08-05 10:57:09,106] {result_logger:104} INFO - recall on REM: 0.960
[2024-08-05 10:57:09,388] {result_logger:107} INFO - F1-score on REM: 0.860
[2024-08-05 10:57:09,388] {result_logger:108} INFO - 
[2024-08-05 10:57:09,827] {result_logger:103} INFO - precision on Non REM: 0.962
[2024-08-05 10:57:10,146] {result_logger:104} INFO - recall on Non REM: 0.947
[2024-08-05 10:57:10,464] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2024-08-05 10:57:10,464] {result_logger:108} INFO - 
[2024-08-05 10:57:10,533] {result_logger:111} INFO - average precision on sleep stages: 0.906
[2024-08-05 10:57:10,601] {result_logger:113} INFO - average recall on sleep stages: 0.959
[2024-08-05 10:57:10,670] {result_logger:115} INFO - average F1-score on sleep stages: 0.929
[2024-08-05 10:57:10,671] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 10:57:10,726] {result_logger:103} INFO - precision on Wake: 0.965
[2024-08-05 10:57:10,765] {result_logger:104} INFO - recall on Wake: 0.981
[2024-08-05 10:57:10,804] {result_logger:107} INFO - F1-score on Wake: 0.973
[2024-08-05 10:57:10,804] {result_logger:108} INFO - 
[2024-08-05 10:57:10,859] {result_logger:103} INFO - precision on REM: 0.766
[2024-08-05 10:57:10,898] {result_logger:104} INFO - recall on REM: 0.979
[2024-08-05 10:57:10,937] {result_logger:107} INFO - F1-score on REM: 0.860
[2024-08-05 10:57:10,937] {result_logger:108} INFO - 
[2024-08-05 10:57:10,993] {result_logger:103} INFO - precision on Non REM: 0.979
[2024-08-05 10:57:11,032] {result_logger:104} INFO - recall on Non REM: 0.923
[2024-08-05 10:57:11,072] {result_logger:107} INFO - F1-score on Non REM: 0.950
[2024-08-05 10:57:11,072] {result_logger:108} INFO - 
[2024-08-05 10:57:11,078] {result_logger:111} INFO - average precision on sleep stages: 0.903
[2024-08-05 10:57:11,084] {result_logger:113} INFO - average recall on sleep stages: 0.961
[2024-08-05 10:57:11,091] {result_logger:115} INFO - average F1-score on sleep stages: 0.928
[2024-08-05 10:57:11,091] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 10:57:11,138] {result_logger:134} INFO - 
[[197445   1395   4907]
 [   261  17870    475]
 [  3991   3694 136082]]
[2024-08-05 10:57:11,185] {result_logger:141} INFO - 
[[ 96.91%   0.68%   2.41%]
 [  1.40%  96.04%   2.55%]
 [  2.78%   2.57%  94.65%]]
[2024-08-05 10:57:11,232] {result_logger:145} INFO - 
[[ 97.89%   6.08%   3.47%]
 [  0.13%  77.83%   0.34%]
 [  1.98%  16.09%  96.20%]]
[2024-08-05 10:57:11,232] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 10:57:11,237] {result_logger:134} INFO - 
[[27836   173   373]
 [   19  2491    35]
 [ 1000   586 19117]]
[2024-08-05 10:57:11,241] {result_logger:141} INFO - 
[[ 98.08%   0.61%   1.31%]
 [  0.75%  97.88%   1.38%]
 [  4.83%   2.83%  92.34%]]
[2024-08-05 10:57:11,246] {result_logger:145} INFO - 
[[ 96.47%   5.32%   1.91%]
 [  0.07%  76.65%   0.18%]
 [  3.47%  18.03%  97.91%]]
[2024-08-05 10:57:11,296] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 10:57:11,296] {result_logger:77} INFO - actual:
[2024-08-05 10:57:11,296] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 10:57:11,296] {result_logger:79} INFO - predicted:
[2024-08-05 10:57:11,296] {result_logger:80} INFO - 
[[95.04%  0.34%  4.62%]
 [17.08% 78.43%  4.49%]
 [ 4.49%  3.08% 92.43%]]
[2024-08-05 10:57:11,296] {run_experiment:113} INFO - [epoch  13] execution time: 113.48s	 avg f1-score: 0.9276

[2024-08-05 10:57:11,296] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:57:11,316] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:58:01,249] {train_model:82} INFO - Train Epoch: 14 [36352/366120 (10%)]	lr:2.27e-04	Loss: 0.087944
[2024-08-05 10:58:07,131] {train_model:82} INFO - Train Epoch: 14 [72960/366120 (20%)]	lr:2.27e-04	Loss: 0.086407
[2024-08-05 10:58:13,031] {train_model:82} INFO - Train Epoch: 14 [109568/366120 (30%)]	lr:2.27e-04	Loss: 0.253213
[2024-08-05 10:58:18,945] {train_model:82} INFO - Train Epoch: 14 [146176/366120 (40%)]	lr:2.27e-04	Loss: 0.041248
[2024-08-05 10:58:24,865] {train_model:82} INFO - Train Epoch: 14 [182784/366120 (50%)]	lr:2.27e-04	Loss: 0.147709
[2024-08-05 10:58:30,805] {train_model:82} INFO - Train Epoch: 14 [219392/366120 (60%)]	lr:2.27e-04	Loss: 0.190036
[2024-08-05 10:58:36,747] {train_model:82} INFO - Train Epoch: 14 [256000/366120 (70%)]	lr:2.27e-04	Loss: 0.324049
[2024-08-05 10:58:42,688] {train_model:82} INFO - Train Epoch: 14 [292608/366120 (80%)]	lr:2.27e-04	Loss: 0.046418
[2024-08-05 10:58:48,646] {train_model:82} INFO - Train Epoch: 14 [329216/366120 (90%)]	lr:2.27e-04	Loss: 0.060079
[2024-08-05 10:58:54,632] {train_model:82} INFO - Train Epoch: 14 [365824/366120 (100%)]	lr:2.27e-04	Loss: 0.069067
[2024-08-05 10:59:02,554] {run_experiment:79} INFO - 
[2024-08-05 10:59:02,555] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 10:59:03,005] {result_logger:103} INFO - precision on Wake: 0.980
[2024-08-05 10:59:03,333] {result_logger:104} INFO - recall on Wake: 0.971
[2024-08-05 10:59:03,662] {result_logger:107} INFO - F1-score on Wake: 0.976
[2024-08-05 10:59:03,662] {result_logger:108} INFO - 
[2024-08-05 10:59:04,065] {result_logger:103} INFO - precision on REM: 0.792
[2024-08-05 10:59:04,347] {result_logger:104} INFO - recall on REM: 0.961
[2024-08-05 10:59:04,631] {result_logger:107} INFO - F1-score on REM: 0.868
[2024-08-05 10:59:04,631] {result_logger:108} INFO - 
[2024-08-05 10:59:05,081] {result_logger:103} INFO - precision on Non REM: 0.963
[2024-08-05 10:59:05,407] {result_logger:104} INFO - recall on Non REM: 0.949
[2024-08-05 10:59:05,734] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2024-08-05 10:59:05,735] {result_logger:108} INFO - 
[2024-08-05 10:59:05,797] {result_logger:111} INFO - average precision on sleep stages: 0.912
[2024-08-05 10:59:05,860] {result_logger:113} INFO - average recall on sleep stages: 0.961
[2024-08-05 10:59:05,922] {result_logger:115} INFO - average F1-score on sleep stages: 0.933
[2024-08-05 10:59:05,923] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 10:59:05,980] {result_logger:103} INFO - precision on Wake: 0.964
[2024-08-05 10:59:06,019] {result_logger:104} INFO - recall on Wake: 0.981
[2024-08-05 10:59:06,059] {result_logger:107} INFO - F1-score on Wake: 0.972
[2024-08-05 10:59:06,059] {result_logger:108} INFO - 
[2024-08-05 10:59:06,115] {result_logger:103} INFO - precision on REM: 0.727
[2024-08-05 10:59:06,153] {result_logger:104} INFO - recall on REM: 0.983
[2024-08-05 10:59:06,192] {result_logger:107} INFO - F1-score on REM: 0.836
[2024-08-05 10:59:06,192] {result_logger:108} INFO - 
[2024-08-05 10:59:06,250] {result_logger:103} INFO - precision on Non REM: 0.981
[2024-08-05 10:59:06,289] {result_logger:104} INFO - recall on Non REM: 0.915
[2024-08-05 10:59:06,329] {result_logger:107} INFO - F1-score on Non REM: 0.947
[2024-08-05 10:59:06,329] {result_logger:108} INFO - 
[2024-08-05 10:59:06,335] {result_logger:111} INFO - average precision on sleep stages: 0.891
[2024-08-05 10:59:06,341] {result_logger:113} INFO - average recall on sleep stages: 0.960
[2024-08-05 10:59:06,347] {result_logger:115} INFO - average F1-score on sleep stages: 0.919
[2024-08-05 10:59:06,348] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 10:59:06,390] {result_logger:134} INFO - 
[[197841   1140   4766]
 [   241  17889    476]
 [  3753   3566 136448]]
[2024-08-05 10:59:06,433] {result_logger:141} INFO - 
[[ 97.10%   0.56%   2.34%]
 [  1.30%  96.15%   2.56%]
 [  2.61%   2.48%  94.91%]]
[2024-08-05 10:59:06,475] {result_logger:145} INFO - 
[[ 98.02%   5.05%   3.36%]
 [  0.12%  79.17%   0.34%]
 [  1.86%  15.78%  96.30%]]
[2024-08-05 10:59:06,475] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 10:59:06,480] {result_logger:134} INFO - 
[[27843   211   328]
 [   11  2502    32]
 [ 1025   728 18950]]
[2024-08-05 10:59:06,484] {result_logger:141} INFO - 
[[ 98.10%   0.74%   1.16%]
 [  0.43%  98.31%   1.26%]
 [  4.95%   3.52%  91.53%]]
[2024-08-05 10:59:06,489] {result_logger:145} INFO - 
[[ 96.41%   6.13%   1.70%]
 [  0.04%  72.71%   0.17%]
 [  3.55%  21.16%  98.14%]]
[2024-08-05 10:59:06,540] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 10:59:06,540] {result_logger:77} INFO - actual:
[2024-08-05 10:59:06,540] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 10:59:06,540] {result_logger:79} INFO - predicted:
[2024-08-05 10:59:06,540] {result_logger:80} INFO - 
[[94.63%  0.38%  4.99%]
 [17.81% 76.23%  5.96%]
 [ 4.85%  3.67% 91.48%]]
[2024-08-05 10:59:06,540] {run_experiment:113} INFO - [epoch  14] execution time: 115.24s	 avg f1-score: 0.9185

[2024-08-05 10:59:06,540] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:59:06,559] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:59:55,549] {train_model:82} INFO - Train Epoch: 15 [36352/366120 (10%)]	lr:2.14e-04	Loss: 0.085662
[2024-08-05 11:00:01,426] {train_model:82} INFO - Train Epoch: 15 [72960/366120 (20%)]	lr:2.14e-04	Loss: 3.491435
[2024-08-05 11:00:07,316] {train_model:82} INFO - Train Epoch: 15 [109568/366120 (30%)]	lr:2.14e-04	Loss: 0.089479
[2024-08-05 11:00:13,211] {train_model:82} INFO - Train Epoch: 15 [146176/366120 (40%)]	lr:2.14e-04	Loss: 0.275304
[2024-08-05 11:00:19,133] {train_model:82} INFO - Train Epoch: 15 [182784/366120 (50%)]	lr:2.14e-04	Loss: 0.052346
[2024-08-05 11:00:25,107] {train_model:82} INFO - Train Epoch: 15 [219392/366120 (60%)]	lr:2.14e-04	Loss: 0.062665
[2024-08-05 11:00:31,056] {train_model:82} INFO - Train Epoch: 15 [256000/366120 (70%)]	lr:2.14e-04	Loss: 0.104361
[2024-08-05 11:00:37,017] {train_model:82} INFO - Train Epoch: 15 [292608/366120 (80%)]	lr:2.14e-04	Loss: 0.086472
[2024-08-05 11:00:42,981] {train_model:82} INFO - Train Epoch: 15 [329216/366120 (90%)]	lr:2.14e-04	Loss: 0.043530
[2024-08-05 11:00:48,948] {train_model:82} INFO - Train Epoch: 15 [365824/366120 (100%)]	lr:2.14e-04	Loss: 0.105681
[2024-08-05 11:00:56,803] {run_experiment:79} INFO - 
[2024-08-05 11:00:56,803] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:00:57,249] {result_logger:103} INFO - precision on Wake: 0.981
[2024-08-05 11:00:57,580] {result_logger:104} INFO - recall on Wake: 0.972
[2024-08-05 11:00:57,912] {result_logger:107} INFO - F1-score on Wake: 0.977
[2024-08-05 11:00:57,912] {result_logger:108} INFO - 
[2024-08-05 11:00:58,326] {result_logger:103} INFO - precision on REM: 0.800
[2024-08-05 11:00:58,612] {result_logger:104} INFO - recall on REM: 0.967
[2024-08-05 11:00:58,902] {result_logger:107} INFO - F1-score on REM: 0.875
[2024-08-05 11:00:58,902] {result_logger:108} INFO - 
[2024-08-05 11:00:59,354] {result_logger:103} INFO - precision on Non REM: 0.965
[2024-08-05 11:00:59,682] {result_logger:104} INFO - recall on Non REM: 0.951
[2024-08-05 11:01:00,009] {result_logger:107} INFO - F1-score on Non REM: 0.958
[2024-08-05 11:01:00,009] {result_logger:108} INFO - 
[2024-08-05 11:01:00,078] {result_logger:111} INFO - average precision on sleep stages: 0.915
[2024-08-05 11:01:00,147] {result_logger:113} INFO - average recall on sleep stages: 0.963
[2024-08-05 11:01:00,216] {result_logger:115} INFO - average F1-score on sleep stages: 0.937
[2024-08-05 11:01:00,217] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:01:00,274] {result_logger:103} INFO - precision on Wake: 0.971
[2024-08-05 11:01:00,314] {result_logger:104} INFO - recall on Wake: 0.984
[2024-08-05 11:01:00,353] {result_logger:107} INFO - F1-score on Wake: 0.978
[2024-08-05 11:01:00,353] {result_logger:108} INFO - 
[2024-08-05 11:01:00,410] {result_logger:103} INFO - precision on REM: 0.804
[2024-08-05 11:01:00,449] {result_logger:104} INFO - recall on REM: 0.971
[2024-08-05 11:01:00,488] {result_logger:107} INFO - F1-score on REM: 0.879
[2024-08-05 11:01:00,488] {result_logger:108} INFO - 
[2024-08-05 11:01:00,545] {result_logger:103} INFO - precision on Non REM: 0.980
[2024-08-05 11:01:00,584] {result_logger:104} INFO - recall on Non REM: 0.937
[2024-08-05 11:01:00,624] {result_logger:107} INFO - F1-score on Non REM: 0.958
[2024-08-05 11:01:00,624] {result_logger:108} INFO - 
[2024-08-05 11:01:00,630] {result_logger:111} INFO - average precision on sleep stages: 0.918
[2024-08-05 11:01:00,636] {result_logger:113} INFO - average recall on sleep stages: 0.964
[2024-08-05 11:01:00,643] {result_logger:115} INFO - average F1-score on sleep stages: 0.938
[2024-08-05 11:01:00,643] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:01:00,690] {result_logger:134} INFO - 
[[198098   1052   4597]
 [   203  17987    416]
 [  3631   3452 136684]]
[2024-08-05 11:01:00,737] {result_logger:141} INFO - 
[[ 97.23%   0.52%   2.26%]
 [  1.09%  96.67%   2.24%]
 [  2.53%   2.40%  95.07%]]
[2024-08-05 11:01:00,784] {result_logger:145} INFO - 
[[ 98.10%   4.68%   3.24%]
 [  0.10%  79.97%   0.29%]
 [  1.80%  15.35%  96.46%]]
[2024-08-05 11:01:00,784] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:01:00,789] {result_logger:134} INFO - 
[[27936   106   340]
 [   18  2470    57]
 [  807   498 19398]]
[2024-08-05 11:01:01,033] {result_logger:141} INFO - 
[[ 98.43%   0.37%   1.20%]
 [  0.71%  97.05%   2.24%]
 [  3.90%   2.41%  93.70%]]
[2024-08-05 11:01:01,236] {result_logger:145} INFO - 
[[ 97.13%   3.45%   1.72%]
 [  0.06%  80.35%   0.29%]
 [  2.81%  16.20%  97.99%]]
[2024-08-05 11:01:01,528] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:01:01,528] {result_logger:77} INFO - actual:
[2024-08-05 11:01:01,528] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:01:01,528] {result_logger:79} INFO - predicted:
[2024-08-05 11:01:01,528] {result_logger:80} INFO - 
[[94.94%  0.18%  4.89%]
 [16.59% 79.47%  3.94%]
 [ 4.78%  2.93% 92.29%]]
[2024-08-05 11:01:01,649] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_D_weighted/model_8conv_2fc-best.pth
[2024-08-05 11:01:01,649] {run_experiment:113} INFO - [epoch  15] execution time: 115.11s	 avg f1-score: 0.9383

[2024-08-05 11:01:01,650] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:01:01,670] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:02:19,375] {train_model:82} INFO - Train Epoch: 16 [36352/366120 (10%)]	lr:2.01e-04	Loss: 0.107528
[2024-08-05 11:02:25,263] {train_model:82} INFO - Train Epoch: 16 [72960/366120 (20%)]	lr:2.01e-04	Loss: 0.103712
[2024-08-05 11:02:31,140] {train_model:82} INFO - Train Epoch: 16 [109568/366120 (30%)]	lr:2.01e-04	Loss: 0.044429
[2024-08-05 11:02:37,039] {train_model:82} INFO - Train Epoch: 16 [146176/366120 (40%)]	lr:2.01e-04	Loss: 0.109749
[2024-08-05 11:02:43,084] {train_model:82} INFO - Train Epoch: 16 [182784/366120 (50%)]	lr:2.01e-04	Loss: 0.184398
[2024-08-05 11:02:49,003] {train_model:82} INFO - Train Epoch: 16 [219392/366120 (60%)]	lr:2.01e-04	Loss: 0.073768
[2024-08-05 11:02:54,919] {train_model:82} INFO - Train Epoch: 16 [256000/366120 (70%)]	lr:2.01e-04	Loss: 0.061991
[2024-08-05 11:03:00,849] {train_model:82} INFO - Train Epoch: 16 [292608/366120 (80%)]	lr:2.01e-04	Loss: 0.069072
[2024-08-05 11:03:06,796] {train_model:82} INFO - Train Epoch: 16 [329216/366120 (90%)]	lr:2.01e-04	Loss: 0.110817
[2024-08-05 11:03:12,796] {train_model:82} INFO - Train Epoch: 16 [365824/366120 (100%)]	lr:2.01e-04	Loss: 0.151133
[2024-08-05 11:03:19,853] {run_experiment:79} INFO - 
[2024-08-05 11:03:19,853] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:03:20,299] {result_logger:103} INFO - precision on Wake: 0.982
[2024-08-05 11:03:20,621] {result_logger:104} INFO - recall on Wake: 0.974
[2024-08-05 11:03:20,946] {result_logger:107} INFO - F1-score on Wake: 0.978
[2024-08-05 11:03:20,946] {result_logger:108} INFO - 
[2024-08-05 11:03:21,354] {result_logger:103} INFO - precision on REM: 0.802
[2024-08-05 11:03:21,640] {result_logger:104} INFO - recall on REM: 0.969
[2024-08-05 11:03:21,921] {result_logger:107} INFO - F1-score on REM: 0.878
[2024-08-05 11:03:21,921] {result_logger:108} INFO - 
[2024-08-05 11:03:22,371] {result_logger:103} INFO - precision on Non REM: 0.966
[2024-08-05 11:03:22,698] {result_logger:104} INFO - recall on Non REM: 0.952
[2024-08-05 11:03:23,027] {result_logger:107} INFO - F1-score on Non REM: 0.959
[2024-08-05 11:03:23,027] {result_logger:108} INFO - 
[2024-08-05 11:03:23,090] {result_logger:111} INFO - average precision on sleep stages: 0.917
[2024-08-05 11:03:23,153] {result_logger:113} INFO - average recall on sleep stages: 0.965
[2024-08-05 11:03:23,216] {result_logger:115} INFO - average F1-score on sleep stages: 0.938
[2024-08-05 11:03:23,217] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:03:23,274] {result_logger:103} INFO - precision on Wake: 0.973
[2024-08-05 11:03:23,314] {result_logger:104} INFO - recall on Wake: 0.983
[2024-08-05 11:03:23,353] {result_logger:107} INFO - F1-score on Wake: 0.978
[2024-08-05 11:03:23,353] {result_logger:108} INFO - 
[2024-08-05 11:03:23,409] {result_logger:103} INFO - precision on REM: 0.776
[2024-08-05 11:03:23,448] {result_logger:104} INFO - recall on REM: 0.976
[2024-08-05 11:03:23,487] {result_logger:107} INFO - F1-score on REM: 0.864
[2024-08-05 11:03:23,487] {result_logger:108} INFO - 
[2024-08-05 11:03:23,544] {result_logger:103} INFO - precision on Non REM: 0.977
[2024-08-05 11:03:23,584] {result_logger:104} INFO - recall on Non REM: 0.932
[2024-08-05 11:03:23,624] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2024-08-05 11:03:23,624] {result_logger:108} INFO - 
[2024-08-05 11:03:23,630] {result_logger:111} INFO - average precision on sleep stages: 0.908
[2024-08-05 11:03:23,636] {result_logger:113} INFO - average recall on sleep stages: 0.963
[2024-08-05 11:03:23,642] {result_logger:115} INFO - average F1-score on sleep stages: 0.932
[2024-08-05 11:03:23,642] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:03:23,686] {result_logger:134} INFO - 
[[198372    967   4408]
 [   164  18029    413]
 [  3486   3473 136808]]
[2024-08-05 11:03:23,728] {result_logger:141} INFO - 
[[ 97.36%   0.47%   2.16%]
 [  0.88%  96.90%   2.22%]
 [  2.42%   2.42%  95.16%]]
[2024-08-05 11:03:23,771] {result_logger:145} INFO - 
[[ 98.19%   4.30%   3.11%]
 [  0.08%  80.24%   0.29%]
 [  1.73%  15.46%  96.60%]]
[2024-08-05 11:03:23,771] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:03:23,775] {result_logger:134} INFO - 
[[27891    74   417]
 [   15  2484    46]
 [  771   644 19288]]
[2024-08-05 11:03:23,780] {result_logger:141} INFO - 
[[ 98.27%   0.26%   1.47%]
 [  0.59%  97.60%   1.81%]
 [  3.72%   3.11%  93.17%]]
[2024-08-05 11:03:23,784] {result_logger:145} INFO - 
[[ 97.26%   2.31%   2.11%]
 [  0.05%  77.58%   0.23%]
 [  2.69%  20.11%  97.66%]]
[2024-08-05 11:03:23,835] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:03:23,835] {result_logger:77} INFO - actual:
[2024-08-05 11:03:23,835] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:03:23,835] {result_logger:79} INFO - predicted:
[2024-08-05 11:03:23,835] {result_logger:80} INFO - 
[[95.13%  0.11%  4.76%]
 [15.37% 79.26%  5.37%]
 [ 4.58%  3.20% 92.21%]]
[2024-08-05 11:03:23,835] {run_experiment:113} INFO - [epoch  16] execution time: 142.19s	 avg f1-score: 0.9319

[2024-08-05 11:03:23,835] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:03:23,855] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:04:24,973] {train_model:82} INFO - Train Epoch: 17 [36352/366120 (10%)]	lr:1.90e-04	Loss: 0.102520
[2024-08-05 11:04:30,794] {train_model:82} INFO - Train Epoch: 17 [72960/366120 (20%)]	lr:1.90e-04	Loss: 0.062444
[2024-08-05 11:04:36,606] {train_model:82} INFO - Train Epoch: 17 [109568/366120 (30%)]	lr:1.90e-04	Loss: 0.120887
[2024-08-05 11:04:42,394] {train_model:82} INFO - Train Epoch: 17 [146176/366120 (40%)]	lr:1.90e-04	Loss: 0.455151
[2024-08-05 11:04:48,197] {train_model:82} INFO - Train Epoch: 17 [182784/366120 (50%)]	lr:1.90e-04	Loss: 0.084250
[2024-08-05 11:04:54,010] {train_model:82} INFO - Train Epoch: 17 [219392/366120 (60%)]	lr:1.90e-04	Loss: 0.086251
[2024-08-05 11:04:59,838] {train_model:82} INFO - Train Epoch: 17 [256000/366120 (70%)]	lr:1.90e-04	Loss: 0.045791
[2024-08-05 11:05:05,675] {train_model:82} INFO - Train Epoch: 17 [292608/366120 (80%)]	lr:1.90e-04	Loss: 0.052676
[2024-08-05 11:05:11,523] {train_model:82} INFO - Train Epoch: 17 [329216/366120 (90%)]	lr:1.90e-04	Loss: 0.068310
[2024-08-05 11:05:17,404] {train_model:82} INFO - Train Epoch: 17 [365824/366120 (100%)]	lr:1.90e-04	Loss: 0.058235
[2024-08-05 11:05:25,385] {run_experiment:79} INFO - 
[2024-08-05 11:05:25,385] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:05:25,834] {result_logger:103} INFO - precision on Wake: 0.982
[2024-08-05 11:05:26,164] {result_logger:104} INFO - recall on Wake: 0.974
[2024-08-05 11:05:26,487] {result_logger:107} INFO - F1-score on Wake: 0.978
[2024-08-05 11:05:26,487] {result_logger:108} INFO - 
[2024-08-05 11:05:26,892] {result_logger:103} INFO - precision on REM: 0.813
[2024-08-05 11:05:27,173] {result_logger:104} INFO - recall on REM: 0.971
[2024-08-05 11:05:27,460] {result_logger:107} INFO - F1-score on REM: 0.885
[2024-08-05 11:05:27,460] {result_logger:108} INFO - 
[2024-08-05 11:05:27,906] {result_logger:103} INFO - precision on Non REM: 0.966
[2024-08-05 11:05:28,230] {result_logger:104} INFO - recall on Non REM: 0.953
[2024-08-05 11:05:28,551] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2024-08-05 11:05:28,551] {result_logger:108} INFO - 
[2024-08-05 11:05:28,618] {result_logger:111} INFO - average precision on sleep stages: 0.921
[2024-08-05 11:05:28,686] {result_logger:113} INFO - average recall on sleep stages: 0.966
[2024-08-05 11:05:28,754] {result_logger:115} INFO - average F1-score on sleep stages: 0.941
[2024-08-05 11:05:28,755] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:05:28,812] {result_logger:103} INFO - precision on Wake: 0.984
[2024-08-05 11:05:28,852] {result_logger:104} INFO - recall on Wake: 0.976
[2024-08-05 11:05:28,893] {result_logger:107} INFO - F1-score on Wake: 0.980
[2024-08-05 11:05:28,893] {result_logger:108} INFO - 
[2024-08-05 11:05:28,950] {result_logger:103} INFO - precision on REM: 0.797
[2024-08-05 11:05:28,989] {result_logger:104} INFO - recall on REM: 0.978
[2024-08-05 11:05:29,029] {result_logger:107} INFO - F1-score on REM: 0.878
[2024-08-05 11:05:29,029] {result_logger:108} INFO - 
[2024-08-05 11:05:29,087] {result_logger:103} INFO - precision on Non REM: 0.968
[2024-08-05 11:05:29,127] {result_logger:104} INFO - recall on Non REM: 0.952
[2024-08-05 11:05:29,167] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2024-08-05 11:05:29,167] {result_logger:108} INFO - 
[2024-08-05 11:05:29,174] {result_logger:111} INFO - average precision on sleep stages: 0.917
[2024-08-05 11:05:29,180] {result_logger:113} INFO - average recall on sleep stages: 0.969
[2024-08-05 11:05:29,186] {result_logger:115} INFO - average F1-score on sleep stages: 0.940
[2024-08-05 11:05:29,186] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:05:29,234] {result_logger:134} INFO - 
[[198451    894   4402]
 [   146  18072    388]
 [  3452   3260 137055]]
[2024-08-05 11:05:29,280] {result_logger:141} INFO - 
[[ 97.40%   0.44%   2.16%]
 [  0.78%  97.13%   2.09%]
 [  2.40%   2.27%  95.33%]]
[2024-08-05 11:05:29,326] {result_logger:145} INFO - 
[[ 98.22%   4.02%   3.10%]
 [  0.07%  81.31%   0.27%]
 [  1.71%  14.67%  96.62%]]
[2024-08-05 11:05:29,327] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:05:29,331] {result_logger:134} INFO - 
[[27699    86   597]
 [   10  2488    47]
 [  437   547 19719]]
[2024-08-05 11:05:29,564] {result_logger:141} INFO - 
[[ 97.59%   0.30%   2.10%]
 [  0.39%  97.76%   1.85%]
 [  2.11%   2.64%  95.25%]]
[2024-08-05 11:05:29,671] {result_logger:145} INFO - 
[[ 98.41%   2.76%   2.93%]
 [  0.04%  79.72%   0.23%]
 [  1.55%  17.53%  96.84%]]
[2024-08-05 11:05:29,953] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:05:29,953] {result_logger:77} INFO - actual:
[2024-08-05 11:05:29,953] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:05:29,954] {result_logger:79} INFO - predicted:
[2024-08-05 11:05:29,954] {result_logger:80} INFO - 
[[95.59%  0.10%  4.31%]
 [14.58% 79.17%  6.25%]
 [ 3.86%  3.05% 93.08%]]
[2024-08-05 11:05:30,047] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_D_weighted/model_8conv_2fc-best.pth
[2024-08-05 11:05:30,047] {run_experiment:113} INFO - [epoch  17] execution time: 126.21s	 avg f1-score: 0.9395

[2024-08-05 11:05:30,048] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:05:30,067] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:06:35,930] {train_model:82} INFO - Train Epoch: 18 [36352/366120 (10%)]	lr:1.79e-04	Loss: 0.069723
[2024-08-05 11:06:41,822] {train_model:82} INFO - Train Epoch: 18 [72960/366120 (20%)]	lr:1.79e-04	Loss: 0.056724
[2024-08-05 11:06:47,719] {train_model:82} INFO - Train Epoch: 18 [109568/366120 (30%)]	lr:1.79e-04	Loss: 0.270861
[2024-08-05 11:06:53,636] {train_model:82} INFO - Train Epoch: 18 [146176/366120 (40%)]	lr:1.79e-04	Loss: 0.078128
[2024-08-05 11:06:59,573] {train_model:82} INFO - Train Epoch: 18 [182784/366120 (50%)]	lr:1.79e-04	Loss: 0.051466
[2024-08-05 11:07:05,517] {train_model:82} INFO - Train Epoch: 18 [219392/366120 (60%)]	lr:1.79e-04	Loss: 0.241477
[2024-08-05 11:07:11,460] {train_model:82} INFO - Train Epoch: 18 [256000/366120 (70%)]	lr:1.79e-04	Loss: 0.078673
[2024-08-05 11:07:17,417] {train_model:82} INFO - Train Epoch: 18 [292608/366120 (80%)]	lr:1.79e-04	Loss: 0.043839
[2024-08-05 11:07:23,399] {train_model:82} INFO - Train Epoch: 18 [329216/366120 (90%)]	lr:1.79e-04	Loss: 0.062856
[2024-08-05 11:07:29,402] {train_model:82} INFO - Train Epoch: 18 [365824/366120 (100%)]	lr:1.79e-04	Loss: 0.063617
[2024-08-05 11:07:35,658] {run_experiment:79} INFO - 
[2024-08-05 11:07:35,658] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:07:36,110] {result_logger:103} INFO - precision on Wake: 0.983
[2024-08-05 11:07:36,428] {result_logger:104} INFO - recall on Wake: 0.976
[2024-08-05 11:07:36,748] {result_logger:107} INFO - F1-score on Wake: 0.979
[2024-08-05 11:07:36,748] {result_logger:108} INFO - 
[2024-08-05 11:07:37,150] {result_logger:103} INFO - precision on REM: 0.823
[2024-08-05 11:07:37,426] {result_logger:104} INFO - recall on REM: 0.973
[2024-08-05 11:07:37,706] {result_logger:107} INFO - F1-score on REM: 0.892
[2024-08-05 11:07:37,706] {result_logger:108} INFO - 
[2024-08-05 11:07:38,149] {result_logger:103} INFO - precision on Non REM: 0.968
[2024-08-05 11:07:38,464] {result_logger:104} INFO - recall on Non REM: 0.956
[2024-08-05 11:07:38,779] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2024-08-05 11:07:38,779] {result_logger:108} INFO - 
[2024-08-05 11:07:38,849] {result_logger:111} INFO - average precision on sleep stages: 0.925
[2024-08-05 11:07:38,919] {result_logger:113} INFO - average recall on sleep stages: 0.968
[2024-08-05 11:07:38,989] {result_logger:115} INFO - average F1-score on sleep stages: 0.944
[2024-08-05 11:07:38,990] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:07:39,046] {result_logger:103} INFO - precision on Wake: 0.984
[2024-08-05 11:07:39,085] {result_logger:104} INFO - recall on Wake: 0.968
[2024-08-05 11:07:39,125] {result_logger:107} INFO - F1-score on Wake: 0.976
[2024-08-05 11:07:39,125] {result_logger:108} INFO - 
[2024-08-05 11:07:39,182] {result_logger:103} INFO - precision on REM: 0.817
[2024-08-05 11:07:39,221] {result_logger:104} INFO - recall on REM: 0.960
[2024-08-05 11:07:39,261] {result_logger:107} INFO - F1-score on REM: 0.882
[2024-08-05 11:07:39,261] {result_logger:108} INFO - 
[2024-08-05 11:07:39,319] {result_logger:103} INFO - precision on Non REM: 0.958
[2024-08-05 11:07:39,358] {result_logger:104} INFO - recall on Non REM: 0.960
[2024-08-05 11:07:39,398] {result_logger:107} INFO - F1-score on Non REM: 0.959
[2024-08-05 11:07:39,398] {result_logger:108} INFO - 
[2024-08-05 11:07:39,404] {result_logger:111} INFO - average precision on sleep stages: 0.920
[2024-08-05 11:07:39,410] {result_logger:113} INFO - average recall on sleep stages: 0.962
[2024-08-05 11:07:39,417] {result_logger:115} INFO - average F1-score on sleep stages: 0.939
[2024-08-05 11:07:39,417] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:07:39,465] {result_logger:134} INFO - 
[[198778    812   4157]
 [   158  18109    339]
 [  3286   3083 137398]]
[2024-08-05 11:07:39,513] {result_logger:141} INFO - 
[[ 97.56%   0.40%   2.04%]
 [  0.85%  97.33%   1.82%]
 [  2.29%   2.14%  95.57%]]
[2024-08-05 11:07:39,561] {result_logger:145} INFO - 
[[ 98.30%   3.69%   2.93%]
 [  0.08%  82.30%   0.24%]
 [  1.62%  14.01%  96.83%]]
[2024-08-05 11:07:39,561] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:07:39,566] {result_logger:134} INFO - 
[[27470   111   801]
 [   39  2442    64]
 [  399   437 19867]]
[2024-08-05 11:07:39,570] {result_logger:141} INFO - 
[[ 96.79%   0.39%   2.82%]
 [  1.53%  95.95%   2.51%]
 [  1.93%   2.11%  95.96%]]
[2024-08-05 11:07:39,575] {result_logger:145} INFO - 
[[ 98.43%   3.71%   3.86%]
 [  0.14%  81.67%   0.31%]
 [  1.43%  14.62%  95.83%]]
[2024-08-05 11:07:39,625] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:07:39,625] {result_logger:77} INFO - actual:
[2024-08-05 11:07:39,625] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:07:39,625] {result_logger:79} INFO - predicted:
[2024-08-05 11:07:39,625] {result_logger:80} INFO - 
[[95.17%  0.23%  4.60%]
 [14.95% 78.60%  6.45%]
 [ 4.35%  2.78% 92.87%]]
[2024-08-05 11:07:39,625] {run_experiment:113} INFO - [epoch  18] execution time: 129.58s	 avg f1-score: 0.9391

[2024-08-05 11:07:39,625] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:07:39,645] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:08:30,766] {train_model:82} INFO - Train Epoch: 19 [36352/366120 (10%)]	lr:1.68e-04	Loss: 0.081180
[2024-08-05 11:08:36,600] {train_model:82} INFO - Train Epoch: 19 [72960/366120 (20%)]	lr:1.68e-04	Loss: 0.076079
[2024-08-05 11:08:42,452] {train_model:82} INFO - Train Epoch: 19 [109568/366120 (30%)]	lr:1.68e-04	Loss: 0.093078
[2024-08-05 11:08:48,320] {train_model:82} INFO - Train Epoch: 19 [146176/366120 (40%)]	lr:1.68e-04	Loss: 0.048944
[2024-08-05 11:08:54,193] {train_model:82} INFO - Train Epoch: 19 [182784/366120 (50%)]	lr:1.68e-04	Loss: 0.162705
[2024-08-05 11:09:00,066] {train_model:82} INFO - Train Epoch: 19 [219392/366120 (60%)]	lr:1.68e-04	Loss: 0.080720
[2024-08-05 11:09:05,948] {train_model:82} INFO - Train Epoch: 19 [256000/366120 (70%)]	lr:1.68e-04	Loss: 0.060418
[2024-08-05 11:09:11,836] {train_model:82} INFO - Train Epoch: 19 [292608/366120 (80%)]	lr:1.68e-04	Loss: 0.046686
[2024-08-05 11:09:17,713] {train_model:82} INFO - Train Epoch: 19 [329216/366120 (90%)]	lr:1.68e-04	Loss: 0.075891
[2024-08-05 11:09:23,611] {train_model:82} INFO - Train Epoch: 19 [365824/366120 (100%)]	lr:1.68e-04	Loss: 0.056572
[2024-08-05 11:09:29,895] {run_experiment:79} INFO - 
[2024-08-05 11:09:29,895] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:09:30,347] {result_logger:103} INFO - precision on Wake: 0.983
[2024-08-05 11:09:30,669] {result_logger:104} INFO - recall on Wake: 0.977
[2024-08-05 11:09:30,997] {result_logger:107} INFO - F1-score on Wake: 0.980
[2024-08-05 11:09:30,997] {result_logger:108} INFO - 
[2024-08-05 11:09:31,406] {result_logger:103} INFO - precision on REM: 0.831
[2024-08-05 11:09:31,686] {result_logger:104} INFO - recall on REM: 0.975
[2024-08-05 11:09:31,972] {result_logger:107} INFO - F1-score on REM: 0.897
[2024-08-05 11:09:31,972] {result_logger:108} INFO - 
[2024-08-05 11:09:32,409] {result_logger:103} INFO - precision on Non REM: 0.969
[2024-08-05 11:09:32,718] {result_logger:104} INFO - recall on Non REM: 0.957
[2024-08-05 11:09:33,026] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2024-08-05 11:09:33,026] {result_logger:108} INFO - 
[2024-08-05 11:09:33,089] {result_logger:111} INFO - average precision on sleep stages: 0.928
[2024-08-05 11:09:33,151] {result_logger:113} INFO - average recall on sleep stages: 0.970
[2024-08-05 11:09:33,214] {result_logger:115} INFO - average F1-score on sleep stages: 0.947
[2024-08-05 11:09:33,215] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:09:33,273] {result_logger:103} INFO - precision on Wake: 0.979
[2024-08-05 11:09:33,311] {result_logger:104} INFO - recall on Wake: 0.971
[2024-08-05 11:09:33,351] {result_logger:107} INFO - F1-score on Wake: 0.975
[2024-08-05 11:09:33,351] {result_logger:108} INFO - 
[2024-08-05 11:09:33,409] {result_logger:103} INFO - precision on REM: 0.781
[2024-08-05 11:09:33,447] {result_logger:104} INFO - recall on REM: 0.964
[2024-08-05 11:09:33,486] {result_logger:107} INFO - F1-score on REM: 0.863
[2024-08-05 11:09:33,486] {result_logger:108} INFO - 
[2024-08-05 11:09:33,542] {result_logger:103} INFO - precision on Non REM: 0.969
[2024-08-05 11:09:33,581] {result_logger:104} INFO - recall on Non REM: 0.951
[2024-08-05 11:09:33,621] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2024-08-05 11:09:33,621] {result_logger:108} INFO - 
[2024-08-05 11:09:33,627] {result_logger:111} INFO - average precision on sleep stages: 0.909
[2024-08-05 11:09:33,634] {result_logger:113} INFO - average recall on sleep stages: 0.962
[2024-08-05 11:09:33,640] {result_logger:115} INFO - average F1-score on sleep stages: 0.933
[2024-08-05 11:09:33,640] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:09:33,684] {result_logger:134} INFO - 
[[198997    686   4064]
 [   115  18148    343]
 [  3225   3014 137528]]
[2024-08-05 11:09:33,726] {result_logger:141} INFO - 
[[ 97.67%   0.34%   1.99%]
 [  0.62%  97.54%   1.84%]
 [  2.24%   2.10%  95.66%]]
[2024-08-05 11:09:33,768] {result_logger:145} INFO - 
[[ 98.35%   3.14%   2.86%]
 [  0.06%  83.06%   0.24%]
 [  1.59%  13.80%  96.90%]]
[2024-08-05 11:09:33,769] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:09:33,773] {result_logger:134} INFO - 
[[27566   261   555]
 [    9  2453    83]
 [  587   427 19689]]
[2024-08-05 11:09:33,778] {result_logger:141} INFO - 
[[ 97.12%   0.92%   1.96%]
 [  0.35%  96.39%   3.26%]
 [  2.84%   2.06%  95.10%]]
[2024-08-05 11:09:33,782] {result_logger:145} INFO - 
[[ 97.88%   8.31%   2.73%]
 [  0.03%  78.10%   0.41%]
 [  2.08%  13.59%  96.86%]]
[2024-08-05 11:09:33,831] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:09:33,831] {result_logger:77} INFO - actual:
[2024-08-05 11:09:33,832] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:09:33,832] {result_logger:79} INFO - predicted:
[2024-08-05 11:09:33,832] {result_logger:80} INFO - 
[[94.53%  0.57%  4.90%]
 [19.13% 75.55%  5.32%]
 [ 4.62%  2.99% 92.39%]]
[2024-08-05 11:09:33,832] {run_experiment:113} INFO - [epoch  19] execution time: 114.21s	 avg f1-score: 0.9325

[2024-08-05 11:09:33,832] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:09:33,851] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:10:25,091] {train_model:82} INFO - Train Epoch: 20 [36352/366120 (10%)]	lr:1.58e-04	Loss: 0.075820
[2024-08-05 11:10:30,953] {train_model:82} INFO - Train Epoch: 20 [72960/366120 (20%)]	lr:1.58e-04	Loss: 0.112591
[2024-08-05 11:10:36,859] {train_model:82} INFO - Train Epoch: 20 [109568/366120 (30%)]	lr:1.58e-04	Loss: 0.124249
[2024-08-05 11:10:42,781] {train_model:82} INFO - Train Epoch: 20 [146176/366120 (40%)]	lr:1.58e-04	Loss: 0.093506
[2024-08-05 11:10:48,717] {train_model:82} INFO - Train Epoch: 20 [182784/366120 (50%)]	lr:1.58e-04	Loss: 0.071649
[2024-08-05 11:10:54,656] {train_model:82} INFO - Train Epoch: 20 [219392/366120 (60%)]	lr:1.58e-04	Loss: 0.067264
[2024-08-05 11:11:00,612] {train_model:82} INFO - Train Epoch: 20 [256000/366120 (70%)]	lr:1.58e-04	Loss: 0.050361
[2024-08-05 11:11:06,573] {train_model:82} INFO - Train Epoch: 20 [292608/366120 (80%)]	lr:1.58e-04	Loss: 0.126082
[2024-08-05 11:11:12,551] {train_model:82} INFO - Train Epoch: 20 [329216/366120 (90%)]	lr:1.58e-04	Loss: 0.024578
[2024-08-05 11:11:18,554] {train_model:82} INFO - Train Epoch: 20 [365824/366120 (100%)]	lr:1.58e-04	Loss: 0.058017
[2024-08-05 11:11:25,063] {run_experiment:79} INFO - 
[2024-08-05 11:11:25,063] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:11:25,506] {result_logger:103} INFO - precision on Wake: 0.984
[2024-08-05 11:11:25,831] {result_logger:104} INFO - recall on Wake: 0.978
[2024-08-05 11:11:26,159] {result_logger:107} INFO - F1-score on Wake: 0.981
[2024-08-05 11:11:26,159] {result_logger:108} INFO - 
[2024-08-05 11:11:26,567] {result_logger:103} INFO - precision on REM: 0.837
[2024-08-05 11:11:26,854] {result_logger:104} INFO - recall on REM: 0.977
[2024-08-05 11:11:27,142] {result_logger:107} INFO - F1-score on REM: 0.902
[2024-08-05 11:11:27,142] {result_logger:108} INFO - 
[2024-08-05 11:11:27,596] {result_logger:103} INFO - precision on Non REM: 0.970
[2024-08-05 11:11:27,916] {result_logger:104} INFO - recall on Non REM: 0.958
[2024-08-05 11:11:28,233] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2024-08-05 11:11:28,233] {result_logger:108} INFO - 
[2024-08-05 11:11:28,304] {result_logger:111} INFO - average precision on sleep stages: 0.931
[2024-08-05 11:11:28,374] {result_logger:113} INFO - average recall on sleep stages: 0.971
[2024-08-05 11:11:28,444] {result_logger:115} INFO - average F1-score on sleep stages: 0.949
[2024-08-05 11:11:28,445] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:11:28,502] {result_logger:103} INFO - precision on Wake: 0.978
[2024-08-05 11:11:28,540] {result_logger:104} INFO - recall on Wake: 0.978
[2024-08-05 11:11:28,578] {result_logger:107} INFO - F1-score on Wake: 0.978
[2024-08-05 11:11:28,578] {result_logger:108} INFO - 
[2024-08-05 11:11:28,634] {result_logger:103} INFO - precision on REM: 0.798
[2024-08-05 11:11:28,673] {result_logger:104} INFO - recall on REM: 0.972
[2024-08-05 11:11:28,712] {result_logger:107} INFO - F1-score on REM: 0.876
[2024-08-05 11:11:28,712] {result_logger:108} INFO - 
[2024-08-05 11:11:28,769] {result_logger:103} INFO - precision on Non REM: 0.975
[2024-08-05 11:11:28,809] {result_logger:104} INFO - recall on Non REM: 0.949
[2024-08-05 11:11:28,849] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2024-08-05 11:11:28,849] {result_logger:108} INFO - 
[2024-08-05 11:11:28,856] {result_logger:111} INFO - average precision on sleep stages: 0.917
[2024-08-05 11:11:28,862] {result_logger:113} INFO - average recall on sleep stages: 0.966
[2024-08-05 11:11:28,868] {result_logger:115} INFO - average F1-score on sleep stages: 0.939
[2024-08-05 11:11:28,868] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:11:28,917] {result_logger:134} INFO - 
[[199193    628   3926]
 [   102  18176    328]
 [  3072   2906 137789]]
[2024-08-05 11:11:28,965] {result_logger:141} INFO - 
[[ 97.76%   0.31%   1.93%]
 [  0.55%  97.69%   1.76%]
 [  2.14%   2.02%  95.84%]]
[2024-08-05 11:11:29,012] {result_logger:145} INFO - 
[[ 98.43%   2.89%   2.76%]
 [  0.05%  83.72%   0.23%]
 [  1.52%  13.39%  97.01%]]
[2024-08-05 11:11:29,012] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:11:29,017] {result_logger:134} INFO - 
[[27771   162   449]
 [   13  2474    58]
 [  600   466 19637]]
[2024-08-05 11:11:29,021] {result_logger:141} INFO - 
[[ 97.85%   0.57%   1.58%]
 [  0.51%  97.21%   2.28%]
 [  2.90%   2.25%  94.85%]]
[2024-08-05 11:11:29,026] {result_logger:145} INFO - 
[[ 97.84%   5.22%   2.23%]
 [  0.05%  79.75%   0.29%]
 [  2.11%  15.02%  97.48%]]
[2024-08-05 11:11:29,076] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:11:29,076] {result_logger:77} INFO - actual:
[2024-08-05 11:11:29,076] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:11:29,076] {result_logger:79} INFO - predicted:
[2024-08-05 11:11:29,076] {result_logger:80} INFO - 
[[94.97%  0.32%  4.70%]
 [16.89% 78.47%  4.64%]
 [ 4.48%  2.86% 92.66%]]
[2024-08-05 11:11:29,077] {run_experiment:113} INFO - [epoch  20] execution time: 115.24s	 avg f1-score: 0.9387

[2024-08-05 11:11:29,077] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:11:29,096] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:12:19,722] {train_model:82} INFO - Train Epoch: 21 [36352/366120 (10%)]	lr:1.49e-04	Loss: 0.040907
[2024-08-05 11:12:25,623] {train_model:82} INFO - Train Epoch: 21 [72960/366120 (20%)]	lr:1.49e-04	Loss: 0.077363
[2024-08-05 11:12:31,528] {train_model:82} INFO - Train Epoch: 21 [109568/366120 (30%)]	lr:1.49e-04	Loss: 0.071773
[2024-08-05 11:12:37,453] {train_model:82} INFO - Train Epoch: 21 [146176/366120 (40%)]	lr:1.49e-04	Loss: 0.081467
[2024-08-05 11:12:43,391] {train_model:82} INFO - Train Epoch: 21 [182784/366120 (50%)]	lr:1.49e-04	Loss: 0.090007
[2024-08-05 11:12:49,334] {train_model:82} INFO - Train Epoch: 21 [219392/366120 (60%)]	lr:1.49e-04	Loss: 0.054212
[2024-08-05 11:12:55,281] {train_model:82} INFO - Train Epoch: 21 [256000/366120 (70%)]	lr:1.49e-04	Loss: 0.029214
[2024-08-05 11:13:01,239] {train_model:82} INFO - Train Epoch: 21 [292608/366120 (80%)]	lr:1.49e-04	Loss: 0.041625
[2024-08-05 11:13:07,203] {train_model:82} INFO - Train Epoch: 21 [329216/366120 (90%)]	lr:1.49e-04	Loss: 0.103890
[2024-08-05 11:13:13,195] {train_model:82} INFO - Train Epoch: 21 [365824/366120 (100%)]	lr:1.49e-04	Loss: 0.062884
[2024-08-05 11:13:19,067] {run_experiment:79} INFO - 
[2024-08-05 11:13:19,067] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:13:19,520] {result_logger:103} INFO - precision on Wake: 0.985
[2024-08-05 11:13:19,851] {result_logger:104} INFO - recall on Wake: 0.978
[2024-08-05 11:13:20,177] {result_logger:107} INFO - F1-score on Wake: 0.981
[2024-08-05 11:13:20,178] {result_logger:108} INFO - 
[2024-08-05 11:13:20,582] {result_logger:103} INFO - precision on REM: 0.849
[2024-08-05 11:13:20,862] {result_logger:104} INFO - recall on REM: 0.981
[2024-08-05 11:13:21,140] {result_logger:107} INFO - F1-score on REM: 0.910
[2024-08-05 11:13:21,140] {result_logger:108} INFO - 
[2024-08-05 11:13:21,592] {result_logger:103} INFO - precision on Non REM: 0.971
[2024-08-05 11:13:21,913] {result_logger:104} INFO - recall on Non REM: 0.961
[2024-08-05 11:13:22,234] {result_logger:107} INFO - F1-score on Non REM: 0.966
[2024-08-05 11:13:22,234] {result_logger:108} INFO - 
[2024-08-05 11:13:22,303] {result_logger:111} INFO - average precision on sleep stages: 0.935
[2024-08-05 11:13:22,372] {result_logger:113} INFO - average recall on sleep stages: 0.973
[2024-08-05 11:13:22,442] {result_logger:115} INFO - average F1-score on sleep stages: 0.952
[2024-08-05 11:13:22,442] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:13:22,500] {result_logger:103} INFO - precision on Wake: 0.977
[2024-08-05 11:13:22,539] {result_logger:104} INFO - recall on Wake: 0.967
[2024-08-05 11:13:22,579] {result_logger:107} INFO - F1-score on Wake: 0.972
[2024-08-05 11:13:22,579] {result_logger:108} INFO - 
[2024-08-05 11:13:22,636] {result_logger:103} INFO - precision on REM: 0.739
[2024-08-05 11:13:22,675] {result_logger:104} INFO - recall on REM: 0.975
[2024-08-05 11:13:22,714] {result_logger:107} INFO - F1-score on REM: 0.840
[2024-08-05 11:13:22,714] {result_logger:108} INFO - 
[2024-08-05 11:13:22,772] {result_logger:103} INFO - precision on Non REM: 0.970
[2024-08-05 11:13:22,812] {result_logger:104} INFO - recall on Non REM: 0.945
[2024-08-05 11:13:22,852] {result_logger:107} INFO - F1-score on Non REM: 0.957
[2024-08-05 11:13:22,852] {result_logger:108} INFO - 
[2024-08-05 11:13:22,858] {result_logger:111} INFO - average precision on sleep stages: 0.895
[2024-08-05 11:13:22,864] {result_logger:113} INFO - average recall on sleep stages: 0.962
[2024-08-05 11:13:22,871] {result_logger:115} INFO - average F1-score on sleep stages: 0.923
[2024-08-05 11:13:22,871] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:13:22,919] {result_logger:134} INFO - 
[[199320    590   3837]
 [    93  18246    267]
 [  2999   2656 138112]]
[2024-08-05 11:13:22,966] {result_logger:141} INFO - 
[[ 97.83%   0.29%   1.88%]
 [  0.50%  98.07%   1.44%]
 [  2.09%   1.85%  96.07%]]
[2024-08-05 11:13:23,014] {result_logger:145} INFO - 
[[ 98.47%   2.75%   2.70%]
 [  0.05%  84.90%   0.19%]
 [  1.48%  12.36%  97.11%]]
[2024-08-05 11:13:23,015] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:13:23,019] {result_logger:134} INFO - 
[[27459   371   552]
 [   12  2481    52]
 [  639   507 19557]]
[2024-08-05 11:13:23,024] {result_logger:141} INFO - 
[[ 96.75%   1.31%   1.94%]
 [  0.47%  97.49%   2.04%]
 [  3.09%   2.45%  94.46%]]
[2024-08-05 11:13:23,029] {result_logger:145} INFO - 
[[ 97.68%  11.04%   2.74%]
 [  0.04%  73.86%   0.26%]
 [  2.27%  15.09%  97.00%]]
[2024-08-05 11:13:23,079] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:13:23,080] {result_logger:77} INFO - actual:
[2024-08-05 11:13:23,080] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:13:23,080] {result_logger:79} INFO - predicted:
[2024-08-05 11:13:23,080] {result_logger:80} INFO - 
[[94.36%  0.80%  4.84%]
 [19.11% 75.17%  5.72%]
 [ 4.67%  3.03% 92.30%]]
[2024-08-05 11:13:23,080] {run_experiment:113} INFO - [epoch  21] execution time: 114.00s	 avg f1-score: 0.9233

[2024-08-05 11:13:23,080] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:13:23,100] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:14:11,063] {train_model:82} INFO - Train Epoch: 22 [36352/366120 (10%)]	lr:1.40e-04	Loss: 0.082290
[2024-08-05 11:14:19,171] {train_model:82} INFO - Train Epoch: 22 [72960/366120 (20%)]	lr:1.40e-04	Loss: 0.079510
[2024-08-05 11:14:25,056] {train_model:82} INFO - Train Epoch: 22 [109568/366120 (30%)]	lr:1.40e-04	Loss: 0.052330
[2024-08-05 11:14:30,963] {train_model:82} INFO - Train Epoch: 22 [146176/366120 (40%)]	lr:1.40e-04	Loss: 0.053088
[2024-08-05 11:14:36,884] {train_model:82} INFO - Train Epoch: 22 [182784/366120 (50%)]	lr:1.40e-04	Loss: 0.049540
[2024-08-05 11:14:42,810] {train_model:82} INFO - Train Epoch: 22 [219392/366120 (60%)]	lr:1.40e-04	Loss: 0.046979
[2024-08-05 11:14:48,795] {train_model:82} INFO - Train Epoch: 22 [256000/366120 (70%)]	lr:1.40e-04	Loss: 0.129914
[2024-08-05 11:14:54,735] {train_model:82} INFO - Train Epoch: 22 [292608/366120 (80%)]	lr:1.40e-04	Loss: 0.036681
[2024-08-05 11:15:00,680] {train_model:82} INFO - Train Epoch: 22 [329216/366120 (90%)]	lr:1.40e-04	Loss: 0.060978
[2024-08-05 11:15:06,663] {train_model:82} INFO - Train Epoch: 22 [365824/366120 (100%)]	lr:1.40e-04	Loss: 0.040858
[2024-08-05 11:15:12,402] {run_experiment:79} INFO - 
[2024-08-05 11:15:12,402] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:15:12,853] {result_logger:103} INFO - precision on Wake: 0.986
[2024-08-05 11:15:13,180] {result_logger:104} INFO - recall on Wake: 0.979
[2024-08-05 11:15:13,511] {result_logger:107} INFO - F1-score on Wake: 0.982
[2024-08-05 11:15:13,511] {result_logger:108} INFO - 
[2024-08-05 11:15:13,915] {result_logger:103} INFO - precision on REM: 0.858
[2024-08-05 11:15:14,200] {result_logger:104} INFO - recall on REM: 0.981
[2024-08-05 11:15:14,489] {result_logger:107} INFO - F1-score on REM: 0.916
[2024-08-05 11:15:14,489] {result_logger:108} INFO - 
[2024-08-05 11:15:14,939] {result_logger:103} INFO - precision on Non REM: 0.972
[2024-08-05 11:15:15,267] {result_logger:104} INFO - recall on Non REM: 0.963
[2024-08-05 11:15:15,595] {result_logger:107} INFO - F1-score on Non REM: 0.967
[2024-08-05 11:15:15,595] {result_logger:108} INFO - 
[2024-08-05 11:15:15,664] {result_logger:111} INFO - average precision on sleep stages: 0.939
[2024-08-05 11:15:15,733] {result_logger:113} INFO - average recall on sleep stages: 0.974
[2024-08-05 11:15:15,802] {result_logger:115} INFO - average F1-score on sleep stages: 0.955
[2024-08-05 11:15:15,803] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:15:15,860] {result_logger:103} INFO - precision on Wake: 0.985
[2024-08-05 11:15:15,899] {result_logger:104} INFO - recall on Wake: 0.973
[2024-08-05 11:15:15,938] {result_logger:107} INFO - F1-score on Wake: 0.979
[2024-08-05 11:15:15,939] {result_logger:108} INFO - 
[2024-08-05 11:15:15,995] {result_logger:103} INFO - precision on REM: 0.803
[2024-08-05 11:15:16,034] {result_logger:104} INFO - recall on REM: 0.970
[2024-08-05 11:15:16,073] {result_logger:107} INFO - F1-score on REM: 0.879
[2024-08-05 11:15:16,073] {result_logger:108} INFO - 
[2024-08-05 11:15:16,131] {result_logger:103} INFO - precision on Non REM: 0.965
[2024-08-05 11:15:16,170] {result_logger:104} INFO - recall on Non REM: 0.956
[2024-08-05 11:15:16,210] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2024-08-05 11:15:16,210] {result_logger:108} INFO - 
[2024-08-05 11:15:16,216] {result_logger:111} INFO - average precision on sleep stages: 0.918
[2024-08-05 11:15:16,222] {result_logger:113} INFO - average recall on sleep stages: 0.967
[2024-08-05 11:15:16,228] {result_logger:115} INFO - average F1-score on sleep stages: 0.939
[2024-08-05 11:15:16,228] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:15:16,276] {result_logger:134} INFO - 
[[199500    499   3748]
 [    86  18250    270]
 [  2844   2510 138413]]
[2024-08-05 11:15:16,323] {result_logger:141} INFO - 
[[ 97.92%   0.24%   1.84%]
 [  0.46%  98.09%   1.45%]
 [  1.98%   1.75%  96.28%]]
[2024-08-05 11:15:16,370] {result_logger:145} INFO - 
[[ 98.55%   2.35%   2.63%]
 [  0.04%  85.85%   0.19%]
 [  1.40%  11.81%  97.18%]]
[2024-08-05 11:15:16,370] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:15:16,374] {result_logger:134} INFO - 
[[27627    88   667]
 [   16  2469    60]
 [  394   517 19792]]
[2024-08-05 11:15:16,379] {result_logger:141} INFO - 
[[ 97.34%   0.31%   2.35%]
 [  0.63%  97.01%   2.36%]
 [  1.90%   2.50%  95.60%]]
[2024-08-05 11:15:16,383] {result_logger:145} INFO - 
[[ 98.54%   2.86%   3.25%]
 [  0.06%  80.32%   0.29%]
 [  1.41%  16.82%  96.46%]]
[2024-08-05 11:15:16,433] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:15:16,433] {result_logger:77} INFO - actual:
[2024-08-05 11:15:16,433] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:15:16,433] {result_logger:79} INFO - predicted:
[2024-08-05 11:15:16,433] {result_logger:80} INFO - 
[[95.50%  0.17%  4.33%]
 [14.48% 78.99%  6.54%]
 [ 3.98%  2.91% 93.11%]]
[2024-08-05 11:15:16,433] {run_experiment:113} INFO - [epoch  22] execution time: 113.35s	 avg f1-score: 0.9395

[2024-08-05 11:15:16,433] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:15:16,453] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:15:38,195] {train_model:82} INFO - Train Epoch: 23 [36352/366120 (10%)]	lr:1.32e-04	Loss: 0.053671
[2024-08-05 11:16:08,563] {train_model:82} INFO - Train Epoch: 23 [72960/366120 (20%)]	lr:1.32e-04	Loss: 0.075526
[2024-08-05 11:16:14,434] {train_model:82} INFO - Train Epoch: 23 [109568/366120 (30%)]	lr:1.32e-04	Loss: 0.049820
[2024-08-05 11:16:20,275] {train_model:82} INFO - Train Epoch: 23 [146176/366120 (40%)]	lr:1.32e-04	Loss: 0.035658
[2024-08-05 11:16:26,103] {train_model:82} INFO - Train Epoch: 23 [182784/366120 (50%)]	lr:1.32e-04	Loss: 0.035391
[2024-08-05 11:16:31,944] {train_model:82} INFO - Train Epoch: 23 [219392/366120 (60%)]	lr:1.32e-04	Loss: 0.051159
[2024-08-05 11:16:37,793] {train_model:82} INFO - Train Epoch: 23 [256000/366120 (70%)]	lr:1.32e-04	Loss: 0.057838
[2024-08-05 11:16:43,650] {train_model:82} INFO - Train Epoch: 23 [292608/366120 (80%)]	lr:1.32e-04	Loss: 0.045200
[2024-08-05 11:16:49,520] {train_model:82} INFO - Train Epoch: 23 [329216/366120 (90%)]	lr:1.32e-04	Loss: 0.050422
[2024-08-05 11:16:55,453] {train_model:82} INFO - Train Epoch: 23 [365824/366120 (100%)]	lr:1.32e-04	Loss: 0.042950
[2024-08-05 11:17:00,913] {run_experiment:79} INFO - 
[2024-08-05 11:17:00,913] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:17:01,359] {result_logger:103} INFO - precision on Wake: 0.986
[2024-08-05 11:17:01,686] {result_logger:104} INFO - recall on Wake: 0.980
[2024-08-05 11:17:02,015] {result_logger:107} INFO - F1-score on Wake: 0.983
[2024-08-05 11:17:02,015] {result_logger:108} INFO - 
[2024-08-05 11:17:02,421] {result_logger:103} INFO - precision on REM: 0.859
[2024-08-05 11:17:02,704] {result_logger:104} INFO - recall on REM: 0.982
[2024-08-05 11:17:02,983] {result_logger:107} INFO - F1-score on REM: 0.917
[2024-08-05 11:17:02,983] {result_logger:108} INFO - 
[2024-08-05 11:17:03,425] {result_logger:103} INFO - precision on Non REM: 0.973
[2024-08-05 11:17:03,749] {result_logger:104} INFO - recall on Non REM: 0.964
[2024-08-05 11:17:04,073] {result_logger:107} INFO - F1-score on Non REM: 0.968
[2024-08-05 11:17:04,073] {result_logger:108} INFO - 
[2024-08-05 11:17:04,141] {result_logger:111} INFO - average precision on sleep stages: 0.939
[2024-08-05 11:17:04,210] {result_logger:113} INFO - average recall on sleep stages: 0.975
[2024-08-05 11:17:04,278] {result_logger:115} INFO - average F1-score on sleep stages: 0.956
[2024-08-05 11:17:04,279] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:17:04,336] {result_logger:103} INFO - precision on Wake: 0.980
[2024-08-05 11:17:04,375] {result_logger:104} INFO - recall on Wake: 0.979
[2024-08-05 11:17:04,415] {result_logger:107} INFO - F1-score on Wake: 0.979
[2024-08-05 11:17:04,415] {result_logger:108} INFO - 
[2024-08-05 11:17:04,472] {result_logger:103} INFO - precision on REM: 0.815
[2024-08-05 11:17:04,513] {result_logger:104} INFO - recall on REM: 0.972
[2024-08-05 11:17:04,554] {result_logger:107} INFO - F1-score on REM: 0.886
[2024-08-05 11:17:04,554] {result_logger:108} INFO - 
[2024-08-05 11:17:04,613] {result_logger:103} INFO - precision on Non REM: 0.973
[2024-08-05 11:17:04,654] {result_logger:104} INFO - recall on Non REM: 0.950
[2024-08-05 11:17:04,695] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2024-08-05 11:17:04,695] {result_logger:108} INFO - 
[2024-08-05 11:17:04,702] {result_logger:111} INFO - average precision on sleep stages: 0.922
[2024-08-05 11:17:04,708] {result_logger:113} INFO - average recall on sleep stages: 0.967
[2024-08-05 11:17:04,714] {result_logger:115} INFO - average F1-score on sleep stages: 0.942
[2024-08-05 11:17:04,714] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:17:04,761] {result_logger:134} INFO - 
[[199613    492   3642]
 [    77  18268    261]
 [  2740   2497 138530]]
[2024-08-05 11:17:04,808] {result_logger:141} INFO - 
[[ 97.97%   0.24%   1.79%]
 [  0.41%  98.18%   1.40%]
 [  1.91%   1.74%  96.36%]]
[2024-08-05 11:17:04,855] {result_logger:145} INFO - 
[[ 98.61%   2.31%   2.56%]
 [  0.04%  85.94%   0.18%]
 [  1.35%  11.75%  97.26%]]
[2024-08-05 11:17:04,855] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:17:04,860] {result_logger:134} INFO - 
[[27790    98   494]
 [   11  2473    61]
 [  567   464 19672]]
[2024-08-05 11:17:04,990] {result_logger:141} INFO - 
[[ 97.91%   0.35%   1.74%]
 [  0.43%  97.17%   2.40%]
 [  2.74%   2.24%  95.02%]]
[2024-08-05 11:17:05,069] {result_logger:145} INFO - 
[[ 97.96%   3.23%   2.44%]
 [  0.04%  81.48%   0.30%]
 [  2.00%  15.29%  97.26%]]
[2024-08-05 11:17:05,281] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:17:05,281] {result_logger:77} INFO - actual:
[2024-08-05 11:17:05,281] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:17:05,281] {result_logger:79} INFO - predicted:
[2024-08-05 11:17:05,281] {result_logger:80} INFO - 
[[95.43%  0.12%  4.45%]
 [14.46% 78.98%  6.56%]
 [ 4.23%  2.99% 92.78%]]
[2024-08-05 11:17:05,363] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_D_weighted/model_8conv_2fc-best.pth
[2024-08-05 11:17:05,363] {run_experiment:113} INFO - [epoch  23] execution time: 108.93s	 avg f1-score: 0.9423

[2024-08-05 11:17:05,363] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:17:05,382] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:17:26,697] {train_model:82} INFO - Train Epoch: 24 [36352/366120 (10%)]	lr:1.25e-04	Loss: 0.048511
[2024-08-05 11:17:57,799] {train_model:82} INFO - Train Epoch: 24 [72960/366120 (20%)]	lr:1.25e-04	Loss: 0.065198
[2024-08-05 11:18:03,680] {train_model:82} INFO - Train Epoch: 24 [109568/366120 (30%)]	lr:1.25e-04	Loss: 0.056695
[2024-08-05 11:18:09,571] {train_model:82} INFO - Train Epoch: 24 [146176/366120 (40%)]	lr:1.25e-04	Loss: 0.040836
[2024-08-05 11:18:15,485] {train_model:82} INFO - Train Epoch: 24 [182784/366120 (50%)]	lr:1.25e-04	Loss: 0.037793
[2024-08-05 11:18:21,405] {train_model:82} INFO - Train Epoch: 24 [219392/366120 (60%)]	lr:1.25e-04	Loss: 0.059151
[2024-08-05 11:18:27,341] {train_model:82} INFO - Train Epoch: 24 [256000/366120 (70%)]	lr:1.25e-04	Loss: 0.075040
[2024-08-05 11:18:33,282] {train_model:82} INFO - Train Epoch: 24 [292608/366120 (80%)]	lr:1.25e-04	Loss: 0.061651
[2024-08-05 11:18:39,233] {train_model:82} INFO - Train Epoch: 24 [329216/366120 (90%)]	lr:1.25e-04	Loss: 0.050501
[2024-08-05 11:18:45,211] {train_model:82} INFO - Train Epoch: 24 [365824/366120 (100%)]	lr:1.25e-04	Loss: 0.032645
[2024-08-05 11:18:50,592] {run_experiment:79} INFO - 
[2024-08-05 11:18:50,592] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:18:51,038] {result_logger:103} INFO - precision on Wake: 0.986
[2024-08-05 11:18:51,360] {result_logger:104} INFO - recall on Wake: 0.980
[2024-08-05 11:18:51,679] {result_logger:107} INFO - F1-score on Wake: 0.983
[2024-08-05 11:18:51,679] {result_logger:108} INFO - 
[2024-08-05 11:18:52,085] {result_logger:103} INFO - precision on REM: 0.869
[2024-08-05 11:18:52,362] {result_logger:104} INFO - recall on REM: 0.984
[2024-08-05 11:18:52,642] {result_logger:107} INFO - F1-score on REM: 0.923
[2024-08-05 11:18:52,642] {result_logger:108} INFO - 
[2024-08-05 11:18:53,081] {result_logger:103} INFO - precision on Non REM: 0.974
[2024-08-05 11:18:53,401] {result_logger:104} INFO - recall on Non REM: 0.965
[2024-08-05 11:18:53,724] {result_logger:107} INFO - F1-score on Non REM: 0.969
[2024-08-05 11:18:53,725] {result_logger:108} INFO - 
[2024-08-05 11:18:53,791] {result_logger:111} INFO - average precision on sleep stages: 0.943
[2024-08-05 11:18:53,857] {result_logger:113} INFO - average recall on sleep stages: 0.977
[2024-08-05 11:18:53,924] {result_logger:115} INFO - average F1-score on sleep stages: 0.959
[2024-08-05 11:18:53,925] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:18:53,981] {result_logger:103} INFO - precision on Wake: 0.984
[2024-08-05 11:18:54,019] {result_logger:104} INFO - recall on Wake: 0.975
[2024-08-05 11:18:54,058] {result_logger:107} INFO - F1-score on Wake: 0.980
[2024-08-05 11:18:54,058] {result_logger:108} INFO - 
[2024-08-05 11:18:54,115] {result_logger:103} INFO - precision on REM: 0.840
[2024-08-05 11:18:54,155] {result_logger:104} INFO - recall on REM: 0.960
[2024-08-05 11:18:54,196] {result_logger:107} INFO - F1-score on REM: 0.896
[2024-08-05 11:18:54,196] {result_logger:108} INFO - 
[2024-08-05 11:18:54,255] {result_logger:103} INFO - precision on Non REM: 0.966
[2024-08-05 11:18:54,296] {result_logger:104} INFO - recall on Non REM: 0.961
[2024-08-05 11:18:54,337] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2024-08-05 11:18:54,337] {result_logger:108} INFO - 
[2024-08-05 11:18:54,343] {result_logger:111} INFO - average precision on sleep stages: 0.930
[2024-08-05 11:18:54,349] {result_logger:113} INFO - average recall on sleep stages: 0.966
[2024-08-05 11:18:54,355] {result_logger:115} INFO - average F1-score on sleep stages: 0.946
[2024-08-05 11:18:54,355] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:18:54,401] {result_logger:134} INFO - 
[[199757    464   3526]
 [    76  18311    219]
 [  2685   2303 138779]]
[2024-08-05 11:18:54,446] {result_logger:141} INFO - 
[[ 98.04%   0.23%   1.73%]
 [  0.41%  98.41%   1.18%]
 [  1.87%   1.60%  96.53%]]
[2024-08-05 11:18:54,491] {result_logger:145} INFO - 
[[ 98.64%   2.20%   2.47%]
 [  0.04%  86.87%   0.15%]
 [  1.33%  10.93%  97.37%]]
[2024-08-05 11:18:54,492] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:18:54,496] {result_logger:134} INFO - 
[[27679    85   618]
 [   14  2444    87]
 [  425   382 19896]]
[2024-08-05 11:18:54,643] {result_logger:141} INFO - 
[[ 97.52%   0.30%   2.18%]
 [  0.55%  96.03%   3.42%]
 [  2.05%   1.85%  96.10%]]
[2024-08-05 11:18:54,715] {result_logger:145} INFO - 
[[ 98.44%   2.92%   3.00%]
 [  0.05%  83.96%   0.42%]
 [  1.51%  13.12%  96.58%]]
[2024-08-05 11:18:54,917] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:18:54,917] {result_logger:77} INFO - actual:
[2024-08-05 11:18:54,917] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:18:54,917] {result_logger:79} INFO - predicted:
[2024-08-05 11:18:54,917] {result_logger:80} INFO - 
[[95.48%  0.13%  4.39%]
 [14.67% 79.46%  5.87%]
 [ 4.09%  2.72% 93.18%]]
[2024-08-05 11:18:54,996] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_D_weighted/model_8conv_2fc-best.pth
[2024-08-05 11:18:54,996] {run_experiment:113} INFO - [epoch  24] execution time: 109.63s	 avg f1-score: 0.9464

[2024-08-05 11:18:54,996] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:18:55,016] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:19:16,692] {train_model:82} INFO - Train Epoch: 25 [36352/366120 (10%)]	lr:1.17e-04	Loss: 0.023383
[2024-08-05 11:19:46,842] {train_model:82} INFO - Train Epoch: 25 [72960/366120 (20%)]	lr:1.17e-04	Loss: 0.048968
[2024-08-05 11:19:52,691] {train_model:82} INFO - Train Epoch: 25 [109568/366120 (30%)]	lr:1.17e-04	Loss: 0.029662
[2024-08-05 11:19:58,568] {train_model:82} INFO - Train Epoch: 25 [146176/366120 (40%)]	lr:1.17e-04	Loss: 0.035171
[2024-08-05 11:20:04,462] {train_model:82} INFO - Train Epoch: 25 [182784/366120 (50%)]	lr:1.17e-04	Loss: 0.089371
[2024-08-05 11:20:10,354] {train_model:82} INFO - Train Epoch: 25 [219392/366120 (60%)]	lr:1.17e-04	Loss: 0.052592
[2024-08-05 11:20:16,260] {train_model:82} INFO - Train Epoch: 25 [256000/366120 (70%)]	lr:1.17e-04	Loss: 0.032771
[2024-08-05 11:20:22,169] {train_model:82} INFO - Train Epoch: 25 [292608/366120 (80%)]	lr:1.17e-04	Loss: 0.030303
[2024-08-05 11:20:28,085] {train_model:82} INFO - Train Epoch: 25 [329216/366120 (90%)]	lr:1.17e-04	Loss: 0.059501
[2024-08-05 11:20:34,031] {train_model:82} INFO - Train Epoch: 25 [365824/366120 (100%)]	lr:1.17e-04	Loss: 0.063067
[2024-08-05 11:20:41,378] {run_experiment:79} INFO - 
[2024-08-05 11:20:41,379] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:20:41,835] {result_logger:103} INFO - precision on Wake: 0.987
[2024-08-05 11:20:42,154] {result_logger:104} INFO - recall on Wake: 0.982
[2024-08-05 11:20:42,476] {result_logger:107} INFO - F1-score on Wake: 0.984
[2024-08-05 11:20:42,476] {result_logger:108} INFO - 
[2024-08-05 11:20:42,885] {result_logger:103} INFO - precision on REM: 0.873
[2024-08-05 11:20:43,164] {result_logger:104} INFO - recall on REM: 0.985
[2024-08-05 11:20:43,450] {result_logger:107} INFO - F1-score on REM: 0.926
[2024-08-05 11:20:43,451] {result_logger:108} INFO - 
[2024-08-05 11:20:43,903] {result_logger:103} INFO - precision on Non REM: 0.975
[2024-08-05 11:20:44,221] {result_logger:104} INFO - recall on Non REM: 0.966
[2024-08-05 11:20:44,544] {result_logger:107} INFO - F1-score on Non REM: 0.971
[2024-08-05 11:20:44,544] {result_logger:108} INFO - 
[2024-08-05 11:20:44,607] {result_logger:111} INFO - average precision on sleep stages: 0.945
[2024-08-05 11:20:44,670] {result_logger:113} INFO - average recall on sleep stages: 0.978
[2024-08-05 11:20:44,733] {result_logger:115} INFO - average F1-score on sleep stages: 0.960
[2024-08-05 11:20:44,733] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:20:44,791] {result_logger:103} INFO - precision on Wake: 0.977
[2024-08-05 11:20:44,831] {result_logger:104} INFO - recall on Wake: 0.980
[2024-08-05 11:20:44,871] {result_logger:107} INFO - F1-score on Wake: 0.978
[2024-08-05 11:20:44,871] {result_logger:108} INFO - 
[2024-08-05 11:20:44,927] {result_logger:103} INFO - precision on REM: 0.780
[2024-08-05 11:20:44,966] {result_logger:104} INFO - recall on REM: 0.972
[2024-08-05 11:20:45,006] {result_logger:107} INFO - F1-score on REM: 0.866
[2024-08-05 11:20:45,006] {result_logger:108} INFO - 
[2024-08-05 11:20:45,064] {result_logger:103} INFO - precision on Non REM: 0.975
[2024-08-05 11:20:45,104] {result_logger:104} INFO - recall on Non REM: 0.942
[2024-08-05 11:20:45,144] {result_logger:107} INFO - F1-score on Non REM: 0.958
[2024-08-05 11:20:45,144] {result_logger:108} INFO - 
[2024-08-05 11:20:45,150] {result_logger:111} INFO - average precision on sleep stages: 0.911
[2024-08-05 11:20:45,156] {result_logger:113} INFO - average recall on sleep stages: 0.965
[2024-08-05 11:20:45,162] {result_logger:115} INFO - average F1-score on sleep stages: 0.934
[2024-08-05 11:20:45,163] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:20:45,206] {result_logger:134} INFO - 
[[200012    415   3320]
 [    62  18333    211]
 [  2648   2240 138879]]
[2024-08-05 11:20:45,249] {result_logger:141} INFO - 
[[ 98.17%   0.20%   1.63%]
 [  0.33%  98.53%   1.13%]
 [  1.84%   1.56%  96.60%]]
[2024-08-05 11:20:45,291] {result_logger:145} INFO - 
[[ 98.66%   1.98%   2.33%]
 [  0.03%  87.35%   0.15%]
 [  1.31%  10.67%  97.52%]]
[2024-08-05 11:20:45,291] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:20:45,296] {result_logger:134} INFO - 
[[27805   138   439]
 [    8  2473    64]
 [  638   558 19507]]
[2024-08-05 11:20:45,300] {result_logger:141} INFO - 
[[ 97.97%   0.49%   1.55%]
 [  0.31%  97.17%   2.51%]
 [  3.08%   2.70%  94.22%]]
[2024-08-05 11:20:45,304] {result_logger:145} INFO - 
[[ 97.73%   4.35%   2.19%]
 [  0.03%  78.04%   0.32%]
 [  2.24%  17.61%  97.49%]]
[2024-08-05 11:20:45,355] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:20:45,355] {result_logger:77} INFO - actual:
[2024-08-05 11:20:45,355] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:20:45,355] {result_logger:79} INFO - predicted:
[2024-08-05 11:20:45,355] {result_logger:80} INFO - 
[[95.16%  0.24%  4.61%]
 [15.68% 76.93%  7.38%]
 [ 4.40%  3.32% 92.28%]]
[2024-08-05 11:20:45,355] {run_experiment:113} INFO - [epoch  25] execution time: 110.36s	 avg f1-score: 0.9341

[2024-08-05 11:20:45,355] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:20:45,375] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:21:13,116] {train_model:82} INFO - Train Epoch: 26 [36352/366120 (10%)]	lr:1.11e-04	Loss: 0.027291
[2024-08-05 11:21:48,619] {train_model:82} INFO - Train Epoch: 26 [72960/366120 (20%)]	lr:1.11e-04	Loss: 0.035387
[2024-08-05 11:21:54,525] {train_model:82} INFO - Train Epoch: 26 [109568/366120 (30%)]	lr:1.11e-04	Loss: 0.046539
[2024-08-05 11:22:00,438] {train_model:82} INFO - Train Epoch: 26 [146176/366120 (40%)]	lr:1.11e-04	Loss: 0.062427
[2024-08-05 11:22:06,365] {train_model:82} INFO - Train Epoch: 26 [182784/366120 (50%)]	lr:1.11e-04	Loss: 0.124017
[2024-08-05 11:22:12,312] {train_model:82} INFO - Train Epoch: 26 [219392/366120 (60%)]	lr:1.11e-04	Loss: 0.051662
[2024-08-05 11:22:18,270] {train_model:82} INFO - Train Epoch: 26 [256000/366120 (70%)]	lr:1.11e-04	Loss: 0.041442
[2024-08-05 11:22:24,229] {train_model:82} INFO - Train Epoch: 26 [292608/366120 (80%)]	lr:1.11e-04	Loss: 0.044623
[2024-08-05 11:22:30,204] {train_model:82} INFO - Train Epoch: 26 [329216/366120 (90%)]	lr:1.11e-04	Loss: 0.041515
[2024-08-05 11:22:36,205] {train_model:82} INFO - Train Epoch: 26 [365824/366120 (100%)]	lr:1.11e-04	Loss: 0.044726
[2024-08-05 11:22:42,767] {run_experiment:79} INFO - 
[2024-08-05 11:22:42,768] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:22:43,211] {result_logger:103} INFO - precision on Wake: 0.987
[2024-08-05 11:22:43,536] {result_logger:104} INFO - recall on Wake: 0.982
[2024-08-05 11:22:43,864] {result_logger:107} INFO - F1-score on Wake: 0.985
[2024-08-05 11:22:43,864] {result_logger:108} INFO - 
[2024-08-05 11:22:44,277] {result_logger:103} INFO - precision on REM: 0.883
[2024-08-05 11:22:44,566] {result_logger:104} INFO - recall on REM: 0.986
[2024-08-05 11:22:44,856] {result_logger:107} INFO - F1-score on REM: 0.932
[2024-08-05 11:22:44,856] {result_logger:108} INFO - 
[2024-08-05 11:22:45,307] {result_logger:103} INFO - precision on Non REM: 0.976
[2024-08-05 11:22:45,632] {result_logger:104} INFO - recall on Non REM: 0.968
[2024-08-05 11:22:45,955] {result_logger:107} INFO - F1-score on Non REM: 0.972
[2024-08-05 11:22:45,955] {result_logger:108} INFO - 
[2024-08-05 11:22:46,021] {result_logger:111} INFO - average precision on sleep stages: 0.949
[2024-08-05 11:22:46,087] {result_logger:113} INFO - average recall on sleep stages: 0.979
[2024-08-05 11:22:46,153] {result_logger:115} INFO - average F1-score on sleep stages: 0.963
[2024-08-05 11:22:46,154] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:22:46,210] {result_logger:103} INFO - precision on Wake: 0.982
[2024-08-05 11:22:46,250] {result_logger:104} INFO - recall on Wake: 0.974
[2024-08-05 11:22:46,289] {result_logger:107} INFO - F1-score on Wake: 0.978
[2024-08-05 11:22:46,289] {result_logger:108} INFO - 
[2024-08-05 11:22:46,346] {result_logger:103} INFO - precision on REM: 0.847
[2024-08-05 11:22:46,385] {result_logger:104} INFO - recall on REM: 0.954
[2024-08-05 11:22:46,424] {result_logger:107} INFO - F1-score on REM: 0.898
[2024-08-05 11:22:46,424] {result_logger:108} INFO - 
[2024-08-05 11:22:46,481] {result_logger:103} INFO - precision on Non REM: 0.965
[2024-08-05 11:22:46,521] {result_logger:104} INFO - recall on Non REM: 0.961
[2024-08-05 11:22:46,561] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2024-08-05 11:22:46,561] {result_logger:108} INFO - 
[2024-08-05 11:22:46,567] {result_logger:111} INFO - average precision on sleep stages: 0.931
[2024-08-05 11:22:46,573] {result_logger:113} INFO - average recall on sleep stages: 0.963
[2024-08-05 11:22:46,580] {result_logger:115} INFO - average F1-score on sleep stages: 0.946
[2024-08-05 11:22:46,580] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:22:46,625] {result_logger:134} INFO - 
[[200079    379   3289]
 [    61  18348    197]
 [  2497   2058 139212]]
[2024-08-05 11:22:46,670] {result_logger:141} INFO - 
[[ 98.20%   0.19%   1.61%]
 [  0.33%  98.61%   1.06%]
 [  1.74%   1.43%  96.83%]]
[2024-08-05 11:22:46,715] {result_logger:145} INFO - 
[[ 98.74%   1.82%   2.30%]
 [  0.03%  88.28%   0.14%]
 [  1.23%   9.90%  97.56%]]
[2024-08-05 11:22:46,716] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:22:46,720] {result_logger:134} INFO - 
[[27644   109   629]
 [   13  2429   103]
 [  483   329 19891]]
[2024-08-05 11:22:46,724] {result_logger:141} INFO - 
[[ 97.40%   0.38%   2.22%]
 [  0.51%  95.44%   4.05%]
 [  2.33%   1.59%  96.08%]]
[2024-08-05 11:22:46,729] {result_logger:145} INFO - 
[[ 98.24%   3.80%   3.05%]
 [  0.05%  84.72%   0.50%]
 [  1.72%  11.48%  96.45%]]
[2024-08-05 11:22:46,781] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:22:46,781] {result_logger:77} INFO - actual:
[2024-08-05 11:22:46,781] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:22:46,781] {result_logger:79} INFO - predicted:
[2024-08-05 11:22:46,781] {result_logger:80} INFO - 
[[95.07%  0.22%  4.71%]
 [15.49% 79.04%  5.48%]
 [ 4.57%  2.62% 92.81%]]
[2024-08-05 11:22:46,781] {run_experiment:113} INFO - [epoch  26] execution time: 121.43s	 avg f1-score: 0.9461

[2024-08-05 11:22:46,781] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:22:46,800] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:23:13,361] {train_model:82} INFO - Train Epoch: 27 [36352/366120 (10%)]	lr:1.04e-04	Loss: 0.037773
[2024-08-05 11:23:45,014] {train_model:82} INFO - Train Epoch: 27 [72960/366120 (20%)]	lr:1.04e-04	Loss: 0.057859
[2024-08-05 11:23:50,806] {train_model:82} INFO - Train Epoch: 27 [109568/366120 (30%)]	lr:1.04e-04	Loss: 0.021303
[2024-08-05 11:23:56,605] {train_model:82} INFO - Train Epoch: 27 [146176/366120 (40%)]	lr:1.04e-04	Loss: 0.057923
[2024-08-05 11:24:02,421] {train_model:82} INFO - Train Epoch: 27 [182784/366120 (50%)]	lr:1.04e-04	Loss: 0.052249
[2024-08-05 11:24:08,251] {train_model:82} INFO - Train Epoch: 27 [219392/366120 (60%)]	lr:1.04e-04	Loss: 0.168447
[2024-08-05 11:24:14,091] {train_model:82} INFO - Train Epoch: 27 [256000/366120 (70%)]	lr:1.04e-04	Loss: 0.061050
[2024-08-05 11:24:19,942] {train_model:82} INFO - Train Epoch: 27 [292608/366120 (80%)]	lr:1.04e-04	Loss: 0.037096
[2024-08-05 11:24:25,804] {train_model:82} INFO - Train Epoch: 27 [329216/366120 (90%)]	lr:1.04e-04	Loss: 0.103290
[2024-08-05 11:24:31,725] {train_model:82} INFO - Train Epoch: 27 [365824/366120 (100%)]	lr:1.04e-04	Loss: 0.077364
[2024-08-05 11:24:37,958] {run_experiment:79} INFO - 
[2024-08-05 11:24:37,958] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:24:38,407] {result_logger:103} INFO - precision on Wake: 0.988
[2024-08-05 11:24:38,733] {result_logger:104} INFO - recall on Wake: 0.983
[2024-08-05 11:24:39,060] {result_logger:107} INFO - F1-score on Wake: 0.985
[2024-08-05 11:24:39,060] {result_logger:108} INFO - 
[2024-08-05 11:24:39,459] {result_logger:103} INFO - precision on REM: 0.891
[2024-08-05 11:24:39,739] {result_logger:104} INFO - recall on REM: 0.989
[2024-08-05 11:24:40,017] {result_logger:107} INFO - F1-score on REM: 0.938
[2024-08-05 11:24:40,017] {result_logger:108} INFO - 
[2024-08-05 11:24:40,469] {result_logger:103} INFO - precision on Non REM: 0.976
[2024-08-05 11:24:40,795] {result_logger:104} INFO - recall on Non REM: 0.970
[2024-08-05 11:24:41,122] {result_logger:107} INFO - F1-score on Non REM: 0.973
[2024-08-05 11:24:41,122] {result_logger:108} INFO - 
[2024-08-05 11:24:41,191] {result_logger:111} INFO - average precision on sleep stages: 0.952
[2024-08-05 11:24:41,259] {result_logger:113} INFO - average recall on sleep stages: 0.980
[2024-08-05 11:24:41,327] {result_logger:115} INFO - average F1-score on sleep stages: 0.965
[2024-08-05 11:24:41,328] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:24:41,385] {result_logger:103} INFO - precision on Wake: 0.981
[2024-08-05 11:24:41,424] {result_logger:104} INFO - recall on Wake: 0.978
[2024-08-05 11:24:41,464] {result_logger:107} INFO - F1-score on Wake: 0.979
[2024-08-05 11:24:41,464] {result_logger:108} INFO - 
[2024-08-05 11:24:41,520] {result_logger:103} INFO - precision on REM: 0.837
[2024-08-05 11:24:41,559] {result_logger:104} INFO - recall on REM: 0.953
[2024-08-05 11:24:41,598] {result_logger:107} INFO - F1-score on REM: 0.891
[2024-08-05 11:24:41,598] {result_logger:108} INFO - 
[2024-08-05 11:24:41,656] {result_logger:103} INFO - precision on Non REM: 0.970
[2024-08-05 11:24:41,694] {result_logger:104} INFO - recall on Non REM: 0.958
[2024-08-05 11:24:41,734] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2024-08-05 11:24:41,734] {result_logger:108} INFO - 
[2024-08-05 11:24:41,740] {result_logger:111} INFO - average precision on sleep stages: 0.929
[2024-08-05 11:24:41,746] {result_logger:113} INFO - average recall on sleep stages: 0.963
[2024-08-05 11:24:41,752] {result_logger:115} INFO - average F1-score on sleep stages: 0.945
[2024-08-05 11:24:41,753] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:24:41,799] {result_logger:134} INFO - 
[[200194    350   3203]
 [    50  18396    160]
 [  2411   1889 139467]]
[2024-08-05 11:24:41,846] {result_logger:141} INFO - 
[[ 98.26%   0.17%   1.57%]
 [  0.27%  98.87%   0.86%]
 [  1.68%   1.31%  97.01%]]
[2024-08-05 11:24:41,893] {result_logger:145} INFO - 
[[ 98.79%   1.70%   2.24%]
 [  0.02%  89.15%   0.11%]
 [  1.19%   9.15%  97.65%]]
[2024-08-05 11:24:41,893] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:24:41,897] {result_logger:134} INFO - 
[[27745   125   512]
 [   16  2425   104]
 [  532   347 19824]]
[2024-08-05 11:24:41,902] {result_logger:141} INFO - 
[[ 97.76%   0.44%   1.80%]
 [  0.63%  95.28%   4.09%]
 [  2.57%   1.68%  95.75%]]
[2024-08-05 11:24:41,906] {result_logger:145} INFO - 
[[ 98.06%   4.31%   2.50%]
 [  0.06%  83.71%   0.51%]
 [  1.88%  11.98%  96.99%]]
[2024-08-05 11:24:41,958] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:24:41,958] {result_logger:77} INFO - actual:
[2024-08-05 11:24:41,958] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:24:41,958] {result_logger:79} INFO - predicted:
[2024-08-05 11:24:41,958] {result_logger:80} INFO - 
[[94.97%  0.23%  4.80%]
 [16.33% 78.36%  5.32%]
 [ 4.65%  2.75% 92.60%]]
[2024-08-05 11:24:41,958] {run_experiment:113} INFO - [epoch  27] execution time: 115.18s	 avg f1-score: 0.9447

[2024-08-05 11:24:41,958] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:24:41,977] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:25:07,521] {train_model:82} INFO - Train Epoch: 28 [36352/366120 (10%)]	lr:9.80e-05	Loss: 0.056952
[2024-08-05 11:25:38,271] {train_model:82} INFO - Train Epoch: 28 [72960/366120 (20%)]	lr:9.80e-05	Loss: 0.054002
[2024-08-05 11:25:44,109] {train_model:82} INFO - Train Epoch: 28 [109568/366120 (30%)]	lr:9.80e-05	Loss: 0.031933
[2024-08-05 11:25:49,950] {train_model:82} INFO - Train Epoch: 28 [146176/366120 (40%)]	lr:9.80e-05	Loss: 0.045777
[2024-08-05 11:25:55,805] {train_model:82} INFO - Train Epoch: 28 [182784/366120 (50%)]	lr:9.80e-05	Loss: 0.073515
[2024-08-05 11:26:01,673] {train_model:82} INFO - Train Epoch: 28 [219392/366120 (60%)]	lr:9.80e-05	Loss: 0.029397
[2024-08-05 11:26:07,546] {train_model:82} INFO - Train Epoch: 28 [256000/366120 (70%)]	lr:9.80e-05	Loss: 0.054719
[2024-08-05 11:26:13,432] {train_model:82} INFO - Train Epoch: 28 [292608/366120 (80%)]	lr:9.80e-05	Loss: 0.038215
[2024-08-05 11:26:19,295] {train_model:82} INFO - Train Epoch: 28 [329216/366120 (90%)]	lr:9.80e-05	Loss: 0.087267
[2024-08-05 11:26:25,193] {train_model:82} INFO - Train Epoch: 28 [365824/366120 (100%)]	lr:9.80e-05	Loss: 0.031424
[2024-08-05 11:26:31,843] {run_experiment:79} INFO - 
[2024-08-05 11:26:31,843] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:26:32,299] {result_logger:103} INFO - precision on Wake: 0.989
[2024-08-05 11:26:32,616] {result_logger:104} INFO - recall on Wake: 0.984
[2024-08-05 11:26:32,937] {result_logger:107} INFO - F1-score on Wake: 0.986
[2024-08-05 11:26:32,937] {result_logger:108} INFO - 
[2024-08-05 11:26:33,345] {result_logger:103} INFO - precision on REM: 0.902
[2024-08-05 11:26:33,625] {result_logger:104} INFO - recall on REM: 0.990
[2024-08-05 11:26:33,909] {result_logger:107} INFO - F1-score on REM: 0.944
[2024-08-05 11:26:33,909] {result_logger:108} INFO - 
[2024-08-05 11:26:34,362] {result_logger:103} INFO - precision on Non REM: 0.978
[2024-08-05 11:26:34,691] {result_logger:104} INFO - recall on Non REM: 0.972
[2024-08-05 11:26:35,019] {result_logger:107} INFO - F1-score on Non REM: 0.975
[2024-08-05 11:26:35,019] {result_logger:108} INFO - 
[2024-08-05 11:26:35,089] {result_logger:111} INFO - average precision on sleep stages: 0.956
[2024-08-05 11:26:35,157] {result_logger:113} INFO - average recall on sleep stages: 0.982
[2024-08-05 11:26:35,226] {result_logger:115} INFO - average F1-score on sleep stages: 0.968
[2024-08-05 11:26:35,227] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:26:35,284] {result_logger:103} INFO - precision on Wake: 0.981
[2024-08-05 11:26:35,324] {result_logger:104} INFO - recall on Wake: 0.983
[2024-08-05 11:26:35,364] {result_logger:107} INFO - F1-score on Wake: 0.982
[2024-08-05 11:26:35,364] {result_logger:108} INFO - 
[2024-08-05 11:26:35,421] {result_logger:103} INFO - precision on REM: 0.852
[2024-08-05 11:26:35,460] {result_logger:104} INFO - recall on REM: 0.960
[2024-08-05 11:26:35,499] {result_logger:107} INFO - F1-score on REM: 0.903
[2024-08-05 11:26:35,499] {result_logger:108} INFO - 
[2024-08-05 11:26:35,557] {result_logger:103} INFO - precision on Non REM: 0.974
[2024-08-05 11:26:35,597] {result_logger:104} INFO - recall on Non REM: 0.957
[2024-08-05 11:26:35,637] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2024-08-05 11:26:35,637] {result_logger:108} INFO - 
[2024-08-05 11:26:35,643] {result_logger:111} INFO - average precision on sleep stages: 0.936
[2024-08-05 11:26:35,649] {result_logger:113} INFO - average recall on sleep stages: 0.966
[2024-08-05 11:26:35,655] {result_logger:115} INFO - average F1-score on sleep stages: 0.950
[2024-08-05 11:26:35,655] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:26:35,703] {result_logger:134} INFO - 
[[200428    313   3006]
 [    51  18421    134]
 [  2269   1698 139800]]
[2024-08-05 11:26:35,750] {result_logger:141} INFO - 
[[ 98.37%   0.15%   1.48%]
 [  0.27%  99.01%   0.72%]
 [  1.58%   1.18%  97.24%]]
[2024-08-05 11:26:35,797] {result_logger:145} INFO - 
[[ 98.86%   1.53%   2.10%]
 [  0.03%  90.16%   0.09%]
 [  1.12%   8.31%  97.80%]]
[2024-08-05 11:26:35,798] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:26:35,802] {result_logger:134} INFO - 
[[27891    60   431]
 [   12  2442    91]
 [  532   363 19808]]
[2024-08-05 11:26:35,984] {result_logger:141} INFO - 
[[ 98.27%   0.21%   1.52%]
 [  0.47%  95.95%   3.58%]
 [  2.57%   1.75%  95.68%]]
[2024-08-05 11:26:36,067] {result_logger:145} INFO - 
[[ 98.09%   2.09%   2.12%]
 [  0.04%  85.24%   0.45%]
 [  1.87%  12.67%  97.43%]]
[2024-08-05 11:26:36,359] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:26:36,359] {result_logger:77} INFO - actual:
[2024-08-05 11:26:36,360] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:26:36,360] {result_logger:79} INFO - predicted:
[2024-08-05 11:26:36,360] {result_logger:80} INFO - 
[[95.42%  0.08%  4.50%]
 [15.18% 79.69%  5.13%]
 [ 4.27%  2.74% 92.99%]]
[2024-08-05 11:26:36,453] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_D_weighted/model_8conv_2fc-best.pth
[2024-08-05 11:26:36,453] {run_experiment:113} INFO - [epoch  28] execution time: 114.50s	 avg f1-score: 0.9500

[2024-08-05 11:26:36,454] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:26:36,473] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:26:58,009] {train_model:82} INFO - Train Epoch: 29 [36352/366120 (10%)]	lr:9.23e-05	Loss: 0.034570
[2024-08-05 11:27:30,747] {train_model:82} INFO - Train Epoch: 29 [72960/366120 (20%)]	lr:9.23e-05	Loss: 0.043580
[2024-08-05 11:27:38,719] {train_model:82} INFO - Train Epoch: 29 [109568/366120 (30%)]	lr:9.23e-05	Loss: 0.029106
[2024-08-05 11:27:44,579] {train_model:82} INFO - Train Epoch: 29 [146176/366120 (40%)]	lr:9.23e-05	Loss: 0.043335
[2024-08-05 11:27:50,457] {train_model:82} INFO - Train Epoch: 29 [182784/366120 (50%)]	lr:9.23e-05	Loss: 0.018580
[2024-08-05 11:27:56,348] {train_model:82} INFO - Train Epoch: 29 [219392/366120 (60%)]	lr:9.23e-05	Loss: 0.102841
[2024-08-05 11:28:02,241] {train_model:82} INFO - Train Epoch: 29 [256000/366120 (70%)]	lr:9.23e-05	Loss: 0.013195
[2024-08-05 11:28:08,136] {train_model:82} INFO - Train Epoch: 29 [292608/366120 (80%)]	lr:9.23e-05	Loss: 0.056140
[2024-08-05 11:28:14,050] {train_model:82} INFO - Train Epoch: 29 [329216/366120 (90%)]	lr:9.23e-05	Loss: 0.059728
[2024-08-05 11:28:20,003] {train_model:82} INFO - Train Epoch: 29 [365824/366120 (100%)]	lr:9.23e-05	Loss: 0.025567
[2024-08-05 11:28:26,610] {run_experiment:79} INFO - 
[2024-08-05 11:28:26,610] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:28:27,062] {result_logger:103} INFO - precision on Wake: 0.989
[2024-08-05 11:28:27,384] {result_logger:104} INFO - recall on Wake: 0.984
[2024-08-05 11:28:27,709] {result_logger:107} INFO - F1-score on Wake: 0.987
[2024-08-05 11:28:27,709] {result_logger:108} INFO - 
[2024-08-05 11:28:28,119] {result_logger:103} INFO - precision on REM: 0.908
[2024-08-05 11:28:28,403] {result_logger:104} INFO - recall on REM: 0.990
[2024-08-05 11:28:28,684] {result_logger:107} INFO - F1-score on REM: 0.947
[2024-08-05 11:28:28,684] {result_logger:108} INFO - 
[2024-08-05 11:28:29,125] {result_logger:103} INFO - precision on Non REM: 0.979
[2024-08-05 11:28:29,442] {result_logger:104} INFO - recall on Non REM: 0.974
[2024-08-05 11:28:29,761] {result_logger:107} INFO - F1-score on Non REM: 0.976
[2024-08-05 11:28:29,761] {result_logger:108} INFO - 
[2024-08-05 11:28:29,824] {result_logger:111} INFO - average precision on sleep stages: 0.959
[2024-08-05 11:28:29,888] {result_logger:113} INFO - average recall on sleep stages: 0.983
[2024-08-05 11:28:29,952] {result_logger:115} INFO - average F1-score on sleep stages: 0.970
[2024-08-05 11:28:29,953] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:28:30,009] {result_logger:103} INFO - precision on Wake: 0.981
[2024-08-05 11:28:30,047] {result_logger:104} INFO - recall on Wake: 0.978
[2024-08-05 11:28:30,085] {result_logger:107} INFO - F1-score on Wake: 0.980
[2024-08-05 11:28:30,085] {result_logger:108} INFO - 
[2024-08-05 11:28:30,141] {result_logger:103} INFO - precision on REM: 0.846
[2024-08-05 11:28:30,181] {result_logger:104} INFO - recall on REM: 0.950
[2024-08-05 11:28:30,220] {result_logger:107} INFO - F1-score on REM: 0.895
[2024-08-05 11:28:30,220] {result_logger:108} INFO - 
[2024-08-05 11:28:30,277] {result_logger:103} INFO - precision on Non REM: 0.969
[2024-08-05 11:28:30,317] {result_logger:104} INFO - recall on Non REM: 0.958
[2024-08-05 11:28:30,357] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2024-08-05 11:28:30,357] {result_logger:108} INFO - 
[2024-08-05 11:28:30,363] {result_logger:111} INFO - average precision on sleep stages: 0.932
[2024-08-05 11:28:30,369] {result_logger:113} INFO - average recall on sleep stages: 0.962
[2024-08-05 11:28:30,376] {result_logger:115} INFO - average F1-score on sleep stages: 0.946
[2024-08-05 11:28:30,376] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:28:30,420] {result_logger:134} INFO - 
[[200524    301   2922]
 [    50  18413    143]
 [  2118   1560 140089]]
[2024-08-05 11:28:30,463] {result_logger:141} INFO - 
[[ 98.42%   0.15%   1.43%]
 [  0.27%  98.96%   0.77%]
 [  1.47%   1.09%  97.44%]]
[2024-08-05 11:28:30,507] {result_logger:145} INFO - 
[[ 98.93%   1.48%   2.04%]
 [  0.02%  90.82%   0.10%]
 [  1.04%   7.69%  97.86%]]
[2024-08-05 11:28:30,507] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:28:30,512] {result_logger:134} INFO - 
[[27764    97   521]
 [   12  2418   115]
 [  523   343 19837]]
[2024-08-05 11:28:30,516] {result_logger:141} INFO - 
[[ 97.82%   0.34%   1.84%]
 [  0.47%  95.01%   4.52%]
 [  2.53%   1.66%  95.82%]]
[2024-08-05 11:28:30,520] {result_logger:145} INFO - 
[[ 98.11%   3.39%   2.54%]
 [  0.04%  84.60%   0.56%]
 [  1.85%  12.00%  96.89%]]
[2024-08-05 11:28:30,572] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:28:30,572] {result_logger:77} INFO - actual:
[2024-08-05 11:28:30,572] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:28:30,572] {result_logger:79} INFO - predicted:
[2024-08-05 11:28:30,572] {result_logger:80} INFO - 
[[95.15%  0.19%  4.66%]
 [16.31% 78.48%  5.21%]
 [ 4.43%  2.74% 92.83%]]
[2024-08-05 11:28:30,572] {run_experiment:113} INFO - [epoch  29] execution time: 114.12s	 avg f1-score: 0.9461

[2024-08-05 11:28:30,572] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:28:30,592] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:28:55,720] {train_model:82} INFO - Train Epoch: 30 [36352/366120 (10%)]	lr:8.69e-05	Loss: 0.028988
[2024-08-05 11:29:01,618] {train_model:82} INFO - Train Epoch: 30 [72960/366120 (20%)]	lr:8.69e-05	Loss: 0.074477
[2024-08-05 11:29:35,580] {train_model:82} INFO - Train Epoch: 30 [109568/366120 (30%)]	lr:8.69e-05	Loss: 0.019458
[2024-08-05 11:29:41,455] {train_model:82} INFO - Train Epoch: 30 [146176/366120 (40%)]	lr:8.69e-05	Loss: 0.010631
[2024-08-05 11:29:47,379] {train_model:82} INFO - Train Epoch: 30 [182784/366120 (50%)]	lr:8.69e-05	Loss: 0.062520
[2024-08-05 11:29:53,319] {train_model:82} INFO - Train Epoch: 30 [219392/366120 (60%)]	lr:8.69e-05	Loss: 0.048111
[2024-08-05 11:29:59,274] {train_model:82} INFO - Train Epoch: 30 [256000/366120 (70%)]	lr:8.69e-05	Loss: 0.045530
[2024-08-05 11:30:05,241] {train_model:82} INFO - Train Epoch: 30 [292608/366120 (80%)]	lr:8.69e-05	Loss: 0.011351
[2024-08-05 11:30:11,216] {train_model:82} INFO - Train Epoch: 30 [329216/366120 (90%)]	lr:8.69e-05	Loss: 0.044091
[2024-08-05 11:30:17,213] {train_model:82} INFO - Train Epoch: 30 [365824/366120 (100%)]	lr:8.69e-05	Loss: 0.048626
[2024-08-05 11:30:23,465] {run_experiment:79} INFO - 
[2024-08-05 11:30:23,466] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:30:23,919] {result_logger:103} INFO - precision on Wake: 0.990
[2024-08-05 11:30:24,248] {result_logger:104} INFO - recall on Wake: 0.985
[2024-08-05 11:30:24,574] {result_logger:107} INFO - F1-score on Wake: 0.987
[2024-08-05 11:30:24,574] {result_logger:108} INFO - 
[2024-08-05 11:30:24,984] {result_logger:103} INFO - precision on REM: 0.916
[2024-08-05 11:30:25,267] {result_logger:104} INFO - recall on REM: 0.991
[2024-08-05 11:30:25,552] {result_logger:107} INFO - F1-score on REM: 0.952
[2024-08-05 11:30:25,553] {result_logger:108} INFO - 
[2024-08-05 11:30:26,010] {result_logger:103} INFO - precision on Non REM: 0.980
[2024-08-05 11:30:26,341] {result_logger:104} INFO - recall on Non REM: 0.976
[2024-08-05 11:30:26,669] {result_logger:107} INFO - F1-score on Non REM: 0.978
[2024-08-05 11:30:26,669] {result_logger:108} INFO - 
[2024-08-05 11:30:26,736] {result_logger:111} INFO - average precision on sleep stages: 0.962
[2024-08-05 11:30:26,804] {result_logger:113} INFO - average recall on sleep stages: 0.984
[2024-08-05 11:30:26,872] {result_logger:115} INFO - average F1-score on sleep stages: 0.972
[2024-08-05 11:30:26,873] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:30:26,931] {result_logger:103} INFO - precision on Wake: 0.979
[2024-08-05 11:30:26,971] {result_logger:104} INFO - recall on Wake: 0.977
[2024-08-05 11:30:27,011] {result_logger:107} INFO - F1-score on Wake: 0.978
[2024-08-05 11:30:27,011] {result_logger:108} INFO - 
[2024-08-05 11:30:27,069] {result_logger:103} INFO - precision on REM: 0.842
[2024-08-05 11:30:27,109] {result_logger:104} INFO - recall on REM: 0.936
[2024-08-05 11:30:27,149] {result_logger:107} INFO - F1-score on REM: 0.887
[2024-08-05 11:30:27,149] {result_logger:108} INFO - 
[2024-08-05 11:30:27,208] {result_logger:103} INFO - precision on Non REM: 0.970
[2024-08-05 11:30:27,248] {result_logger:104} INFO - recall on Non REM: 0.959
[2024-08-05 11:30:27,287] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2024-08-05 11:30:27,287] {result_logger:108} INFO - 
[2024-08-05 11:30:27,294] {result_logger:111} INFO - average precision on sleep stages: 0.930
[2024-08-05 11:30:27,300] {result_logger:113} INFO - average recall on sleep stages: 0.957
[2024-08-05 11:30:27,306] {result_logger:115} INFO - average F1-score on sleep stages: 0.943
[2024-08-05 11:30:27,306] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:30:27,351] {result_logger:134} INFO - 
[[200729    264   2754]
 [    42  18436    128]
 [  2062   1418 140287]]
[2024-08-05 11:30:27,396] {result_logger:141} INFO - 
[[ 98.52%   0.13%   1.35%]
 [  0.23%  99.09%   0.69%]
 [  1.43%   0.99%  97.58%]]
[2024-08-05 11:30:27,441] {result_logger:145} INFO - 
[[ 98.96%   1.31%   1.92%]
 [  0.02%  91.64%   0.09%]
 [  1.02%   7.05%  97.99%]]
[2024-08-05 11:30:27,441] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:30:27,445] {result_logger:134} INFO - 
[[27742   165   475]
 [   24  2383   138]
 [  577   282 19844]]
[2024-08-05 11:30:27,450] {result_logger:141} INFO - 
[[ 97.75%   0.58%   1.67%]
 [  0.94%  93.63%   5.42%]
 [  2.79%   1.36%  95.85%]]
[2024-08-05 11:30:27,454] {result_logger:145} INFO - 
[[ 97.88%   5.83%   2.32%]
 [  0.08%  84.20%   0.67%]
 [  2.04%   9.96%  97.00%]]
[2024-08-05 11:30:27,506] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:30:27,506] {result_logger:77} INFO - actual:
[2024-08-05 11:30:27,506] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:30:27,506] {result_logger:79} INFO - predicted:
[2024-08-05 11:30:27,506] {result_logger:80} INFO - 
[[94.84%  0.37%  4.78%]
 [18.09% 76.61%  5.30%]
 [ 4.64%  2.72% 92.64%]]
[2024-08-05 11:30:27,506] {run_experiment:113} INFO - [epoch  30] execution time: 116.93s	 avg f1-score: 0.9430

[2024-08-05 11:30:27,506] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:30:27,526] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:30:52,693] {train_model:82} INFO - Train Epoch: 31 [36352/366120 (10%)]	lr:8.19e-05	Loss: 0.020749
[2024-08-05 11:30:58,485] {train_model:82} INFO - Train Epoch: 31 [72960/366120 (20%)]	lr:8.19e-05	Loss: 0.016682
[2024-08-05 11:31:28,161] {train_model:82} INFO - Train Epoch: 31 [109568/366120 (30%)]	lr:8.19e-05	Loss: 0.053301
[2024-08-05 11:31:34,027] {train_model:82} INFO - Train Epoch: 31 [146176/366120 (40%)]	lr:8.19e-05	Loss: 0.062376
[2024-08-05 11:31:39,913] {train_model:82} INFO - Train Epoch: 31 [182784/366120 (50%)]	lr:8.19e-05	Loss: 0.015138
[2024-08-05 11:31:45,813] {train_model:82} INFO - Train Epoch: 31 [219392/366120 (60%)]	lr:8.19e-05	Loss: 0.051821
[2024-08-05 11:31:51,716] {train_model:82} INFO - Train Epoch: 31 [256000/366120 (70%)]	lr:8.19e-05	Loss: 0.039476
[2024-08-05 11:31:57,633] {train_model:82} INFO - Train Epoch: 31 [292608/366120 (80%)]	lr:8.19e-05	Loss: 0.049598
[2024-08-05 11:32:03,547] {train_model:82} INFO - Train Epoch: 31 [329216/366120 (90%)]	lr:8.19e-05	Loss: 0.036057
[2024-08-05 11:32:09,502] {train_model:82} INFO - Train Epoch: 31 [365824/366120 (100%)]	lr:8.19e-05	Loss: 0.021967
[2024-08-05 11:32:16,171] {run_experiment:79} INFO - 
[2024-08-05 11:32:16,172] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:32:16,628] {result_logger:103} INFO - precision on Wake: 0.990
[2024-08-05 11:32:16,960] {result_logger:104} INFO - recall on Wake: 0.985
[2024-08-05 11:32:17,293] {result_logger:107} INFO - F1-score on Wake: 0.988
[2024-08-05 11:32:17,293] {result_logger:108} INFO - 
[2024-08-05 11:32:17,703] {result_logger:103} INFO - precision on REM: 0.920
[2024-08-05 11:32:17,993] {result_logger:104} INFO - recall on REM: 0.990
[2024-08-05 11:32:18,282] {result_logger:107} INFO - F1-score on REM: 0.954
[2024-08-05 11:32:18,282] {result_logger:108} INFO - 
[2024-08-05 11:32:18,733] {result_logger:103} INFO - precision on Non REM: 0.980
[2024-08-05 11:32:19,064] {result_logger:104} INFO - recall on Non REM: 0.977
[2024-08-05 11:32:19,394] {result_logger:107} INFO - F1-score on Non REM: 0.979
[2024-08-05 11:32:19,394] {result_logger:108} INFO - 
[2024-08-05 11:32:19,458] {result_logger:111} INFO - average precision on sleep stages: 0.963
[2024-08-05 11:32:19,522] {result_logger:113} INFO - average recall on sleep stages: 0.984
[2024-08-05 11:32:19,586] {result_logger:115} INFO - average F1-score on sleep stages: 0.973
[2024-08-05 11:32:19,587] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:32:19,646] {result_logger:103} INFO - precision on Wake: 0.982
[2024-08-05 11:32:19,687] {result_logger:104} INFO - recall on Wake: 0.975
[2024-08-05 11:32:19,728] {result_logger:107} INFO - F1-score on Wake: 0.979
[2024-08-05 11:32:19,728] {result_logger:108} INFO - 
[2024-08-05 11:32:19,786] {result_logger:103} INFO - precision on REM: 0.824
[2024-08-05 11:32:19,826] {result_logger:104} INFO - recall on REM: 0.958
[2024-08-05 11:32:19,865] {result_logger:107} INFO - F1-score on REM: 0.886
[2024-08-05 11:32:19,866] {result_logger:108} INFO - 
[2024-08-05 11:32:19,924] {result_logger:103} INFO - precision on Non REM: 0.967
[2024-08-05 11:32:19,964] {result_logger:104} INFO - recall on Non REM: 0.956
[2024-08-05 11:32:20,005] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2024-08-05 11:32:20,005] {result_logger:108} INFO - 
[2024-08-05 11:32:20,011] {result_logger:111} INFO - average precision on sleep stages: 0.924
[2024-08-05 11:32:20,017] {result_logger:113} INFO - average recall on sleep stages: 0.963
[2024-08-05 11:32:20,023] {result_logger:115} INFO - average F1-score on sleep stages: 0.942
[2024-08-05 11:32:20,024] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:32:20,067] {result_logger:134} INFO - 
[[200766    275   2706]
 [    47  18426    133]
 [  1965   1338 140464]]
[2024-08-05 11:32:20,111] {result_logger:141} INFO - 
[[ 98.54%   0.13%   1.33%]
 [  0.25%  99.03%   0.71%]
 [  1.37%   0.93%  97.70%]]
[2024-08-05 11:32:20,155] {result_logger:145} INFO - 
[[ 99.01%   1.37%   1.89%]
 [  0.02%  91.95%   0.09%]
 [  0.97%   6.68%  98.02%]]
[2024-08-05 11:32:20,155] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:32:20,159] {result_logger:134} INFO - 
[[27681   114   587]
 [   14  2439    92]
 [  496   406 19801]]
[2024-08-05 11:32:20,163] {result_logger:141} INFO - 
[[ 97.53%   0.40%   2.07%]
 [  0.55%  95.83%   3.61%]
 [  2.40%   1.96%  95.64%]]
[2024-08-05 11:32:20,168] {result_logger:145} INFO - 
[[ 98.19%   3.85%   2.87%]
 [  0.05%  82.43%   0.45%]
 [  1.76%  13.72%  96.68%]]
[2024-08-05 11:32:20,221] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:32:20,221] {result_logger:77} INFO - actual:
[2024-08-05 11:32:20,221] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:32:20,221] {result_logger:79} INFO - predicted:
[2024-08-05 11:32:20,221] {result_logger:80} INFO - 
[[95.21%  0.22%  4.57%]
 [15.58% 78.34%  6.08%]
 [ 4.34%  2.82% 92.84%]]
[2024-08-05 11:32:20,221] {run_experiment:113} INFO - [epoch  31] execution time: 112.71s	 avg f1-score: 0.9422

[2024-08-05 11:32:20,221] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:32:20,240] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:32:45,963] {train_model:82} INFO - Train Epoch: 32 [36352/366120 (10%)]	lr:7.71e-05	Loss: 0.038634
[2024-08-05 11:32:51,910] {train_model:82} INFO - Train Epoch: 32 [72960/366120 (20%)]	lr:7.71e-05	Loss: 0.024570
[2024-08-05 11:33:21,955] {train_model:82} INFO - Train Epoch: 32 [109568/366120 (30%)]	lr:7.71e-05	Loss: 0.026328
[2024-08-05 11:33:27,897] {train_model:82} INFO - Train Epoch: 32 [146176/366120 (40%)]	lr:7.71e-05	Loss: 0.030274
[2024-08-05 11:33:33,845] {train_model:82} INFO - Train Epoch: 32 [182784/366120 (50%)]	lr:7.71e-05	Loss: 0.033165
[2024-08-05 11:33:39,862] {train_model:82} INFO - Train Epoch: 32 [219392/366120 (60%)]	lr:7.71e-05	Loss: 0.026845
[2024-08-05 11:33:45,834] {train_model:82} INFO - Train Epoch: 32 [256000/366120 (70%)]	lr:7.71e-05	Loss: 0.022311
[2024-08-05 11:33:51,814] {train_model:82} INFO - Train Epoch: 32 [292608/366120 (80%)]	lr:7.71e-05	Loss: 0.029070
[2024-08-05 11:33:57,807] {train_model:82} INFO - Train Epoch: 32 [329216/366120 (90%)]	lr:7.71e-05	Loss: 0.041303
[2024-08-05 11:34:03,821] {train_model:82} INFO - Train Epoch: 32 [365824/366120 (100%)]	lr:7.71e-05	Loss: 0.028918
[2024-08-05 11:34:10,140] {run_experiment:79} INFO - 
[2024-08-05 11:34:10,140] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:34:10,583] {result_logger:103} INFO - precision on Wake: 0.991
[2024-08-05 11:34:10,902] {result_logger:104} INFO - recall on Wake: 0.987
[2024-08-05 11:34:11,221] {result_logger:107} INFO - F1-score on Wake: 0.989
[2024-08-05 11:34:11,221] {result_logger:108} INFO - 
[2024-08-05 11:34:11,624] {result_logger:103} INFO - precision on REM: 0.925
[2024-08-05 11:34:11,903] {result_logger:104} INFO - recall on REM: 0.992
[2024-08-05 11:34:12,184] {result_logger:107} INFO - F1-score on REM: 0.957
[2024-08-05 11:34:12,184] {result_logger:108} INFO - 
[2024-08-05 11:34:12,630] {result_logger:103} INFO - precision on Non REM: 0.982
[2024-08-05 11:34:12,950] {result_logger:104} INFO - recall on Non REM: 0.978
[2024-08-05 11:34:13,273] {result_logger:107} INFO - F1-score on Non REM: 0.980
[2024-08-05 11:34:13,273] {result_logger:108} INFO - 
[2024-08-05 11:34:13,339] {result_logger:111} INFO - average precision on sleep stages: 0.966
[2024-08-05 11:34:13,406] {result_logger:113} INFO - average recall on sleep stages: 0.986
[2024-08-05 11:34:13,472] {result_logger:115} INFO - average F1-score on sleep stages: 0.975
[2024-08-05 11:34:13,473] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:34:13,530] {result_logger:103} INFO - precision on Wake: 0.986
[2024-08-05 11:34:13,570] {result_logger:104} INFO - recall on Wake: 0.972
[2024-08-05 11:34:13,609] {result_logger:107} INFO - F1-score on Wake: 0.979
[2024-08-05 11:34:13,609] {result_logger:108} INFO - 
[2024-08-05 11:34:13,666] {result_logger:103} INFO - precision on REM: 0.860
[2024-08-05 11:34:13,705] {result_logger:104} INFO - recall on REM: 0.947
[2024-08-05 11:34:13,743] {result_logger:107} INFO - F1-score on REM: 0.902
[2024-08-05 11:34:13,743] {result_logger:108} INFO - 
[2024-08-05 11:34:13,800] {result_logger:103} INFO - precision on Non REM: 0.961
[2024-08-05 11:34:13,838] {result_logger:104} INFO - recall on Non REM: 0.968
[2024-08-05 11:34:13,877] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2024-08-05 11:34:13,877] {result_logger:108} INFO - 
[2024-08-05 11:34:13,883] {result_logger:111} INFO - average precision on sleep stages: 0.936
[2024-08-05 11:34:13,889] {result_logger:113} INFO - average recall on sleep stages: 0.962
[2024-08-05 11:34:13,895] {result_logger:115} INFO - average F1-score on sleep stages: 0.948
[2024-08-05 11:34:13,896] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:34:13,941] {result_logger:134} INFO - 
[[201009    246   2492]
 [    44  18454    108]
 [  1875   1256 140636]]
[2024-08-05 11:34:13,987] {result_logger:141} INFO - 
[[ 98.66%   0.12%   1.22%]
 [  0.24%  99.18%   0.58%]
 [  1.30%   0.87%  97.82%]]
[2024-08-05 11:34:14,032] {result_logger:145} INFO - 
[[ 99.05%   1.23%   1.74%]
 [  0.02%  92.47%   0.08%]
 [  0.92%   6.29%  98.18%]]
[2024-08-05 11:34:14,032] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:34:14,037] {result_logger:134} INFO - 
[[27585   105   692]
 [   13  2410   122]
 [  386   286 20031]]
[2024-08-05 11:34:14,041] {result_logger:141} INFO - 
[[ 97.19%   0.37%   2.44%]
 [  0.51%  94.70%   4.79%]
 [  1.86%   1.38%  96.75%]]
[2024-08-05 11:34:14,046] {result_logger:145} INFO - 
[[ 98.57%   3.75%   3.32%]
 [  0.05%  86.04%   0.59%]
 [  1.38%  10.21%  96.09%]]
[2024-08-05 11:34:14,096] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:34:14,096] {result_logger:77} INFO - actual:
[2024-08-05 11:34:14,096] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:34:14,096] {result_logger:79} INFO - predicted:
[2024-08-05 11:34:14,096] {result_logger:80} INFO - 
[[95.26%  0.21%  4.53%]
 [15.74% 78.47%  5.78%]
 [ 4.25%  2.61% 93.14%]]
[2024-08-05 11:34:14,096] {run_experiment:113} INFO - [epoch  32] execution time: 113.88s	 avg f1-score: 0.9482

[2024-08-05 11:34:14,096] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:34:14,116] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:34:38,425] {train_model:82} INFO - Train Epoch: 33 [36352/366120 (10%)]	lr:7.26e-05	Loss: 0.052333
[2024-08-05 11:34:44,311] {train_model:82} INFO - Train Epoch: 33 [72960/366120 (20%)]	lr:7.26e-05	Loss: 0.012980
[2024-08-05 11:35:16,900] {train_model:82} INFO - Train Epoch: 33 [109568/366120 (30%)]	lr:7.26e-05	Loss: 0.037018
[2024-08-05 11:35:22,765] {train_model:82} INFO - Train Epoch: 33 [146176/366120 (40%)]	lr:7.26e-05	Loss: 0.033212
[2024-08-05 11:35:28,645] {train_model:82} INFO - Train Epoch: 33 [182784/366120 (50%)]	lr:7.26e-05	Loss: 0.038784
[2024-08-05 11:35:34,541] {train_model:82} INFO - Train Epoch: 33 [219392/366120 (60%)]	lr:7.26e-05	Loss: 0.044876
[2024-08-05 11:35:40,439] {train_model:82} INFO - Train Epoch: 33 [256000/366120 (70%)]	lr:7.26e-05	Loss: 0.030791
[2024-08-05 11:35:46,342] {train_model:82} INFO - Train Epoch: 33 [292608/366120 (80%)]	lr:7.26e-05	Loss: 0.045475
[2024-08-05 11:35:52,256] {train_model:82} INFO - Train Epoch: 33 [329216/366120 (90%)]	lr:7.26e-05	Loss: 0.031270
[2024-08-05 11:35:58,200] {train_model:82} INFO - Train Epoch: 33 [365824/366120 (100%)]	lr:7.26e-05	Loss: 0.062193
[2024-08-05 11:36:04,159] {run_experiment:79} INFO - 
[2024-08-05 11:36:04,159] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:36:04,606] {result_logger:103} INFO - precision on Wake: 0.991
[2024-08-05 11:36:04,934] {result_logger:104} INFO - recall on Wake: 0.987
[2024-08-05 11:36:05,264] {result_logger:107} INFO - F1-score on Wake: 0.989
[2024-08-05 11:36:05,264] {result_logger:108} INFO - 
[2024-08-05 11:36:05,677] {result_logger:103} INFO - precision on REM: 0.931
[2024-08-05 11:36:05,968] {result_logger:104} INFO - recall on REM: 0.993
[2024-08-05 11:36:06,259] {result_logger:107} INFO - F1-score on REM: 0.961
[2024-08-05 11:36:06,259] {result_logger:108} INFO - 
[2024-08-05 11:36:06,707] {result_logger:103} INFO - precision on Non REM: 0.982
[2024-08-05 11:36:07,029] {result_logger:104} INFO - recall on Non REM: 0.980
[2024-08-05 11:36:07,352] {result_logger:107} INFO - F1-score on Non REM: 0.981
[2024-08-05 11:36:07,352] {result_logger:108} INFO - 
[2024-08-05 11:36:07,416] {result_logger:111} INFO - average precision on sleep stages: 0.968
[2024-08-05 11:36:07,480] {result_logger:113} INFO - average recall on sleep stages: 0.986
[2024-08-05 11:36:07,545] {result_logger:115} INFO - average F1-score on sleep stages: 0.977
[2024-08-05 11:36:07,546] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:36:07,603] {result_logger:103} INFO - precision on Wake: 0.982
[2024-08-05 11:36:07,642] {result_logger:104} INFO - recall on Wake: 0.975
[2024-08-05 11:36:07,681] {result_logger:107} INFO - F1-score on Wake: 0.979
[2024-08-05 11:36:07,681] {result_logger:108} INFO - 
[2024-08-05 11:36:07,737] {result_logger:103} INFO - precision on REM: 0.867
[2024-08-05 11:36:07,776] {result_logger:104} INFO - recall on REM: 0.941
[2024-08-05 11:36:07,815] {result_logger:107} INFO - F1-score on REM: 0.902
[2024-08-05 11:36:07,815] {result_logger:108} INFO - 
[2024-08-05 11:36:07,872] {result_logger:103} INFO - precision on Non REM: 0.964
[2024-08-05 11:36:07,911] {result_logger:104} INFO - recall on Non REM: 0.963
[2024-08-05 11:36:07,950] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2024-08-05 11:36:07,950] {result_logger:108} INFO - 
[2024-08-05 11:36:07,956] {result_logger:111} INFO - average precision on sleep stages: 0.937
[2024-08-05 11:36:07,962] {result_logger:113} INFO - average recall on sleep stages: 0.960
[2024-08-05 11:36:07,968] {result_logger:115} INFO - average F1-score on sleep stages: 0.948
[2024-08-05 11:36:07,969] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:36:08,012] {result_logger:134} INFO - 
[[201079    215   2453]
 [    35  18467    104]
 [  1787   1144 140836]]
[2024-08-05 11:36:08,055] {result_logger:141} INFO - 
[[ 98.69%   0.11%   1.20%]
 [  0.19%  99.25%   0.56%]
 [  1.24%   0.80%  97.96%]]
[2024-08-05 11:36:08,099] {result_logger:145} INFO - 
[[ 99.10%   1.08%   1.71%]
 [  0.02%  93.15%   0.07%]
 [  0.88%   5.77%  98.22%]]
[2024-08-05 11:36:08,100] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:36:08,104] {result_logger:134} INFO - 
[[27677    85   620]
 [   21  2394   130]
 [  487   283 19933]]
[2024-08-05 11:36:08,108] {result_logger:141} INFO - 
[[ 97.52%   0.30%   2.18%]
 [  0.83%  94.07%   5.11%]
 [  2.35%   1.37%  96.28%]]
[2024-08-05 11:36:08,113] {result_logger:145} INFO - 
[[ 98.20%   3.08%   3.00%]
 [  0.07%  86.68%   0.63%]
 [  1.73%  10.25%  96.37%]]
[2024-08-05 11:36:08,165] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:36:08,165] {result_logger:77} INFO - actual:
[2024-08-05 11:36:08,165] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:36:08,165] {result_logger:79} INFO - predicted:
[2024-08-05 11:36:08,165] {result_logger:80} INFO - 
[[95.16%  0.18%  4.66%]
 [15.97% 78.75%  5.29%]
 [ 4.46%  2.59% 92.95%]]
[2024-08-05 11:36:08,165] {run_experiment:113} INFO - [epoch  33] execution time: 114.07s	 avg f1-score: 0.9480

[2024-08-05 11:36:08,166] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:36:08,185] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:36:35,629] {train_model:82} INFO - Train Epoch: 34 [36352/366120 (10%)]	lr:6.84e-05	Loss: 0.012939
[2024-08-05 11:36:41,524] {train_model:82} INFO - Train Epoch: 34 [72960/366120 (20%)]	lr:6.84e-05	Loss: 0.009272
[2024-08-05 11:37:16,601] {train_model:82} INFO - Train Epoch: 34 [109568/366120 (30%)]	lr:6.84e-05	Loss: 0.018539
[2024-08-05 11:37:22,491] {train_model:82} INFO - Train Epoch: 34 [146176/366120 (40%)]	lr:6.84e-05	Loss: 0.016873
[2024-08-05 11:37:28,412] {train_model:82} INFO - Train Epoch: 34 [182784/366120 (50%)]	lr:6.84e-05	Loss: 0.038855
[2024-08-05 11:37:34,333] {train_model:82} INFO - Train Epoch: 34 [219392/366120 (60%)]	lr:6.84e-05	Loss: 0.027074
[2024-08-05 11:37:40,262] {train_model:82} INFO - Train Epoch: 34 [256000/366120 (70%)]	lr:6.84e-05	Loss: 0.023388
[2024-08-05 11:37:46,205] {train_model:82} INFO - Train Epoch: 34 [292608/366120 (80%)]	lr:6.84e-05	Loss: 0.096011
[2024-08-05 11:37:52,160] {train_model:82} INFO - Train Epoch: 34 [329216/366120 (90%)]	lr:6.84e-05	Loss: 0.042659
[2024-08-05 11:37:58,137] {train_model:82} INFO - Train Epoch: 34 [365824/366120 (100%)]	lr:6.84e-05	Loss: 0.033705
[2024-08-05 11:38:04,342] {run_experiment:79} INFO - 
[2024-08-05 11:38:04,342] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:38:04,792] {result_logger:103} INFO - precision on Wake: 0.991
[2024-08-05 11:38:05,114] {result_logger:104} INFO - recall on Wake: 0.987
[2024-08-05 11:38:05,441] {result_logger:107} INFO - F1-score on Wake: 0.989
[2024-08-05 11:38:05,441] {result_logger:108} INFO - 
[2024-08-05 11:38:05,849] {result_logger:103} INFO - precision on REM: 0.934
[2024-08-05 11:38:06,133] {result_logger:104} INFO - recall on REM: 0.994
[2024-08-05 11:38:06,410] {result_logger:107} INFO - F1-score on REM: 0.963
[2024-08-05 11:38:06,410] {result_logger:108} INFO - 
[2024-08-05 11:38:06,858] {result_logger:103} INFO - precision on Non REM: 0.983
[2024-08-05 11:38:07,176] {result_logger:104} INFO - recall on Non REM: 0.980
[2024-08-05 11:38:07,502] {result_logger:107} INFO - F1-score on Non REM: 0.982
[2024-08-05 11:38:07,502] {result_logger:108} INFO - 
[2024-08-05 11:38:07,569] {result_logger:111} INFO - average precision on sleep stages: 0.969
[2024-08-05 11:38:07,636] {result_logger:113} INFO - average recall on sleep stages: 0.987
[2024-08-05 11:38:07,703] {result_logger:115} INFO - average F1-score on sleep stages: 0.978
[2024-08-05 11:38:07,703] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:38:07,761] {result_logger:103} INFO - precision on Wake: 0.980
[2024-08-05 11:38:07,800] {result_logger:104} INFO - recall on Wake: 0.975
[2024-08-05 11:38:07,839] {result_logger:107} INFO - F1-score on Wake: 0.977
[2024-08-05 11:38:07,839] {result_logger:108} INFO - 
[2024-08-05 11:38:07,895] {result_logger:103} INFO - precision on REM: 0.844
[2024-08-05 11:38:07,934] {result_logger:104} INFO - recall on REM: 0.949
[2024-08-05 11:38:07,972] {result_logger:107} INFO - F1-score on REM: 0.894
[2024-08-05 11:38:07,972] {result_logger:108} INFO - 
[2024-08-05 11:38:08,029] {result_logger:103} INFO - precision on Non REM: 0.966
[2024-08-05 11:38:08,069] {result_logger:104} INFO - recall on Non REM: 0.959
[2024-08-05 11:38:08,108] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2024-08-05 11:38:08,108] {result_logger:108} INFO - 
[2024-08-05 11:38:08,114] {result_logger:111} INFO - average precision on sleep stages: 0.930
[2024-08-05 11:38:08,120] {result_logger:113} INFO - average recall on sleep stages: 0.961
[2024-08-05 11:38:08,127] {result_logger:115} INFO - average F1-score on sleep stages: 0.944
[2024-08-05 11:38:08,127] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:38:08,172] {result_logger:134} INFO - 
[[201142    222   2383]
 [    35  18487     84]
 [  1717   1094 140956]]
[2024-08-05 11:38:08,218] {result_logger:141} INFO - 
[[ 98.72%   0.11%   1.17%]
 [  0.19%  99.36%   0.45%]
 [  1.19%   0.76%  98.04%]]
[2024-08-05 11:38:08,263] {result_logger:145} INFO - 
[[ 99.14%   1.12%   1.66%]
 [  0.02%  93.35%   0.06%]
 [  0.85%   5.52%  98.28%]]
[2024-08-05 11:38:08,263] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:38:08,267] {result_logger:134} INFO - 
[[27659   138   585]
 [   18  2416   111]
 [  545   308 19850]]
[2024-08-05 11:38:08,272] {result_logger:141} INFO - 
[[ 97.45%   0.49%   2.06%]
 [  0.71%  94.93%   4.36%]
 [  2.63%   1.49%  95.88%]]
[2024-08-05 11:38:08,276] {result_logger:145} INFO - 
[[ 98.01%   4.82%   2.85%]
 [  0.06%  84.42%   0.54%]
 [  1.93%  10.76%  96.61%]]
[2024-08-05 11:38:08,329] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:38:08,330] {result_logger:77} INFO - actual:
[2024-08-05 11:38:08,330] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:38:08,330] {result_logger:79} INFO - predicted:
[2024-08-05 11:38:08,330] {result_logger:80} INFO - 
[[95.05%  0.29%  4.66%]
 [16.53% 78.23%  5.24%]
 [ 4.49%  2.64% 92.87%]]
[2024-08-05 11:38:08,330] {run_experiment:113} INFO - [epoch  34] execution time: 120.16s	 avg f1-score: 0.9445

[2024-08-05 11:38:08,583] {result_logger:56} INFO - final F1-scores on train:
	Wake                : [0.5382443171768552, 0.7716434506822378, 0.8485649663833434, 0.9046744264253411, 0.9372827760873946, 0.9508623301038372, 0.9573541864813789, 0.962239415217456, 0.9658555428718586, 0.9679515434865512, 0.9706152614886028, 0.9717717628689732, 0.9739692781247226, 0.975590632720387, 0.9766243754298349, 0.9777582811895438, 0.9780825833670119, 0.9792767428054853, 0.9800780134159435, 0.9809708603988042, 0.9814875455178883, 0.9823303633637552, 0.982886771038242, 0.9833827674055111, 0.9841439322555965, 0.9846795149415332, 0.9852018444791119, 0.9861277506488394, 0.9867360169668757, 0.9874022332628264, 0.9877178525305946, 0.9885485953156699, 0.988958509570931, 0.9892853893237523]
	REM                 : [0.15745980500958442, 0.36118849824145627, 0.4986562340534104, 0.6452038690783097, 0.737782968020122, 0.7695031436548109, 0.7928673851704519, 0.8098145213906235, 0.8236374337845792, 0.83482513829863, 0.8418220349072554, 0.8477246068034375, 0.8598580536509083, 0.8683769811412343, 0.8753436990534589, 0.8778575776019477, 0.8851880877742946, 0.8918492982024132, 0.8972165916843822, 0.901676753646195, 0.910070327697142, 0.9155901166436724, 0.9165391465770264, 0.9228404394718274, 0.9260494014244582, 0.9315833566043005, 0.9375907851481868, 0.9437471181925303, 0.9471707818930041, 0.9521743621526703, 0.9536033122008021, 0.9571080338156733, 0.9610220649458785, 0.9626389648259523]
	Non REM             : [0.6247532095458379, 0.8280662008193447, 0.8546106478601534, 0.8888382576142623, 0.9158924290938358, 0.9296131896005073, 0.9364716237125105, 0.9414675339177043, 0.9448311077846406, 0.9466808711294296, 0.9500187451604201, 0.9515252279528867, 0.9541880090172528, 0.9559968751861052, 0.9576268811478855, 0.9587240185566721, 0.959728582832654, 0.9619654065483212, 0.9627373977081014, 0.9641999930023443, 0.9658755940038394, 0.9672534399262048, 0.9680642907058001, 0.969496072178308, 0.970581143837555, 0.9719302532595604, 0.9732621067212844, 0.9752116272012892, 0.9764987574977084, 0.9778278082917445, 0.9786045215452678, 0.9800315676142758, 0.9808887031620003, 0.9816219227688987]
	avg                 : [0.44015244391075914, 0.653632716581013, 0.7339439494323025, 0.8129055177059711, 0.8636527244004508, 0.8833262211197184, 0.8955643984547804, 0.904507156841928, 0.9114413614803595, 0.916485850971537, 0.9208186805187594, 0.9236738658750991, 0.9293384469309611, 0.9333214963492421, 0.9365316518770598, 0.9381132924493878, 0.9409997513246534, 0.9443638158520732, 0.9466773342694758, 0.9489492023491145, 0.9524778224062899, 0.9550579733112108, 0.9558300694403562, 0.9585730930185489, 0.9602581591725365, 0.9627310416017979, 0.9653515787828609, 0.968362165347553, 0.9701351854525294, 0.9724681345690804, 0.9733085620922215, 0.9752293989152063, 0.9769564258929365, 0.9778487589728678]
[2024-08-05 11:38:08,583] {result_logger:56} INFO - final F1-scores on valid:
	Wake                : [0.7858963086598214, 0.8062535424145097, 0.8179374389051808, 0.7805950545371482, 0.8304018793023982, 0.9317801386943599, 0.9357309245697241, 0.9017320029805718, 0.9635800491295524, 0.9602761587565918, 0.9677216406564024, 0.9756563921888003, 0.9726575466918251, 0.9724943678943783, 0.9777575556061111, 0.9776196568464222, 0.9800099065949618, 0.9760170545389945, 0.9750282965478212, 0.9784377972730155, 0.9721376478085393, 0.9793509278789061, 0.9793832599118942, 0.9797876106194691, 0.9784808122041772, 0.9781677930717244, 0.9790913101014558, 0.9817836210993188, 0.9796580864840071, 0.9781225209343323, 0.978594028953741, 0.9787815349678884, 0.9785564021425919, 0.9772807575436365]
	REM                 : [0.40009934186017637, 0.5354877680459077, 0.6089280100597296, 0.6289960255745638, 0.7039611964430073, 0.6906700957279612, 0.8271004527922187, 0.546936114732725, 0.7817403708987161, 0.8156734693877551, 0.8161728597151744, 0.8552354181307097, 0.8597066436583262, 0.8359505512863348, 0.8791599928812958, 0.8644510179223943, 0.8782209671726084, 0.8823848238482386, 0.8628209637706648, 0.8762174605985479, 0.8404471544715447, 0.8788040576615056, 0.8863799283154122, 0.8958944281524928, 0.8655932796639833, 0.8976348854397634, 0.8912164645350974, 0.9027726432532347, 0.89505830094392, 0.8866976744186047, 0.8862645348837209, 0.9016086793864572, 0.9022046353872244, 0.8936563713704457]
	Non REM             : [0.5148021633931112, 0.687760400941972, 0.6697002482021256, 0.4883882022676729, 0.609672658975047, 0.8911043351451676, 0.8852920852601924, 0.919068480516486, 0.9505309886444461, 0.9223288677286196, 0.9368895567242675, 0.9534866739686017, 0.9504325345530475, 0.9471921625471722, 0.9579732332460863, 0.9535769021604785, 0.9603564992938198, 0.9589477494871486, 0.959736777967341, 0.9614904399343893, 0.9571750195771338, 0.9602639367328125, 0.9612509161983874, 0.9633933759442185, 0.9582688576130475, 0.9626385326428882, 0.96366332061347, 0.965466819389272, 0.96352244025646, 0.9642371234207969, 0.9616103732122478, 0.9642341388273804, 0.9632726042623109, 0.9624475744866542]
	avg                 : [0.566932604637703, 0.676500570467463, 0.698855232389012, 0.6326597607931282, 0.7146785782401507, 0.8378515231891629, 0.8827078208740451, 0.7892455327432609, 0.8986171362242382, 0.8994261652909888, 0.9069280190319481, 0.9281261614293705, 0.9275989083010664, 0.918545693909295, 0.9382969272444978, 0.9318825256430984, 0.9395291243537965, 0.9391165426247938, 0.932528679428609, 0.9387152326019842, 0.9232532739524059, 0.9394729740910748, 0.9423380348085647, 0.9463584715720601, 0.9341143164937359, 0.9461470703847921, 0.9446570317500077, 0.9500076945806085, 0.9460796092281291, 0.9430191062579113, 0.9421563123499034, 0.948208117727242, 0.948011213930709, 0.9444615678002455]
[2024-08-05 11:38:08,674] {logger:50} INFO - 
[2024-08-05 11:38:08,675] {logger:51} INFO - ================================================================================
[2024-08-05 11:38:08,675] {logger:52} INFO - finished training
[2024-08-05 11:38:08,675] {logger:53} INFO - ================================================================================
[2024-08-05 11:38:08,675] {logger:54} INFO - 
[2024-08-05 11:38:08,675] {logger:50} INFO - 
[2024-08-05 11:38:08,675] {logger:51} INFO - ================================================================================
[2024-08-05 11:38:08,675] {logger:52} INFO - best model on epoch: 28 	f1-score: 0.9500
[2024-08-05 11:38:08,675] {logger:53} INFO - ================================================================================
[2024-08-05 11:38:08,675] {logger:54} INFO - 
