[2024-03-27 13:56:31,030] {logger:43} INFO - run_experiment_multiple_labs.py, args: Namespace(experiment='all_data', save_dir='/home/s202283/code/grieger_validation/results/step4/', test_lab='Antoine')
================================================================================
[2024-03-27 13:56:31,030] {logger:44} INFO - config:
[2024-03-27 13:56:31,030] {logger:45} INFO - parameter name      | parameter value
[2024-03-27 13:56:31,031] {logger:46} INFO - experiment          : all_data
[2024-03-27 13:56:31,031] {logger:46} INFO - RUN_NAME            : all_data_2024-03-27_13-56-31
[2024-03-27 13:56:31,031] {logger:46} INFO - DEVICE              : cuda
[2024-03-27 13:56:31,031] {logger:46} INFO - EXPERIMENT_DIR      : /home/s202283/code/grieger_validation/results/step4/Antoine
[2024-03-27 13:56:31,031] {logger:46} INFO - MODELS_DIR          : /home/s202283/code/grieger_validation/results/step4/Antoine/models
[2024-03-27 13:56:31,031] {logger:46} INFO - VISUALS_DIR         : /home/s202283/code/grieger_validation/results/step4/Antoine/visuals/all_data_2024-03-27_13-56-31
[2024-03-27 13:56:31,031] {logger:46} INFO - DATA_DIR            : /scratch/s202283/data/grieger_validation
[2024-03-27 13:56:31,031] {logger:46} INFO - SAMPLE_DURATION     : 4
[2024-03-27 13:56:31,031] {logger:46} INFO - SAMPLING_RATE       : 64
[2024-03-27 13:56:31,031] {logger:46} INFO - ORIGINAL_FS         : {'Alessandro': 128, 'Antoine': 512, 'Kornum': 400}
[2024-03-27 13:56:31,031] {logger:46} INFO - DATA_FILE           : /home/s202283/code/grieger_validation/cache/dataset/multiple_labs.h5
[2024-03-27 13:56:31,031] {logger:46} INFO - STAGES              : ['Wake', 'Non REM', 'REM']
[2024-03-27 13:56:31,031] {logger:46} INFO - CHANNELS_IN_MODEL   : ['EEG1']
[2024-03-27 13:56:31,031] {logger:46} INFO - CHANNELS_IN_TABLE   : ['EEG1', 'EEG2', 'EEG3', 'EEG4', 'EMG']
[2024-03-27 13:56:31,031] {logger:46} INFO - LABS_CHANNELS       : {'Alessandro': {'EEG1': 0, 'EMG': 1}, 'Antoine': {'EEG1': 0, 'EEG2': 1, 'EEG3': 2, 'EEG4': 3, 'EMG': 4}, 'Maiken': {'EEG1': 0, 'EMG': 1}, 'Kornum': {'EEG1': 0, 'EEG2': 1, 'EMG': 2}, 'Sebastian': {'EEG1': 1, 'EEG2': 2, 'EMG': 0}}
[2024-03-27 13:56:31,031] {logger:46} INFO - SAMPLES_LEFT        : 3.25
[2024-03-27 13:56:31,031] {logger:46} INFO - SAMPLES_RIGHT       : 3.25
[2024-03-27 13:56:31,031] {logger:46} INFO - LABS                : ['Antoine', 'Kornum', 'Alessandro', 'Sebastian', 'Maiken']
[2024-03-27 13:56:31,031] {logger:46} INFO - ORIGINAL_DATASET_SIZE: 366122
[2024-03-27 13:56:31,031] {logger:46} INFO - VALIDATION_SPLIT    : 0.2
[2024-03-27 13:56:31,031] {logger:46} INFO - LOG_INTERVAL        : 10
[2024-03-27 13:56:31,031] {logger:46} INFO - EXTRA_SAFE_MODELS   : False
[2024-03-27 13:56:31,031] {logger:46} INFO - BATCH_SIZE          : 256
[2024-03-27 13:56:31,031] {logger:46} INFO - DATA_FRACTION       : False
[2024-03-27 13:56:31,031] {logger:46} INFO - EPOCHS              : 50
[2024-03-27 13:56:31,031] {logger:46} INFO - WARMUP_EPOCHS       : 12
[2024-03-27 13:56:31,031] {logger:46} INFO - S_OPTIM_MODE        : exp
[2024-03-27 13:56:31,031] {logger:46} INFO - S_OPTIM_PARAS       : [0.06]
[2024-03-27 13:56:31,032] {logger:46} INFO - LEARNING_RATE       : 0.000256
[2024-03-27 13:56:31,032] {logger:46} INFO - OPTIMIZER           : <class 'torch.optim.adam.Adam'>
[2024-03-27 13:56:31,032] {logger:46} INFO - OPTIM_PARAS         : {}
[2024-03-27 13:56:31,032] {logger:46} INFO - L1_WEIGHT_DECAY     : 0
[2024-03-27 13:56:31,032] {logger:46} INFO - L2_WEIGHT_DECAY     : 0.0001
[2024-03-27 13:56:31,032] {logger:46} INFO - BATCH_SIZE_EVAL     : 512
[2024-03-27 13:56:31,032] {logger:46} INFO - FILTERS             : 96
[2024-03-27 13:56:31,032] {logger:46} INFO - CLASSIFIER_DROPOUT  : [0.2, 0.2]
[2024-03-27 13:56:31,032] {logger:46} INFO - FEATURE_EXTR_DROPOUT: [0.0, 0.2, 0.0, 0.2, 0.0, 0.2, 0.0, 0.2]
[2024-03-27 13:56:31,032] {logger:46} INFO - MODEL_NAME          : model_8conv_2fc
[2024-03-27 13:56:31,032] {logger:50} INFO - 
[2024-03-27 13:56:31,032] {logger:51} INFO - ================================================================================
[2024-03-27 13:56:31,032] {logger:52} INFO - start training with model: model_8conv_2fc
[2024-03-27 13:56:31,032] {logger:53} INFO - ================================================================================
[2024-03-27 13:56:31,032] {logger:54} INFO - 
[2024-03-27 13:58:27,895] {dataloader:174} INFO - data distribution in database for dataset train:
	Kornum              : {'Wake': 388855, 'Non REM': 274988, 'REM': 44482}
	Alessandro          : {'Wake': 262755, 'Non REM': 206400, 'REM': 26473}
	Sebastian           : {'Wake': 74492, 'Non REM': 70444, 'REM': 10511}
	Maiken              : {'Wake': 16789, 'Non REM': 38503, 'REM': 4346}
[2024-03-27 13:58:27,981] {dataloader:202} INFO - data distribution after processing:
	Kornum              : {'Wake': 388855, 'Non REM': 274988, 'REM': 44482}
	Alessandro          : {'Wake': 262755, 'Non REM': 206400, 'REM': 26473}
	Sebastian           : {'Wake': 74492, 'Non REM': 70444, 'REM': 10511}
	Maiken              : {'Wake': 16789, 'Non REM': 38503, 'REM': 4346}
[2024-03-27 13:58:27,981] {dataloader:174} INFO - data distribution in database for dataset train:
	Kornum              : {'Wake': 97213, 'Non REM': 68746, 'REM': 11120}
	Alessandro          : {'Wake': 65688, 'Non REM': 51600, 'REM': 6618}
	Sebastian           : {'Wake': 18622, 'Non REM': 17611, 'REM': 2627}
	Maiken              : {'Wake': 4197, 'Non REM': 9625, 'REM': 1086}
[2024-03-27 13:58:27,996] {dataloader:202} INFO - data distribution after processing:
	Kornum              : {'Wake': 97213, 'Non REM': 68746, 'REM': 11120}
	Alessandro          : {'Wake': 65688, 'Non REM': 51600, 'REM': 6618}
	Sebastian           : {'Wake': 18622, 'Non REM': 17611, 'REM': 2627}
	Maiken              : {'Wake': 4197, 'Non REM': 9625, 'REM': 1086}
[2024-03-27 13:58:28,864] {run_experiment_multiple_labs:49} INFO - classifier:
Model(
  (feature_extractor): Sequential(
    (0): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): Conv1d(1, 96, kernel_size=(5,), stride=(1,))
    (2): ReLU(inplace=True)
    (3): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): Dropout(p=0.0, inplace=False)
    (5): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (6): ReLU(inplace=True)
    (7): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): Dropout(p=0.2, inplace=False)
    (9): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (10): ReLU(inplace=True)
    (11): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (12): Dropout(p=0.0, inplace=False)
    (13): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (14): ReLU(inplace=True)
    (15): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (16): Dropout(p=0.2, inplace=False)
    (17): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (18): ReLU(inplace=True)
    (19): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (20): Dropout(p=0.0, inplace=False)
    (21): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (22): ReLU(inplace=True)
    (23): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (24): Dropout(p=0.2, inplace=False)
    (25): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (26): ReLU(inplace=True)
    (27): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (28): Dropout(p=0.0, inplace=False)
    (29): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (30): ReLU(inplace=True)
    (31): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (32): Dropout(p=0.2, inplace=False)
  )
  (classifier): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=10848, out_features=80, bias=True)
    (2): ReLU(inplace=True)
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=80, out_features=3, bias=True)
  )
)
[2024-03-27 13:59:56,433] {train_model:84} INFO - Train Epoch: 1 [141568/1419038 (10%)]	lr:2.56e-05	Loss: 54.970581
[2024-03-27 14:00:21,780] {train_model:84} INFO - Train Epoch: 1 [283392/1419038 (20%)]	lr:2.56e-05	Loss: 34.951321
[2024-03-27 14:00:47,408] {train_model:84} INFO - Train Epoch: 1 [425216/1419038 (30%)]	lr:2.56e-05	Loss: 28.440252
[2024-03-27 14:01:13,403] {train_model:84} INFO - Train Epoch: 1 [567040/1419038 (40%)]	lr:2.56e-05	Loss: 19.077999
[2024-03-27 14:01:39,902] {train_model:84} INFO - Train Epoch: 1 [708864/1419038 (50%)]	lr:2.56e-05	Loss: 11.383398
[2024-03-27 14:02:06,290] {train_model:84} INFO - Train Epoch: 1 [850688/1419038 (60%)]	lr:2.56e-05	Loss: 8.198399
[2024-03-27 14:02:32,968] {train_model:84} INFO - Train Epoch: 1 [992512/1419038 (70%)]	lr:2.56e-05	Loss: 4.962489
[2024-03-27 14:02:59,848] {train_model:84} INFO - Train Epoch: 1 [1134336/1419038 (80%)]	lr:2.56e-05	Loss: 5.864054
[2024-03-27 14:03:26,724] {train_model:84} INFO - Train Epoch: 1 [1276160/1419038 (90%)]	lr:2.56e-05	Loss: 5.528366
[2024-03-27 14:03:54,139] {train_model:84} INFO - Train Epoch: 1 [1417984/1419038 (100%)]	lr:2.56e-05	Loss: 2.297672
[2024-03-27 14:05:17,148] {run_experiment_multiple_labs:78} INFO - 
[2024-03-27 14:05:17,149] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-27 14:05:19,653] {result_logger:103} INFO - precision on Wake: 0.676
[2024-03-27 14:05:21,310] {result_logger:104} INFO - recall on Wake: 0.406
[2024-03-27 14:05:22,944] {result_logger:107} INFO - F1-score on Wake: 0.507
[2024-03-27 14:05:22,944] {result_logger:108} INFO - 
[2024-03-27 14:05:25,393] {result_logger:103} INFO - precision on Non REM: 0.686
[2024-03-27 14:05:27,027] {result_logger:104} INFO - recall on Non REM: 0.650
[2024-03-27 14:05:28,661] {result_logger:107} INFO - F1-score on Non REM: 0.667
[2024-03-27 14:05:28,661] {result_logger:108} INFO - 
[2024-03-27 14:05:31,058] {result_logger:103} INFO - precision on REM: 0.104
[2024-03-27 14:05:32,613] {result_logger:104} INFO - recall on REM: 0.501
[2024-03-27 14:05:34,144] {result_logger:107} INFO - F1-score on REM: 0.172
[2024-03-27 14:05:34,144] {result_logger:108} INFO - 
[2024-03-27 14:05:34,572] {result_logger:111} INFO - average precision on sleep stages: 0.488
[2024-03-27 14:05:34,999] {result_logger:113} INFO - average recall on sleep stages: 0.519
[2024-03-27 14:05:35,425] {result_logger:115} INFO - average F1-score on sleep stages: 0.449
[2024-03-27 14:05:35,432] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-27 14:05:36,005] {result_logger:103} INFO - precision on Wake: 0.220
[2024-03-27 14:05:36,361] {result_logger:104} INFO - recall on Wake: 0.064
[2024-03-27 14:05:36,717] {result_logger:107} INFO - F1-score on Wake: 0.099
[2024-03-27 14:05:36,717] {result_logger:108} INFO - 
[2024-03-27 14:05:37,282] {result_logger:103} INFO - precision on Non REM: 0.951
[2024-03-27 14:05:37,625] {result_logger:104} INFO - recall on Non REM: 0.035
[2024-03-27 14:05:37,973] {result_logger:107} INFO - F1-score on Non REM: 0.067
[2024-03-27 14:05:37,973] {result_logger:108} INFO - 
[2024-03-27 14:05:38,542] {result_logger:103} INFO - precision on REM: 0.072
[2024-03-27 14:05:38,901] {result_logger:104} INFO - recall on REM: 0.983
[2024-03-27 14:05:39,265] {result_logger:107} INFO - F1-score on REM: 0.133
[2024-03-27 14:05:39,265] {result_logger:108} INFO - 
[2024-03-27 14:05:39,340] {result_logger:111} INFO - average precision on sleep stages: 0.414
[2024-03-27 14:05:39,414] {result_logger:113} INFO - average recall on sleep stages: 0.361
[2024-03-27 14:05:39,488] {result_logger:115} INFO - average F1-score on sleep stages: 0.100
[2024-03-27 14:05:39,490] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-27 14:05:40,586] {result_logger:134} INFO - 
[[301874 164524 276498]
 [113453 383579  93301]
 [ 31439  11400  42970]]
[2024-03-27 14:05:41,669] {result_logger:141} INFO - 
[[ 40.63%  22.15%  37.22%]
 [ 19.22%  64.98%  15.80%]
 [ 36.64%  13.29%  50.08%]]
[2024-03-27 14:05:42,760] {result_logger:145} INFO - 
[[ 67.57%  29.41%  66.99%]
 [ 25.39%  68.56%  22.60%]
 [  7.04%   2.04%  10.41%]]
[2024-03-27 14:05:42,760] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-27 14:05:43,005] {result_logger:134} INFO - 
[[ 11938    254 173528]
 [ 42079   5094 100409]
 [   349      6  21096]]
[2024-03-27 14:05:43,351] {result_logger:141} INFO - 
[[  6.43%   0.14%  93.44%]
 [ 28.51%   3.45%  68.04%]
 [  1.63%   0.03%  98.35%]]
[2024-03-27 14:05:43,675] {result_logger:145} INFO - 
[[ 21.96%   4.74%  58.82%]
 [ 77.40%  95.14%  34.03%]
 [  0.64%   0.11%   7.15%]]
[2024-03-27 14:05:44,460] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-27 14:05:44,460] {result_logger:77} INFO - actual:
[2024-03-27 14:05:44,460] {result_logger:78} INFO - 
[[93.75%  6.20%  0.05%]
 [ 5.98% 90.37%  3.64%]
 [12.92% 12.55% 74.52%]]
[2024-03-27 14:05:44,460] {result_logger:79} INFO - predicted:
[2024-03-27 14:05:44,460] {result_logger:80} INFO - 
[[41.72%  3.49% 54.78%]
 [34.11% 33.23% 32.67%]
 [10.12%  0.57% 89.31%]]
[2024-03-27 14:05:44,533] {train_model:96} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/step4/Antoine/model_8conv_2fc-best.pth
[2024-03-27 14:05:44,534] {run_experiment_multiple_labs:112} INFO - [epoch   1] execution time: 435.67s	 avg f1-score: 0.0998

[2024-03-27 14:07:11,734] {train_model:84} INFO - Train Epoch: 2 [141568/1419038 (10%)]	lr:4.65e-05	Loss: 0.988340
[2024-03-27 14:07:36,823] {train_model:84} INFO - Train Epoch: 2 [283392/1419038 (20%)]	lr:4.65e-05	Loss: 4.988691
[2024-03-27 14:08:02,155] {train_model:84} INFO - Train Epoch: 2 [425216/1419038 (30%)]	lr:4.65e-05	Loss: 0.745057
[2024-03-27 14:08:27,689] {train_model:84} INFO - Train Epoch: 2 [567040/1419038 (40%)]	lr:4.65e-05	Loss: 0.602638
[2024-03-27 14:08:53,673] {train_model:84} INFO - Train Epoch: 2 [708864/1419038 (50%)]	lr:4.65e-05	Loss: 1.035244
[2024-03-27 14:09:19,655] {train_model:84} INFO - Train Epoch: 2 [850688/1419038 (60%)]	lr:4.65e-05	Loss: 0.471346
[2024-03-27 14:09:45,890] {train_model:84} INFO - Train Epoch: 2 [992512/1419038 (70%)]	lr:4.65e-05	Loss: 5.081546
[2024-03-27 14:10:12,416] {train_model:84} INFO - Train Epoch: 2 [1134336/1419038 (80%)]	lr:4.65e-05	Loss: 4.710564
[2024-03-27 14:10:39,467] {train_model:84} INFO - Train Epoch: 2 [1276160/1419038 (90%)]	lr:4.65e-05	Loss: 0.695002
[2024-03-27 14:11:07,167] {train_model:84} INFO - Train Epoch: 2 [1417984/1419038 (100%)]	lr:4.65e-05	Loss: 0.607125
[2024-03-27 14:12:30,269] {run_experiment_multiple_labs:78} INFO - 
[2024-03-27 14:12:30,270] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-27 14:12:32,846] {result_logger:103} INFO - precision on Wake: 0.800
[2024-03-27 14:12:34,586] {result_logger:104} INFO - recall on Wake: 0.633
[2024-03-27 14:12:36,317] {result_logger:107} INFO - F1-score on Wake: 0.707
[2024-03-27 14:12:36,318] {result_logger:108} INFO - 
[2024-03-27 14:12:38,859] {result_logger:103} INFO - precision on Non REM: 0.785
[2024-03-27 14:12:40,574] {result_logger:104} INFO - recall on Non REM: 0.818
[2024-03-27 14:12:42,287] {result_logger:107} INFO - F1-score on Non REM: 0.801
[2024-03-27 14:12:42,287] {result_logger:108} INFO - 
[2024-03-27 14:12:44,633] {result_logger:103} INFO - precision on REM: 0.238
[2024-03-27 14:12:46,108] {result_logger:104} INFO - recall on REM: 0.600
[2024-03-27 14:12:47,641] {result_logger:107} INFO - F1-score on REM: 0.341
[2024-03-27 14:12:47,642] {result_logger:108} INFO - 
[2024-03-27 14:12:48,070] {result_logger:111} INFO - average precision on sleep stages: 0.608
[2024-03-27 14:12:48,500] {result_logger:113} INFO - average recall on sleep stages: 0.684
[2024-03-27 14:12:48,932] {result_logger:115} INFO - average F1-score on sleep stages: 0.616
[2024-03-27 14:12:48,938] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-27 14:12:49,520] {result_logger:103} INFO - precision on Wake: 0.281
[2024-03-27 14:12:49,886] {result_logger:104} INFO - recall on Wake: 0.278
[2024-03-27 14:12:50,252] {result_logger:107} INFO - F1-score on Wake: 0.279
[2024-03-27 14:12:50,252] {result_logger:108} INFO - 
[2024-03-27 14:12:50,830] {result_logger:103} INFO - precision on Non REM: 0.934
[2024-03-27 14:12:51,172] {result_logger:104} INFO - recall on Non REM: 0.000
[2024-03-27 14:12:51,514] {result_logger:107} INFO - F1-score on Non REM: 0.001
[2024-03-27 14:12:51,514] {result_logger:108} INFO - 
[2024-03-27 14:12:52,078] {result_logger:103} INFO - precision on REM: 0.118
[2024-03-27 14:12:52,433] {result_logger:104} INFO - recall on REM: 0.944
[2024-03-27 14:12:52,792] {result_logger:107} INFO - F1-score on REM: 0.210
[2024-03-27 14:12:52,792] {result_logger:108} INFO - 
[2024-03-27 14:12:52,866] {result_logger:111} INFO - average precision on sleep stages: 0.445
[2024-03-27 14:12:52,939] {result_logger:113} INFO - average recall on sleep stages: 0.407
[2024-03-27 14:12:53,012] {result_logger:115} INFO - average F1-score on sleep stages: 0.163
[2024-03-27 14:12:53,014] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-27 14:12:54,134] {result_logger:134} INFO - 
[[470100 126436 146360]
 [ 89503 482629  18201]
 [ 28207   6077  51525]]
[2024-03-27 14:12:55,250] {result_logger:141} INFO - 
[[ 63.28%  17.02%  19.70%]
 [ 15.16%  81.76%   3.08%]
 [ 32.87%   7.08%  60.05%]]
[2024-03-27 14:12:56,381] {result_logger:145} INFO - 
[[ 79.97%  20.55%  67.73%]
 [ 15.23%  78.46%   8.42%]
 [  4.80%   0.99%  23.84%]]
[2024-03-27 14:12:56,381] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-27 14:12:56,635] {result_logger:134} INFO - 
[[ 51544      1 134175]
 [130793     57  16732]
 [  1198      3  20250]]
[2024-03-27 14:12:56,966] {result_logger:141} INFO - 
[[ 27.75%   0.00%  72.25%]
 [ 88.62%   0.04%  11.34%]
 [  5.58%   0.01%  94.40%]]
[2024-03-27 14:12:57,295] {result_logger:145} INFO - 
[[ 28.08%   1.64%  78.39%]
 [ 71.26%  93.44%   9.78%]
 [  0.65%   4.92%  11.83%]]
[2024-03-27 14:12:58,093] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-27 14:12:58,093] {result_logger:77} INFO - actual:
[2024-03-27 14:12:58,093] {result_logger:78} INFO - 
[[93.75%  6.20%  0.05%]
 [ 5.98% 90.37%  3.64%]
 [12.92% 12.55% 74.52%]]
[2024-03-27 14:12:58,093] {result_logger:79} INFO - predicted:
[2024-03-27 14:12:58,093] {result_logger:80} INFO - 
[[83.26%  0.03% 16.71%]
 [81.97% 11.48%  6.56%]
 [17.92%  0.00% 82.08%]]
[2024-03-27 14:12:58,163] {train_model:96} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/step4/Antoine/model_8conv_2fc-best.pth
[2024-03-27 14:12:58,164] {run_experiment_multiple_labs:112} INFO - [epoch   2] execution time: 433.63s	 avg f1-score: 0.1634

[2024-03-27 14:14:25,675] {train_model:84} INFO - Train Epoch: 3 [141568/1419038 (10%)]	lr:6.75e-05	Loss: 0.618216
[2024-03-27 14:14:51,137] {train_model:84} INFO - Train Epoch: 3 [283392/1419038 (20%)]	lr:6.75e-05	Loss: 0.499744
[2024-03-27 14:15:17,148] {train_model:84} INFO - Train Epoch: 3 [425216/1419038 (30%)]	lr:6.75e-05	Loss: 3.443095
[2024-03-27 14:15:43,755] {train_model:84} INFO - Train Epoch: 3 [567040/1419038 (40%)]	lr:6.75e-05	Loss: 0.368381
[2024-03-27 14:16:09,840] {train_model:84} INFO - Train Epoch: 3 [708864/1419038 (50%)]	lr:6.75e-05	Loss: 1.884220
[2024-03-27 14:16:36,411] {train_model:84} INFO - Train Epoch: 3 [850688/1419038 (60%)]	lr:6.75e-05	Loss: 4.304275
[2024-03-27 14:17:02,587] {train_model:84} INFO - Train Epoch: 3 [992512/1419038 (70%)]	lr:6.75e-05	Loss: 0.495350
[2024-03-27 14:17:29,144] {train_model:84} INFO - Train Epoch: 3 [1134336/1419038 (80%)]	lr:6.75e-05	Loss: 0.282606
[2024-03-27 14:17:55,681] {train_model:84} INFO - Train Epoch: 3 [1276160/1419038 (90%)]	lr:6.75e-05	Loss: 0.459554
[2024-03-27 14:18:22,640] {train_model:84} INFO - Train Epoch: 3 [1417984/1419038 (100%)]	lr:6.75e-05	Loss: 0.888798
[2024-03-27 14:19:45,672] {run_experiment_multiple_labs:78} INFO - 
[2024-03-27 14:19:45,673] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-27 14:19:48,256] {result_logger:103} INFO - precision on Wake: 0.887
[2024-03-27 14:19:49,975] {result_logger:104} INFO - recall on Wake: 0.794
[2024-03-27 14:19:51,670] {result_logger:107} INFO - F1-score on Wake: 0.838
[2024-03-27 14:19:51,670] {result_logger:108} INFO - 
[2024-03-27 14:19:54,274] {result_logger:103} INFO - precision on Non REM: 0.860
[2024-03-27 14:19:55,967] {result_logger:104} INFO - recall on Non REM: 0.859
[2024-03-27 14:19:57,676] {result_logger:107} INFO - F1-score on Non REM: 0.859
[2024-03-27 14:19:57,677] {result_logger:108} INFO - 
[2024-03-27 14:20:00,090] {result_logger:103} INFO - precision on REM: 0.401
[2024-03-27 14:20:01,580] {result_logger:104} INFO - recall on REM: 0.764
[2024-03-27 14:20:03,108] {result_logger:107} INFO - F1-score on REM: 0.526
[2024-03-27 14:20:03,108] {result_logger:108} INFO - 
[2024-03-27 14:20:03,537] {result_logger:111} INFO - average precision on sleep stages: 0.716
[2024-03-27 14:20:03,966] {result_logger:113} INFO - average recall on sleep stages: 0.806
[2024-03-27 14:20:04,399] {result_logger:115} INFO - average F1-score on sleep stages: 0.741
[2024-03-27 14:20:04,405] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-27 14:20:04,996] {result_logger:103} INFO - precision on Wake: 0.703
[2024-03-27 14:20:05,367] {result_logger:104} INFO - recall on Wake: 0.890
[2024-03-27 14:20:05,743] {result_logger:107} INFO - F1-score on Wake: 0.786
[2024-03-27 14:20:05,743] {result_logger:108} INFO - 
[2024-03-27 14:20:06,341] {result_logger:103} INFO - precision on Non REM: 0.974
[2024-03-27 14:20:06,705] {result_logger:104} INFO - recall on Non REM: 0.465
[2024-03-27 14:20:07,075] {result_logger:107} INFO - F1-score on Non REM: 0.630
[2024-03-27 14:20:07,075] {result_logger:108} INFO - 
[2024-03-27 14:20:07,663] {result_logger:103} INFO - precision on REM: 0.377
[2024-03-27 14:20:08,029] {result_logger:104} INFO - recall on REM: 0.865
[2024-03-27 14:20:08,395] {result_logger:107} INFO - F1-score on REM: 0.525
[2024-03-27 14:20:08,395] {result_logger:108} INFO - 
[2024-03-27 14:20:08,474] {result_logger:111} INFO - average precision on sleep stages: 0.685
[2024-03-27 14:20:08,553] {result_logger:113} INFO - average recall on sleep stages: 0.740
[2024-03-27 14:20:08,633] {result_logger:115} INFO - average F1-score on sleep stages: 0.647
[2024-03-27 14:20:08,635] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-27 14:20:09,779] {result_logger:134} INFO - 
[[590116  77882  74898]
 [ 60049 507002  23282]
 [ 15355   4854  65600]]
[2024-03-27 14:20:10,906] {result_logger:141} INFO - 
[[ 79.43%  10.48%  10.08%]
 [ 10.17%  85.88%   3.94%]
 [ 17.89%   5.66%  76.45%]]
[2024-03-27 14:20:12,036] {result_logger:145} INFO - 
[[ 88.67%  13.21%  45.73%]
 [  9.02%  85.97%  14.22%]
 [  2.31%   0.82%  40.05%]]
[2024-03-27 14:20:12,036] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-27 14:20:12,291] {result_logger:134} INFO - 
[[165267   1742  18711]
 [ 66886  68686  12010]
 [  2776    122  18553]]
[2024-03-27 14:20:12,624] {result_logger:141} INFO - 
[[ 88.99%   0.94%  10.07%]
 [ 45.32%  46.54%   8.14%]
 [ 12.94%   0.57%  86.49%]]
[2024-03-27 14:20:12,954] {result_logger:145} INFO - 
[[ 70.35%   2.47%  37.97%]
 [ 28.47%  97.36%  24.37%]
 [  1.18%   0.17%  37.65%]]
[2024-03-27 14:20:13,770] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-27 14:20:13,770] {result_logger:77} INFO - actual:
[2024-03-27 14:20:13,771] {result_logger:78} INFO - 
[[93.75%  6.20%  0.05%]
 [ 5.98% 90.37%  3.64%]
 [12.92% 12.55% 74.52%]]
[2024-03-27 14:20:13,771] {result_logger:79} INFO - predicted:
[2024-03-27 14:20:13,771] {result_logger:80} INFO - 
[[84.85%  8.79%  6.36%]
 [24.79% 68.01%  7.20%]
 [36.72%  3.89% 59.39%]]
[2024-03-27 14:20:13,841] {train_model:96} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/step4/Antoine/model_8conv_2fc-best.pth
[2024-03-27 14:20:13,841] {run_experiment_multiple_labs:112} INFO - [epoch   3] execution time: 435.68s	 avg f1-score: 0.6467

[2024-03-27 14:21:41,180] {train_model:84} INFO - Train Epoch: 4 [141568/1419038 (10%)]	lr:8.84e-05	Loss: 1.923173
[2024-03-27 14:22:06,946] {train_model:84} INFO - Train Epoch: 4 [283392/1419038 (20%)]	lr:8.84e-05	Loss: 0.518685
[2024-03-27 14:22:32,898] {train_model:84} INFO - Train Epoch: 4 [425216/1419038 (30%)]	lr:8.84e-05	Loss: 1.599119
[2024-03-27 14:22:58,983] {train_model:84} INFO - Train Epoch: 4 [567040/1419038 (40%)]	lr:8.84e-05	Loss: 0.269353
[2024-03-27 14:23:25,329] {train_model:84} INFO - Train Epoch: 4 [708864/1419038 (50%)]	lr:8.84e-05	Loss: 0.647437
[2024-03-27 14:23:51,504] {train_model:84} INFO - Train Epoch: 4 [850688/1419038 (60%)]	lr:8.84e-05	Loss: 0.656755
[2024-03-27 14:24:17,883] {train_model:84} INFO - Train Epoch: 4 [992512/1419038 (70%)]	lr:8.84e-05	Loss: 0.253046
[2024-03-27 14:24:44,658] {train_model:84} INFO - Train Epoch: 4 [1134336/1419038 (80%)]	lr:8.84e-05	Loss: 0.692863
[2024-03-27 14:25:11,482] {train_model:84} INFO - Train Epoch: 4 [1276160/1419038 (90%)]	lr:8.84e-05	Loss: 0.731607
[2024-03-27 14:25:38,907] {train_model:84} INFO - Train Epoch: 4 [1417984/1419038 (100%)]	lr:8.84e-05	Loss: 0.237725
[2024-03-27 14:27:01,971] {run_experiment_multiple_labs:78} INFO - 
[2024-03-27 14:27:01,971] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-27 14:27:04,588] {result_logger:103} INFO - precision on Wake: 0.909
[2024-03-27 14:27:06,269] {result_logger:104} INFO - recall on Wake: 0.826
[2024-03-27 14:27:07,975] {result_logger:107} INFO - F1-score on Wake: 0.866
[2024-03-27 14:27:07,976] {result_logger:108} INFO - 
[2024-03-27 14:27:10,544] {result_logger:103} INFO - precision on Non REM: 0.878
[2024-03-27 14:27:12,222] {result_logger:104} INFO - recall on Non REM: 0.873
[2024-03-27 14:27:13,915] {result_logger:107} INFO - F1-score on Non REM: 0.875
[2024-03-27 14:27:13,916] {result_logger:108} INFO - 
[2024-03-27 14:27:16,341] {result_logger:103} INFO - precision on REM: 0.442
[2024-03-27 14:27:17,840] {result_logger:104} INFO - recall on REM: 0.809
[2024-03-27 14:27:19,365] {result_logger:107} INFO - F1-score on REM: 0.572
[2024-03-27 14:27:19,365] {result_logger:108} INFO - 
[2024-03-27 14:27:19,782] {result_logger:111} INFO - average precision on sleep stages: 0.743
[2024-03-27 14:27:20,200] {result_logger:113} INFO - average recall on sleep stages: 0.836
[2024-03-27 14:27:20,618] {result_logger:115} INFO - average F1-score on sleep stages: 0.771
[2024-03-27 14:27:20,624] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-27 14:27:21,223] {result_logger:103} INFO - precision on Wake: 0.810
[2024-03-27 14:27:21,591] {result_logger:104} INFO - recall on Wake: 0.876
[2024-03-27 14:27:21,957] {result_logger:107} INFO - F1-score on Wake: 0.842
[2024-03-27 14:27:21,957] {result_logger:108} INFO - 
[2024-03-27 14:27:22,555] {result_logger:103} INFO - precision on Non REM: 0.961
[2024-03-27 14:27:22,920] {result_logger:104} INFO - recall on Non REM: 0.701
[2024-03-27 14:27:23,284] {result_logger:107} INFO - F1-score on Non REM: 0.811
[2024-03-27 14:27:23,284] {result_logger:108} INFO - 
[2024-03-27 14:27:23,871] {result_logger:103} INFO - precision on REM: 0.408
[2024-03-27 14:27:24,237] {result_logger:104} INFO - recall on REM: 0.880
[2024-03-27 14:27:24,605] {result_logger:107} INFO - F1-score on REM: 0.558
[2024-03-27 14:27:24,605] {result_logger:108} INFO - 
[2024-03-27 14:27:24,682] {result_logger:111} INFO - average precision on sleep stages: 0.726
[2024-03-27 14:27:24,759] {result_logger:113} INFO - average recall on sleep stages: 0.819
[2024-03-27 14:27:24,836] {result_logger:115} INFO - average F1-score on sleep stages: 0.737
[2024-03-27 14:27:24,838] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-27 14:27:25,983] {result_logger:134} INFO - 
[[613871  67545  61480]
 [ 49000 515223  26110]
 [ 12193   4209  69407]]
[2024-03-27 14:27:27,151] {result_logger:141} INFO - 
[[ 82.63%   9.09%   8.28%]
 [  8.30%  87.28%   4.42%]
 [ 14.21%   4.91%  80.89%]]
[2024-03-27 14:27:28,293] {result_logger:145} INFO - 
[[ 90.94%  11.51%  39.16%]
 [  7.26%  87.78%  16.63%]
 [  1.81%   0.72%  44.21%]]
[2024-03-27 14:27:28,293] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-27 14:27:28,554] {result_logger:134} INFO - 
[[162608   4024  19088]
 [ 35772 103509   8301]
 [  2365    209  18877]]
[2024-03-27 14:27:28,887] {result_logger:141} INFO - 
[[ 87.56%   2.17%  10.28%]
 [ 24.24%  70.14%   5.62%]
 [ 11.03%   0.97%  88.00%]]
[2024-03-27 14:27:29,223] {result_logger:145} INFO - 
[[ 81.00%   3.73%  41.26%]
 [ 17.82%  96.07%  17.94%]
 [  1.18%   0.19%  40.80%]]
[2024-03-27 14:27:30,015] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-27 14:27:30,015] {result_logger:77} INFO - actual:
[2024-03-27 14:27:30,015] {result_logger:78} INFO - 
[[93.75%  6.20%  0.05%]
 [ 5.98% 90.37%  3.64%]
 [12.92% 12.55% 74.52%]]
[2024-03-27 14:27:30,015] {result_logger:79} INFO - predicted:
[2024-03-27 14:27:30,015] {result_logger:80} INFO - 
[[83.79%  9.66%  6.55%]
 [14.58% 79.14%  6.28%]
 [36.38%  6.66% 56.96%]]
[2024-03-27 14:27:30,085] {train_model:96} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/step4/Antoine/model_8conv_2fc-best.pth
[2024-03-27 14:27:30,085] {run_experiment_multiple_labs:112} INFO - [epoch   4] execution time: 436.24s	 avg f1-score: 0.7366

[2024-03-27 14:28:57,731] {train_model:84} INFO - Train Epoch: 5 [141568/1419038 (10%)]	lr:1.09e-04	Loss: 0.283474
[2024-03-27 14:29:23,615] {train_model:84} INFO - Train Epoch: 5 [283392/1419038 (20%)]	lr:1.09e-04	Loss: 1.027702
[2024-03-27 14:29:50,088] {train_model:84} INFO - Train Epoch: 5 [425216/1419038 (30%)]	lr:1.09e-04	Loss: 0.288639
[2024-03-27 14:30:16,217] {train_model:84} INFO - Train Epoch: 5 [567040/1419038 (40%)]	lr:1.09e-04	Loss: 0.357859
[2024-03-27 14:30:42,542] {train_model:84} INFO - Train Epoch: 5 [708864/1419038 (50%)]	lr:1.09e-04	Loss: 0.465454
[2024-03-27 14:31:09,406] {train_model:84} INFO - Train Epoch: 5 [850688/1419038 (60%)]	lr:1.09e-04	Loss: 0.200878
[2024-03-27 14:31:36,110] {train_model:84} INFO - Train Epoch: 5 [992512/1419038 (70%)]	lr:1.09e-04	Loss: 0.344848
[2024-03-27 14:32:02,738] {train_model:84} INFO - Train Epoch: 5 [1134336/1419038 (80%)]	lr:1.09e-04	Loss: 0.243770
[2024-03-27 14:32:29,553] {train_model:84} INFO - Train Epoch: 5 [1276160/1419038 (90%)]	lr:1.09e-04	Loss: 0.240634
[2024-03-27 14:32:57,086] {train_model:84} INFO - Train Epoch: 5 [1417984/1419038 (100%)]	lr:1.09e-04	Loss: 0.271996
[2024-03-27 14:34:20,356] {run_experiment_multiple_labs:78} INFO - 
[2024-03-27 14:34:20,357] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-27 14:34:22,978] {result_logger:103} INFO - precision on Wake: 0.918
[2024-03-27 14:34:24,718] {result_logger:104} INFO - recall on Wake: 0.841
[2024-03-27 14:34:26,444] {result_logger:107} INFO - F1-score on Wake: 0.878
[2024-03-27 14:34:26,444] {result_logger:108} INFO - 
[2024-03-27 14:34:29,044] {result_logger:103} INFO - precision on Non REM: 0.888
[2024-03-27 14:34:30,745] {result_logger:104} INFO - recall on Non REM: 0.880
[2024-03-27 14:34:32,465] {result_logger:107} INFO - F1-score on Non REM: 0.884
[2024-03-27 14:34:32,465] {result_logger:108} INFO - 
[2024-03-27 14:34:34,916] {result_logger:103} INFO - precision on REM: 0.462
[2024-03-27 14:34:36,433] {result_logger:104} INFO - recall on REM: 0.828
[2024-03-27 14:34:37,988] {result_logger:107} INFO - F1-score on REM: 0.593
[2024-03-27 14:34:37,988] {result_logger:108} INFO - 
[2024-03-27 14:34:38,415] {result_logger:111} INFO - average precision on sleep stages: 0.756
[2024-03-27 14:34:38,836] {result_logger:113} INFO - average recall on sleep stages: 0.850
[2024-03-27 14:34:39,257] {result_logger:115} INFO - average F1-score on sleep stages: 0.785
[2024-03-27 14:34:39,263] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-27 14:34:39,854] {result_logger:103} INFO - precision on Wake: 0.901
[2024-03-27 14:34:40,216] {result_logger:104} INFO - recall on Wake: 0.872
[2024-03-27 14:34:40,584] {result_logger:107} INFO - F1-score on Wake: 0.886
[2024-03-27 14:34:40,584] {result_logger:108} INFO - 
[2024-03-27 14:34:41,177] {result_logger:103} INFO - precision on Non REM: 0.933
[2024-03-27 14:34:41,543] {result_logger:104} INFO - recall on Non REM: 0.844
[2024-03-27 14:34:41,911] {result_logger:107} INFO - F1-score on Non REM: 0.886
[2024-03-27 14:34:41,911] {result_logger:108} INFO - 
[2024-03-27 14:34:42,502] {result_logger:103} INFO - precision on REM: 0.455
[2024-03-27 14:34:42,869] {result_logger:104} INFO - recall on REM: 0.883
[2024-03-27 14:34:43,238] {result_logger:107} INFO - F1-score on REM: 0.601
[2024-03-27 14:34:43,238] {result_logger:108} INFO - 
[2024-03-27 14:34:43,314] {result_logger:111} INFO - average precision on sleep stages: 0.763
[2024-03-27 14:34:43,390] {result_logger:113} INFO - average recall on sleep stages: 0.866
[2024-03-27 14:34:43,467] {result_logger:115} INFO - average F1-score on sleep stages: 0.791
[2024-03-27 14:34:43,469] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-27 14:34:44,610] {result_logger:134} INFO - 
[[624892  61331  56673]
 [ 44823 519490  26020]
 [ 10920   3871  71018]]
[2024-03-27 14:34:45,735] {result_logger:141} INFO - 
[[ 84.12%   8.26%   7.63%]
 [  7.59%  88.00%   4.41%]
 [ 12.73%   4.51%  82.76%]]
[2024-03-27 14:34:46,852] {result_logger:145} INFO - 
[[ 91.81%  10.49%  36.87%]
 [  6.59%  88.85%  16.93%]
 [  1.60%   0.66%  46.20%]]
[2024-03-27 14:34:46,852] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-27 14:34:47,105] {result_logger:134} INFO - 
[[161910   8443  15367]
 [ 15764 124497   7321]
 [  1990    514  18947]]
[2024-03-27 14:34:47,436] {result_logger:141} INFO - 
[[ 87.18%   4.55%   8.27%]
 [ 10.68%  84.36%   4.96%]
 [  9.28%   2.40%  88.33%]]
[2024-03-27 14:34:47,765] {result_logger:145} INFO - 
[[ 90.12%   6.33%  36.91%]
 [  8.77%  93.29%  17.58%]
 [  1.11%   0.39%  45.51%]]
[2024-03-27 14:34:48,572] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-27 14:34:48,572] {result_logger:77} INFO - actual:
[2024-03-27 14:34:48,573] {result_logger:78} INFO - 
[[93.75%  6.20%  0.05%]
 [ 5.98% 90.37%  3.64%]
 [12.92% 12.55% 74.52%]]
[2024-03-27 14:34:48,573] {result_logger:79} INFO - predicted:
[2024-03-27 14:34:48,573] {result_logger:80} INFO - 
[[85.45%  8.87%  5.68%]
 [ 9.18% 84.73%  6.08%]
 [33.35% 10.64% 56.01%]]
[2024-03-27 14:34:48,643] {train_model:96} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/step4/Antoine/model_8conv_2fc-best.pth
[2024-03-27 14:34:48,643] {run_experiment_multiple_labs:112} INFO - [epoch   5] execution time: 438.56s	 avg f1-score: 0.7910

[2024-03-27 14:36:15,984] {train_model:84} INFO - Train Epoch: 6 [141568/1419038 (10%)]	lr:1.30e-04	Loss: 0.301072
[2024-03-27 14:36:41,235] {train_model:84} INFO - Train Epoch: 6 [283392/1419038 (20%)]	lr:1.30e-04	Loss: 0.440845
[2024-03-27 14:37:06,781] {train_model:84} INFO - Train Epoch: 6 [425216/1419038 (30%)]	lr:1.30e-04	Loss: 1.465155
[2024-03-27 14:37:32,275] {train_model:84} INFO - Train Epoch: 6 [567040/1419038 (40%)]	lr:1.30e-04	Loss: 0.182647
[2024-03-27 14:37:57,946] {train_model:84} INFO - Train Epoch: 6 [708864/1419038 (50%)]	lr:1.30e-04	Loss: 0.434717
[2024-03-27 14:38:23,690] {train_model:84} INFO - Train Epoch: 6 [850688/1419038 (60%)]	lr:1.30e-04	Loss: 0.284864
[2024-03-27 14:38:49,579] {train_model:84} INFO - Train Epoch: 6 [992512/1419038 (70%)]	lr:1.30e-04	Loss: 0.269628
[2024-03-27 14:39:15,664] {train_model:84} INFO - Train Epoch: 6 [1134336/1419038 (80%)]	lr:1.30e-04	Loss: 0.248547
[2024-03-27 14:39:42,035] {train_model:84} INFO - Train Epoch: 6 [1276160/1419038 (90%)]	lr:1.30e-04	Loss: 0.412063
[2024-03-27 14:40:08,587] {train_model:84} INFO - Train Epoch: 6 [1417984/1419038 (100%)]	lr:1.30e-04	Loss: 0.288984
[2024-03-27 14:41:31,646] {run_experiment_multiple_labs:78} INFO - 
[2024-03-27 14:41:31,646] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-27 14:41:34,192] {result_logger:103} INFO - precision on Wake: 0.926
[2024-03-27 14:41:35,889] {result_logger:104} INFO - recall on Wake: 0.857
[2024-03-27 14:41:37,604] {result_logger:107} INFO - F1-score on Wake: 0.890
[2024-03-27 14:41:37,604] {result_logger:108} INFO - 
[2024-03-27 14:41:40,161] {result_logger:103} INFO - precision on Non REM: 0.896
[2024-03-27 14:41:41,852] {result_logger:104} INFO - recall on Non REM: 0.886
[2024-03-27 14:41:43,539] {result_logger:107} INFO - F1-score on Non REM: 0.891
[2024-03-27 14:41:43,539] {result_logger:108} INFO - 
[2024-03-27 14:41:45,958] {result_logger:103} INFO - precision on REM: 0.486
[2024-03-27 14:41:47,484] {result_logger:104} INFO - recall on REM: 0.840
[2024-03-27 14:41:49,001] {result_logger:107} INFO - F1-score on REM: 0.616
[2024-03-27 14:41:49,001] {result_logger:108} INFO - 
[2024-03-27 14:41:49,424] {result_logger:111} INFO - average precision on sleep stages: 0.770
[2024-03-27 14:41:49,847] {result_logger:113} INFO - average recall on sleep stages: 0.861
[2024-03-27 14:41:50,270] {result_logger:115} INFO - average F1-score on sleep stages: 0.799
[2024-03-27 14:41:50,278] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-27 14:41:50,864] {result_logger:103} INFO - precision on Wake: 0.933
[2024-03-27 14:41:51,225] {result_logger:104} INFO - recall on Wake: 0.838
[2024-03-27 14:41:51,589] {result_logger:107} INFO - F1-score on Wake: 0.883
[2024-03-27 14:41:51,589] {result_logger:108} INFO - 
[2024-03-27 14:41:52,177] {result_logger:103} INFO - precision on Non REM: 0.920
[2024-03-27 14:41:52,540] {result_logger:104} INFO - recall on Non REM: 0.894
[2024-03-27 14:41:52,908] {result_logger:107} INFO - F1-score on Non REM: 0.907
[2024-03-27 14:41:52,909] {result_logger:108} INFO - 
[2024-03-27 14:41:53,491] {result_logger:103} INFO - precision on REM: 0.434
[2024-03-27 14:41:53,848] {result_logger:104} INFO - recall on REM: 0.903
[2024-03-27 14:41:54,208] {result_logger:107} INFO - F1-score on REM: 0.587
[2024-03-27 14:41:54,208] {result_logger:108} INFO - 
[2024-03-27 14:41:54,284] {result_logger:111} INFO - average precision on sleep stages: 0.763
[2024-03-27 14:41:54,360] {result_logger:113} INFO - average recall on sleep stages: 0.878
[2024-03-27 14:41:54,436] {result_logger:115} INFO - average F1-score on sleep stages: 0.792
[2024-03-27 14:41:54,438] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-27 14:41:55,566] {result_logger:134} INFO - 
[[636520  56548  49828]
 [ 40851 523194  26288]
 [  9830   3885  72094]]
[2024-03-27 14:41:56,696] {result_logger:141} INFO - 
[[ 85.68%   7.61%   6.71%]
 [  6.92%  88.63%   4.45%]
 [ 11.46%   4.53%  84.02%]]
[2024-03-27 14:41:57,831] {result_logger:145} INFO - 
[[ 92.63%   9.69%  33.62%]
 [  5.94%  89.65%  17.74%]
 [  1.43%   0.67%  48.64%]]
[2024-03-27 14:41:57,831] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-27 14:41:58,088] {result_logger:134} INFO - 
[[155686  10626  19408]
 [  9879 131882   5821]
 [  1247    829  19375]]
[2024-03-27 14:41:58,423] {result_logger:141} INFO - 
[[ 83.83%   5.72%  10.45%]
 [  6.69%  89.36%   3.94%]
 [  5.81%   3.86%  90.32%]]
[2024-03-27 14:41:58,752] {result_logger:145} INFO - 
[[ 93.33%   7.41%  43.51%]
 [  5.92%  92.01%  13.05%]
 [  0.75%   0.58%  43.44%]]
[2024-03-27 14:41:59,638] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-27 14:41:59,638] {result_logger:77} INFO - actual:
[2024-03-27 14:41:59,638] {result_logger:78} INFO - 
[[93.75%  6.20%  0.05%]
 [ 5.98% 90.37%  3.64%]
 [12.92% 12.55% 74.52%]]
[2024-03-27 14:41:59,638] {result_logger:79} INFO - predicted:
[2024-03-27 14:41:59,638] {result_logger:80} INFO - 
[[84.87%  8.31%  6.82%]
 [ 7.62% 86.79%  5.59%]
 [32.09% 11.35% 56.56%]]
[2024-03-27 14:41:59,709] {train_model:96} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/step4/Antoine/model_8conv_2fc-best.pth
[2024-03-27 14:41:59,709] {run_experiment_multiple_labs:112} INFO - [epoch   6] execution time: 431.07s	 avg f1-score: 0.7922

[2024-03-27 14:43:27,128] {train_model:84} INFO - Train Epoch: 7 [141568/1419038 (10%)]	lr:1.51e-04	Loss: 0.271494
[2024-03-27 14:43:52,457] {train_model:84} INFO - Train Epoch: 7 [283392/1419038 (20%)]	lr:1.51e-04	Loss: 2.552159
[2024-03-27 14:44:17,652] {train_model:84} INFO - Train Epoch: 7 [425216/1419038 (30%)]	lr:1.51e-04	Loss: 0.286069
[2024-03-27 14:44:43,121] {train_model:84} INFO - Train Epoch: 7 [567040/1419038 (40%)]	lr:1.51e-04	Loss: 0.451490
[2024-03-27 14:45:08,764] {train_model:84} INFO - Train Epoch: 7 [708864/1419038 (50%)]	lr:1.51e-04	Loss: 0.356083
[2024-03-27 14:45:34,666] {train_model:84} INFO - Train Epoch: 7 [850688/1419038 (60%)]	lr:1.51e-04	Loss: 0.214953
[2024-03-27 14:46:01,293] {train_model:84} INFO - Train Epoch: 7 [992512/1419038 (70%)]	lr:1.51e-04	Loss: 0.418305
[2024-03-27 14:46:28,066] {train_model:84} INFO - Train Epoch: 7 [1134336/1419038 (80%)]	lr:1.51e-04	Loss: 0.204807
[2024-03-27 14:46:55,624] {train_model:84} INFO - Train Epoch: 7 [1276160/1419038 (90%)]	lr:1.51e-04	Loss: 0.174307
[2024-03-27 14:47:23,093] {train_model:84} INFO - Train Epoch: 7 [1417984/1419038 (100%)]	lr:1.51e-04	Loss: 0.159150
[2024-03-27 14:48:46,094] {run_experiment_multiple_labs:78} INFO - 
[2024-03-27 14:48:46,095] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-27 14:48:48,648] {result_logger:103} INFO - precision on Wake: 0.934
[2024-03-27 14:48:50,337] {result_logger:104} INFO - recall on Wake: 0.866
[2024-03-27 14:48:52,033] {result_logger:107} INFO - F1-score on Wake: 0.899
[2024-03-27 14:48:52,033] {result_logger:108} INFO - 
[2024-03-27 14:48:54,540] {result_logger:103} INFO - precision on Non REM: 0.901
[2024-03-27 14:48:56,218] {result_logger:104} INFO - recall on Non REM: 0.894
[2024-03-27 14:48:57,899] {result_logger:107} INFO - F1-score on Non REM: 0.898
[2024-03-27 14:48:57,899] {result_logger:108} INFO - 
[2024-03-27 14:49:00,213] {result_logger:103} INFO - precision on REM: 0.505
[2024-03-27 14:49:01,722] {result_logger:104} INFO - recall on REM: 0.855
[2024-03-27 14:49:03,223] {result_logger:107} INFO - F1-score on REM: 0.635
[2024-03-27 14:49:03,223] {result_logger:108} INFO - 
[2024-03-27 14:49:03,650] {result_logger:111} INFO - average precision on sleep stages: 0.780
[2024-03-27 14:49:04,076] {result_logger:113} INFO - average recall on sleep stages: 0.872
[2024-03-27 14:49:04,503] {result_logger:115} INFO - average F1-score on sleep stages: 0.810
[2024-03-27 14:49:04,509] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-27 14:49:05,074] {result_logger:103} INFO - precision on Wake: 0.930
[2024-03-27 14:49:05,435] {result_logger:104} INFO - recall on Wake: 0.894
[2024-03-27 14:49:05,793] {result_logger:107} INFO - F1-score on Wake: 0.911
[2024-03-27 14:49:05,793] {result_logger:108} INFO - 
[2024-03-27 14:49:06,366] {result_logger:103} INFO - precision on Non REM: 0.930
[2024-03-27 14:49:06,729] {result_logger:104} INFO - recall on Non REM: 0.878
[2024-03-27 14:49:07,094] {result_logger:107} INFO - F1-score on Non REM: 0.903
[2024-03-27 14:49:07,094] {result_logger:108} INFO - 
[2024-03-27 14:49:07,669] {result_logger:103} INFO - precision on REM: 0.519
[2024-03-27 14:49:08,028] {result_logger:104} INFO - recall on REM: 0.897
[2024-03-27 14:49:08,392] {result_logger:107} INFO - F1-score on REM: 0.657
[2024-03-27 14:49:08,392] {result_logger:108} INFO - 
[2024-03-27 14:49:08,468] {result_logger:111} INFO - average precision on sleep stages: 0.793
[2024-03-27 14:49:08,543] {result_logger:113} INFO - average recall on sleep stages: 0.889
[2024-03-27 14:49:08,618] {result_logger:115} INFO - average F1-score on sleep stages: 0.824
[2024-03-27 14:49:08,620] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-27 14:49:09,752] {result_logger:134} INFO - 
[[643075  53806  46015]
 [ 36849 527686  25798]
 [  8489   3952  73368]]
[2024-03-27 14:49:10,883] {result_logger:141} INFO - 
[[ 86.56%   7.24%   6.19%]
 [  6.24%  89.39%   4.37%]
 [  9.89%   4.61%  85.50%]]
[2024-03-27 14:49:12,004] {result_logger:145} INFO - 
[[ 93.41%   9.19%  31.69%]
 [  5.35%  90.13%  17.77%]
 [  1.23%   0.68%  50.54%]]
[2024-03-27 14:49:12,004] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-27 14:49:12,261] {result_logger:134} INFO - 
[[165946   9109  10665]
 [ 10886 129522   7174]
 [  1619    601  19231]]
[2024-03-27 14:49:12,590] {result_logger:141} INFO - 
[[ 89.35%   4.90%   5.74%]
 [  7.38%  87.76%   4.86%]
 [  7.55%   2.80%  89.65%]]
[2024-03-27 14:49:12,922] {result_logger:145} INFO - 
[[ 92.99%   6.54%  28.77%]
 [  6.10%  93.03%  19.35%]
 [  0.91%   0.43%  51.88%]]
[2024-03-27 14:49:13,721] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-27 14:49:13,722] {result_logger:77} INFO - actual:
[2024-03-27 14:49:13,722] {result_logger:78} INFO - 
[[93.75%  6.20%  0.05%]
 [ 5.98% 90.37%  3.64%]
 [12.92% 12.55% 74.52%]]
[2024-03-27 14:49:13,722] {result_logger:79} INFO - predicted:
[2024-03-27 14:49:13,722] {result_logger:80} INFO - 
[[87.72%  8.03%  4.24%]
 [ 7.86% 86.28%  5.87%]
 [29.59% 12.86% 57.55%]]
[2024-03-27 14:49:13,792] {train_model:96} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/step4/Antoine/model_8conv_2fc-best.pth
[2024-03-27 14:49:13,793] {run_experiment_multiple_labs:112} INFO - [epoch   7] execution time: 434.08s	 avg f1-score: 0.8239

[2024-03-27 14:50:41,065] {train_model:84} INFO - Train Epoch: 8 [141568/1419038 (10%)]	lr:1.72e-04	Loss: 0.199694
[2024-03-27 14:51:06,554] {train_model:84} INFO - Train Epoch: 8 [283392/1419038 (20%)]	lr:1.72e-04	Loss: 0.179244
[2024-03-27 14:51:32,197] {train_model:84} INFO - Train Epoch: 8 [425216/1419038 (30%)]	lr:1.72e-04	Loss: 0.446857
[2024-03-27 14:51:58,097] {train_model:84} INFO - Train Epoch: 8 [567040/1419038 (40%)]	lr:1.72e-04	Loss: 0.452519
[2024-03-27 14:52:24,153] {train_model:84} INFO - Train Epoch: 8 [708864/1419038 (50%)]	lr:1.72e-04	Loss: 0.168692
[2024-03-27 14:52:50,580] {train_model:84} INFO - Train Epoch: 8 [850688/1419038 (60%)]	lr:1.72e-04	Loss: 0.892506
[2024-03-27 14:53:17,146] {train_model:84} INFO - Train Epoch: 8 [992512/1419038 (70%)]	lr:1.72e-04	Loss: 0.278992
[2024-03-27 14:53:43,760] {train_model:84} INFO - Train Epoch: 8 [1134336/1419038 (80%)]	lr:1.72e-04	Loss: 0.364854
[2024-03-27 14:54:10,557] {train_model:84} INFO - Train Epoch: 8 [1276160/1419038 (90%)]	lr:1.72e-04	Loss: 0.174646
[2024-03-27 14:54:37,610] {train_model:84} INFO - Train Epoch: 8 [1417984/1419038 (100%)]	lr:1.72e-04	Loss: 0.290537
[2024-03-27 14:56:00,834] {run_experiment_multiple_labs:78} INFO - 
[2024-03-27 14:56:00,834] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-27 14:56:03,354] {result_logger:103} INFO - precision on Wake: 0.940
[2024-03-27 14:56:05,053] {result_logger:104} INFO - recall on Wake: 0.872
[2024-03-27 14:56:06,733] {result_logger:107} INFO - F1-score on Wake: 0.905
[2024-03-27 14:56:06,734] {result_logger:108} INFO - 
[2024-03-27 14:56:09,245] {result_logger:103} INFO - precision on Non REM: 0.904
[2024-03-27 14:56:10,919] {result_logger:104} INFO - recall on Non REM: 0.900
[2024-03-27 14:56:12,584] {result_logger:107} INFO - F1-score on Non REM: 0.902
[2024-03-27 14:56:12,584] {result_logger:108} INFO - 
[2024-03-27 14:56:14,938] {result_logger:103} INFO - precision on REM: 0.523
[2024-03-27 14:56:16,455] {result_logger:104} INFO - recall on REM: 0.866
[2024-03-27 14:56:17,967] {result_logger:107} INFO - F1-score on REM: 0.652
[2024-03-27 14:56:17,967] {result_logger:108} INFO - 
[2024-03-27 14:56:18,387] {result_logger:111} INFO - average precision on sleep stages: 0.789
[2024-03-27 14:56:18,808] {result_logger:113} INFO - average recall on sleep stages: 0.879
[2024-03-27 14:56:19,228] {result_logger:115} INFO - average F1-score on sleep stages: 0.820
[2024-03-27 14:56:19,235] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-27 14:56:19,811] {result_logger:103} INFO - precision on Wake: 0.958
[2024-03-27 14:56:20,174] {result_logger:104} INFO - recall on Wake: 0.841
[2024-03-27 14:56:20,536] {result_logger:107} INFO - F1-score on Wake: 0.896
[2024-03-27 14:56:20,537] {result_logger:108} INFO - 
[2024-03-27 14:56:21,113] {result_logger:103} INFO - precision on Non REM: 0.906
[2024-03-27 14:56:21,479] {result_logger:104} INFO - recall on Non REM: 0.909
[2024-03-27 14:56:21,851] {result_logger:107} INFO - F1-score on Non REM: 0.907
[2024-03-27 14:56:21,851] {result_logger:108} INFO - 
[2024-03-27 14:56:22,441] {result_logger:103} INFO - precision on REM: 0.452
[2024-03-27 14:56:22,796] {result_logger:104} INFO - recall on REM: 0.920
[2024-03-27 14:56:23,155] {result_logger:107} INFO - F1-score on REM: 0.606
[2024-03-27 14:56:23,155] {result_logger:108} INFO - 
[2024-03-27 14:56:23,230] {result_logger:111} INFO - average precision on sleep stages: 0.772
[2024-03-27 14:56:23,306] {result_logger:113} INFO - average recall on sleep stages: 0.890
[2024-03-27 14:56:23,381] {result_logger:115} INFO - average F1-score on sleep stages: 0.803
[2024-03-27 14:56:23,383] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-27 14:56:24,512] {result_logger:134} INFO - 
[[647861  52473  42562]
 [ 33601 531392  25340]
 [  7577   3908  74324]]
[2024-03-27 14:56:25,665] {result_logger:141} INFO - 
[[ 87.21%   7.06%   5.73%]
 [  5.69%  90.02%   4.29%]
 [  8.83%   4.55%  86.62%]]
[2024-03-27 14:56:26,814] {result_logger:145} INFO - 
[[ 94.02%   8.93%  29.93%]
 [  4.88%  90.41%  17.82%]
 [  1.10%   0.66%  52.26%]]
[2024-03-27 14:56:26,815] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-27 14:56:27,077] {result_logger:134} INFO - 
[[156186  13121  16413]
 [  5918 134116   7548]
 [   951    756  19744]]
[2024-03-27 14:56:27,340] {result_logger:141} INFO - 
[[ 84.10%   7.06%   8.84%]
 [  4.01%  90.88%   5.11%]
 [  4.43%   3.52%  92.04%]]
[2024-03-27 14:56:27,602] {result_logger:145} INFO - 
[[ 95.79%   8.87%  37.55%]
 [  3.63%  90.62%  17.27%]
 [  0.58%   0.51%  45.18%]]
[2024-03-27 14:56:28,265] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-27 14:56:28,265] {result_logger:77} INFO - actual:
[2024-03-27 14:56:28,265] {result_logger:78} INFO - 
[[93.75%  6.20%  0.05%]
 [ 5.98% 90.37%  3.64%]
 [12.92% 12.55% 74.52%]]
[2024-03-27 14:56:28,265] {result_logger:79} INFO - predicted:
[2024-03-27 14:56:28,265] {result_logger:80} INFO - 
[[86.31%  7.86%  5.83%]
 [ 6.60% 87.29%  6.11%]
 [28.72% 13.72% 57.55%]]
[2024-03-27 14:56:28,265] {run_experiment_multiple_labs:112} INFO - [epoch   8] execution time: 434.47s	 avg f1-score: 0.8031

[2024-03-27 14:57:55,481] {train_model:84} INFO - Train Epoch: 9 [141568/1419038 (10%)]	lr:1.93e-04	Loss: 0.295265
[2024-03-27 14:58:20,970] {train_model:84} INFO - Train Epoch: 9 [283392/1419038 (20%)]	lr:1.93e-04	Loss: 0.324007
[2024-03-27 14:58:47,117] {train_model:84} INFO - Train Epoch: 9 [425216/1419038 (30%)]	lr:1.93e-04	Loss: 0.648007
[2024-03-27 14:59:13,316] {train_model:84} INFO - Train Epoch: 9 [567040/1419038 (40%)]	lr:1.93e-04	Loss: 0.254253
[2024-03-27 14:59:39,455] {train_model:84} INFO - Train Epoch: 9 [708864/1419038 (50%)]	lr:1.93e-04	Loss: 0.394638
[2024-03-27 15:00:05,594] {train_model:84} INFO - Train Epoch: 9 [850688/1419038 (60%)]	lr:1.93e-04	Loss: 0.133164
[2024-03-27 15:00:32,350] {train_model:84} INFO - Train Epoch: 9 [992512/1419038 (70%)]	lr:1.93e-04	Loss: 0.201329
[2024-03-27 15:00:58,996] {train_model:84} INFO - Train Epoch: 9 [1134336/1419038 (80%)]	lr:1.93e-04	Loss: 1.393474
[2024-03-27 15:01:25,812] {train_model:84} INFO - Train Epoch: 9 [1276160/1419038 (90%)]	lr:1.93e-04	Loss: 0.136039
[2024-03-27 15:01:53,055] {train_model:84} INFO - Train Epoch: 9 [1417984/1419038 (100%)]	lr:1.93e-04	Loss: 0.172435
[2024-03-27 15:03:16,106] {run_experiment_multiple_labs:78} INFO - 
[2024-03-27 15:03:16,107] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-27 15:03:18,638] {result_logger:103} INFO - precision on Wake: 0.946
[2024-03-27 15:03:20,323] {result_logger:104} INFO - recall on Wake: 0.876
[2024-03-27 15:03:22,015] {result_logger:107} INFO - F1-score on Wake: 0.910
[2024-03-27 15:03:22,016] {result_logger:108} INFO - 
[2024-03-27 15:03:24,726] {result_logger:103} INFO - precision on Non REM: 0.907
[2024-03-27 15:03:26,826] {result_logger:104} INFO - recall on Non REM: 0.905
[2024-03-27 15:03:28,526] {result_logger:107} INFO - F1-score on Non REM: 0.906
[2024-03-27 15:03:28,526] {result_logger:108} INFO - 
[2024-03-27 15:03:30,908] {result_logger:103} INFO - precision on REM: 0.531
[2024-03-27 15:03:32,401] {result_logger:104} INFO - recall on REM: 0.878
[2024-03-27 15:03:33,918] {result_logger:107} INFO - F1-score on REM: 0.661
[2024-03-27 15:03:33,918] {result_logger:108} INFO - 
[2024-03-27 15:03:34,344] {result_logger:111} INFO - average precision on sleep stages: 0.795
[2024-03-27 15:03:34,766] {result_logger:113} INFO - average recall on sleep stages: 0.886
[2024-03-27 15:03:35,187] {result_logger:115} INFO - average F1-score on sleep stages: 0.826
[2024-03-27 15:03:35,199] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-27 15:03:35,771] {result_logger:103} INFO - precision on Wake: 0.943
[2024-03-27 15:03:36,124] {result_logger:104} INFO - recall on Wake: 0.912
[2024-03-27 15:03:36,482] {result_logger:107} INFO - F1-score on Wake: 0.928
[2024-03-27 15:03:36,482] {result_logger:108} INFO - 
[2024-03-27 15:03:37,053] {result_logger:103} INFO - precision on Non REM: 0.928
[2024-03-27 15:03:37,417] {result_logger:104} INFO - recall on Non REM: 0.897
[2024-03-27 15:03:37,778] {result_logger:107} INFO - F1-score on Non REM: 0.913
[2024-03-27 15:03:37,779] {result_logger:108} INFO - 
[2024-03-27 15:03:38,357] {result_logger:103} INFO - precision on REM: 0.589
[2024-03-27 15:03:38,715] {result_logger:104} INFO - recall on REM: 0.892
[2024-03-27 15:03:39,078] {result_logger:107} INFO - F1-score on REM: 0.709
[2024-03-27 15:03:39,078] {result_logger:108} INFO - 
[2024-03-27 15:03:39,153] {result_logger:111} INFO - average precision on sleep stages: 0.820
[2024-03-27 15:03:39,227] {result_logger:113} INFO - average recall on sleep stages: 0.901
[2024-03-27 15:03:39,301] {result_logger:115} INFO - average F1-score on sleep stages: 0.850
[2024-03-27 15:03:39,302] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-27 15:03:40,436] {result_logger:134} INFO - 
[[651006  50629  41261]
 [ 30730 534222  25381]
 [  6638   3844  75327]]
[2024-03-27 15:03:41,573] {result_logger:141} INFO - 
[[ 87.63%   6.82%   5.55%]
 [  5.21%  90.50%   4.30%]
 [  7.74%   4.48%  87.78%]]
[2024-03-27 15:03:42,704] {result_logger:145} INFO - 
[[ 94.57%   8.60%  29.06%]
 [  4.46%  90.75%  17.88%]
 [  0.96%   0.65%  53.06%]]
[2024-03-27 15:03:42,704] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-27 15:03:42,953] {result_logger:134} INFO - 
[[169395   9473   6852]
 [  8609 132446   6527]
 [  1545    766  19140]]
[2024-03-27 15:03:43,281] {result_logger:141} INFO - 
[[ 91.21%   5.10%   3.69%]
 [  5.83%  89.74%   4.42%]
 [  7.20%   3.57%  89.23%]]
[2024-03-27 15:03:43,608] {result_logger:145} INFO - 
[[ 94.34%   6.64%  21.07%]
 [  4.79%  92.82%  20.07%]
 [  0.86%   0.54%  58.86%]]
[2024-03-27 15:03:44,421] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-27 15:03:44,421] {result_logger:77} INFO - actual:
[2024-03-27 15:03:44,421] {result_logger:78} INFO - 
[[93.75%  6.20%  0.05%]
 [ 5.98% 90.37%  3.64%]
 [12.92% 12.55% 74.52%]]
[2024-03-27 15:03:44,421] {result_logger:79} INFO - predicted:
[2024-03-27 15:03:44,422] {result_logger:80} INFO - 
[[89.87%  7.29%  2.84%]
 [ 6.95% 87.45%  5.59%]
 [25.43% 14.83% 59.74%]]
[2024-03-27 15:03:44,493] {train_model:96} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/step4/Antoine/model_8conv_2fc-best.pth
[2024-03-27 15:03:44,493] {run_experiment_multiple_labs:112} INFO - [epoch   9] execution time: 436.23s	 avg f1-score: 0.8498

[2024-03-27 15:05:11,828] {train_model:84} INFO - Train Epoch: 10 [141568/1419038 (10%)]	lr:2.14e-04	Loss: 0.135940
[2024-03-27 15:05:37,157] {train_model:84} INFO - Train Epoch: 10 [283392/1419038 (20%)]	lr:2.14e-04	Loss: 0.184406
[2024-03-27 15:06:02,372] {train_model:84} INFO - Train Epoch: 10 [425216/1419038 (30%)]	lr:2.14e-04	Loss: 0.197666
[2024-03-27 15:06:27,907] {train_model:84} INFO - Train Epoch: 10 [567040/1419038 (40%)]	lr:2.14e-04	Loss: 0.202568
[2024-03-27 15:06:53,594] {train_model:84} INFO - Train Epoch: 10 [708864/1419038 (50%)]	lr:2.14e-04	Loss: 0.660982
[2024-03-27 15:07:19,432] {train_model:84} INFO - Train Epoch: 10 [850688/1419038 (60%)]	lr:2.14e-04	Loss: 0.703582
[2024-03-27 15:07:45,446] {train_model:84} INFO - Train Epoch: 10 [992512/1419038 (70%)]	lr:2.14e-04	Loss: 0.214796
[2024-03-27 15:08:11,597] {train_model:84} INFO - Train Epoch: 10 [1134336/1419038 (80%)]	lr:2.14e-04	Loss: 0.315142
[2024-03-27 15:08:37,934] {train_model:84} INFO - Train Epoch: 10 [1276160/1419038 (90%)]	lr:2.14e-04	Loss: 0.259232
[2024-03-27 15:09:04,700] {train_model:84} INFO - Train Epoch: 10 [1417984/1419038 (100%)]	lr:2.14e-04	Loss: 0.372273
[2024-03-27 15:10:27,726] {run_experiment_multiple_labs:78} INFO - 
[2024-03-27 15:10:27,727] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-27 15:10:30,313] {result_logger:103} INFO - precision on Wake: 0.949
[2024-03-27 15:10:32,017] {result_logger:104} INFO - recall on Wake: 0.879
[2024-03-27 15:10:33,749] {result_logger:107} INFO - F1-score on Wake: 0.913
[2024-03-27 15:10:33,750] {result_logger:108} INFO - 
[2024-03-27 15:10:36,285] {result_logger:103} INFO - precision on Non REM: 0.910
[2024-03-27 15:10:37,967] {result_logger:104} INFO - recall on Non REM: 0.908
[2024-03-27 15:10:39,657] {result_logger:107} INFO - F1-score on Non REM: 0.909
[2024-03-27 15:10:39,657] {result_logger:108} INFO - 
[2024-03-27 15:10:42,065] {result_logger:103} INFO - precision on REM: 0.536
[2024-03-27 15:10:43,621] {result_logger:104} INFO - recall on REM: 0.886
[2024-03-27 15:10:45,119] {result_logger:107} INFO - F1-score on REM: 0.668
[2024-03-27 15:10:45,119] {result_logger:108} INFO - 
[2024-03-27 15:10:45,545] {result_logger:111} INFO - average precision on sleep stages: 0.798
[2024-03-27 15:10:45,965] {result_logger:113} INFO - average recall on sleep stages: 0.891
[2024-03-27 15:10:46,387] {result_logger:115} INFO - average F1-score on sleep stages: 0.830
[2024-03-27 15:10:46,394] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-27 15:10:46,988] {result_logger:103} INFO - precision on Wake: 0.961
[2024-03-27 15:10:47,349] {result_logger:104} INFO - recall on Wake: 0.876
[2024-03-27 15:10:47,709] {result_logger:107} INFO - F1-score on Wake: 0.916
[2024-03-27 15:10:47,709] {result_logger:108} INFO - 
[2024-03-27 15:10:48,291] {result_logger:103} INFO - precision on Non REM: 0.913
[2024-03-27 15:10:48,662] {result_logger:104} INFO - recall on Non REM: 0.916
[2024-03-27 15:10:49,029] {result_logger:107} INFO - F1-score on Non REM: 0.914
[2024-03-27 15:10:49,030] {result_logger:108} INFO - 
[2024-03-27 15:10:49,625] {result_logger:103} INFO - precision on REM: 0.527
[2024-03-27 15:10:49,989] {result_logger:104} INFO - recall on REM: 0.920
[2024-03-27 15:10:50,350] {result_logger:107} INFO - F1-score on REM: 0.670
[2024-03-27 15:10:50,350] {result_logger:108} INFO - 
[2024-03-27 15:10:50,425] {result_logger:111} INFO - average precision on sleep stages: 0.800
[2024-03-27 15:10:50,499] {result_logger:113} INFO - average recall on sleep stages: 0.904
[2024-03-27 15:10:50,574] {result_logger:115} INFO - average F1-score on sleep stages: 0.834
[2024-03-27 15:10:50,575] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-27 15:10:51,699] {result_logger:134} INFO - 
[[653090  49417  40389]
 [ 28976 535963  25394]
 [  5976   3806  76027]]
[2024-03-27 15:10:52,827] {result_logger:141} INFO - 
[[ 87.91%   6.65%   5.44%]
 [  4.91%  90.79%   4.30%]
 [  6.96%   4.44%  88.60%]]
[2024-03-27 15:10:53,959] {result_logger:145} INFO - 
[[ 94.92%   8.39%  28.48%]
 [  4.21%  90.97%  17.91%]
 [  0.87%   0.65%  53.61%]]
[2024-03-27 15:10:53,959] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-27 15:10:54,217] {result_logger:134} INFO - 
[[162608  12091  11021]
 [  5775 135120   6687]
 [   881    833  19737]]
[2024-03-27 15:10:54,471] {result_logger:141} INFO - 
[[ 87.56%   6.51%   5.93%]
 [  3.91%  91.56%   4.53%]
 [  4.11%   3.88%  92.01%]]
[2024-03-27 15:10:54,728] {result_logger:145} INFO - 
[[ 96.07%   8.17%  29.43%]
 [  3.41%  91.27%  17.86%]
 [  0.52%   0.56%  52.71%]]
[2024-03-27 15:10:55,376] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-27 15:10:55,376] {result_logger:77} INFO - actual:
[2024-03-27 15:10:55,376] {result_logger:78} INFO - 
[[93.75%  6.20%  0.05%]
 [ 5.98% 90.37%  3.64%]
 [12.92% 12.55% 74.52%]]
[2024-03-27 15:10:55,376] {result_logger:79} INFO - predicted:
[2024-03-27 15:10:55,376] {result_logger:80} INFO - 
[[88.27%  7.59%  4.14%]
 [ 6.63% 87.66%  5.70%]
 [26.79% 14.47% 58.74%]]
[2024-03-27 15:10:55,376] {run_experiment_multiple_labs:112} INFO - [epoch  10] execution time: 430.88s	 avg f1-score: 0.8335

[2024-03-27 15:12:23,003] {train_model:84} INFO - Train Epoch: 11 [141568/1419038 (10%)]	lr:2.35e-04	Loss: 0.175710
[2024-03-27 15:12:48,136] {train_model:84} INFO - Train Epoch: 11 [283392/1419038 (20%)]	lr:2.35e-04	Loss: 0.156457
[2024-03-27 15:13:13,463] {train_model:84} INFO - Train Epoch: 11 [425216/1419038 (30%)]	lr:2.35e-04	Loss: 0.143394
[2024-03-27 15:13:38,963] {train_model:84} INFO - Train Epoch: 11 [567040/1419038 (40%)]	lr:2.35e-04	Loss: 0.226101
[2024-03-27 15:14:04,746] {train_model:84} INFO - Train Epoch: 11 [708864/1419038 (50%)]	lr:2.35e-04	Loss: 0.409696
[2024-03-27 15:14:30,805] {train_model:84} INFO - Train Epoch: 11 [850688/1419038 (60%)]	lr:2.35e-04	Loss: 0.191289
[2024-03-27 15:14:57,045] {train_model:84} INFO - Train Epoch: 11 [992512/1419038 (70%)]	lr:2.35e-04	Loss: 0.129869
[2024-03-27 15:15:23,420] {train_model:84} INFO - Train Epoch: 11 [1134336/1419038 (80%)]	lr:2.35e-04	Loss: 0.251610
[2024-03-27 15:15:49,914] {train_model:84} INFO - Train Epoch: 11 [1276160/1419038 (90%)]	lr:2.35e-04	Loss: 0.291834
[2024-03-27 15:16:16,681] {train_model:84} INFO - Train Epoch: 11 [1417984/1419038 (100%)]	lr:2.35e-04	Loss: 0.683706
[2024-03-27 15:17:39,630] {run_experiment_multiple_labs:78} INFO - 
[2024-03-27 15:17:39,631] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-27 15:17:42,185] {result_logger:103} INFO - precision on Wake: 0.952
[2024-03-27 15:17:43,917] {result_logger:104} INFO - recall on Wake: 0.884
[2024-03-27 15:17:45,624] {result_logger:107} INFO - F1-score on Wake: 0.917
[2024-03-27 15:17:45,624] {result_logger:108} INFO - 
[2024-03-27 15:17:48,127] {result_logger:103} INFO - precision on Non REM: 0.913
[2024-03-27 15:17:49,785] {result_logger:104} INFO - recall on Non REM: 0.909
[2024-03-27 15:17:51,456] {result_logger:107} INFO - F1-score on Non REM: 0.911
[2024-03-27 15:17:51,456] {result_logger:108} INFO - 
[2024-03-27 15:17:53,773] {result_logger:103} INFO - precision on REM: 0.540
[2024-03-27 15:17:55,289] {result_logger:104} INFO - recall on REM: 0.894
[2024-03-27 15:17:56,815] {result_logger:107} INFO - F1-score on REM: 0.673
[2024-03-27 15:17:56,815] {result_logger:108} INFO - 
[2024-03-27 15:17:57,233] {result_logger:111} INFO - average precision on sleep stages: 0.802
[2024-03-27 15:17:57,651] {result_logger:113} INFO - average recall on sleep stages: 0.896
[2024-03-27 15:17:58,070] {result_logger:115} INFO - average F1-score on sleep stages: 0.834
[2024-03-27 15:17:58,076] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-27 15:17:58,659] {result_logger:103} INFO - precision on Wake: 0.953
[2024-03-27 15:17:59,019] {result_logger:104} INFO - recall on Wake: 0.904
[2024-03-27 15:17:59,379] {result_logger:107} INFO - F1-score on Wake: 0.928
[2024-03-27 15:17:59,379] {result_logger:108} INFO - 
[2024-03-27 15:17:59,950] {result_logger:103} INFO - precision on Non REM: 0.923
[2024-03-27 15:18:00,308] {result_logger:104} INFO - recall on Non REM: 0.906
[2024-03-27 15:18:00,670] {result_logger:107} INFO - F1-score on Non REM: 0.915
[2024-03-27 15:18:00,670] {result_logger:108} INFO - 
[2024-03-27 15:18:01,253] {result_logger:103} INFO - precision on REM: 0.579
[2024-03-27 15:18:01,618] {result_logger:104} INFO - recall on REM: 0.909
[2024-03-27 15:18:01,980] {result_logger:107} INFO - F1-score on REM: 0.708
[2024-03-27 15:18:01,981] {result_logger:108} INFO - 
[2024-03-27 15:18:02,055] {result_logger:111} INFO - average precision on sleep stages: 0.818
[2024-03-27 15:18:02,129] {result_logger:113} INFO - average recall on sleep stages: 0.907
[2024-03-27 15:18:02,203] {result_logger:115} INFO - average F1-score on sleep stages: 0.850
[2024-03-27 15:18:02,205] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-27 15:18:03,361] {result_logger:134} INFO - 
[[656657  47359  38880]
 [ 27313 536683  26337]
 [  5464   3668  76677]]
[2024-03-27 15:18:04,498] {result_logger:141} INFO - 
[[ 88.39%   6.37%   5.23%]
 [  4.63%  90.91%   4.46%]
 [  6.37%   4.27%  89.36%]]
[2024-03-27 15:18:05,642] {result_logger:145} INFO - 
[[ 95.25%   8.06%  27.40%]
 [  3.96%  91.32%  18.56%]
 [  0.79%   0.62%  54.04%]]
[2024-03-27 15:18:05,642] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-27 15:18:05,900] {result_logger:134} INFO - 
[[167938  10283   7499]
 [  7162 133745   6675]
 [  1148    799  19504]]
[2024-03-27 15:18:06,236] {result_logger:141} INFO - 
[[ 90.43%   5.54%   4.04%]
 [  4.85%  90.62%   4.52%]
 [  5.35%   3.72%  90.92%]]
[2024-03-27 15:18:06,570] {result_logger:145} INFO - 
[[ 95.29%   7.10%  22.27%]
 [  4.06%  92.35%  19.82%]
 [  0.65%   0.55%  57.91%]]
[2024-03-27 15:18:07,377] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-27 15:18:07,377] {result_logger:77} INFO - actual:
[2024-03-27 15:18:07,377] {result_logger:78} INFO - 
[[93.75%  6.20%  0.05%]
 [ 5.98% 90.37%  3.64%]
 [12.92% 12.55% 74.52%]]
[2024-03-27 15:18:07,377] {result_logger:79} INFO - predicted:
[2024-03-27 15:18:07,377] {result_logger:80} INFO - 
[[90.11%  7.03%  2.86%]
 [ 6.43% 87.92%  5.65%]
 [24.10% 15.20% 60.70%]]
[2024-03-27 15:18:07,447] {train_model:96} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/step4/Antoine/model_8conv_2fc-best.pth
[2024-03-27 15:18:07,447] {run_experiment_multiple_labs:112} INFO - [epoch  11] execution time: 432.07s	 avg f1-score: 0.8501

[2024-03-27 15:19:35,019] {train_model:84} INFO - Train Epoch: 12 [141568/1419038 (10%)]	lr:2.56e-04	Loss: 1.149446
[2024-03-27 15:20:00,304] {train_model:84} INFO - Train Epoch: 12 [283392/1419038 (20%)]	lr:2.56e-04	Loss: 0.335152
[2024-03-27 15:20:25,745] {train_model:84} INFO - Train Epoch: 12 [425216/1419038 (30%)]	lr:2.56e-04	Loss: 0.393607
[2024-03-27 15:20:51,412] {train_model:84} INFO - Train Epoch: 12 [567040/1419038 (40%)]	lr:2.56e-04	Loss: 0.242419
[2024-03-27 15:21:17,660] {train_model:84} INFO - Train Epoch: 12 [708864/1419038 (50%)]	lr:2.56e-04	Loss: 0.235544
[2024-03-27 15:21:44,216] {train_model:84} INFO - Train Epoch: 12 [850688/1419038 (60%)]	lr:2.56e-04	Loss: 0.216061
[2024-03-27 15:22:10,937] {train_model:84} INFO - Train Epoch: 12 [992512/1419038 (70%)]	lr:2.56e-04	Loss: 0.289467
[2024-03-27 15:22:37,628] {train_model:84} INFO - Train Epoch: 12 [1134336/1419038 (80%)]	lr:2.56e-04	Loss: 0.217726
[2024-03-27 15:23:04,396] {train_model:84} INFO - Train Epoch: 12 [1276160/1419038 (90%)]	lr:2.56e-04	Loss: 0.168415
[2024-03-27 15:23:31,706] {train_model:84} INFO - Train Epoch: 12 [1417984/1419038 (100%)]	lr:2.56e-04	Loss: 0.094187
[2024-03-27 15:24:54,977] {run_experiment_multiple_labs:78} INFO - 
[2024-03-27 15:24:54,977] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-27 15:24:57,563] {result_logger:103} INFO - precision on Wake: 0.954
[2024-03-27 15:24:59,252] {result_logger:104} INFO - recall on Wake: 0.887
[2024-03-27 15:25:00,959] {result_logger:107} INFO - F1-score on Wake: 0.919
[2024-03-27 15:25:00,959] {result_logger:108} INFO - 
[2024-03-27 15:25:03,490] {result_logger:103} INFO - precision on Non REM: 0.915
[2024-03-27 15:25:05,162] {result_logger:104} INFO - recall on Non REM: 0.911
[2024-03-27 15:25:06,854] {result_logger:107} INFO - F1-score on Non REM: 0.913
[2024-03-27 15:25:06,854] {result_logger:108} INFO - 
[2024-03-27 15:25:09,209] {result_logger:103} INFO - precision on REM: 0.547
[2024-03-27 15:25:10,707] {result_logger:104} INFO - recall on REM: 0.899
[2024-03-27 15:25:12,205] {result_logger:107} INFO - F1-score on REM: 0.680
[2024-03-27 15:25:12,205] {result_logger:108} INFO - 
[2024-03-27 15:25:12,621] {result_logger:111} INFO - average precision on sleep stages: 0.805
[2024-03-27 15:25:13,040] {result_logger:113} INFO - average recall on sleep stages: 0.899
[2024-03-27 15:25:13,457] {result_logger:115} INFO - average F1-score on sleep stages: 0.837
[2024-03-27 15:25:13,463] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-27 15:25:14,043] {result_logger:103} INFO - precision on Wake: 0.953
[2024-03-27 15:25:14,399] {result_logger:104} INFO - recall on Wake: 0.918
[2024-03-27 15:25:14,749] {result_logger:107} INFO - F1-score on Wake: 0.936
[2024-03-27 15:25:14,749] {result_logger:108} INFO - 
[2024-03-27 15:25:15,326] {result_logger:103} INFO - precision on Non REM: 0.922
[2024-03-27 15:25:15,690] {result_logger:104} INFO - recall on Non REM: 0.916
[2024-03-27 15:25:16,061] {result_logger:107} INFO - F1-score on Non REM: 0.919
[2024-03-27 15:25:16,061] {result_logger:108} INFO - 
[2024-03-27 15:25:16,646] {result_logger:103} INFO - precision on REM: 0.630
[2024-03-27 15:25:17,005] {result_logger:104} INFO - recall on REM: 0.856
[2024-03-27 15:25:17,359] {result_logger:107} INFO - F1-score on REM: 0.726
[2024-03-27 15:25:17,359] {result_logger:108} INFO - 
[2024-03-27 15:25:17,433] {result_logger:111} INFO - average precision on sleep stages: 0.835
[2024-03-27 15:25:17,507] {result_logger:113} INFO - average recall on sleep stages: 0.897
[2024-03-27 15:25:17,580] {result_logger:115} INFO - average F1-score on sleep stages: 0.860
[2024-03-27 15:25:17,582] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-27 15:25:18,706] {result_logger:134} INFO - 
[[658599  46586  37711]
 [ 26401 537779  26153]
 [  5103   3554  77152]]
[2024-03-27 15:25:19,835] {result_logger:141} INFO - 
[[ 88.65%   6.27%   5.08%]
 [  4.47%  91.10%   4.43%]
 [  5.95%   4.14%  89.91%]]
[2024-03-27 15:25:20,971] {result_logger:145} INFO - 
[[ 95.43%   7.92%  26.74%]
 [  3.83%  91.47%  18.55%]
 [  0.74%   0.60%  54.71%]]
[2024-03-27 15:25:20,971] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-27 15:25:21,223] {result_logger:134} INFO - 
[[170548  10730   4442]
 [  6012 135244   6326]
 [  2310    778  18363]]
[2024-03-27 15:25:21,552] {result_logger:141} INFO - 
[[ 91.83%   5.78%   2.39%]
 [  4.07%  91.64%   4.29%]
 [ 10.77%   3.63%  85.60%]]
[2024-03-27 15:25:21,877] {result_logger:145} INFO - 
[[ 95.35%   7.31%  15.25%]
 [  3.36%  92.16%  21.72%]
 [  1.29%   0.53%  63.04%]]
[2024-03-27 15:25:22,667] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-27 15:25:22,667] {result_logger:77} INFO - actual:
[2024-03-27 15:25:22,667] {result_logger:78} INFO - 
[[93.75%  6.20%  0.05%]
 [ 5.98% 90.37%  3.64%]
 [12.92% 12.55% 74.52%]]
[2024-03-27 15:25:22,667] {result_logger:79} INFO - predicted:
[2024-03-27 15:25:22,667] {result_logger:80} INFO - 
[[91.13%  6.81%  2.07%]
 [ 6.31% 88.28%  5.41%]
 [22.68% 17.26% 60.06%]]
[2024-03-27 15:25:22,738] {train_model:96} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/step4/Antoine/model_8conv_2fc-best.pth
[2024-03-27 15:25:22,738] {run_experiment_multiple_labs:112} INFO - [epoch  12] execution time: 435.29s	 avg f1-score: 0.8602

[2024-03-27 15:26:50,143] {train_model:84} INFO - Train Epoch: 13 [141568/1419038 (10%)]	lr:2.41e-04	Loss: 0.381358
[2024-03-27 15:27:16,082] {train_model:84} INFO - Train Epoch: 13 [283392/1419038 (20%)]	lr:2.41e-04	Loss: 0.172972
[2024-03-27 15:27:41,640] {train_model:84} INFO - Train Epoch: 13 [425216/1419038 (30%)]	lr:2.41e-04	Loss: 0.198140
[2024-03-27 15:28:07,279] {train_model:84} INFO - Train Epoch: 13 [567040/1419038 (40%)]	lr:2.41e-04	Loss: 0.240429
[2024-03-27 15:28:32,908] {train_model:84} INFO - Train Epoch: 13 [708864/1419038 (50%)]	lr:2.41e-04	Loss: 0.216022
[2024-03-27 15:28:58,776] {train_model:84} INFO - Train Epoch: 13 [850688/1419038 (60%)]	lr:2.41e-04	Loss: 0.282033
[2024-03-27 15:29:24,789] {train_model:84} INFO - Train Epoch: 13 [992512/1419038 (70%)]	lr:2.41e-04	Loss: 0.169008
[2024-03-27 15:29:50,947] {train_model:84} INFO - Train Epoch: 13 [1134336/1419038 (80%)]	lr:2.41e-04	Loss: 0.141602
[2024-03-27 15:30:17,255] {train_model:84} INFO - Train Epoch: 13 [1276160/1419038 (90%)]	lr:2.41e-04	Loss: 0.156332
[2024-03-27 15:30:43,809] {train_model:84} INFO - Train Epoch: 13 [1417984/1419038 (100%)]	lr:2.41e-04	Loss: 0.196311
[2024-03-27 15:32:06,823] {run_experiment_multiple_labs:78} INFO - 
[2024-03-27 15:32:06,823] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-27 15:32:09,357] {result_logger:103} INFO - precision on Wake: 0.958
[2024-03-27 15:32:11,127] {result_logger:104} INFO - recall on Wake: 0.890
[2024-03-27 15:32:12,826] {result_logger:107} INFO - F1-score on Wake: 0.923
[2024-03-27 15:32:12,827] {result_logger:108} INFO - 
[2024-03-27 15:32:15,467] {result_logger:103} INFO - precision on Non REM: 0.917
[2024-03-27 15:32:17,205] {result_logger:104} INFO - recall on Non REM: 0.915
[2024-03-27 15:32:18,964] {result_logger:107} INFO - F1-score on Non REM: 0.916
[2024-03-27 15:32:18,964] {result_logger:108} INFO - 
[2024-03-27 15:32:21,316] {result_logger:103} INFO - precision on REM: 0.560
[2024-03-27 15:32:22,842] {result_logger:104} INFO - recall on REM: 0.905
[2024-03-27 15:32:24,373] {result_logger:107} INFO - F1-score on REM: 0.692
[2024-03-27 15:32:24,374] {result_logger:108} INFO - 
[2024-03-27 15:32:24,793] {result_logger:111} INFO - average precision on sleep stages: 0.811
[2024-03-27 15:32:25,212] {result_logger:113} INFO - average recall on sleep stages: 0.904
[2024-03-27 15:32:25,632] {result_logger:115} INFO - average F1-score on sleep stages: 0.844
[2024-03-27 15:32:25,639] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-27 15:32:26,210] {result_logger:103} INFO - precision on Wake: 0.963
[2024-03-27 15:32:26,571] {result_logger:104} INFO - recall on Wake: 0.909
[2024-03-27 15:32:26,944] {result_logger:107} INFO - F1-score on Wake: 0.935
[2024-03-27 15:32:26,944] {result_logger:108} INFO - 
[2024-03-27 15:32:27,539] {result_logger:103} INFO - precision on Non REM: 0.922
[2024-03-27 15:32:27,904] {result_logger:104} INFO - recall on Non REM: 0.919
[2024-03-27 15:32:28,269] {result_logger:107} INFO - F1-score on Non REM: 0.921
[2024-03-27 15:32:28,269] {result_logger:108} INFO - 
[2024-03-27 15:32:28,837] {result_logger:103} INFO - precision on REM: 0.603
[2024-03-27 15:32:29,197] {result_logger:104} INFO - recall on REM: 0.909
[2024-03-27 15:32:29,560] {result_logger:107} INFO - F1-score on REM: 0.725
[2024-03-27 15:32:29,560] {result_logger:108} INFO - 
[2024-03-27 15:32:29,634] {result_logger:111} INFO - average precision on sleep stages: 0.829
[2024-03-27 15:32:29,707] {result_logger:113} INFO - average recall on sleep stages: 0.912
[2024-03-27 15:32:29,780] {result_logger:115} INFO - average F1-score on sleep stages: 0.860
[2024-03-27 15:32:29,782] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-27 15:32:30,937] {result_logger:134} INFO - 
[[661548  45615  35733]
 [ 24499 540429  25405]
 [  4631   3484  77694]]
[2024-03-27 15:32:32,075] {result_logger:141} INFO - 
[[ 89.05%   6.14%   4.81%]
 [  4.15%  91.55%   4.30%]
 [  5.40%   4.06%  90.54%]]
[2024-03-27 15:32:33,219] {result_logger:145} INFO - 
[[ 95.78%   7.74%  25.74%]
 [  3.55%  91.67%  18.30%]
 [  0.67%   0.59%  55.96%]]
[2024-03-27 15:32:33,219] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-27 15:32:33,478] {result_logger:134} INFO - 
[[168754  10733   6233]
 [  5280 135697   6605]
 [  1281    671  19499]]
[2024-03-27 15:32:33,812] {result_logger:141} INFO - 
[[ 90.86%   5.78%   3.36%]
 [  3.58%  91.95%   4.48%]
 [  5.97%   3.13%  90.90%]]
[2024-03-27 15:32:34,144] {result_logger:145} INFO - 
[[ 96.26%   7.30%  19.28%]
 [  3.01%  92.25%  20.43%]
 [  0.73%   0.46%  60.30%]]
[2024-03-27 15:32:34,947] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-27 15:32:34,947] {result_logger:77} INFO - actual:
[2024-03-27 15:32:34,947] {result_logger:78} INFO - 
[[93.75%  6.20%  0.05%]
 [ 5.98% 90.37%  3.64%]
 [12.92% 12.55% 74.52%]]
[2024-03-27 15:32:34,947] {result_logger:79} INFO - predicted:
[2024-03-27 15:32:34,947] {result_logger:80} INFO - 
[[90.69%  6.77%  2.54%]
 [ 6.12% 88.35%  5.54%]
 [22.64% 16.31% 61.05%]]
[2024-03-27 15:32:35,019] {train_model:96} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/step4/Antoine/model_8conv_2fc-best.pth
[2024-03-27 15:32:35,019] {run_experiment_multiple_labs:112} INFO - [epoch  13] execution time: 432.28s	 avg f1-score: 0.8603

[2024-03-27 15:34:02,216] {train_model:84} INFO - Train Epoch: 14 [141568/1419038 (10%)]	lr:2.27e-04	Loss: 0.125850
[2024-03-27 15:34:27,048] {train_model:84} INFO - Train Epoch: 14 [283392/1419038 (20%)]	lr:2.27e-04	Loss: 0.428492
[2024-03-27 15:34:52,151] {train_model:84} INFO - Train Epoch: 14 [425216/1419038 (30%)]	lr:2.27e-04	Loss: 0.223222
[2024-03-27 15:35:17,470] {train_model:84} INFO - Train Epoch: 14 [567040/1419038 (40%)]	lr:2.27e-04	Loss: 0.204829
[2024-03-27 15:35:43,090] {train_model:84} INFO - Train Epoch: 14 [708864/1419038 (50%)]	lr:2.27e-04	Loss: 0.246693
[2024-03-27 15:36:08,929] {train_model:84} INFO - Train Epoch: 14 [850688/1419038 (60%)]	lr:2.27e-04	Loss: 0.293244
[2024-03-27 15:36:34,892] {train_model:84} INFO - Train Epoch: 14 [992512/1419038 (70%)]	lr:2.27e-04	Loss: 0.201690
[2024-03-27 15:37:00,997] {train_model:84} INFO - Train Epoch: 14 [1134336/1419038 (80%)]	lr:2.27e-04	Loss: 0.123762
[2024-03-27 15:37:27,301] {train_model:84} INFO - Train Epoch: 14 [1276160/1419038 (90%)]	lr:2.27e-04	Loss: 0.252883
[2024-03-27 15:37:53,910] {train_model:84} INFO - Train Epoch: 14 [1417984/1419038 (100%)]	lr:2.27e-04	Loss: 0.112806
[2024-03-27 15:39:16,986] {run_experiment_multiple_labs:78} INFO - 
[2024-03-27 15:39:16,986] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-27 15:39:19,550] {result_logger:103} INFO - precision on Wake: 0.959
[2024-03-27 15:39:21,255] {result_logger:104} INFO - recall on Wake: 0.893
[2024-03-27 15:39:22,944] {result_logger:107} INFO - F1-score on Wake: 0.925
[2024-03-27 15:39:22,944] {result_logger:108} INFO - 
[2024-03-27 15:39:25,537] {result_logger:103} INFO - precision on Non REM: 0.918
[2024-03-27 15:39:27,252] {result_logger:104} INFO - recall on Non REM: 0.918
[2024-03-27 15:39:28,920] {result_logger:107} INFO - F1-score on Non REM: 0.918
[2024-03-27 15:39:28,920] {result_logger:108} INFO - 
[2024-03-27 15:39:31,279] {result_logger:103} INFO - precision on REM: 0.568
[2024-03-27 15:39:32,768] {result_logger:104} INFO - recall on REM: 0.908
[2024-03-27 15:39:34,285] {result_logger:107} INFO - F1-score on REM: 0.699
[2024-03-27 15:39:34,285] {result_logger:108} INFO - 
[2024-03-27 15:39:34,696] {result_logger:111} INFO - average precision on sleep stages: 0.815
[2024-03-27 15:39:35,106] {result_logger:113} INFO - average recall on sleep stages: 0.907
[2024-03-27 15:39:35,516] {result_logger:115} INFO - average F1-score on sleep stages: 0.848
[2024-03-27 15:39:35,523] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-27 15:39:36,104] {result_logger:103} INFO - precision on Wake: 0.961
[2024-03-27 15:39:36,462] {result_logger:104} INFO - recall on Wake: 0.899
[2024-03-27 15:39:36,823] {result_logger:107} INFO - F1-score on Wake: 0.929
[2024-03-27 15:39:36,823] {result_logger:108} INFO - 
[2024-03-27 15:39:37,414] {result_logger:103} INFO - precision on Non REM: 0.932
[2024-03-27 15:39:37,784] {result_logger:104} INFO - recall on Non REM: 0.913
[2024-03-27 15:39:38,158] {result_logger:107} INFO - F1-score on Non REM: 0.922
[2024-03-27 15:39:38,158] {result_logger:108} INFO - 
[2024-03-27 15:39:38,742] {result_logger:103} INFO - precision on REM: 0.550
[2024-03-27 15:39:39,111] {result_logger:104} INFO - recall on REM: 0.933
[2024-03-27 15:39:39,476] {result_logger:107} INFO - F1-score on REM: 0.692
[2024-03-27 15:39:39,476] {result_logger:108} INFO - 
[2024-03-27 15:39:39,552] {result_logger:111} INFO - average precision on sleep stages: 0.814
[2024-03-27 15:39:39,626] {result_logger:113} INFO - average recall on sleep stages: 0.915
[2024-03-27 15:39:39,700] {result_logger:115} INFO - average F1-score on sleep stages: 0.848
[2024-03-27 15:39:39,702] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-27 15:39:40,842] {result_logger:134} INFO - 
[[663574  44900  34422]
 [ 23624 541979  24730]
 [  4412   3465  77932]]
[2024-03-27 15:39:41,979] {result_logger:141} INFO - 
[[ 89.32%   6.04%   4.63%]
 [  4.00%  91.81%   4.19%]
 [  5.14%   4.04%  90.82%]]
[2024-03-27 15:39:43,119] {result_logger:145} INFO - 
[[ 95.95%   7.61%  25.11%]
 [  3.42%  91.81%  18.04%]
 [  0.64%   0.59%  56.85%]]
[2024-03-27 15:39:43,119] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-27 15:39:43,373] {result_logger:134} INFO - 
[[166895   9304   9521]
 [  5981 134763   6838]
 [   830    600  20021]]
[2024-03-27 15:39:43,631] {result_logger:141} INFO - 
[[ 89.86%   5.01%   5.13%]
 [  4.05%  91.31%   4.63%]
 [  3.87%   2.80%  93.33%]]
[2024-03-27 15:39:43,889] {result_logger:145} INFO - 
[[ 96.08%   6.43%  26.17%]
 [  3.44%  93.15%  18.80%]
 [  0.48%   0.41%  55.03%]]
[2024-03-27 15:39:44,550] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-27 15:39:44,550] {result_logger:77} INFO - actual:
[2024-03-27 15:39:44,550] {result_logger:78} INFO - 
[[93.75%  6.20%  0.05%]
 [ 5.98% 90.37%  3.64%]
 [12.92% 12.55% 74.52%]]
[2024-03-27 15:39:44,550] {result_logger:79} INFO - predicted:
[2024-03-27 15:39:44,550] {result_logger:80} INFO - 
[[89.76%  6.72%  3.51%]
 [ 6.00% 88.20%  5.80%]
 [25.05% 14.81% 60.15%]]
[2024-03-27 15:39:44,550] {run_experiment_multiple_labs:112} INFO - [epoch  14] execution time: 429.53s	 avg f1-score: 0.8478

[2024-03-27 15:41:11,930] {train_model:84} INFO - Train Epoch: 15 [141568/1419038 (10%)]	lr:2.14e-04	Loss: 0.191425
[2024-03-27 15:41:37,251] {train_model:84} INFO - Train Epoch: 15 [283392/1419038 (20%)]	lr:2.14e-04	Loss: 0.129396
[2024-03-27 15:42:03,152] {train_model:84} INFO - Train Epoch: 15 [425216/1419038 (30%)]	lr:2.14e-04	Loss: 0.148378
[2024-03-27 15:42:29,378] {train_model:84} INFO - Train Epoch: 15 [567040/1419038 (40%)]	lr:2.14e-04	Loss: 0.219787
[2024-03-27 15:42:55,416] {train_model:84} INFO - Train Epoch: 15 [708864/1419038 (50%)]	lr:2.14e-04	Loss: 0.183647
[2024-03-27 15:43:21,802] {train_model:84} INFO - Train Epoch: 15 [850688/1419038 (60%)]	lr:2.14e-04	Loss: 0.154283
[2024-03-27 15:43:48,659] {train_model:84} INFO - Train Epoch: 15 [992512/1419038 (70%)]	lr:2.14e-04	Loss: 0.241214
[2024-03-27 15:44:15,233] {train_model:84} INFO - Train Epoch: 15 [1134336/1419038 (80%)]	lr:2.14e-04	Loss: 0.347485
[2024-03-27 15:44:42,535] {train_model:84} INFO - Train Epoch: 15 [1276160/1419038 (90%)]	lr:2.14e-04	Loss: 0.256102
[2024-03-27 15:45:09,706] {train_model:84} INFO - Train Epoch: 15 [1417984/1419038 (100%)]	lr:2.14e-04	Loss: 0.221306
[2024-03-27 15:46:32,743] {run_experiment_multiple_labs:78} INFO - 
[2024-03-27 15:46:32,744] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-27 15:46:35,302] {result_logger:103} INFO - precision on Wake: 0.961
[2024-03-27 15:46:37,031] {result_logger:104} INFO - recall on Wake: 0.895
[2024-03-27 15:46:38,766] {result_logger:107} INFO - F1-score on Wake: 0.927
[2024-03-27 15:46:38,766] {result_logger:108} INFO - 
[2024-03-27 15:46:41,330] {result_logger:103} INFO - precision on Non REM: 0.919
[2024-03-27 15:46:43,001] {result_logger:104} INFO - recall on Non REM: 0.921
[2024-03-27 15:46:44,678] {result_logger:107} INFO - F1-score on Non REM: 0.920
[2024-03-27 15:46:44,678] {result_logger:108} INFO - 
[2024-03-27 15:46:47,048] {result_logger:103} INFO - precision on REM: 0.578
[2024-03-27 15:46:48,549] {result_logger:104} INFO - recall on REM: 0.912
[2024-03-27 15:46:50,071] {result_logger:107} INFO - F1-score on REM: 0.707
[2024-03-27 15:46:50,071] {result_logger:108} INFO - 
[2024-03-27 15:46:50,495] {result_logger:111} INFO - average precision on sleep stages: 0.819
[2024-03-27 15:46:50,916] {result_logger:113} INFO - average recall on sleep stages: 0.909
[2024-03-27 15:46:51,339] {result_logger:115} INFO - average F1-score on sleep stages: 0.851
[2024-03-27 15:46:51,346] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-27 15:46:51,921] {result_logger:103} INFO - precision on Wake: 0.964
[2024-03-27 15:46:52,278] {result_logger:104} INFO - recall on Wake: 0.909
[2024-03-27 15:46:52,633] {result_logger:107} INFO - F1-score on Wake: 0.936
[2024-03-27 15:46:52,633] {result_logger:108} INFO - 
[2024-03-27 15:46:53,222] {result_logger:103} INFO - precision on Non REM: 0.929
[2024-03-27 15:46:53,586] {result_logger:104} INFO - recall on Non REM: 0.913
[2024-03-27 15:46:53,948] {result_logger:107} INFO - F1-score on Non REM: 0.921
[2024-03-27 15:46:53,948] {result_logger:108} INFO - 
[2024-03-27 15:46:54,519] {result_logger:103} INFO - precision on REM: 0.574
[2024-03-27 15:46:54,880] {result_logger:104} INFO - recall on REM: 0.927
[2024-03-27 15:46:55,236] {result_logger:107} INFO - F1-score on REM: 0.709
[2024-03-27 15:46:55,236] {result_logger:108} INFO - 
[2024-03-27 15:46:55,311] {result_logger:111} INFO - average precision on sleep stages: 0.822
[2024-03-27 15:46:55,384] {result_logger:113} INFO - average recall on sleep stages: 0.916
[2024-03-27 15:46:55,457] {result_logger:115} INFO - average F1-score on sleep stages: 0.855
[2024-03-27 15:46:55,458] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-27 15:46:56,579] {result_logger:134} INFO - 
[[665203  44542  33151]
 [ 22762 543448  24123]
 [  4112   3397  78300]]
[2024-03-27 15:46:57,706] {result_logger:141} INFO - 
[[ 89.54%   6.00%   4.46%]
 [  3.86%  92.06%   4.09%]
 [  4.79%   3.96%  91.25%]]
[2024-03-27 15:46:58,830] {result_logger:145} INFO - 
[[ 96.12%   7.53%  24.45%]
 [  3.29%  91.89%  17.79%]
 [  0.59%   0.57%  57.75%]]
[2024-03-27 15:46:58,830] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-27 15:46:59,083] {result_logger:134} INFO - 
[[168829   9600   7291]
 [  5428 134673   7481]
 [   913    651  19887]]
[2024-03-27 15:46:59,336] {result_logger:141} INFO - 
[[ 90.91%   5.17%   3.93%]
 [  3.68%  91.25%   5.07%]
 [  4.26%   3.03%  92.71%]]
[2024-03-27 15:46:59,595] {result_logger:145} INFO - 
[[ 96.38%   6.62%  21.04%]
 [  3.10%  92.93%  21.58%]
 [  0.52%   0.45%  57.38%]]
[2024-03-27 15:47:00,258] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-27 15:47:00,258] {result_logger:77} INFO - actual:
[2024-03-27 15:47:00,258] {result_logger:78} INFO - 
[[93.75%  6.20%  0.05%]
 [ 5.98% 90.37%  3.64%]
 [12.92% 12.55% 74.52%]]
[2024-03-27 15:47:00,259] {result_logger:79} INFO - predicted:
[2024-03-27 15:47:00,259] {result_logger:80} INFO - 
[[90.53%  6.68%  2.78%]
 [ 6.15% 88.15%  5.70%]
 [22.14% 15.75% 62.11%]]
[2024-03-27 15:47:00,259] {run_experiment_multiple_labs:112} INFO - [epoch  15] execution time: 435.71s	 avg f1-score: 0.8551

[2024-03-27 15:48:27,961] {train_model:84} INFO - Train Epoch: 16 [141568/1419038 (10%)]	lr:2.01e-04	Loss: 0.148721
[2024-03-27 15:48:52,918] {train_model:84} INFO - Train Epoch: 16 [283392/1419038 (20%)]	lr:2.01e-04	Loss: 0.140024
[2024-03-27 15:49:18,185] {train_model:84} INFO - Train Epoch: 16 [425216/1419038 (30%)]	lr:2.01e-04	Loss: 0.104196
[2024-03-27 15:49:43,815] {train_model:84} INFO - Train Epoch: 16 [567040/1419038 (40%)]	lr:2.01e-04	Loss: 0.091966
[2024-03-27 15:50:09,638] {train_model:84} INFO - Train Epoch: 16 [708864/1419038 (50%)]	lr:2.01e-04	Loss: 0.276272
[2024-03-27 15:50:35,663] {train_model:84} INFO - Train Epoch: 16 [850688/1419038 (60%)]	lr:2.01e-04	Loss: 0.401630
[2024-03-27 15:51:01,785] {train_model:84} INFO - Train Epoch: 16 [992512/1419038 (70%)]	lr:2.01e-04	Loss: 0.198459
[2024-03-27 15:51:28,107] {train_model:84} INFO - Train Epoch: 16 [1134336/1419038 (80%)]	lr:2.01e-04	Loss: 0.136885
[2024-03-27 15:51:54,628] {train_model:84} INFO - Train Epoch: 16 [1276160/1419038 (90%)]	lr:2.01e-04	Loss: 0.167933
[2024-03-27 15:52:21,326] {train_model:84} INFO - Train Epoch: 16 [1417984/1419038 (100%)]	lr:2.01e-04	Loss: 0.164658
[2024-03-27 15:53:44,347] {run_experiment_multiple_labs:78} INFO - 
[2024-03-27 15:53:44,347] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-27 15:53:46,922] {result_logger:103} INFO - precision on Wake: 0.962
[2024-03-27 15:53:48,616] {result_logger:104} INFO - recall on Wake: 0.898
[2024-03-27 15:53:50,304] {result_logger:107} INFO - F1-score on Wake: 0.929
[2024-03-27 15:53:50,304] {result_logger:108} INFO - 
[2024-03-27 15:53:52,883] {result_logger:103} INFO - precision on Non REM: 0.920
[2024-03-27 15:53:54,595] {result_logger:104} INFO - recall on Non REM: 0.922
[2024-03-27 15:53:56,330] {result_logger:107} INFO - F1-score on Non REM: 0.921
[2024-03-27 15:53:56,331] {result_logger:108} INFO - 
[2024-03-27 15:53:58,725] {result_logger:103} INFO - precision on REM: 0.584
[2024-03-27 15:54:00,229] {result_logger:104} INFO - recall on REM: 0.916
[2024-03-27 15:54:01,724] {result_logger:107} INFO - F1-score on REM: 0.713
[2024-03-27 15:54:01,725] {result_logger:108} INFO - 
[2024-03-27 15:54:02,145] {result_logger:111} INFO - average precision on sleep stages: 0.822
[2024-03-27 15:54:02,566] {result_logger:113} INFO - average recall on sleep stages: 0.912
[2024-03-27 15:54:02,985] {result_logger:115} INFO - average F1-score on sleep stages: 0.854
[2024-03-27 15:54:02,993] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-27 15:54:03,575] {result_logger:103} INFO - precision on Wake: 0.955
[2024-03-27 15:54:03,935] {result_logger:104} INFO - recall on Wake: 0.924
[2024-03-27 15:54:04,294] {result_logger:107} INFO - F1-score on Wake: 0.940
[2024-03-27 15:54:04,294] {result_logger:108} INFO - 
[2024-03-27 15:54:04,874] {result_logger:103} INFO - precision on Non REM: 0.934
[2024-03-27 15:54:05,244] {result_logger:104} INFO - recall on Non REM: 0.918
[2024-03-27 15:54:05,618] {result_logger:107} INFO - F1-score on Non REM: 0.926
[2024-03-27 15:54:05,618] {result_logger:108} INFO - 
[2024-03-27 15:54:06,202] {result_logger:103} INFO - precision on REM: 0.648
[2024-03-27 15:54:06,571] {result_logger:104} INFO - recall on REM: 0.906
[2024-03-27 15:54:06,935] {result_logger:107} INFO - F1-score on REM: 0.755
[2024-03-27 15:54:06,935] {result_logger:108} INFO - 
[2024-03-27 15:54:07,009] {result_logger:111} INFO - average precision on sleep stages: 0.846
[2024-03-27 15:54:07,083] {result_logger:113} INFO - average recall on sleep stages: 0.916
[2024-03-27 15:54:07,156] {result_logger:115} INFO - average F1-score on sleep stages: 0.874
[2024-03-27 15:54:07,158] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-27 15:54:08,299] {result_logger:134} INFO - 
[[666990  43765  32141]
 [ 22355 544067  23911]
 [  3935   3297  78577]]
[2024-03-27 15:54:09,438] {result_logger:141} INFO - 
[[ 89.78%   5.89%   4.33%]
 [  3.79%  92.16%   4.05%]
 [  4.59%   3.84%  91.57%]]
[2024-03-27 15:54:10,578] {result_logger:145} INFO - 
[[ 96.21%   7.40%  23.87%]
 [  3.22%  92.04%  17.76%]
 [  0.57%   0.56%  58.37%]]
[2024-03-27 15:54:10,578] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-27 15:54:10,829] {result_logger:134} INFO - 
[[171640   8910   5170]
 [  6719 135466   5397]
 [  1301    713  19437]]
[2024-03-27 15:54:11,161] {result_logger:141} INFO - 
[[ 92.42%   4.80%   2.78%]
 [  4.55%  91.79%   3.66%]
 [  6.06%   3.32%  90.61%]]
[2024-03-27 15:54:11,483] {result_logger:145} INFO - 
[[ 95.54%   6.14%  17.23%]
 [  3.74%  93.37%  17.99%]
 [  0.72%   0.49%  64.78%]]
[2024-03-27 15:54:12,290] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-27 15:54:12,291] {result_logger:77} INFO - actual:
[2024-03-27 15:54:12,291] {result_logger:78} INFO - 
[[93.75%  6.20%  0.05%]
 [ 5.98% 90.37%  3.64%]
 [12.92% 12.55% 74.52%]]
[2024-03-27 15:54:12,291] {result_logger:79} INFO - predicted:
[2024-03-27 15:54:12,291] {result_logger:80} INFO - 
[[90.73%  6.97%  2.29%]
 [ 6.56% 88.42%  5.01%]
 [23.75% 14.22% 62.03%]]
[2024-03-27 15:54:12,361] {train_model:96} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/step4/Antoine/model_8conv_2fc-best.pth
[2024-03-27 15:54:12,361] {run_experiment_multiple_labs:112} INFO - [epoch  16] execution time: 432.10s	 avg f1-score: 0.8736

[2024-03-27 15:55:39,755] {train_model:84} INFO - Train Epoch: 17 [141568/1419038 (10%)]	lr:1.90e-04	Loss: 0.236982
[2024-03-27 15:56:04,766] {train_model:84} INFO - Train Epoch: 17 [283392/1419038 (20%)]	lr:1.90e-04	Loss: 0.154374
[2024-03-27 15:56:29,865] {train_model:84} INFO - Train Epoch: 17 [425216/1419038 (30%)]	lr:1.90e-04	Loss: 0.111845
[2024-03-27 15:56:55,257] {train_model:84} INFO - Train Epoch: 17 [567040/1419038 (40%)]	lr:1.90e-04	Loss: 0.122604
[2024-03-27 15:57:20,930] {train_model:84} INFO - Train Epoch: 17 [708864/1419038 (50%)]	lr:1.90e-04	Loss: 0.114404
[2024-03-27 15:57:46,863] {train_model:84} INFO - Train Epoch: 17 [850688/1419038 (60%)]	lr:1.90e-04	Loss: 0.154691
[2024-03-27 15:58:13,614] {train_model:84} INFO - Train Epoch: 17 [992512/1419038 (70%)]	lr:1.90e-04	Loss: 0.147655
[2024-03-27 15:58:39,964] {train_model:84} INFO - Train Epoch: 17 [1134336/1419038 (80%)]	lr:1.90e-04	Loss: 0.144259
[2024-03-27 15:59:06,688] {train_model:84} INFO - Train Epoch: 17 [1276160/1419038 (90%)]	lr:1.90e-04	Loss: 0.167771
[2024-03-27 15:59:34,036] {train_model:84} INFO - Train Epoch: 17 [1417984/1419038 (100%)]	lr:1.90e-04	Loss: 0.121472
[2024-03-27 16:00:57,073] {run_experiment_multiple_labs:78} INFO - 
[2024-03-27 16:00:57,074] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-27 16:00:59,889] {result_logger:103} INFO - precision on Wake: 0.963
[2024-03-27 16:01:01,603] {result_logger:104} INFO - recall on Wake: 0.900
[2024-03-27 16:01:03,288] {result_logger:107} INFO - F1-score on Wake: 0.930
[2024-03-27 16:01:03,288] {result_logger:108} INFO - 
[2024-03-27 16:01:05,867] {result_logger:103} INFO - precision on Non REM: 0.921
[2024-03-27 16:01:07,550] {result_logger:104} INFO - recall on Non REM: 0.923
[2024-03-27 16:01:09,214] {result_logger:107} INFO - F1-score on Non REM: 0.922
[2024-03-27 16:01:09,214] {result_logger:108} INFO - 
[2024-03-27 16:01:11,603] {result_logger:103} INFO - precision on REM: 0.593
[2024-03-27 16:01:13,091] {result_logger:104} INFO - recall on REM: 0.917
[2024-03-27 16:01:14,558] {result_logger:107} INFO - F1-score on REM: 0.720
[2024-03-27 16:01:14,558] {result_logger:108} INFO - 
[2024-03-27 16:01:14,967] {result_logger:111} INFO - average precision on sleep stages: 0.826
[2024-03-27 16:01:15,375] {result_logger:113} INFO - average recall on sleep stages: 0.914
[2024-03-27 16:01:15,782] {result_logger:115} INFO - average F1-score on sleep stages: 0.858
[2024-03-27 16:01:15,788] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-27 16:01:16,365] {result_logger:103} INFO - precision on Wake: 0.954
[2024-03-27 16:01:16,726] {result_logger:104} INFO - recall on Wake: 0.931
[2024-03-27 16:01:17,080] {result_logger:107} INFO - F1-score on Wake: 0.942
[2024-03-27 16:01:17,080] {result_logger:108} INFO - 
[2024-03-27 16:01:17,664] {result_logger:103} INFO - precision on Non REM: 0.938
[2024-03-27 16:01:18,025] {result_logger:104} INFO - recall on Non REM: 0.912
[2024-03-27 16:01:18,381] {result_logger:107} INFO - F1-score on Non REM: 0.925
[2024-03-27 16:01:18,381] {result_logger:108} INFO - 
[2024-03-27 16:01:18,954] {result_logger:103} INFO - precision on REM: 0.653
[2024-03-27 16:01:19,305] {result_logger:104} INFO - recall on REM: 0.913
[2024-03-27 16:01:19,659] {result_logger:107} INFO - F1-score on REM: 0.762
[2024-03-27 16:01:19,659] {result_logger:108} INFO - 
[2024-03-27 16:01:19,732] {result_logger:111} INFO - average precision on sleep stages: 0.848
[2024-03-27 16:01:19,806] {result_logger:113} INFO - average recall on sleep stages: 0.919
[2024-03-27 16:01:19,880] {result_logger:115} INFO - average F1-score on sleep stages: 0.876
[2024-03-27 16:01:19,882] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-27 16:01:21,004] {result_logger:134} INFO - 
[[668723  43364  30809]
 [ 21900 545114  23319]
 [  3836   3262  78711]]
[2024-03-27 16:01:22,114] {result_logger:141} INFO - 
[[ 90.02%   5.84%   4.15%]
 [  3.71%  92.34%   3.95%]
 [  4.47%   3.80%  91.73%]]
[2024-03-27 16:01:23,242] {result_logger:145} INFO - 
[[ 96.29%   7.33%  23.19%]
 [  3.15%  92.12%  17.55%]
 [  0.55%   0.55%  59.25%]]
[2024-03-27 16:01:23,242] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-27 16:01:23,494] {result_logger:134} INFO - 
[[172899   8279   4542]
 [  7087 134638   5857]
 [  1309    550  19592]]
[2024-03-27 16:01:23,825] {result_logger:141} INFO - 
[[ 93.10%   4.46%   2.45%]
 [  4.80%  91.23%   3.97%]
 [  6.10%   2.56%  91.33%]]
[2024-03-27 16:01:24,154] {result_logger:145} INFO - 
[[ 95.37%   5.77%  15.14%]
 [  3.91%  93.85%  19.53%]
 [  0.72%   0.38%  65.33%]]
[2024-03-27 16:01:24,938] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-27 16:01:24,938] {result_logger:77} INFO - actual:
[2024-03-27 16:01:24,939] {result_logger:78} INFO - 
[[93.75%  6.20%  0.05%]
 [ 5.98% 90.37%  3.64%]
 [12.92% 12.55% 74.52%]]
[2024-03-27 16:01:24,939] {result_logger:79} INFO - predicted:
[2024-03-27 16:01:24,939] {result_logger:80} INFO - 
[[90.92%  7.04%  2.04%]
 [ 6.82% 88.02%  5.17%]
 [22.26% 14.76% 62.98%]]
[2024-03-27 16:01:25,009] {train_model:96} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/step4/Antoine/model_8conv_2fc-best.pth
[2024-03-27 16:01:25,009] {run_experiment_multiple_labs:112} INFO - [epoch  17] execution time: 432.65s	 avg f1-score: 0.8764

[2024-03-27 16:02:52,327] {train_model:84} INFO - Train Epoch: 18 [141568/1419038 (10%)]	lr:1.79e-04	Loss: 0.257852
[2024-03-27 16:03:17,676] {train_model:84} INFO - Train Epoch: 18 [283392/1419038 (20%)]	lr:1.79e-04	Loss: 0.211009
[2024-03-27 16:03:43,080] {train_model:84} INFO - Train Epoch: 18 [425216/1419038 (30%)]	lr:1.79e-04	Loss: 0.151980
[2024-03-27 16:04:08,708] {train_model:84} INFO - Train Epoch: 18 [567040/1419038 (40%)]	lr:1.79e-04	Loss: 0.257297
[2024-03-27 16:04:34,543] {train_model:84} INFO - Train Epoch: 18 [708864/1419038 (50%)]	lr:1.79e-04	Loss: 0.140361
[2024-03-27 16:05:00,524] {train_model:84} INFO - Train Epoch: 18 [850688/1419038 (60%)]	lr:1.79e-04	Loss: 0.187617
[2024-03-27 16:05:26,701] {train_model:84} INFO - Train Epoch: 18 [992512/1419038 (70%)]	lr:1.79e-04	Loss: 0.204166
[2024-03-27 16:05:53,018] {train_model:84} INFO - Train Epoch: 18 [1134336/1419038 (80%)]	lr:1.79e-04	Loss: 0.088353
[2024-03-27 16:06:19,498] {train_model:84} INFO - Train Epoch: 18 [1276160/1419038 (90%)]	lr:1.79e-04	Loss: 0.124979
[2024-03-27 16:06:46,812] {train_model:84} INFO - Train Epoch: 18 [1417984/1419038 (100%)]	lr:1.79e-04	Loss: 0.577305
[2024-03-27 16:08:10,090] {run_experiment_multiple_labs:78} INFO - 
[2024-03-27 16:08:10,090] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-27 16:08:12,617] {result_logger:103} INFO - precision on Wake: 0.964
[2024-03-27 16:08:14,286] {result_logger:104} INFO - recall on Wake: 0.901
[2024-03-27 16:08:15,982] {result_logger:107} INFO - F1-score on Wake: 0.931
[2024-03-27 16:08:15,982] {result_logger:108} INFO - 
[2024-03-27 16:08:18,540] {result_logger:103} INFO - precision on Non REM: 0.922
[2024-03-27 16:08:20,197] {result_logger:104} INFO - recall on Non REM: 0.925
[2024-03-27 16:08:21,873] {result_logger:107} INFO - F1-score on Non REM: 0.923
[2024-03-27 16:08:21,874] {result_logger:108} INFO - 
[2024-03-27 16:08:24,231] {result_logger:103} INFO - precision on REM: 0.595
[2024-03-27 16:08:25,735] {result_logger:104} INFO - recall on REM: 0.921
[2024-03-27 16:08:27,251] {result_logger:107} INFO - F1-score on REM: 0.723
[2024-03-27 16:08:27,251] {result_logger:108} INFO - 
[2024-03-27 16:08:27,674] {result_logger:111} INFO - average precision on sleep stages: 0.827
[2024-03-27 16:08:28,091] {result_logger:113} INFO - average recall on sleep stages: 0.915
[2024-03-27 16:08:28,510] {result_logger:115} INFO - average F1-score on sleep stages: 0.859
[2024-03-27 16:08:28,517] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-27 16:08:29,085] {result_logger:103} INFO - precision on Wake: 0.965
[2024-03-27 16:08:29,450] {result_logger:104} INFO - recall on Wake: 0.920
[2024-03-27 16:08:29,813] {result_logger:107} INFO - F1-score on Wake: 0.942
[2024-03-27 16:08:29,813] {result_logger:108} INFO - 
[2024-03-27 16:08:30,407] {result_logger:103} INFO - precision on Non REM: 0.931
[2024-03-27 16:08:30,779] {result_logger:104} INFO - recall on Non REM: 0.929
[2024-03-27 16:08:31,152] {result_logger:107} INFO - F1-score on Non REM: 0.930
[2024-03-27 16:08:31,152] {result_logger:108} INFO - 
[2024-03-27 16:08:31,726] {result_logger:103} INFO - precision on REM: 0.648
[2024-03-27 16:08:32,096] {result_logger:104} INFO - recall on REM: 0.920
[2024-03-27 16:08:32,460] {result_logger:107} INFO - F1-score on REM: 0.760
[2024-03-27 16:08:32,460] {result_logger:108} INFO - 
[2024-03-27 16:08:32,533] {result_logger:111} INFO - average precision on sleep stages: 0.848
[2024-03-27 16:08:32,605] {result_logger:113} INFO - average recall on sleep stages: 0.923
[2024-03-27 16:08:32,678] {result_logger:115} INFO - average F1-score on sleep stages: 0.877
[2024-03-27 16:08:32,680] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-27 16:08:33,829] {result_logger:134} INFO - 
[[669018  43174  30704]
 [ 21342 545906  23085]
 [  3592   3225  78992]]
[2024-03-27 16:08:34,981] {result_logger:141} INFO - 
[[ 90.06%   5.81%   4.13%]
 [  3.62%  92.47%   3.91%]
 [  4.19%   3.76%  92.06%]]
[2024-03-27 16:08:36,135] {result_logger:145} INFO - 
[[ 96.41%   7.29%  23.12%]
 [  3.08%  92.17%  17.39%]
 [  0.52%   0.54%  59.49%]]
[2024-03-27 16:08:36,136] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-27 16:08:36,393] {result_logger:134} INFO - 
[[170822   9450   5448]
 [  5157 137144   5281]
 [  1062    661  19728]]
[2024-03-27 16:08:36,727] {result_logger:141} INFO - 
[[ 91.98%   5.09%   2.93%]
 [  3.49%  92.93%   3.58%]
 [  4.95%   3.08%  91.97%]]
[2024-03-27 16:08:37,057] {result_logger:145} INFO - 
[[ 96.49%   6.42%  17.89%]
 [  2.91%  93.13%  17.34%]
 [  0.60%   0.45%  64.77%]]
[2024-03-27 16:08:37,858] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-27 16:08:37,858] {result_logger:77} INFO - actual:
[2024-03-27 16:08:37,859] {result_logger:78} INFO - 
[[93.75%  6.20%  0.05%]
 [ 5.98% 90.37%  3.64%]
 [12.92% 12.55% 74.52%]]
[2024-03-27 16:08:37,859] {result_logger:79} INFO - predicted:
[2024-03-27 16:08:37,859] {result_logger:80} INFO - 
[[91.08%  6.57%  2.35%]
 [ 5.98% 88.97%  5.06%]
 [22.94% 15.15% 61.91%]]
[2024-03-27 16:08:37,929] {train_model:96} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/step4/Antoine/model_8conv_2fc-best.pth
[2024-03-27 16:08:37,929] {run_experiment_multiple_labs:112} INFO - [epoch  18] execution time: 432.92s	 avg f1-score: 0.8774

[2024-03-27 16:10:05,290] {train_model:84} INFO - Train Epoch: 19 [141568/1419038 (10%)]	lr:1.68e-04	Loss: 0.137762
[2024-03-27 16:10:30,739] {train_model:84} INFO - Train Epoch: 19 [283392/1419038 (20%)]	lr:1.68e-04	Loss: 0.088408
[2024-03-27 16:10:56,119] {train_model:84} INFO - Train Epoch: 19 [425216/1419038 (30%)]	lr:1.68e-04	Loss: 0.114634
[2024-03-27 16:11:21,575] {train_model:84} INFO - Train Epoch: 19 [567040/1419038 (40%)]	lr:1.68e-04	Loss: 0.212454
[2024-03-27 16:11:47,277] {train_model:84} INFO - Train Epoch: 19 [708864/1419038 (50%)]	lr:1.68e-04	Loss: 0.186380
[2024-03-27 16:12:13,203] {train_model:84} INFO - Train Epoch: 19 [850688/1419038 (60%)]	lr:1.68e-04	Loss: 0.214141
[2024-03-27 16:12:39,449] {train_model:84} INFO - Train Epoch: 19 [992512/1419038 (70%)]	lr:1.68e-04	Loss: 0.231057
[2024-03-27 16:13:05,748] {train_model:84} INFO - Train Epoch: 19 [1134336/1419038 (80%)]	lr:1.68e-04	Loss: 0.370584
[2024-03-27 16:13:32,138] {train_model:84} INFO - Train Epoch: 19 [1276160/1419038 (90%)]	lr:1.68e-04	Loss: 0.242143
[2024-03-27 16:13:59,076] {train_model:84} INFO - Train Epoch: 19 [1417984/1419038 (100%)]	lr:1.68e-04	Loss: 0.116316
[2024-03-27 16:15:22,372] {run_experiment_multiple_labs:78} INFO - 
[2024-03-27 16:15:22,373] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-27 16:15:24,915] {result_logger:103} INFO - precision on Wake: 0.965
[2024-03-27 16:15:26,575] {result_logger:104} INFO - recall on Wake: 0.903
[2024-03-27 16:15:28,233] {result_logger:107} INFO - F1-score on Wake: 0.933
[2024-03-27 16:15:28,233] {result_logger:108} INFO - 
[2024-03-27 16:15:30,768] {result_logger:103} INFO - precision on Non REM: 0.923
[2024-03-27 16:15:32,432] {result_logger:104} INFO - recall on Non REM: 0.926
[2024-03-27 16:15:34,117] {result_logger:107} INFO - F1-score on Non REM: 0.924
[2024-03-27 16:15:34,117] {result_logger:108} INFO - 
[2024-03-27 16:15:36,506] {result_logger:103} INFO - precision on REM: 0.604
[2024-03-27 16:15:38,021] {result_logger:104} INFO - recall on REM: 0.922
[2024-03-27 16:15:39,534] {result_logger:107} INFO - F1-score on REM: 0.730
[2024-03-27 16:15:39,534] {result_logger:108} INFO - 
[2024-03-27 16:15:39,957] {result_logger:111} INFO - average precision on sleep stages: 0.830
[2024-03-27 16:15:40,377] {result_logger:113} INFO - average recall on sleep stages: 0.917
[2024-03-27 16:15:40,802] {result_logger:115} INFO - average F1-score on sleep stages: 0.862
[2024-03-27 16:15:40,808] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-27 16:15:41,396] {result_logger:103} INFO - precision on Wake: 0.967
[2024-03-27 16:15:41,750] {result_logger:104} INFO - recall on Wake: 0.909
[2024-03-27 16:15:42,117] {result_logger:107} INFO - F1-score on Wake: 0.937
[2024-03-27 16:15:42,117] {result_logger:108} INFO - 
[2024-03-27 16:15:42,703] {result_logger:103} INFO - precision on Non REM: 0.934
[2024-03-27 16:15:43,067] {result_logger:104} INFO - recall on Non REM: 0.925
[2024-03-27 16:15:43,433] {result_logger:107} INFO - F1-score on Non REM: 0.930
[2024-03-27 16:15:43,433] {result_logger:108} INFO - 
[2024-03-27 16:15:44,007] {result_logger:103} INFO - precision on REM: 0.592
[2024-03-27 16:15:44,365] {result_logger:104} INFO - recall on REM: 0.941
[2024-03-27 16:15:44,726] {result_logger:107} INFO - F1-score on REM: 0.727
[2024-03-27 16:15:44,726] {result_logger:108} INFO - 
[2024-03-27 16:15:44,801] {result_logger:111} INFO - average precision on sleep stages: 0.831
[2024-03-27 16:15:44,875] {result_logger:113} INFO - average recall on sleep stages: 0.925
[2024-03-27 16:15:44,949] {result_logger:115} INFO - average F1-score on sleep stages: 0.864
[2024-03-27 16:15:44,951] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-27 16:15:46,083] {result_logger:134} INFO - 
[[670898  42628  29370]
 [ 21222 546614  22497]
 [  3447   3222  79140]]
[2024-03-27 16:15:47,206] {result_logger:141} INFO - 
[[ 90.31%   5.74%   3.95%]
 [  3.59%  92.59%   3.81%]
 [  4.02%   3.75%  92.23%]]
[2024-03-27 16:15:48,329] {result_logger:145} INFO - 
[[ 96.45%   7.20%  22.42%]
 [  3.05%  92.26%  17.17%]
 [  0.50%   0.54%  60.41%]]
[2024-03-27 16:15:48,329] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-27 16:15:48,580] {result_logger:134} INFO - 
[[168776   8979   7965]
 [  5122 136505   5955]
 [   608    651  20192]]
[2024-03-27 16:15:48,833] {result_logger:141} INFO - 
[[ 90.88%   4.83%   4.29%]
 [  3.47%  92.49%   4.04%]
 [  2.83%   3.03%  94.13%]]
[2024-03-27 16:15:49,084] {result_logger:145} INFO - 
[[ 96.72%   6.14%  23.35%]
 [  2.94%  93.41%  17.46%]
 [  0.35%   0.45%  59.19%]]
[2024-03-27 16:15:49,744] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-27 16:15:49,744] {result_logger:77} INFO - actual:
[2024-03-27 16:15:49,744] {result_logger:78} INFO - 
[[93.75%  6.20%  0.05%]
 [ 5.98% 90.37%  3.64%]
 [12.92% 12.55% 74.52%]]
[2024-03-27 16:15:49,744] {result_logger:79} INFO - predicted:
[2024-03-27 16:15:49,744] {result_logger:80} INFO - 
[[90.02%  6.98%  2.99%]
 [ 6.32% 88.22%  5.45%]
 [23.95% 14.71% 61.33%]]
[2024-03-27 16:15:49,744] {run_experiment_multiple_labs:112} INFO - [epoch  19] execution time: 431.81s	 avg f1-score: 0.8645

[2024-03-27 16:17:17,236] {train_model:84} INFO - Train Epoch: 20 [141568/1419038 (10%)]	lr:1.58e-04	Loss: 0.752910
[2024-03-27 16:17:42,780] {train_model:84} INFO - Train Epoch: 20 [283392/1419038 (20%)]	lr:1.58e-04	Loss: 0.165680
[2024-03-27 16:18:08,640] {train_model:84} INFO - Train Epoch: 20 [425216/1419038 (30%)]	lr:1.58e-04	Loss: 0.142481
[2024-03-27 16:18:34,553] {train_model:84} INFO - Train Epoch: 20 [567040/1419038 (40%)]	lr:1.58e-04	Loss: 0.155005
[2024-03-27 16:19:00,715] {train_model:84} INFO - Train Epoch: 20 [708864/1419038 (50%)]	lr:1.58e-04	Loss: 0.145953
[2024-03-27 16:19:27,091] {train_model:84} INFO - Train Epoch: 20 [850688/1419038 (60%)]	lr:1.58e-04	Loss: 0.115989
[2024-03-27 16:19:53,795] {train_model:84} INFO - Train Epoch: 20 [992512/1419038 (70%)]	lr:1.58e-04	Loss: 0.209507
[2024-03-27 16:20:20,983] {train_model:84} INFO - Train Epoch: 20 [1134336/1419038 (80%)]	lr:1.58e-04	Loss: 0.179957
[2024-03-27 16:20:47,773] {train_model:84} INFO - Train Epoch: 20 [1276160/1419038 (90%)]	lr:1.58e-04	Loss: 0.189878
[2024-03-27 16:21:14,601] {train_model:84} INFO - Train Epoch: 20 [1417984/1419038 (100%)]	lr:1.58e-04	Loss: 0.130387
[2024-03-27 16:22:37,857] {run_experiment_multiple_labs:78} INFO - 
[2024-03-27 16:22:37,858] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-27 16:22:40,428] {result_logger:103} INFO - precision on Wake: 0.966
[2024-03-27 16:22:42,116] {result_logger:104} INFO - recall on Wake: 0.904
[2024-03-27 16:22:43,789] {result_logger:107} INFO - F1-score on Wake: 0.934
[2024-03-27 16:22:43,789] {result_logger:108} INFO - 
[2024-03-27 16:22:46,351] {result_logger:103} INFO - precision on Non REM: 0.924
[2024-03-27 16:22:48,026] {result_logger:104} INFO - recall on Non REM: 0.927
[2024-03-27 16:22:49,705] {result_logger:107} INFO - F1-score on Non REM: 0.926
[2024-03-27 16:22:49,705] {result_logger:108} INFO - 
[2024-03-27 16:22:52,073] {result_logger:103} INFO - precision on REM: 0.608
[2024-03-27 16:22:53,536] {result_logger:104} INFO - recall on REM: 0.926
[2024-03-27 16:22:55,051] {result_logger:107} INFO - F1-score on REM: 0.734
[2024-03-27 16:22:55,051] {result_logger:108} INFO - 
[2024-03-27 16:22:55,481] {result_logger:111} INFO - average precision on sleep stages: 0.832
[2024-03-27 16:22:55,908] {result_logger:113} INFO - average recall on sleep stages: 0.919
[2024-03-27 16:22:56,333] {result_logger:115} INFO - average F1-score on sleep stages: 0.865
[2024-03-27 16:22:56,339] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-27 16:22:56,927] {result_logger:103} INFO - precision on Wake: 0.968
[2024-03-27 16:22:57,287] {result_logger:104} INFO - recall on Wake: 0.907
[2024-03-27 16:22:57,650] {result_logger:107} INFO - F1-score on Wake: 0.937
[2024-03-27 16:22:57,650] {result_logger:108} INFO - 
[2024-03-27 16:22:58,235] {result_logger:103} INFO - precision on Non REM: 0.931
[2024-03-27 16:22:58,596] {result_logger:104} INFO - recall on Non REM: 0.920
[2024-03-27 16:22:58,971] {result_logger:107} INFO - F1-score on Non REM: 0.926
[2024-03-27 16:22:58,972] {result_logger:108} INFO - 
[2024-03-27 16:22:59,558] {result_logger:103} INFO - precision on REM: 0.583
[2024-03-27 16:22:59,923] {result_logger:104} INFO - recall on REM: 0.948
[2024-03-27 16:23:00,282] {result_logger:107} INFO - F1-score on REM: 0.722
[2024-03-27 16:23:00,282] {result_logger:108} INFO - 
[2024-03-27 16:23:00,356] {result_logger:111} INFO - average precision on sleep stages: 0.828
[2024-03-27 16:23:00,429] {result_logger:113} INFO - average recall on sleep stages: 0.925
[2024-03-27 16:23:00,503] {result_logger:115} INFO - average F1-score on sleep stages: 0.862
[2024-03-27 16:23:00,505] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-27 16:23:01,634] {result_logger:134} INFO - 
[[671786  42146  28964]
 [ 20557 547506  22270]
 [  3322   3036  79451]]
[2024-03-27 16:23:02,767] {result_logger:141} INFO - 
[[ 90.43%   5.67%   3.90%]
 [  3.48%  92.75%   3.77%]
 [  3.87%   3.54%  92.59%]]
[2024-03-27 16:23:03,904] {result_logger:145} INFO - 
[[ 96.57%   7.11%  22.16%]
 [  2.96%  92.38%  17.04%]
 [  0.48%   0.51%  60.80%]]
[2024-03-27 16:23:03,904] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-27 16:23:04,163] {result_logger:134} INFO - 
[[168486   9485   7749]
 [  4961 135849   6772]
 [   601    507  20343]]
[2024-03-27 16:23:04,419] {result_logger:141} INFO - 
[[ 90.72%   5.11%   4.17%]
 [  3.36%  92.05%   4.59%]
 [  2.80%   2.36%  94.83%]]
[2024-03-27 16:23:04,673] {result_logger:145} INFO - 
[[ 96.80%   6.50%  22.23%]
 [  2.85%  93.15%  19.42%]
 [  0.35%   0.35%  58.35%]]
[2024-03-27 16:23:05,332] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-27 16:23:05,332] {result_logger:77} INFO - actual:
[2024-03-27 16:23:05,332] {result_logger:78} INFO - 
[[93.75%  6.20%  0.05%]
 [ 5.98% 90.37%  3.64%]
 [12.92% 12.55% 74.52%]]
[2024-03-27 16:23:05,332] {result_logger:79} INFO - predicted:
[2024-03-27 16:23:05,332] {result_logger:80} INFO - 
[[90.30%  6.74%  2.97%]
 [ 6.11% 88.20%  5.68%]
 [22.87% 15.72% 61.41%]]
[2024-03-27 16:23:05,332] {run_experiment_multiple_labs:112} INFO - [epoch  20] execution time: 435.59s	 avg f1-score: 0.8617

[2024-03-27 16:24:32,736] {train_model:84} INFO - Train Epoch: 21 [141568/1419038 (10%)]	lr:1.49e-04	Loss: 0.080215
[2024-03-27 16:24:57,749] {train_model:84} INFO - Train Epoch: 21 [283392/1419038 (20%)]	lr:1.49e-04	Loss: 0.086764
[2024-03-27 16:25:23,096] {train_model:84} INFO - Train Epoch: 21 [425216/1419038 (30%)]	lr:1.49e-04	Loss: 0.168819
[2024-03-27 16:25:48,705] {train_model:84} INFO - Train Epoch: 21 [567040/1419038 (40%)]	lr:1.49e-04	Loss: 0.165811
[2024-03-27 16:26:14,549] {train_model:84} INFO - Train Epoch: 21 [708864/1419038 (50%)]	lr:1.49e-04	Loss: 0.113805
[2024-03-27 16:26:40,393] {train_model:84} INFO - Train Epoch: 21 [850688/1419038 (60%)]	lr:1.49e-04	Loss: 0.159119
[2024-03-27 16:27:06,405] {train_model:84} INFO - Train Epoch: 21 [992512/1419038 (70%)]	lr:1.49e-04	Loss: 0.169537
[2024-03-27 16:27:32,845] {train_model:84} INFO - Train Epoch: 21 [1134336/1419038 (80%)]	lr:1.49e-04	Loss: 0.105754
[2024-03-27 16:27:59,298] {train_model:84} INFO - Train Epoch: 21 [1276160/1419038 (90%)]	lr:1.49e-04	Loss: 0.217997
[2024-03-27 16:28:26,041] {train_model:84} INFO - Train Epoch: 21 [1417984/1419038 (100%)]	lr:1.49e-04	Loss: 0.150074
[2024-03-27 16:29:49,150] {run_experiment_multiple_labs:78} INFO - 
[2024-03-27 16:29:49,150] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-27 16:29:51,742] {result_logger:103} INFO - precision on Wake: 0.966
[2024-03-27 16:29:53,433] {result_logger:104} INFO - recall on Wake: 0.905
[2024-03-27 16:29:55,114] {result_logger:107} INFO - F1-score on Wake: 0.935
[2024-03-27 16:29:55,114] {result_logger:108} INFO - 
[2024-03-27 16:29:57,689] {result_logger:103} INFO - precision on Non REM: 0.923
[2024-03-27 16:29:59,390] {result_logger:104} INFO - recall on Non REM: 0.929
[2024-03-27 16:30:01,095] {result_logger:107} INFO - F1-score on Non REM: 0.926
[2024-03-27 16:30:01,095] {result_logger:108} INFO - 
[2024-03-27 16:30:03,536] {result_logger:103} INFO - precision on REM: 0.617
[2024-03-27 16:30:05,061] {result_logger:104} INFO - recall on REM: 0.927
[2024-03-27 16:30:06,593] {result_logger:107} INFO - F1-score on REM: 0.741
[2024-03-27 16:30:06,593] {result_logger:108} INFO - 
[2024-03-27 16:30:07,019] {result_logger:111} INFO - average precision on sleep stages: 0.836
[2024-03-27 16:30:07,440] {result_logger:113} INFO - average recall on sleep stages: 0.920
[2024-03-27 16:30:07,861] {result_logger:115} INFO - average F1-score on sleep stages: 0.867
[2024-03-27 16:30:07,869] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-27 16:30:08,452] {result_logger:103} INFO - precision on Wake: 0.972
[2024-03-27 16:30:08,814] {result_logger:104} INFO - recall on Wake: 0.899
[2024-03-27 16:30:09,184] {result_logger:107} INFO - F1-score on Wake: 0.934
[2024-03-27 16:30:09,185] {result_logger:108} INFO - 
[2024-03-27 16:30:09,772] {result_logger:103} INFO - precision on Non REM: 0.927
[2024-03-27 16:30:10,136] {result_logger:104} INFO - recall on Non REM: 0.937
[2024-03-27 16:30:10,505] {result_logger:107} INFO - F1-score on Non REM: 0.932
[2024-03-27 16:30:10,505] {result_logger:108} INFO - 
[2024-03-27 16:30:11,095] {result_logger:103} INFO - precision on REM: 0.594
[2024-03-27 16:30:11,456] {result_logger:104} INFO - recall on REM: 0.938
[2024-03-27 16:30:11,824] {result_logger:107} INFO - F1-score on REM: 0.728
[2024-03-27 16:30:11,824] {result_logger:108} INFO - 
[2024-03-27 16:30:11,898] {result_logger:111} INFO - average precision on sleep stages: 0.831
[2024-03-27 16:30:11,972] {result_logger:113} INFO - average recall on sleep stages: 0.925
[2024-03-27 16:30:12,046] {result_logger:115} INFO - average F1-score on sleep stages: 0.865
[2024-03-27 16:30:12,048] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-27 16:30:13,195] {result_logger:134} INFO - 
[[672647  42433  27816]
 [ 20491 548386  21456]
 [  3172   3097  79540]]
[2024-03-27 16:30:14,343] {result_logger:141} INFO - 
[[ 90.54%   5.71%   3.74%]
 [  3.47%  92.89%   3.63%]
 [  3.70%   3.61%  92.69%]]
[2024-03-27 16:30:15,491] {result_logger:145} INFO - 
[[ 96.60%   7.14%  21.59%]
 [  2.94%  92.33%  16.66%]
 [  0.46%   0.52%  61.75%]]
[2024-03-27 16:30:15,492] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-27 16:30:15,748] {result_logger:134} INFO - 
[[167003  10087   8630]
 [  4262 138215   5105]
 [   557    772  20122]]
[2024-03-27 16:30:16,004] {result_logger:141} INFO - 
[[ 89.92%   5.43%   4.65%]
 [  2.89%  93.65%   3.46%]
 [  2.60%   3.60%  93.80%]]
[2024-03-27 16:30:16,262] {result_logger:145} INFO - 
[[ 97.20%   6.77%  25.49%]
 [  2.48%  92.72%  15.08%]
 [  0.32%   0.52%  59.43%]]
[2024-03-27 16:30:16,930] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-27 16:30:16,930] {result_logger:77} INFO - actual:
[2024-03-27 16:30:16,930] {result_logger:78} INFO - 
[[93.75%  6.20%  0.05%]
 [ 5.98% 90.37%  3.64%]
 [12.92% 12.55% 74.52%]]
[2024-03-27 16:30:16,930] {result_logger:79} INFO - predicted:
[2024-03-27 16:30:16,930] {result_logger:80} INFO - 
[[90.11%  6.66%  3.23%]
 [ 5.85% 89.04%  5.11%]
 [24.43% 14.43% 61.14%]]
[2024-03-27 16:30:16,930] {run_experiment_multiple_labs:112} INFO - [epoch  21] execution time: 431.60s	 avg f1-score: 0.8645

[2024-03-27 16:31:44,061] {train_model:84} INFO - Train Epoch: 22 [141568/1419038 (10%)]	lr:1.40e-04	Loss: 0.145142
[2024-03-27 16:32:09,533] {train_model:84} INFO - Train Epoch: 22 [283392/1419038 (20%)]	lr:1.40e-04	Loss: 0.223007
[2024-03-27 16:32:35,264] {train_model:84} INFO - Train Epoch: 22 [425216/1419038 (30%)]	lr:1.40e-04	Loss: 0.213825
[2024-03-27 16:33:01,053] {train_model:84} INFO - Train Epoch: 22 [567040/1419038 (40%)]	lr:1.40e-04	Loss: 0.157467
[2024-03-27 16:33:27,098] {train_model:84} INFO - Train Epoch: 22 [708864/1419038 (50%)]	lr:1.40e-04	Loss: 0.160912
[2024-03-27 16:33:53,464] {train_model:84} INFO - Train Epoch: 22 [850688/1419038 (60%)]	lr:1.40e-04	Loss: 0.165406
[2024-03-27 16:34:19,993] {train_model:84} INFO - Train Epoch: 22 [992512/1419038 (70%)]	lr:1.40e-04	Loss: 0.159977
[2024-03-27 16:34:46,876] {train_model:84} INFO - Train Epoch: 22 [1134336/1419038 (80%)]	lr:1.40e-04	Loss: 0.117403
[2024-03-27 16:35:13,830] {train_model:84} INFO - Train Epoch: 22 [1276160/1419038 (90%)]	lr:1.40e-04	Loss: 0.136015
[2024-03-27 16:35:40,803] {train_model:84} INFO - Train Epoch: 22 [1417984/1419038 (100%)]	lr:1.40e-04	Loss: 0.185344
[2024-03-27 16:37:03,847] {run_experiment_multiple_labs:78} INFO - 
[2024-03-27 16:37:03,848] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-27 16:37:06,422] {result_logger:103} INFO - precision on Wake: 0.967
[2024-03-27 16:37:08,101] {result_logger:104} INFO - recall on Wake: 0.907
[2024-03-27 16:37:09,784] {result_logger:107} INFO - F1-score on Wake: 0.936
[2024-03-27 16:37:09,784] {result_logger:108} INFO - 
[2024-03-27 16:37:12,408] {result_logger:103} INFO - precision on Non REM: 0.925
[2024-03-27 16:37:14,128] {result_logger:104} INFO - recall on Non REM: 0.930
[2024-03-27 16:37:15,847] {result_logger:107} INFO - F1-score on Non REM: 0.928
[2024-03-27 16:37:15,848] {result_logger:108} INFO - 
[2024-03-27 16:37:18,244] {result_logger:103} INFO - precision on REM: 0.621
[2024-03-27 16:37:19,778] {result_logger:104} INFO - recall on REM: 0.929
[2024-03-27 16:37:21,297] {result_logger:107} INFO - F1-score on REM: 0.744
[2024-03-27 16:37:21,297] {result_logger:108} INFO - 
[2024-03-27 16:37:21,716] {result_logger:111} INFO - average precision on sleep stages: 0.837
[2024-03-27 16:37:22,136] {result_logger:113} INFO - average recall on sleep stages: 0.922
[2024-03-27 16:37:22,555] {result_logger:115} INFO - average F1-score on sleep stages: 0.869
[2024-03-27 16:37:22,561] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-27 16:37:23,143] {result_logger:103} INFO - precision on Wake: 0.968
[2024-03-27 16:37:23,503] {result_logger:104} INFO - recall on Wake: 0.912
[2024-03-27 16:37:23,864] {result_logger:107} INFO - F1-score on Wake: 0.940
[2024-03-27 16:37:23,864] {result_logger:108} INFO - 
[2024-03-27 16:37:24,452] {result_logger:103} INFO - precision on Non REM: 0.934
[2024-03-27 16:37:24,817] {result_logger:104} INFO - recall on Non REM: 0.924
[2024-03-27 16:37:25,191] {result_logger:107} INFO - F1-score on Non REM: 0.929
[2024-03-27 16:37:25,192] {result_logger:108} INFO - 
[2024-03-27 16:37:25,777] {result_logger:103} INFO - precision on REM: 0.604
[2024-03-27 16:37:26,133] {result_logger:104} INFO - recall on REM: 0.949
[2024-03-27 16:37:26,501] {result_logger:107} INFO - F1-score on REM: 0.739
[2024-03-27 16:37:26,501] {result_logger:108} INFO - 
[2024-03-27 16:37:26,575] {result_logger:111} INFO - average precision on sleep stages: 0.835
[2024-03-27 16:37:26,649] {result_logger:113} INFO - average recall on sleep stages: 0.929
[2024-03-27 16:37:26,723] {result_logger:115} INFO - average F1-score on sleep stages: 0.869
[2024-03-27 16:37:26,724] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-27 16:37:27,860] {result_logger:134} INFO - 
[[673546  41635  27715]
 [ 20177 549195  20961]
 [  3120   3003  79686]]
[2024-03-27 16:37:29,000] {result_logger:141} INFO - 
[[ 90.66%   5.60%   3.73%]
 [  3.42%  93.03%   3.55%]
 [  3.64%   3.50%  92.86%]]
[2024-03-27 16:37:30,143] {result_logger:145} INFO - 
[[ 96.66%   7.01%  21.59%]
 [  2.90%  92.48%  16.33%]
 [  0.45%   0.51%  62.08%]]
[2024-03-27 16:37:30,143] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-27 16:37:30,399] {result_logger:134} INFO - 
[[169439   9171   7110]
 [  4965 136404   6213]
 [   548    545  20358]]
[2024-03-27 16:37:30,660] {result_logger:141} INFO - 
[[ 91.23%   4.94%   3.83%]
 [  3.36%  92.43%   4.21%]
 [  2.55%   2.54%  94.90%]]
[2024-03-27 16:37:30,922] {result_logger:145} INFO - 
[[ 96.85%   6.28%  21.11%]
 [  2.84%  93.35%  18.45%]
 [  0.31%   0.37%  60.44%]]
[2024-03-27 16:37:31,594] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-27 16:37:31,594] {result_logger:77} INFO - actual:
[2024-03-27 16:37:31,594] {result_logger:78} INFO - 
[[93.75%  6.20%  0.05%]
 [ 5.98% 90.37%  3.64%]
 [12.92% 12.55% 74.52%]]
[2024-03-27 16:37:31,594] {result_logger:79} INFO - predicted:
[2024-03-27 16:37:31,594] {result_logger:80} INFO - 
[[90.47%  6.77%  2.76%]
 [ 6.11% 88.43%  5.46%]
 [23.02% 15.02% 61.96%]]
[2024-03-27 16:37:31,594] {run_experiment_multiple_labs:112} INFO - [epoch  22] execution time: 434.66s	 avg f1-score: 0.8690

[2024-03-27 16:38:59,024] {train_model:84} INFO - Train Epoch: 23 [141568/1419038 (10%)]	lr:1.32e-04	Loss: 0.159534
[2024-03-27 16:39:24,449] {train_model:84} INFO - Train Epoch: 23 [283392/1419038 (20%)]	lr:1.32e-04	Loss: 0.147415
[2024-03-27 16:39:50,025] {train_model:84} INFO - Train Epoch: 23 [425216/1419038 (30%)]	lr:1.32e-04	Loss: 0.296515
[2024-03-27 16:40:15,939] {train_model:84} INFO - Train Epoch: 23 [567040/1419038 (40%)]	lr:1.32e-04	Loss: 0.109916
[2024-03-27 16:40:42,089] {train_model:84} INFO - Train Epoch: 23 [708864/1419038 (50%)]	lr:1.32e-04	Loss: 0.117829
[2024-03-27 16:41:08,429] {train_model:84} INFO - Train Epoch: 23 [850688/1419038 (60%)]	lr:1.32e-04	Loss: 0.206647
[2024-03-27 16:41:34,885] {train_model:84} INFO - Train Epoch: 23 [992512/1419038 (70%)]	lr:1.32e-04	Loss: 0.130171
[2024-03-27 16:42:01,687] {train_model:84} INFO - Train Epoch: 23 [1134336/1419038 (80%)]	lr:1.32e-04	Loss: 0.211176
[2024-03-27 16:42:28,486] {train_model:84} INFO - Train Epoch: 23 [1276160/1419038 (90%)]	lr:1.32e-04	Loss: 0.129659
[2024-03-27 16:42:55,577] {train_model:84} INFO - Train Epoch: 23 [1417984/1419038 (100%)]	lr:1.32e-04	Loss: 0.232567
[2024-03-27 16:44:18,609] {run_experiment_multiple_labs:78} INFO - 
[2024-03-27 16:44:18,610] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-27 16:44:21,183] {result_logger:103} INFO - precision on Wake: 0.967
[2024-03-27 16:44:22,878] {result_logger:104} INFO - recall on Wake: 0.907
[2024-03-27 16:44:24,574] {result_logger:107} INFO - F1-score on Wake: 0.936
[2024-03-27 16:44:24,574] {result_logger:108} INFO - 
[2024-03-27 16:44:27,126] {result_logger:103} INFO - precision on Non REM: 0.925
[2024-03-27 16:44:28,802] {result_logger:104} INFO - recall on Non REM: 0.931
[2024-03-27 16:44:30,459] {result_logger:107} INFO - F1-score on Non REM: 0.928
[2024-03-27 16:44:30,459] {result_logger:108} INFO - 
[2024-03-27 16:44:32,801] {result_logger:103} INFO - precision on REM: 0.624
[2024-03-27 16:44:34,289] {result_logger:104} INFO - recall on REM: 0.930
[2024-03-27 16:44:35,781] {result_logger:107} INFO - F1-score on REM: 0.747
[2024-03-27 16:44:35,781] {result_logger:108} INFO - 
[2024-03-27 16:44:36,197] {result_logger:111} INFO - average precision on sleep stages: 0.839
[2024-03-27 16:44:36,612] {result_logger:113} INFO - average recall on sleep stages: 0.923
[2024-03-27 16:44:37,026] {result_logger:115} INFO - average F1-score on sleep stages: 0.870
[2024-03-27 16:44:37,032] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-27 16:44:37,603] {result_logger:103} INFO - precision on Wake: 0.972
[2024-03-27 16:44:37,962] {result_logger:104} INFO - recall on Wake: 0.902
[2024-03-27 16:44:38,320] {result_logger:107} INFO - F1-score on Wake: 0.936
[2024-03-27 16:44:38,320] {result_logger:108} INFO - 
[2024-03-27 16:44:38,905] {result_logger:103} INFO - precision on Non REM: 0.931
[2024-03-27 16:44:39,266] {result_logger:104} INFO - recall on Non REM: 0.931
[2024-03-27 16:44:39,627] {result_logger:107} INFO - F1-score on Non REM: 0.931
[2024-03-27 16:44:39,627] {result_logger:108} INFO - 
[2024-03-27 16:44:40,201] {result_logger:103} INFO - precision on REM: 0.588
[2024-03-27 16:44:40,561] {result_logger:104} INFO - recall on REM: 0.952
[2024-03-27 16:44:40,917] {result_logger:107} INFO - F1-score on REM: 0.727
[2024-03-27 16:44:40,917] {result_logger:108} INFO - 
[2024-03-27 16:44:40,990] {result_logger:111} INFO - average precision on sleep stages: 0.830
[2024-03-27 16:44:41,063] {result_logger:113} INFO - average recall on sleep stages: 0.929
[2024-03-27 16:44:41,136] {result_logger:115} INFO - average F1-score on sleep stages: 0.865
[2024-03-27 16:44:41,137] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-27 16:44:42,278] {result_logger:134} INFO - 
[[673977  41705  27214]
 [ 19767 549784  20782]
 [  3019   3010  79780]]
[2024-03-27 16:44:43,414] {result_logger:141} INFO - 
[[ 90.72%   5.61%   3.66%]
 [  3.35%  93.13%   3.52%]
 [  3.52%   3.51%  92.97%]]
[2024-03-27 16:44:44,549] {result_logger:145} INFO - 
[[ 96.73%   7.02%  21.30%]
 [  2.84%  92.48%  16.26%]
 [  0.43%   0.51%  62.44%]]
[2024-03-27 16:44:44,549] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-27 16:44:44,809] {result_logger:134} INFO - 
[[167602   9616   8502]
 [  4311 137466   5805]
 [   472    551  20428]]
[2024-03-27 16:44:45,068] {result_logger:141} INFO - 
[[ 90.24%   5.18%   4.58%]
 [  2.92%  93.15%   3.93%]
 [  2.20%   2.57%  95.23%]]
[2024-03-27 16:44:45,323] {result_logger:145} INFO - 
[[ 97.23%   6.51%  24.48%]
 [  2.50%  93.11%  16.71%]
 [  0.27%   0.37%  58.81%]]
[2024-03-27 16:44:46,002] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-27 16:44:46,002] {result_logger:77} INFO - actual:
[2024-03-27 16:44:46,002] {result_logger:78} INFO - 
[[93.75%  6.20%  0.05%]
 [ 5.98% 90.37%  3.64%]
 [12.92% 12.55% 74.52%]]
[2024-03-27 16:44:46,002] {result_logger:79} INFO - predicted:
[2024-03-27 16:44:46,002] {result_logger:80} INFO - 
[[90.19%  6.67%  3.14%]
 [ 5.83% 88.79%  5.38%]
 [23.92% 14.56% 61.52%]]
[2024-03-27 16:44:46,002] {run_experiment_multiple_labs:112} INFO - [epoch  23] execution time: 434.41s	 avg f1-score: 0.8648

[2024-03-27 16:46:13,807] {train_model:84} INFO - Train Epoch: 24 [141568/1419038 (10%)]	lr:1.25e-04	Loss: 0.122940
[2024-03-27 16:46:38,999] {train_model:84} INFO - Train Epoch: 24 [283392/1419038 (20%)]	lr:1.25e-04	Loss: 0.408506
[2024-03-27 16:47:05,078] {train_model:84} INFO - Train Epoch: 24 [425216/1419038 (30%)]	lr:1.25e-04	Loss: 0.164161
[2024-03-27 16:47:31,177] {train_model:84} INFO - Train Epoch: 24 [567040/1419038 (40%)]	lr:1.25e-04	Loss: 0.100024
[2024-03-27 16:47:57,520] {train_model:84} INFO - Train Epoch: 24 [708864/1419038 (50%)]	lr:1.25e-04	Loss: 0.069445
[2024-03-27 16:48:24,129] {train_model:84} INFO - Train Epoch: 24 [850688/1419038 (60%)]	lr:1.25e-04	Loss: 0.114080
[2024-03-27 16:48:50,985] {train_model:84} INFO - Train Epoch: 24 [992512/1419038 (70%)]	lr:1.25e-04	Loss: 0.237838
[2024-03-27 16:49:17,584] {train_model:84} INFO - Train Epoch: 24 [1134336/1419038 (80%)]	lr:1.25e-04	Loss: 0.315244
[2024-03-27 16:49:44,399] {train_model:84} INFO - Train Epoch: 24 [1276160/1419038 (90%)]	lr:1.25e-04	Loss: 0.138007
[2024-03-27 16:50:11,853] {train_model:84} INFO - Train Epoch: 24 [1417984/1419038 (100%)]	lr:1.25e-04	Loss: 0.119188
[2024-03-27 16:51:35,109] {run_experiment_multiple_labs:78} INFO - 
[2024-03-27 16:51:35,110] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-03-27 16:51:37,725] {result_logger:103} INFO - precision on Wake: 0.968
[2024-03-27 16:51:39,449] {result_logger:104} INFO - recall on Wake: 0.909
[2024-03-27 16:51:41,157] {result_logger:107} INFO - F1-score on Wake: 0.938
[2024-03-27 16:51:41,157] {result_logger:108} INFO - 
[2024-03-27 16:51:43,720] {result_logger:103} INFO - precision on Non REM: 0.926
[2024-03-27 16:51:45,365] {result_logger:104} INFO - recall on Non REM: 0.932
[2024-03-27 16:51:46,998] {result_logger:107} INFO - F1-score on Non REM: 0.929
[2024-03-27 16:51:46,998] {result_logger:108} INFO - 
[2024-03-27 16:51:49,366] {result_logger:103} INFO - precision on REM: 0.631
[2024-03-27 16:51:50,856] {result_logger:104} INFO - recall on REM: 0.932
[2024-03-27 16:51:52,333] {result_logger:107} INFO - F1-score on REM: 0.752
[2024-03-27 16:51:52,333] {result_logger:108} INFO - 
[2024-03-27 16:51:52,753] {result_logger:111} INFO - average precision on sleep stages: 0.841
[2024-03-27 16:51:53,172] {result_logger:113} INFO - average recall on sleep stages: 0.924
[2024-03-27 16:51:53,591] {result_logger:115} INFO - average F1-score on sleep stages: 0.873
[2024-03-27 16:51:53,601] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-03-27 16:51:54,177] {result_logger:103} INFO - precision on Wake: 0.963
[2024-03-27 16:51:54,532] {result_logger:104} INFO - recall on Wake: 0.921
[2024-03-27 16:51:54,890] {result_logger:107} INFO - F1-score on Wake: 0.941
[2024-03-27 16:51:54,891] {result_logger:108} INFO - 
[2024-03-27 16:51:55,475] {result_logger:103} INFO - precision on Non REM: 0.939
[2024-03-27 16:51:55,839] {result_logger:104} INFO - recall on Non REM: 0.921
[2024-03-27 16:51:56,202] {result_logger:107} INFO - F1-score on Non REM: 0.930
[2024-03-27 16:51:56,203] {result_logger:108} INFO - 
[2024-03-27 16:51:56,792] {result_logger:103} INFO - precision on REM: 0.624
[2024-03-27 16:51:57,147] {result_logger:104} INFO - recall on REM: 0.945
[2024-03-27 16:51:57,508] {result_logger:107} INFO - F1-score on REM: 0.752
[2024-03-27 16:51:57,508] {result_logger:108} INFO - 
[2024-03-27 16:51:57,581] {result_logger:111} INFO - average precision on sleep stages: 0.842
[2024-03-27 16:51:57,654] {result_logger:113} INFO - average recall on sleep stages: 0.929
[2024-03-27 16:51:57,726] {result_logger:115} INFO - average F1-score on sleep stages: 0.874
[2024-03-27 16:51:57,728] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-03-27 16:51:58,884] {result_logger:134} INFO - 
[[675439  41170  26287]
 [ 19524 550231  20578]
 [  2919   2912  79978]]
[2024-03-27 16:52:00,033] {result_logger:141} INFO - 
[[ 90.92%   5.54%   3.54%]
 [  3.31%  93.21%   3.49%]
 [  3.40%   3.39%  93.20%]]
[2024-03-27 16:52:01,178] {result_logger:145} INFO - 
[[ 96.78%   6.93%  20.72%]
 [  2.80%  92.58%  16.22%]
 [  0.42%   0.49%  63.05%]]
[2024-03-27 16:52:01,178] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-03-27 16:52:01,432] {result_logger:134} INFO - 
[[170988   8320   6412]
 [  5939 135851   5792]
 [   683    497  20271]]
[2024-03-27 16:52:01,685] {result_logger:141} INFO - 
[[ 92.07%   4.48%   3.45%]
 [  4.02%  92.05%   3.92%]
 [  3.18%   2.32%  94.50%]]
[2024-03-27 16:52:01,943] {result_logger:145} INFO - 
[[ 96.27%   5.75%  19.74%]
 [  3.34%  93.91%  17.84%]
 [  0.38%   0.34%  62.42%]]
[2024-03-27 16:52:02,607] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-03-27 16:52:02,607] {result_logger:77} INFO - actual:
[2024-03-27 16:52:02,607] {result_logger:78} INFO - 
[[93.75%  6.20%  0.05%]
 [ 5.98% 90.37%  3.64%]
 [12.92% 12.55% 74.52%]]
[2024-03-27 16:52:02,607] {result_logger:79} INFO - predicted:
[2024-03-27 16:52:02,607] {result_logger:80} INFO - 
[[90.63%  6.79%  2.58%]
 [ 6.34% 88.45%  5.21%]
 [22.99% 14.33% 62.68%]]
[2024-03-27 16:52:02,607] {run_experiment_multiple_labs:112} INFO - [epoch  24] execution time: 436.61s	 avg f1-score: 0.8742

[2024-03-27 16:52:02,768] {result_logger:56} INFO - final F1-scores on train:
	Wake                : [0.5074954062582481, 0.7065422414868499, 0.8379853679594665, 0.8658509407881745, 0.8779464584894886, 0.8901773795763505, 0.8985830453102719, 0.9048748721136085, 0.9096899955983149, 0.9128138326049067, 0.9169074165869597, 0.9191897551917342, 0.9229352652880145, 0.9251602990855388, 0.9271296393730055, 0.9288415904457393, 0.930491075621541, 0.9312300257229713, 0.9327984105256791, 0.933969431953181, 0.93474735374922, 0.9356501421438191, 0.9363008879185974, 0.9376031560726219]
	Non REM             : [0.6671890600050789, 0.8007283435989963, 0.8592737216658998, 0.8752546058387342, 0.8842194846918152, 0.8913319022794643, 0.8975953773547195, 0.9021123735894733, 0.9062074861665711, 0.9087823087207582, 0.9111433114071389, 0.9128420745307456, 0.9160892681426033, 0.9180817446261763, 0.9197576414040551, 0.9210063463742381, 0.9223017529374242, 0.923200505987462, 0.9242735651172601, 0.925606561506516, 0.9261329331922593, 0.9275642097476199, 0.9280370550424026, 0.9289374209679516]
	REM                 : [0.17237022090826312, 0.3413438447142218, 0.5256641919315355, 0.5717074536873059, 0.593002672010688, 0.6161380058884107, 0.6352482791462835, 0.6518648453088342, 0.6614071596027711, 0.6680198050250638, 0.6734825628120842, 0.6802777471619089, 0.6917170062455206, 0.6992772316761854, 0.7073713880469592, 0.7129170106787396, 0.7199791445611211, 0.722741204995654, 0.7300199247288024, 0.7339787707742479, 0.7412135811500273, 0.7441343599273478, 0.7470562071306505, 0.7521960762184228]
	avg                 : [0.44901822905719674, 0.616204809933356, 0.740974427185634, 0.7709376667714049, 0.7850562050639972, 0.7992157625814086, 0.810475567270425, 0.8196173636706386, 0.8257682137892189, 0.8298719821169095, 0.8338444302687277, 0.8374365256281296, 0.8435805132253794, 0.8475064251293002, 0.8514195562746734, 0.8542549824995723, 0.8575906577066954, 0.8590572455686957, 0.8623639667905806, 0.8645182547446484, 0.8673646226971689, 0.869116237272929, 0.8704647166972168, 0.8729122177529988]
[2024-03-27 16:52:02,769] {result_logger:56} INFO - final F1-scores on valid:
	Wake                : [0.09944769790824953, 0.27917834558773746, 0.785771510213979, 0.8415147555406052, 0.886245703150658, 0.8832446416211862, 0.9113630684486135, 0.8956261199913985, 0.9275082199693923, 0.9161426993892682, 0.9279162798921451, 0.9355604926081351, 0.9348345728253493, 0.9286751654026142, 0.9356258139599324, 0.939515025452953, 0.9421903736904487, 0.9417881194505473, 0.937056181397234, 0.9366369438082319, 0.9341727685139088, 0.9395739064856713, 0.9360494826936234, 0.9412269837337958]
	Non REM             : [0.06661610085264424, 0.0007721327797457381, 0.6297654631140778, 0.8108050947032006, 0.8859861370073584, 0.9066578669664065, 0.903177669151436, 0.907492176266599, 0.9125804862419773, 0.9141279860364109, 0.9147803248190035, 0.918983195961051, 0.9209693127869609, 0.9222478092311692, 0.9208221369818056, 0.9257220565071359, 0.9251912908135743, 0.9303038628123336, 0.9295001651249333, 0.9259601326412721, 0.9318200204951189, 0.9288598647608799, 0.9312941415578477, 0.9296903336184774]
	REM                 : [0.13331479632461674, 0.21027163980727698, 0.5246518204312478, 0.5575261751111242, 0.6006720984053514, 0.5866323518280221, 0.6572341552605049, 0.6060531647123826, 0.709282934963869, 0.6702322738386308, 0.7075767744744146, 0.7260685619390297, 0.725031605562579, 0.6923968113987308, 0.7088576011406166, 0.7554950927995336, 0.7617122195871078, 0.7601140479309548, 0.726814606842683, 0.7224718103524815, 0.7276343386128589, 0.738518464775448, 0.7271562310895954, 0.7518080332307238]
	avg                 : [0.0997928650285035, 0.16340737272492006, 0.6467295979197681, 0.7366153417849768, 0.7909679795211226, 0.7921782868052049, 0.8239249642868515, 0.8030571536567933, 0.8497905470584128, 0.8335009864214366, 0.8500911263951877, 0.8602040835027386, 0.8602784970582964, 0.847773262010838, 0.8551018506941181, 0.8735773915865409, 0.8763646280303768, 0.8774020100646119, 0.8644569844549501, 0.8616896289339953, 0.8645423758739622, 0.8689840786739996, 0.8648332851136887, 0.8742417835276658]
[2024-03-27 16:52:02,927] {logger:50} INFO - 
[2024-03-27 16:52:02,928] {logger:51} INFO - ================================================================================
[2024-03-27 16:52:02,928] {logger:52} INFO - finished training
[2024-03-27 16:52:02,928] {logger:53} INFO - ================================================================================
[2024-03-27 16:52:02,928] {logger:54} INFO - 
[2024-03-27 16:52:02,928] {logger:50} INFO - 
[2024-03-27 16:52:02,928] {logger:51} INFO - ================================================================================
[2024-03-27 16:52:02,928] {logger:52} INFO - best model on epoch: 18 	f1-score: 0.8774
[2024-03-27 16:52:02,928] {logger:53} INFO - ================================================================================
[2024-03-27 16:52:02,928] {logger:54} INFO - 
