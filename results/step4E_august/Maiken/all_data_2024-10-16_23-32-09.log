[2024-10-16 23:32:09,988] {logger:43} INFO - run_experiment_multiple_labs.py, args: Namespace(experiment='all_data', save_dir='/home/s202283/code/grieger_validation/results/step4E_august/', test_lab='Maiken')
================================================================================
[2024-10-16 23:32:09,988] {logger:44} INFO - config:
[2024-10-16 23:32:09,988] {logger:45} INFO - parameter name      | parameter value
[2024-10-16 23:32:09,988] {logger:46} INFO - experiment          : all_data
[2024-10-16 23:32:09,988] {logger:46} INFO - RUN_NAME            : all_data_2024-10-16_23-32-09
[2024-10-16 23:32:09,988] {logger:46} INFO - DEVICE              : cuda
[2024-10-16 23:32:09,988] {logger:46} INFO - EXPERIMENT_DIR      : /home/s202283/code/grieger_validation/results/step4E_august/Maiken
[2024-10-16 23:32:09,988] {logger:46} INFO - MODELS_DIR          : /home/s202283/code/grieger_validation/results/step4E_august/Maiken/models
[2024-10-16 23:32:09,988] {logger:46} INFO - VISUALS_DIR         : /home/s202283/code/grieger_validation/results/step4E_august/Maiken/visuals/all_data_2024-10-16_23-32-09
[2024-10-16 23:32:09,988] {logger:46} INFO - DATA_DIR            : /scratch/s202283/data/grieger_validation
[2024-10-16 23:32:09,988] {logger:46} INFO - SAMPLE_DURATION     : 4
[2024-10-16 23:32:09,988] {logger:46} INFO - SAMPLING_RATE       : 64
[2024-10-16 23:32:09,988] {logger:46} INFO - ORIGINAL_FS         : {'Alessandro': 128, 'Antoine': 512, 'Kornum': 400}
[2024-10-16 23:32:09,988] {logger:46} INFO - DATA_FILE           : /home/s202283/code/grieger_validation/cache/dataset/multiple_labs.h5
[2024-10-16 23:32:09,988] {logger:46} INFO - STAGES              : ['Wake', 'REM', 'Non REM']
[2024-10-16 23:32:09,988] {logger:46} INFO - CHANNELS_IN_MODEL   : ['EEG1']
[2024-10-16 23:32:09,988] {logger:46} INFO - CHANNELS_IN_TABLE   : ['EEG1', 'EEG2', 'EEG3', 'EEG4', 'EMG']
[2024-10-16 23:32:09,988] {logger:46} INFO - LABS_CHANNELS       : {'Alessandro': {'EEG1': 0, 'EMG': 1}, 'Antoine': {'EEG1': 0, 'EEG2': 1, 'EEG3': 2, 'EEG4': 3, 'EMG': 4}, 'Maiken': {'EEG1': 0, 'EMG': 1}, 'Kornum': {'EEG1': 0, 'EEG2': 1, 'EMG': 2}, 'Sebastian': {'EEG1': 1, 'EEG2': 2, 'EMG': 0}}
[2024-10-16 23:32:09,989] {logger:46} INFO - SAMPLES_LEFT        : 3.25
[2024-10-16 23:32:09,989] {logger:46} INFO - SAMPLES_RIGHT       : 3.25
[2024-10-16 23:32:09,989] {logger:46} INFO - LABS                : ['Antoine', 'Kornum', 'Alessandro', 'Sebastian', 'Maiken']
[2024-10-16 23:32:09,989] {logger:46} INFO - ORIGINAL_DATASET_SIZE: 366122
[2024-10-16 23:32:09,989] {logger:46} INFO - VALIDATION_SPLIT    : 0.1392
[2024-10-16 23:32:09,989] {logger:46} INFO - LOG_INTERVAL        : 10
[2024-10-16 23:32:09,989] {logger:46} INFO - EXTRA_SAFE_MODELS   : False
[2024-10-16 23:32:09,989] {logger:46} INFO - BATCH_SIZE          : 256
[2024-10-16 23:32:09,989] {logger:46} INFO - DATA_FRACTION       : False
[2024-10-16 23:32:09,989] {logger:46} INFO - EPOCHS              : 50
[2024-10-16 23:32:09,989] {logger:46} INFO - WARMUP_EPOCHS       : 12
[2024-10-16 23:32:09,989] {logger:46} INFO - S_OPTIM_MODE        : exp
[2024-10-16 23:32:09,989] {logger:46} INFO - S_OPTIM_PARAS       : [0.06]
[2024-10-16 23:32:09,989] {logger:46} INFO - LEARNING_RATE       : 0.000256
[2024-10-16 23:32:09,989] {logger:46} INFO - OPTIMIZER           : <class 'torch.optim.adam.Adam'>
[2024-10-16 23:32:09,989] {logger:46} INFO - OPTIM_PARAS         : {}
[2024-10-16 23:32:09,989] {logger:46} INFO - L1_WEIGHT_DECAY     : 0
[2024-10-16 23:32:09,989] {logger:46} INFO - L2_WEIGHT_DECAY     : 0.0001
[2024-10-16 23:32:09,989] {logger:46} INFO - BATCH_SIZE_EVAL     : 512
[2024-10-16 23:32:09,989] {logger:46} INFO - FILTERS             : 96
[2024-10-16 23:32:09,989] {logger:46} INFO - CLASSIFIER_DROPOUT  : [0.2, 0.2]
[2024-10-16 23:32:09,989] {logger:46} INFO - FEATURE_EXTR_DROPOUT: [0.0, 0.2, 0.0, 0.2, 0.0, 0.2, 0.0, 0.2]
[2024-10-16 23:32:09,989] {logger:46} INFO - MODEL_NAME          : model_8conv_2fc
[2024-10-16 23:32:09,989] {logger:50} INFO - 
[2024-10-16 23:32:09,989] {logger:51} INFO - ================================================================================
[2024-10-16 23:32:09,989] {logger:52} INFO - start training with model: model_8conv_2fc
[2024-10-16 23:32:09,989] {logger:53} INFO - ================================================================================
[2024-10-16 23:32:09,989] {logger:54} INFO - 
[2024-10-16 23:34:07,631] {dataloader:161} INFO - data distribution in database for dataset train:
	Antoine             : {'Wake': 76474, 'REM': 8847, 'Non REM': 73498}
	Kornum              : {'Wake': 418408, 'REM': 47863, 'Non REM': 295887}
	Alessandro          : {'Wake': 282724, 'REM': 28485, 'Non REM': 222087}
	Sebastian           : {'Wake': 80153, 'REM': 11310, 'Non REM': 75798}
[2024-10-16 23:34:07,711] {dataloader:189} INFO - data distribution after processing:
	Antoine             : {'Wake': 76474, 'REM': 8847, 'Non REM': 73498}
	Kornum              : {'Wake': 418408, 'REM': 47863, 'Non REM': 295887}
	Alessandro          : {'Wake': 282724, 'REM': 28485, 'Non REM': 222087}
	Sebastian           : {'Wake': 80153, 'REM': 11310, 'Non REM': 75798}
[2024-10-16 23:34:07,711] {dataloader:161} INFO - data distribution in database for dataset train:
	Antoine             : {'Wake': 12366, 'REM': 1430, 'Non REM': 11885}
	Kornum              : {'Wake': 67660, 'REM': 7739, 'Non REM': 47847}
	Alessandro          : {'Wake': 45719, 'REM': 4606, 'Non REM': 35913}
	Sebastian           : {'Wake': 12961, 'REM': 1828, 'Non REM': 12257}
[2024-10-16 23:34:07,722] {dataloader:189} INFO - data distribution after processing:
	Antoine             : {'Wake': 12366, 'REM': 1430, 'Non REM': 11885}
	Kornum              : {'Wake': 67660, 'REM': 7739, 'Non REM': 47847}
	Alessandro          : {'Wake': 45719, 'REM': 4606, 'Non REM': 35913}
	Sebastian           : {'Wake': 12961, 'REM': 1828, 'Non REM': 12257}
[2024-10-16 23:34:11,634] {run_experiment_multiple_labs:49} INFO - classifier:
Model(
  (feature_extractor): Sequential(
    (0): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): Conv1d(1, 96, kernel_size=(5,), stride=(1,))
    (2): ReLU(inplace=True)
    (3): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): Dropout(p=0.0, inplace=False)
    (5): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (6): ReLU(inplace=True)
    (7): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): Dropout(p=0.2, inplace=False)
    (9): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (10): ReLU(inplace=True)
    (11): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (12): Dropout(p=0.0, inplace=False)
    (13): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (14): ReLU(inplace=True)
    (15): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (16): Dropout(p=0.2, inplace=False)
    (17): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (18): ReLU(inplace=True)
    (19): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (20): Dropout(p=0.0, inplace=False)
    (21): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (22): ReLU(inplace=True)
    (23): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (24): Dropout(p=0.2, inplace=False)
    (25): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (26): ReLU(inplace=True)
    (27): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (28): Dropout(p=0.0, inplace=False)
    (29): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (30): ReLU(inplace=True)
    (31): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (32): Dropout(p=0.2, inplace=False)
  )
  (classifier): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=10848, out_features=80, bias=True)
    (2): ReLU(inplace=True)
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=80, out_features=3, bias=True)
  )
)
[2024-10-16 23:35:54,015] {train_model:80} INFO - Train Epoch: 1 [161792/1621534 (10%)]	lr:2.56e-05	Loss: 79.552284
[2024-10-16 23:36:23,600] {train_model:80} INFO - Train Epoch: 1 [323840/1621534 (20%)]	lr:2.56e-05	Loss: 49.974968
[2024-10-16 23:36:53,213] {train_model:80} INFO - Train Epoch: 1 [485888/1621534 (30%)]	lr:2.56e-05	Loss: 24.327192
[2024-10-16 23:37:23,378] {train_model:80} INFO - Train Epoch: 1 [647936/1621534 (40%)]	lr:2.56e-05	Loss: 20.447115
[2024-10-16 23:37:53,445] {train_model:80} INFO - Train Epoch: 1 [809984/1621534 (50%)]	lr:2.56e-05	Loss: 5.591208
[2024-10-16 23:38:23,120] {train_model:80} INFO - Train Epoch: 1 [972032/1621534 (60%)]	lr:2.56e-05	Loss: 9.100795
[2024-10-16 23:38:53,196] {train_model:80} INFO - Train Epoch: 1 [1134080/1621534 (70%)]	lr:2.56e-05	Loss: 2.459657
[2024-10-16 23:39:23,321] {train_model:80} INFO - Train Epoch: 1 [1296128/1621534 (80%)]	lr:2.56e-05	Loss: 2.540691
[2024-10-16 23:39:54,058] {train_model:80} INFO - Train Epoch: 1 [1458176/1621534 (90%)]	lr:2.56e-05	Loss: 1.327419
[2024-10-16 23:40:25,083] {train_model:80} INFO - Train Epoch: 1 [1620224/1621534 (100%)]	lr:2.56e-05	Loss: 0.851962
[2024-10-16 23:41:53,359] {run_experiment_multiple_labs:78} INFO - 
[2024-10-16 23:41:53,359] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-10-16 23:41:56,263] {result_logger:103} INFO - precision on Wake: 0.712
[2024-10-16 23:41:58,198] {result_logger:104} INFO - recall on Wake: 0.424
[2024-10-16 23:42:00,119] {result_logger:107} INFO - F1-score on Wake: 0.531
[2024-10-16 23:42:00,119] {result_logger:108} INFO - 
[2024-10-16 23:42:02,914] {result_logger:103} INFO - precision on REM: 0.114
[2024-10-16 23:42:04,699] {result_logger:104} INFO - recall on REM: 0.565
[2024-10-16 23:42:06,497] {result_logger:107} INFO - F1-score on REM: 0.190
[2024-10-16 23:42:06,497] {result_logger:108} INFO - 
[2024-10-16 23:42:09,393] {result_logger:103} INFO - precision on Non REM: 0.707
[2024-10-16 23:42:11,345] {result_logger:104} INFO - recall on Non REM: 0.671
[2024-10-16 23:42:13,303] {result_logger:107} INFO - F1-score on Non REM: 0.689
[2024-10-16 23:42:13,304] {result_logger:108} INFO - 
[2024-10-16 23:42:13,773] {result_logger:111} INFO - average precision on sleep stages: 0.511
[2024-10-16 23:42:14,242] {result_logger:113} INFO - average recall on sleep stages: 0.553
[2024-10-16 23:42:14,712] {result_logger:115} INFO - average F1-score on sleep stages: 0.470
[2024-10-16 23:42:14,718] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-10-16 23:42:15,164] {result_logger:103} INFO - precision on Wake: 0.477
[2024-10-16 23:42:15,447] {result_logger:104} INFO - recall on Wake: 0.710
[2024-10-16 23:42:15,719] {result_logger:107} INFO - F1-score on Wake: 0.571
[2024-10-16 23:42:15,719] {result_logger:108} INFO - 
[2024-10-16 23:42:16,164] {result_logger:103} INFO - precision on REM: 0.204
[2024-10-16 23:42:16,442] {result_logger:104} INFO - recall on REM: 0.718
[2024-10-16 23:42:16,714] {result_logger:107} INFO - F1-score on REM: 0.318
[2024-10-16 23:42:16,714] {result_logger:108} INFO - 
[2024-10-16 23:42:17,136] {result_logger:103} INFO - precision on Non REM: 0.938
[2024-10-16 23:42:17,398] {result_logger:104} INFO - recall on Non REM: 0.007
[2024-10-16 23:42:17,667] {result_logger:107} INFO - F1-score on Non REM: 0.013
[2024-10-16 23:42:17,667] {result_logger:108} INFO - 
[2024-10-16 23:42:17,721] {result_logger:111} INFO - average precision on sleep stages: 0.540
[2024-10-16 23:42:17,774] {result_logger:113} INFO - average recall on sleep stages: 0.479
[2024-10-16 23:42:17,827] {result_logger:115} INFO - average F1-score on sleep stages: 0.301
[2024-10-16 23:42:17,828] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-10-16 23:42:18,150] {result_logger:134} INFO - 
[[363544 318658 175572]
 [ 31782  54524  10197]
 [115135 104194 447928]]
[2024-10-16 23:42:18,473] {result_logger:141} INFO - 
[[ 42.38%  37.15%  20.47%]
 [ 32.93%  56.50%  10.57%]
 [ 17.25%  15.62%  67.13%]]
[2024-10-16 23:42:18,794] {result_logger:145} INFO - 
[[ 71.22%  66.75%  27.71%]
 [  6.23%  11.42%   1.61%]
 [ 22.56%  21.83%  70.68%]]
[2024-10-16 23:42:18,794] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-10-16 23:42:18,832] {result_logger:134} INFO - 
[[ 98537  40118     47]
 [  4393  11209      1]
 [103528   3649    729]]
[2024-10-16 23:42:19,008] {result_logger:141} INFO - 
[[ 71.04%  28.92%   0.03%]
 [ 28.15%  71.84%   0.01%]
 [ 95.94%   3.38%   0.68%]]
[2024-10-16 23:42:19,116] {result_logger:145} INFO - 
[[ 47.73%  72.97%   6.05%]
 [  2.13%  20.39%   0.13%]
 [ 50.14%   6.64%  93.82%]]
[2024-10-16 23:42:19,740] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-10-16 23:42:19,740] {result_logger:77} INFO - actual:
[2024-10-16 23:42:19,740] {result_logger:78} INFO - 
[[92.77%  0.10%  7.14%]
 [14.73% 66.42% 18.85%]
 [ 7.17%  4.73% 88.10%]]
[2024-10-16 23:42:19,740] {result_logger:79} INFO - predicted:
[2024-10-16 23:42:19,741] {result_logger:80} INFO - 
[[86.03% 13.65%  0.32%]
 [51.30% 48.65%  0.05%]
 [82.88%  5.53% 11.58%]]
[2024-10-16 23:42:19,811] {train_model:92} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/step4E_august/Maiken/model_8conv_2fc-best.pth
[2024-10-16 23:42:19,811] {run_experiment_multiple_labs:112} INFO - [epoch   1] execution time: 488.18s	 avg f1-score: 0.3007

[2024-10-16 23:43:54,480] {train_model:80} INFO - Train Epoch: 2 [161792/1621534 (10%)]	lr:4.65e-05	Loss: 5.183619
[2024-10-16 23:44:23,713] {train_model:80} INFO - Train Epoch: 2 [323840/1621534 (20%)]	lr:4.65e-05	Loss: 7.001123
[2024-10-16 23:44:52,733] {train_model:80} INFO - Train Epoch: 2 [485888/1621534 (30%)]	lr:4.65e-05	Loss: 1.959872
[2024-10-16 23:45:22,735] {train_model:80} INFO - Train Epoch: 2 [647936/1621534 (40%)]	lr:4.65e-05	Loss: 0.615692
[2024-10-16 23:45:52,522] {train_model:80} INFO - Train Epoch: 2 [809984/1621534 (50%)]	lr:4.65e-05	Loss: 14.999911
[2024-10-16 23:46:22,421] {train_model:80} INFO - Train Epoch: 2 [972032/1621534 (60%)]	lr:4.65e-05	Loss: 1.179061
[2024-10-16 23:46:52,356] {train_model:80} INFO - Train Epoch: 2 [1134080/1621534 (70%)]	lr:4.65e-05	Loss: 0.710858
[2024-10-16 23:47:22,801] {train_model:80} INFO - Train Epoch: 2 [1296128/1621534 (80%)]	lr:4.65e-05	Loss: 1.231195
[2024-10-16 23:47:53,659] {train_model:80} INFO - Train Epoch: 2 [1458176/1621534 (90%)]	lr:4.65e-05	Loss: 2.792637
[2024-10-16 23:48:24,812] {train_model:80} INFO - Train Epoch: 2 [1620224/1621534 (100%)]	lr:4.65e-05	Loss: 1.644972
[2024-10-16 23:49:52,372] {run_experiment_multiple_labs:78} INFO - 
[2024-10-16 23:49:52,373] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-10-16 23:49:55,357] {result_logger:103} INFO - precision on Wake: 0.813
[2024-10-16 23:49:57,362] {result_logger:104} INFO - recall on Wake: 0.741
[2024-10-16 23:49:59,352] {result_logger:107} INFO - F1-score on Wake: 0.775
[2024-10-16 23:49:59,352] {result_logger:108} INFO - 
[2024-10-16 23:50:02,081] {result_logger:103} INFO - precision on REM: 0.290
[2024-10-16 23:50:03,838] {result_logger:104} INFO - recall on REM: 0.615
[2024-10-16 23:50:05,606] {result_logger:107} INFO - F1-score on REM: 0.394
[2024-10-16 23:50:05,606] {result_logger:108} INFO - 
[2024-10-16 23:50:08,580] {result_logger:103} INFO - precision on Non REM: 0.826
[2024-10-16 23:50:10,565] {result_logger:104} INFO - recall on Non REM: 0.787
[2024-10-16 23:50:12,551] {result_logger:107} INFO - F1-score on Non REM: 0.806
[2024-10-16 23:50:12,551] {result_logger:108} INFO - 
[2024-10-16 23:50:13,022] {result_logger:111} INFO - average precision on sleep stages: 0.643
[2024-10-16 23:50:13,492] {result_logger:113} INFO - average recall on sleep stages: 0.714
[2024-10-16 23:50:13,962] {result_logger:115} INFO - average F1-score on sleep stages: 0.658
[2024-10-16 23:50:13,967] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-10-16 23:50:14,412] {result_logger:103} INFO - precision on Wake: 0.550
[2024-10-16 23:50:14,674] {result_logger:104} INFO - recall on Wake: 0.987
[2024-10-16 23:50:14,933] {result_logger:107} INFO - F1-score on Wake: 0.706
[2024-10-16 23:50:14,933] {result_logger:108} INFO - 
[2024-10-16 23:50:15,357] {result_logger:103} INFO - precision on REM: 0.650
[2024-10-16 23:50:15,622] {result_logger:104} INFO - recall on REM: 0.551
[2024-10-16 23:50:15,891] {result_logger:107} INFO - F1-score on REM: 0.596
[2024-10-16 23:50:15,891] {result_logger:108} INFO - 
[2024-10-16 23:50:16,328] {result_logger:103} INFO - precision on Non REM: 1.000
[2024-10-16 23:50:16,595] {result_logger:104} INFO - recall on Non REM: 0.000
[2024-10-16 23:50:16,858] {result_logger:107} INFO - F1-score on Non REM: 0.001
[2024-10-16 23:50:16,858] {result_logger:108} INFO - 
[2024-10-16 23:50:16,907] {result_logger:111} INFO - average precision on sleep stages: 0.733
[2024-10-16 23:50:16,956] {result_logger:113} INFO - average recall on sleep stages: 0.513
[2024-10-16 23:50:17,005] {result_logger:115} INFO - average F1-score on sleep stages: 0.435
[2024-10-16 23:50:17,006] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-10-16 23:50:17,330] {result_logger:134} INFO - 
[[635288 118104 104382]
 [ 31170  59316   6017]
 [115029  27424 524804]]
[2024-10-16 23:50:17,653] {result_logger:141} INFO - 
[[ 74.06%  13.77%  12.17%]
 [ 32.30%  61.47%   6.24%]
 [ 17.24%   4.11%  78.65%]]
[2024-10-16 23:50:17,978] {result_logger:145} INFO - 
[[ 81.29%  57.66%  16.43%]
 [  3.99%  28.96%   0.95%]
 [ 14.72%  13.39%  82.62%]]
[2024-10-16 23:50:17,978] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-10-16 23:50:18,013] {result_logger:134} INFO - 
[[136934   1768      0]
 [  7006   8597      0]
 [105002   2864     40]]
[2024-10-16 23:50:18,126] {result_logger:141} INFO - 
[[ 98.73%   1.27%   0.00%]
 [ 44.90%  55.10%   0.00%]
 [ 97.31%   2.65%   0.04%]]
[2024-10-16 23:50:18,231] {result_logger:145} INFO - 
[[ 55.01%  13.36%   0.00%]
 [  2.81%  64.99%   0.00%]
 [ 42.18%  21.65% 100.00%]]
[2024-10-16 23:50:18,842] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-10-16 23:50:18,842] {result_logger:77} INFO - actual:
[2024-10-16 23:50:18,842] {result_logger:78} INFO - 
[[92.77%  0.10%  7.14%]
 [14.73% 66.42% 18.85%]
 [ 7.17%  4.73% 88.10%]]
[2024-10-16 23:50:18,842] {result_logger:79} INFO - predicted:
[2024-10-16 23:50:18,842] {result_logger:80} INFO - 
[[97.72%  2.27%  0.02%]
 [42.69% 57.31%  0.00%]
 [90.00%  5.00%  5.00%]]
[2024-10-16 23:50:18,914] {train_model:92} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/step4E_august/Maiken/model_8conv_2fc-best.pth
[2024-10-16 23:50:18,914] {run_experiment_multiple_labs:112} INFO - [epoch   2] execution time: 479.10s	 avg f1-score: 0.4345

[2024-10-16 23:51:54,829] {train_model:80} INFO - Train Epoch: 3 [161792/1621534 (10%)]	lr:6.75e-05	Loss: 3.344900
[2024-10-16 23:52:23,808] {train_model:80} INFO - Train Epoch: 3 [323840/1621534 (20%)]	lr:6.75e-05	Loss: 0.427559
[2024-10-16 23:52:52,778] {train_model:80} INFO - Train Epoch: 3 [485888/1621534 (30%)]	lr:6.75e-05	Loss: 0.479523
[2024-10-16 23:53:22,118] {train_model:80} INFO - Train Epoch: 3 [647936/1621534 (40%)]	lr:6.75e-05	Loss: 0.600942
[2024-10-16 23:53:51,808] {train_model:80} INFO - Train Epoch: 3 [809984/1621534 (50%)]	lr:6.75e-05	Loss: 0.384356
[2024-10-16 23:54:21,622] {train_model:80} INFO - Train Epoch: 3 [972032/1621534 (60%)]	lr:6.75e-05	Loss: 9.432909
[2024-10-16 23:54:51,721] {train_model:80} INFO - Train Epoch: 3 [1134080/1621534 (70%)]	lr:6.75e-05	Loss: 4.078012
[2024-10-16 23:55:21,957] {train_model:80} INFO - Train Epoch: 3 [1296128/1621534 (80%)]	lr:6.75e-05	Loss: 0.343301
[2024-10-16 23:55:52,439] {train_model:80} INFO - Train Epoch: 3 [1458176/1621534 (90%)]	lr:6.75e-05	Loss: 0.658799
[2024-10-16 23:56:23,141] {train_model:80} INFO - Train Epoch: 3 [1620224/1621534 (100%)]	lr:6.75e-05	Loss: 0.386588
[2024-10-16 23:57:50,931] {run_experiment_multiple_labs:78} INFO - 
[2024-10-16 23:57:50,931] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-10-16 23:57:53,886] {result_logger:103} INFO - precision on Wake: 0.886
[2024-10-16 23:57:55,849] {result_logger:104} INFO - recall on Wake: 0.811
[2024-10-16 23:57:57,826] {result_logger:107} INFO - F1-score on Wake: 0.847
[2024-10-16 23:57:57,826] {result_logger:108} INFO - 
[2024-10-16 23:58:00,646] {result_logger:103} INFO - precision on REM: 0.391
[2024-10-16 23:58:02,414] {result_logger:104} INFO - recall on REM: 0.767
[2024-10-16 23:58:04,167] {result_logger:107} INFO - F1-score on REM: 0.518
[2024-10-16 23:58:04,168] {result_logger:108} INFO - 
[2024-10-16 23:58:07,192] {result_logger:103} INFO - precision on Non REM: 0.862
[2024-10-16 23:58:09,175] {result_logger:104} INFO - recall on Non REM: 0.836
[2024-10-16 23:58:11,176] {result_logger:107} INFO - F1-score on Non REM: 0.848
[2024-10-16 23:58:11,176] {result_logger:108} INFO - 
[2024-10-16 23:58:11,662] {result_logger:111} INFO - average precision on sleep stages: 0.713
[2024-10-16 23:58:12,147] {result_logger:113} INFO - average recall on sleep stages: 0.805
[2024-10-16 23:58:12,633] {result_logger:115} INFO - average F1-score on sleep stages: 0.738
[2024-10-16 23:58:12,639] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-10-16 23:58:13,084] {result_logger:103} INFO - precision on Wake: 0.707
[2024-10-16 23:58:13,361] {result_logger:104} INFO - recall on Wake: 0.965
[2024-10-16 23:58:13,639] {result_logger:107} INFO - F1-score on Wake: 0.816
[2024-10-16 23:58:13,640] {result_logger:108} INFO - 
[2024-10-16 23:58:14,077] {result_logger:103} INFO - precision on REM: 0.471
[2024-10-16 23:58:14,349] {result_logger:104} INFO - recall on REM: 0.766
[2024-10-16 23:58:14,626] {result_logger:107} INFO - F1-score on REM: 0.584
[2024-10-16 23:58:14,626] {result_logger:108} INFO - 
[2024-10-16 23:58:15,074] {result_logger:103} INFO - precision on Non REM: 0.978
[2024-10-16 23:58:15,353] {result_logger:104} INFO - recall on Non REM: 0.431
[2024-10-16 23:58:15,631] {result_logger:107} INFO - F1-score on Non REM: 0.598
[2024-10-16 23:58:15,631] {result_logger:108} INFO - 
[2024-10-16 23:58:15,687] {result_logger:111} INFO - average precision on sleep stages: 0.719
[2024-10-16 23:58:15,742] {result_logger:113} INFO - average recall on sleep stages: 0.720
[2024-10-16 23:58:15,797] {result_logger:115} INFO - average F1-score on sleep stages: 0.666
[2024-10-16 23:58:15,798] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-10-16 23:58:16,133] {result_logger:134} INFO - 
[[695877  78076  83821]
 [ 16754  73986   5763]
 [ 72567  37002 557688]]
[2024-10-16 23:58:16,467] {result_logger:141} INFO - 
[[ 81.13%   9.10%   9.77%]
 [ 17.36%  76.67%   5.97%]
 [ 10.88%   5.55%  83.58%]]
[2024-10-16 23:58:16,803] {result_logger:145} INFO - 
[[ 88.62%  41.30%  12.95%]
 [  2.13%  39.13%   0.89%]
 [  9.24%  19.57%  86.16%]]
[2024-10-16 23:58:16,803] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-10-16 23:58:16,842] {result_logger:134} INFO - 
[[133779   3961    962]
 [  3554  11952     97]
 [ 51977   9439  46490]]
[2024-10-16 23:58:16,957] {result_logger:141} INFO - 
[[ 96.45%   2.86%   0.69%]
 [ 22.78%  76.60%   0.62%]
 [ 48.17%   8.75%  43.08%]]
[2024-10-16 23:58:17,067] {result_logger:145} INFO - 
[[ 70.67%  15.62%   2.02%]
 [  1.88%  47.14%   0.20%]
 [ 27.46%  37.23%  97.77%]]
[2024-10-16 23:58:17,688] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-10-16 23:58:17,688] {result_logger:77} INFO - actual:
[2024-10-16 23:58:17,688] {result_logger:78} INFO - 
[[92.77%  0.10%  7.14%]
 [14.73% 66.42% 18.85%]
 [ 7.17%  4.73% 88.10%]]
[2024-10-16 23:58:17,688] {result_logger:79} INFO - predicted:
[2024-10-16 23:58:17,688] {result_logger:80} INFO - 
[[86.95%  4.04%  9.01%]
 [39.76% 50.73%  9.50%]
 [30.75% 10.18% 59.07%]]
[2024-10-16 23:58:17,761] {train_model:92} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/step4E_august/Maiken/model_8conv_2fc-best.pth
[2024-10-16 23:58:17,761] {run_experiment_multiple_labs:112} INFO - [epoch   3] execution time: 478.85s	 avg f1-score: 0.6658

[2024-10-16 23:59:52,500] {train_model:80} INFO - Train Epoch: 4 [161792/1621534 (10%)]	lr:8.84e-05	Loss: 0.546737
[2024-10-17 00:00:21,629] {train_model:80} INFO - Train Epoch: 4 [323840/1621534 (20%)]	lr:8.84e-05	Loss: 0.326941
[2024-10-17 00:00:51,178] {train_model:80} INFO - Train Epoch: 4 [485888/1621534 (30%)]	lr:8.84e-05	Loss: 0.368343
[2024-10-17 00:01:20,890] {train_model:80} INFO - Train Epoch: 4 [647936/1621534 (40%)]	lr:8.84e-05	Loss: 0.571579
[2024-10-17 00:01:51,153] {train_model:80} INFO - Train Epoch: 4 [809984/1621534 (50%)]	lr:8.84e-05	Loss: 0.409208
[2024-10-17 00:02:21,216] {train_model:80} INFO - Train Epoch: 4 [972032/1621534 (60%)]	lr:8.84e-05	Loss: 0.265735
[2024-10-17 00:02:51,164] {train_model:80} INFO - Train Epoch: 4 [1134080/1621534 (70%)]	lr:8.84e-05	Loss: 0.317710
[2024-10-17 00:03:21,512] {train_model:80} INFO - Train Epoch: 4 [1296128/1621534 (80%)]	lr:8.84e-05	Loss: 4.868639
[2024-10-17 00:03:52,045] {train_model:80} INFO - Train Epoch: 4 [1458176/1621534 (90%)]	lr:8.84e-05	Loss: 0.524019
[2024-10-17 00:04:22,822] {train_model:80} INFO - Train Epoch: 4 [1620224/1621534 (100%)]	lr:8.84e-05	Loss: 8.977215
[2024-10-17 00:05:50,875] {run_experiment_multiple_labs:78} INFO - 
[2024-10-17 00:05:50,875] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-10-17 00:05:53,916] {result_logger:103} INFO - precision on Wake: 0.907
[2024-10-17 00:05:55,880] {result_logger:104} INFO - recall on Wake: 0.822
[2024-10-17 00:05:57,843] {result_logger:107} INFO - F1-score on Wake: 0.863
[2024-10-17 00:05:57,843] {result_logger:108} INFO - 
[2024-10-17 00:06:00,645] {result_logger:103} INFO - precision on REM: 0.422
[2024-10-17 00:06:02,422] {result_logger:104} INFO - recall on REM: 0.811
[2024-10-17 00:06:04,206] {result_logger:107} INFO - F1-score on REM: 0.556
[2024-10-17 00:06:04,206] {result_logger:108} INFO - 
[2024-10-17 00:06:07,262] {result_logger:103} INFO - precision on Non REM: 0.872
[2024-10-17 00:06:09,192] {result_logger:104} INFO - recall on Non REM: 0.861
[2024-10-17 00:06:11,163] {result_logger:107} INFO - F1-score on Non REM: 0.867
[2024-10-17 00:06:11,163] {result_logger:108} INFO - 
[2024-10-17 00:06:11,633] {result_logger:111} INFO - average precision on sleep stages: 0.734
[2024-10-17 00:06:12,102] {result_logger:113} INFO - average recall on sleep stages: 0.832
[2024-10-17 00:06:12,574] {result_logger:115} INFO - average F1-score on sleep stages: 0.762
[2024-10-17 00:06:12,579] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-10-17 00:06:13,038] {result_logger:103} INFO - precision on Wake: 0.843
[2024-10-17 00:06:13,313] {result_logger:104} INFO - recall on Wake: 0.927
[2024-10-17 00:06:13,590] {result_logger:107} INFO - F1-score on Wake: 0.883
[2024-10-17 00:06:13,590] {result_logger:108} INFO - 
[2024-10-17 00:06:14,038] {result_logger:103} INFO - precision on REM: 0.478
[2024-10-17 00:06:14,312] {result_logger:104} INFO - recall on REM: 0.824
[2024-10-17 00:06:14,585] {result_logger:107} INFO - F1-score on REM: 0.605
[2024-10-17 00:06:14,585] {result_logger:108} INFO - 
[2024-10-17 00:06:15,052] {result_logger:103} INFO - precision on Non REM: 0.954
[2024-10-17 00:06:15,333] {result_logger:104} INFO - recall on Non REM: 0.732
[2024-10-17 00:06:15,613] {result_logger:107} INFO - F1-score on Non REM: 0.828
[2024-10-17 00:06:15,613] {result_logger:108} INFO - 
[2024-10-17 00:06:15,669] {result_logger:111} INFO - average precision on sleep stages: 0.758
[2024-10-17 00:06:15,724] {result_logger:113} INFO - average recall on sleep stages: 0.827
[2024-10-17 00:06:15,779] {result_logger:115} INFO - average F1-score on sleep stages: 0.772
[2024-10-17 00:06:15,780] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-10-17 00:06:16,102] {result_logger:134} INFO - 
[[705297  73529  78948]
 [ 13101  78308   5094]
 [ 58956  33581 574720]]
[2024-10-17 00:06:16,423] {result_logger:141} INFO - 
[[ 82.22%   8.57%   9.20%]
 [ 13.58%  81.15%   5.28%]
 [  8.84%   5.03%  86.13%]]
[2024-10-17 00:06:16,746] {result_logger:145} INFO - 
[[ 90.73%  39.66%  11.98%]
 [  1.69%  42.23%   0.77%]
 [  7.58%  18.11%  87.24%]]
[2024-10-17 00:06:16,746] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-10-17 00:06:16,785] {result_logger:134} INFO - 
[[128561   6545   3596]
 [  2498  12854    251]
 [ 21463   7503  78940]]
[2024-10-17 00:06:16,900] {result_logger:141} INFO - 
[[ 92.69%   4.72%   2.59%]
 [ 16.01%  82.38%   1.61%]
 [ 19.89%   6.95%  73.16%]]
[2024-10-17 00:06:17,011] {result_logger:145} INFO - 
[[ 84.29%  24.33%   4.34%]
 [  1.64%  47.78%   0.30%]
 [ 14.07%  27.89%  95.35%]]
[2024-10-17 00:06:17,624] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-10-17 00:06:17,624] {result_logger:77} INFO - actual:
[2024-10-17 00:06:17,624] {result_logger:78} INFO - 
[[92.77%  0.10%  7.14%]
 [14.73% 66.42% 18.85%]
 [ 7.17%  4.73% 88.10%]]
[2024-10-17 00:06:17,625] {result_logger:79} INFO - predicted:
[2024-10-17 00:06:17,625] {result_logger:80} INFO - 
[[85.99%  4.24%  9.77%]
 [34.80% 49.49% 15.71%]
 [14.50%  8.60% 76.89%]]
[2024-10-17 00:06:17,696] {train_model:92} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/step4E_august/Maiken/model_8conv_2fc-best.pth
[2024-10-17 00:06:17,696] {run_experiment_multiple_labs:112} INFO - [epoch   4] execution time: 479.93s	 avg f1-score: 0.7719

[2024-10-17 00:07:52,823] {train_model:80} INFO - Train Epoch: 5 [161792/1621534 (10%)]	lr:1.09e-04	Loss: 0.267213
[2024-10-17 00:08:21,638] {train_model:80} INFO - Train Epoch: 5 [323840/1621534 (20%)]	lr:1.09e-04	Loss: 0.288996
[2024-10-17 00:08:50,777] {train_model:80} INFO - Train Epoch: 5 [485888/1621534 (30%)]	lr:1.09e-04	Loss: 1.743461
[2024-10-17 00:09:20,981] {train_model:80} INFO - Train Epoch: 5 [647936/1621534 (40%)]	lr:1.09e-04	Loss: 0.403530
[2024-10-17 00:09:51,043] {train_model:80} INFO - Train Epoch: 5 [809984/1621534 (50%)]	lr:1.09e-04	Loss: 5.077711
[2024-10-17 00:10:20,800] {train_model:80} INFO - Train Epoch: 5 [972032/1621534 (60%)]	lr:1.09e-04	Loss: 0.280378
[2024-10-17 00:10:50,817] {train_model:80} INFO - Train Epoch: 5 [1134080/1621534 (70%)]	lr:1.09e-04	Loss: 0.214846
[2024-10-17 00:11:20,973] {train_model:80} INFO - Train Epoch: 5 [1296128/1621534 (80%)]	lr:1.09e-04	Loss: 0.229370
[2024-10-17 00:11:51,312] {train_model:80} INFO - Train Epoch: 5 [1458176/1621534 (90%)]	lr:1.09e-04	Loss: 0.358770
[2024-10-17 00:12:22,242] {train_model:80} INFO - Train Epoch: 5 [1620224/1621534 (100%)]	lr:1.09e-04	Loss: 0.429144
[2024-10-17 00:13:50,383] {run_experiment_multiple_labs:78} INFO - 
[2024-10-17 00:13:50,384] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-10-17 00:13:53,387] {result_logger:103} INFO - precision on Wake: 0.918
[2024-10-17 00:13:55,385] {result_logger:104} INFO - recall on Wake: 0.841
[2024-10-17 00:13:57,421] {result_logger:107} INFO - F1-score on Wake: 0.878
[2024-10-17 00:13:57,421] {result_logger:108} INFO - 
[2024-10-17 00:14:00,302] {result_logger:103} INFO - precision on REM: 0.457
[2024-10-17 00:14:02,140] {result_logger:104} INFO - recall on REM: 0.833
[2024-10-17 00:14:04,001] {result_logger:107} INFO - F1-score on REM: 0.590
[2024-10-17 00:14:04,001] {result_logger:108} INFO - 
[2024-10-17 00:14:07,134] {result_logger:103} INFO - precision on Non REM: 0.883
[2024-10-17 00:14:09,188] {result_logger:104} INFO - recall on Non REM: 0.873
[2024-10-17 00:14:11,234] {result_logger:107} INFO - F1-score on Non REM: 0.878
[2024-10-17 00:14:11,234] {result_logger:108} INFO - 
[2024-10-17 00:14:11,716] {result_logger:111} INFO - average precision on sleep stages: 0.753
[2024-10-17 00:14:12,197] {result_logger:113} INFO - average recall on sleep stages: 0.849
[2024-10-17 00:14:12,679] {result_logger:115} INFO - average F1-score on sleep stages: 0.782
[2024-10-17 00:14:12,683] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-10-17 00:14:13,130] {result_logger:103} INFO - precision on Wake: 0.914
[2024-10-17 00:14:13,417] {result_logger:104} INFO - recall on Wake: 0.861
[2024-10-17 00:14:13,700] {result_logger:107} INFO - F1-score on Wake: 0.887
[2024-10-17 00:14:13,701] {result_logger:108} INFO - 
[2024-10-17 00:14:14,143] {result_logger:103} INFO - precision on REM: 0.404
[2024-10-17 00:14:14,423] {result_logger:104} INFO - recall on REM: 0.898
[2024-10-17 00:14:14,704] {result_logger:107} INFO - F1-score on REM: 0.557
[2024-10-17 00:14:14,704] {result_logger:108} INFO - 
[2024-10-17 00:14:15,159] {result_logger:103} INFO - precision on Non REM: 0.930
[2024-10-17 00:14:15,448] {result_logger:104} INFO - recall on Non REM: 0.835
[2024-10-17 00:14:15,736] {result_logger:107} INFO - F1-score on Non REM: 0.880
[2024-10-17 00:14:15,736] {result_logger:108} INFO - 
[2024-10-17 00:14:15,792] {result_logger:111} INFO - average precision on sleep stages: 0.749
[2024-10-17 00:14:15,847] {result_logger:113} INFO - average recall on sleep stages: 0.865
[2024-10-17 00:14:15,903] {result_logger:115} INFO - average F1-score on sleep stages: 0.774
[2024-10-17 00:14:15,904] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-10-17 00:14:16,236] {result_logger:134} INFO - 
[[721634  63945  72195]
 [ 11215  80416   4872]
 [ 52895  31721 582641]]
[2024-10-17 00:14:16,569] {result_logger:141} INFO - 
[[ 84.13%   7.45%   8.42%]
 [ 11.62%  83.33%   5.05%]
 [  7.93%   4.75%  87.32%]]
[2024-10-17 00:14:16,902] {result_logger:145} INFO - 
[[ 91.84%  36.32%  10.94%]
 [  1.43%  45.67%   0.74%]
 [  6.73%  18.01%  88.32%]]
[2024-10-17 00:14:16,902] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-10-17 00:14:16,941] {result_logger:134} INFO - 
[[119420  12865   6417]
 [  1212  14011    380]
 [ 10008   7841  90057]]
[2024-10-17 00:14:17,054] {result_logger:141} INFO - 
[[ 86.10%   9.28%   4.63%]
 [  7.77%  89.80%   2.44%]
 [  9.27%   7.27%  83.46%]]
[2024-10-17 00:14:17,164] {result_logger:145} INFO - 
[[ 91.41%  37.06%   6.63%]
 [  0.93%  40.36%   0.39%]
 [  7.66%  22.59%  92.98%]]
[2024-10-17 00:14:17,782] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-10-17 00:14:17,782] {result_logger:77} INFO - actual:
[2024-10-17 00:14:17,782] {result_logger:78} INFO - 
[[92.77%  0.10%  7.14%]
 [14.73% 66.42% 18.85%]
 [ 7.17%  4.73% 88.10%]]
[2024-10-17 00:14:17,782] {result_logger:79} INFO - predicted:
[2024-10-17 00:14:17,782] {result_logger:80} INFO - 
[[84.52%  6.51%  8.97%]
 [32.69% 50.00% 17.31%]
 [ 9.16%  9.14% 81.70%]]
[2024-10-17 00:14:17,853] {train_model:92} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/step4E_august/Maiken/model_8conv_2fc-best.pth
[2024-10-17 00:14:17,853] {run_experiment_multiple_labs:112} INFO - [epoch   5] execution time: 480.16s	 avg f1-score: 0.7744

[2024-10-17 00:15:52,535] {train_model:80} INFO - Train Epoch: 6 [161792/1621534 (10%)]	lr:1.30e-04	Loss: 0.403239
[2024-10-17 00:16:22,594] {train_model:80} INFO - Train Epoch: 6 [323840/1621534 (20%)]	lr:1.30e-04	Loss: 0.832754
[2024-10-17 00:16:52,966] {train_model:80} INFO - Train Epoch: 6 [485888/1621534 (30%)]	lr:1.30e-04	Loss: 0.382582
[2024-10-17 00:17:23,398] {train_model:80} INFO - Train Epoch: 6 [647936/1621534 (40%)]	lr:1.30e-04	Loss: 0.159502
[2024-10-17 00:17:53,559] {train_model:80} INFO - Train Epoch: 6 [809984/1621534 (50%)]	lr:1.30e-04	Loss: 0.308956
[2024-10-17 00:18:23,226] {train_model:80} INFO - Train Epoch: 6 [972032/1621534 (60%)]	lr:1.30e-04	Loss: 0.425255
[2024-10-17 00:18:54,074] {train_model:80} INFO - Train Epoch: 6 [1134080/1621534 (70%)]	lr:1.30e-04	Loss: 0.305667
[2024-10-17 00:19:24,249] {train_model:80} INFO - Train Epoch: 6 [1296128/1621534 (80%)]	lr:1.30e-04	Loss: 0.209699
[2024-10-17 00:19:54,743] {train_model:80} INFO - Train Epoch: 6 [1458176/1621534 (90%)]	lr:1.30e-04	Loss: 0.385312
[2024-10-17 00:20:25,048] {train_model:80} INFO - Train Epoch: 6 [1620224/1621534 (100%)]	lr:1.30e-04	Loss: 0.859138
[2024-10-17 00:21:52,818] {run_experiment_multiple_labs:78} INFO - 
[2024-10-17 00:21:52,819] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-10-17 00:21:55,770] {result_logger:103} INFO - precision on Wake: 0.928
[2024-10-17 00:21:57,735] {result_logger:104} INFO - recall on Wake: 0.856
[2024-10-17 00:21:59,739] {result_logger:107} INFO - F1-score on Wake: 0.891
[2024-10-17 00:21:59,739] {result_logger:108} INFO - 
[2024-10-17 00:22:02,505] {result_logger:103} INFO - precision on REM: 0.485
[2024-10-17 00:22:04,273] {result_logger:104} INFO - recall on REM: 0.851
[2024-10-17 00:22:06,018] {result_logger:107} INFO - F1-score on REM: 0.618
[2024-10-17 00:22:06,018] {result_logger:108} INFO - 
[2024-10-17 00:22:08,991] {result_logger:103} INFO - precision on Non REM: 0.890
[2024-10-17 00:22:10,963] {result_logger:104} INFO - recall on Non REM: 0.882
[2024-10-17 00:22:12,935] {result_logger:107} INFO - F1-score on Non REM: 0.886
[2024-10-17 00:22:12,935] {result_logger:108} INFO - 
[2024-10-17 00:22:13,408] {result_logger:111} INFO - average precision on sleep stages: 0.768
[2024-10-17 00:22:13,882] {result_logger:113} INFO - average recall on sleep stages: 0.863
[2024-10-17 00:22:14,354] {result_logger:115} INFO - average F1-score on sleep stages: 0.798
[2024-10-17 00:22:14,359] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-10-17 00:22:14,797] {result_logger:103} INFO - precision on Wake: 0.930
[2024-10-17 00:22:15,073] {result_logger:104} INFO - recall on Wake: 0.860
[2024-10-17 00:22:15,350] {result_logger:107} INFO - F1-score on Wake: 0.894
[2024-10-17 00:22:15,350] {result_logger:108} INFO - 
[2024-10-17 00:22:15,787] {result_logger:103} INFO - precision on REM: 0.405
[2024-10-17 00:22:16,061] {result_logger:104} INFO - recall on REM: 0.917
[2024-10-17 00:22:16,338] {result_logger:107} INFO - F1-score on REM: 0.562
[2024-10-17 00:22:16,338] {result_logger:108} INFO - 
[2024-10-17 00:22:16,786] {result_logger:103} INFO - precision on Non REM: 0.927
[2024-10-17 00:22:17,070] {result_logger:104} INFO - recall on Non REM: 0.847
[2024-10-17 00:22:17,350] {result_logger:107} INFO - F1-score on Non REM: 0.885
[2024-10-17 00:22:17,350] {result_logger:108} INFO - 
[2024-10-17 00:22:17,405] {result_logger:111} INFO - average precision on sleep stages: 0.754
[2024-10-17 00:22:17,461] {result_logger:113} INFO - average recall on sleep stages: 0.875
[2024-10-17 00:22:17,517] {result_logger:115} INFO - average F1-score on sleep stages: 0.780
[2024-10-17 00:22:17,518] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-10-17 00:22:17,841] {result_logger:134} INFO - 
[[734667  55591  67516]
 [  9513  82169   4821]
 [ 47400  31607 588250]]
[2024-10-17 00:22:18,165] {result_logger:141} INFO - 
[[ 85.65%   6.48%   7.87%]
 [  9.86%  85.15%   5.00%]
 [  7.10%   4.74%  88.16%]]
[2024-10-17 00:22:18,491] {result_logger:145} INFO - 
[[ 92.81%  32.82%  10.22%]
 [  1.20%  48.52%   0.73%]
 [  5.99%  18.66%  89.05%]]
[2024-10-17 00:22:18,491] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-10-17 00:22:18,530] {result_logger:134} INFO - 
[[119292  12647   6763]
 [   815  14309    479]
 [  8138   8336  91432]]
[2024-10-17 00:22:18,644] {result_logger:141} INFO - 
[[ 86.01%   9.12%   4.88%]
 [  5.22%  91.71%   3.07%]
 [  7.54%   7.73%  84.73%]]
[2024-10-17 00:22:18,755] {result_logger:145} INFO - 
[[ 93.02%  35.84%   6.85%]
 [  0.64%  40.54%   0.49%]
 [  6.35%  23.62%  92.66%]]
[2024-10-17 00:22:19,462] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-10-17 00:22:19,462] {result_logger:77} INFO - actual:
[2024-10-17 00:22:19,462] {result_logger:78} INFO - 
[[92.77%  0.10%  7.14%]
 [14.73% 66.42% 18.85%]
 [ 7.17%  4.73% 88.10%]]
[2024-10-17 00:22:19,462] {result_logger:79} INFO - predicted:
[2024-10-17 00:22:19,462] {result_logger:80} INFO - 
[[85.07%  6.26%  8.67%]
 [29.79% 53.59% 16.62%]
 [ 8.75%  8.47% 82.78%]]
[2024-10-17 00:22:19,533] {train_model:92} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/step4E_august/Maiken/model_8conv_2fc-best.pth
[2024-10-17 00:22:19,534] {run_experiment_multiple_labs:112} INFO - [epoch   6] execution time: 481.68s	 avg f1-score: 0.7804

[2024-10-17 00:23:54,072] {train_model:80} INFO - Train Epoch: 7 [161792/1621534 (10%)]	lr:1.51e-04	Loss: 0.332788
[2024-10-17 00:24:23,269] {train_model:80} INFO - Train Epoch: 7 [323840/1621534 (20%)]	lr:1.51e-04	Loss: 0.229623
[2024-10-17 00:24:52,290] {train_model:80} INFO - Train Epoch: 7 [485888/1621534 (30%)]	lr:1.51e-04	Loss: 0.602227
[2024-10-17 00:25:22,245] {train_model:80} INFO - Train Epoch: 7 [647936/1621534 (40%)]	lr:1.51e-04	Loss: 0.564093
[2024-10-17 00:25:51,919] {train_model:80} INFO - Train Epoch: 7 [809984/1621534 (50%)]	lr:1.51e-04	Loss: 0.322563
[2024-10-17 00:26:21,542] {train_model:80} INFO - Train Epoch: 7 [972032/1621534 (60%)]	lr:1.51e-04	Loss: 0.530767
[2024-10-17 00:26:51,874] {train_model:80} INFO - Train Epoch: 7 [1134080/1621534 (70%)]	lr:1.51e-04	Loss: 0.618708
[2024-10-17 00:27:22,395] {train_model:80} INFO - Train Epoch: 7 [1296128/1621534 (80%)]	lr:1.51e-04	Loss: 0.178748
[2024-10-17 00:27:53,138] {train_model:80} INFO - Train Epoch: 7 [1458176/1621534 (90%)]	lr:1.51e-04	Loss: 0.191940
[2024-10-17 00:28:24,325] {train_model:80} INFO - Train Epoch: 7 [1620224/1621534 (100%)]	lr:1.51e-04	Loss: 0.328932
[2024-10-17 00:29:52,051] {run_experiment_multiple_labs:78} INFO - 
[2024-10-17 00:29:52,051] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-10-17 00:29:55,014] {result_logger:103} INFO - precision on Wake: 0.935
[2024-10-17 00:29:56,991] {result_logger:104} INFO - recall on Wake: 0.873
[2024-10-17 00:29:59,018] {result_logger:107} INFO - F1-score on Wake: 0.903
[2024-10-17 00:29:59,018] {result_logger:108} INFO - 
[2024-10-17 00:30:01,831] {result_logger:103} INFO - precision on REM: 0.520
[2024-10-17 00:30:03,627] {result_logger:104} INFO - recall on REM: 0.864
[2024-10-17 00:30:05,405] {result_logger:107} INFO - F1-score on REM: 0.650
[2024-10-17 00:30:05,405] {result_logger:108} INFO - 
[2024-10-17 00:30:08,363] {result_logger:103} INFO - precision on Non REM: 0.898
[2024-10-17 00:30:10,318] {result_logger:104} INFO - recall on Non REM: 0.889
[2024-10-17 00:30:12,267] {result_logger:107} INFO - F1-score on Non REM: 0.894
[2024-10-17 00:30:12,268] {result_logger:108} INFO - 
[2024-10-17 00:30:12,735] {result_logger:111} INFO - average precision on sleep stages: 0.785
[2024-10-17 00:30:13,202] {result_logger:113} INFO - average recall on sleep stages: 0.875
[2024-10-17 00:30:13,672] {result_logger:115} INFO - average F1-score on sleep stages: 0.815
[2024-10-17 00:30:13,677] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-10-17 00:30:14,116] {result_logger:103} INFO - precision on Wake: 0.946
[2024-10-17 00:30:14,390] {result_logger:104} INFO - recall on Wake: 0.881
[2024-10-17 00:30:14,663] {result_logger:107} INFO - F1-score on Wake: 0.912
[2024-10-17 00:30:14,663] {result_logger:108} INFO - 
[2024-10-17 00:30:15,099] {result_logger:103} INFO - precision on REM: 0.533
[2024-10-17 00:30:15,370] {result_logger:104} INFO - recall on REM: 0.894
[2024-10-17 00:30:15,643] {result_logger:107} INFO - F1-score on REM: 0.668
[2024-10-17 00:30:15,643] {result_logger:108} INFO - 
[2024-10-17 00:30:16,088] {result_logger:103} INFO - precision on Non REM: 0.906
[2024-10-17 00:30:16,368] {result_logger:104} INFO - recall on Non REM: 0.898
[2024-10-17 00:30:16,644] {result_logger:107} INFO - F1-score on Non REM: 0.902
[2024-10-17 00:30:16,644] {result_logger:108} INFO - 
[2024-10-17 00:30:16,698] {result_logger:111} INFO - average precision on sleep stages: 0.795
[2024-10-17 00:30:16,751] {result_logger:113} INFO - average recall on sleep stages: 0.891
[2024-10-17 00:30:16,804] {result_logger:115} INFO - average F1-score on sleep stages: 0.827
[2024-10-17 00:30:16,805] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-10-17 00:30:17,130] {result_logger:134} INFO - 
[[748634  46665  62475]
 [  8364  83390   4749]
 [ 43593  30208 593456]]
[2024-10-17 00:30:17,454] {result_logger:141} INFO - 
[[ 87.28%   5.44%   7.28%]
 [  8.67%  86.41%   4.92%]
 [  6.53%   4.53%  88.94%]]
[2024-10-17 00:30:17,779] {result_logger:145} INFO - 
[[ 93.51%  29.12%   9.46%]
 [  1.04%  52.03%   0.72%]
 [  5.45%  18.85%  89.83%]]
[2024-10-17 00:30:17,779] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-10-17 00:30:17,817] {result_logger:134} INFO - 
[[122131   7303   9268]
 [   891  13945    767]
 [  6072   4918  96916]]
[2024-10-17 00:30:17,929] {result_logger:141} INFO - 
[[ 88.05%   5.27%   6.68%]
 [  5.71%  89.37%   4.92%]
 [  5.63%   4.56%  89.82%]]
[2024-10-17 00:30:18,038] {result_logger:145} INFO - 
[[ 94.61%  27.91%   8.67%]
 [  0.69%  53.29%   0.72%]
 [  4.70%  18.80%  90.62%]]
[2024-10-17 00:30:18,660] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-10-17 00:30:18,660] {result_logger:77} INFO - actual:
[2024-10-17 00:30:18,660] {result_logger:78} INFO - 
[[92.77%  0.10%  7.14%]
 [14.73% 66.42% 18.85%]
 [ 7.17%  4.73% 88.10%]]
[2024-10-17 00:30:18,661] {result_logger:79} INFO - predicted:
[2024-10-17 00:30:18,661] {result_logger:80} INFO - 
[[87.16%  3.90%  8.94%]
 [28.01% 52.57% 19.42%]
 [ 8.64%  6.90% 84.46%]]
[2024-10-17 00:30:18,732] {train_model:92} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/step4E_august/Maiken/model_8conv_2fc-best.pth
[2024-10-17 00:30:18,732] {run_experiment_multiple_labs:112} INFO - [epoch   7] execution time: 479.20s	 avg f1-score: 0.8273

[2024-10-17 00:31:53,843] {train_model:80} INFO - Train Epoch: 8 [161792/1621534 (10%)]	lr:1.72e-04	Loss: 0.400305
[2024-10-17 00:32:23,081] {train_model:80} INFO - Train Epoch: 8 [323840/1621534 (20%)]	lr:1.72e-04	Loss: 0.294594
[2024-10-17 00:32:52,447] {train_model:80} INFO - Train Epoch: 8 [485888/1621534 (30%)]	lr:1.72e-04	Loss: 0.200565
[2024-10-17 00:33:21,932] {train_model:80} INFO - Train Epoch: 8 [647936/1621534 (40%)]	lr:1.72e-04	Loss: 0.248479
[2024-10-17 00:33:51,540] {train_model:80} INFO - Train Epoch: 8 [809984/1621534 (50%)]	lr:1.72e-04	Loss: 0.459989
[2024-10-17 00:34:21,206] {train_model:80} INFO - Train Epoch: 8 [972032/1621534 (60%)]	lr:1.72e-04	Loss: 0.254126
[2024-10-17 00:34:51,553] {train_model:80} INFO - Train Epoch: 8 [1134080/1621534 (70%)]	lr:1.72e-04	Loss: 0.387369
[2024-10-17 00:35:22,175] {train_model:80} INFO - Train Epoch: 8 [1296128/1621534 (80%)]	lr:1.72e-04	Loss: 0.192683
[2024-10-17 00:35:53,309] {train_model:80} INFO - Train Epoch: 8 [1458176/1621534 (90%)]	lr:1.72e-04	Loss: 0.194440
[2024-10-17 00:36:24,166] {train_model:80} INFO - Train Epoch: 8 [1620224/1621534 (100%)]	lr:1.72e-04	Loss: 0.304005
[2024-10-17 00:37:51,934] {run_experiment_multiple_labs:78} INFO - 
[2024-10-17 00:37:51,935] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-10-17 00:37:54,949] {result_logger:103} INFO - precision on Wake: 0.942
[2024-10-17 00:37:56,934] {result_logger:104} INFO - recall on Wake: 0.879
[2024-10-17 00:37:58,928] {result_logger:107} INFO - F1-score on Wake: 0.910
[2024-10-17 00:37:58,928] {result_logger:108} INFO - 
[2024-10-17 00:38:01,684] {result_logger:103} INFO - precision on REM: 0.535
[2024-10-17 00:38:03,419] {result_logger:104} INFO - recall on REM: 0.875
[2024-10-17 00:38:05,172] {result_logger:107} INFO - F1-score on REM: 0.664
[2024-10-17 00:38:05,172] {result_logger:108} INFO - 
[2024-10-17 00:38:08,166] {result_logger:103} INFO - precision on Non REM: 0.902
[2024-10-17 00:38:10,097] {result_logger:104} INFO - recall on Non REM: 0.896
[2024-10-17 00:38:12,040] {result_logger:107} INFO - F1-score on Non REM: 0.899
[2024-10-17 00:38:12,040] {result_logger:108} INFO - 
[2024-10-17 00:38:12,504] {result_logger:111} INFO - average precision on sleep stages: 0.793
[2024-10-17 00:38:12,966] {result_logger:113} INFO - average recall on sleep stages: 0.884
[2024-10-17 00:38:13,433] {result_logger:115} INFO - average F1-score on sleep stages: 0.824
[2024-10-17 00:38:13,438] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-10-17 00:38:13,891] {result_logger:103} INFO - precision on Wake: 0.938
[2024-10-17 00:38:14,166] {result_logger:104} INFO - recall on Wake: 0.910
[2024-10-17 00:38:14,444] {result_logger:107} INFO - F1-score on Wake: 0.924
[2024-10-17 00:38:14,444] {result_logger:108} INFO - 
[2024-10-17 00:38:14,886] {result_logger:103} INFO - precision on REM: 0.540
[2024-10-17 00:38:15,156] {result_logger:104} INFO - recall on REM: 0.903
[2024-10-17 00:38:15,429] {result_logger:107} INFO - F1-score on REM: 0.676
[2024-10-17 00:38:15,429] {result_logger:108} INFO - 
[2024-10-17 00:38:15,889] {result_logger:103} INFO - precision on Non REM: 0.929
[2024-10-17 00:38:16,171] {result_logger:104} INFO - recall on Non REM: 0.875
[2024-10-17 00:38:16,449] {result_logger:107} INFO - F1-score on Non REM: 0.901
[2024-10-17 00:38:16,449] {result_logger:108} INFO - 
[2024-10-17 00:38:16,504] {result_logger:111} INFO - average precision on sleep stages: 0.802
[2024-10-17 00:38:16,559] {result_logger:113} INFO - average recall on sleep stages: 0.896
[2024-10-17 00:38:16,613] {result_logger:115} INFO - average F1-score on sleep stages: 0.833
[2024-10-17 00:38:16,614] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-10-17 00:38:16,936] {result_logger:134} INFO - 
[[754373  43316  60085]
 [  7229  84435   4839]
 [ 39279  29987 597991]]
[2024-10-17 00:38:17,259] {result_logger:141} INFO - 
[[ 87.95%   5.05%   7.00%]
 [  7.49%  87.49%   5.01%]
 [  5.89%   4.49%  89.62%]]
[2024-10-17 00:38:17,581] {result_logger:145} INFO - 
[[ 94.19%  27.46%   9.06%]
 [  0.90%  53.53%   0.73%]
 [  4.90%  19.01%  90.21%]]
[2024-10-17 00:38:17,581] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-10-17 00:38:17,619] {result_logger:134} INFO - 
[[126172   5719   6811]
 [  1126  14082    395]
 [  7240   6275  94391]]
[2024-10-17 00:38:17,735] {result_logger:141} INFO - 
[[ 90.97%   4.12%   4.91%]
 [  7.22%  90.25%   2.53%]
 [  6.71%   5.82%  87.48%]]
[2024-10-17 00:38:17,845] {result_logger:145} INFO - 
[[ 93.78%  21.93%   6.70%]
 [  0.84%  54.00%   0.39%]
 [  5.38%  24.06%  92.91%]]
[2024-10-17 00:38:18,492] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-10-17 00:38:18,492] {result_logger:77} INFO - actual:
[2024-10-17 00:38:18,493] {result_logger:78} INFO - 
[[92.77%  0.10%  7.14%]
 [14.73% 66.42% 18.85%]
 [ 7.17%  4.73% 88.10%]]
[2024-10-17 00:38:18,493] {result_logger:79} INFO - predicted:
[2024-10-17 00:38:18,493] {result_logger:80} INFO - 
[[88.35%  3.39%  8.26%]
 [26.87% 52.71% 20.42%]
 [ 8.53%  7.65% 83.82%]]
[2024-10-17 00:38:18,564] {train_model:92} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/step4E_august/Maiken/model_8conv_2fc-best.pth
[2024-10-17 00:38:18,564] {run_experiment_multiple_labs:112} INFO - [epoch   8] execution time: 479.83s	 avg f1-score: 0.8335

[2024-10-17 00:39:53,525] {train_model:80} INFO - Train Epoch: 9 [161792/1621534 (10%)]	lr:1.93e-04	Loss: 0.230021
[2024-10-17 00:40:22,956] {train_model:80} INFO - Train Epoch: 9 [323840/1621534 (20%)]	lr:1.93e-04	Loss: 0.167820
[2024-10-17 00:40:52,350] {train_model:80} INFO - Train Epoch: 9 [485888/1621534 (30%)]	lr:1.93e-04	Loss: 0.337291
[2024-10-17 00:41:22,030] {train_model:80} INFO - Train Epoch: 9 [647936/1621534 (40%)]	lr:1.93e-04	Loss: 0.349631
[2024-10-17 00:41:52,027] {train_model:80} INFO - Train Epoch: 9 [809984/1621534 (50%)]	lr:1.93e-04	Loss: 0.281287
[2024-10-17 00:42:22,186] {train_model:80} INFO - Train Epoch: 9 [972032/1621534 (60%)]	lr:1.93e-04	Loss: 0.273089
[2024-10-17 00:42:52,597] {train_model:80} INFO - Train Epoch: 9 [1134080/1621534 (70%)]	lr:1.93e-04	Loss: 0.178909
[2024-10-17 00:43:23,770] {train_model:80} INFO - Train Epoch: 9 [1296128/1621534 (80%)]	lr:1.93e-04	Loss: 0.140902
[2024-10-17 00:43:54,963] {train_model:80} INFO - Train Epoch: 9 [1458176/1621534 (90%)]	lr:1.93e-04	Loss: 0.266403
[2024-10-17 00:44:25,799] {train_model:80} INFO - Train Epoch: 9 [1620224/1621534 (100%)]	lr:1.93e-04	Loss: 0.154020
[2024-10-17 00:45:55,813] {run_experiment_multiple_labs:78} INFO - 
[2024-10-17 00:45:55,814] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-10-17 00:45:58,745] {result_logger:103} INFO - precision on Wake: 0.949
[2024-10-17 00:46:00,738] {result_logger:104} INFO - recall on Wake: 0.883
[2024-10-17 00:46:02,733] {result_logger:107} INFO - F1-score on Wake: 0.915
[2024-10-17 00:46:02,733] {result_logger:108} INFO - 
[2024-10-17 00:46:05,464] {result_logger:103} INFO - precision on REM: 0.541
[2024-10-17 00:46:07,167] {result_logger:104} INFO - recall on REM: 0.888
[2024-10-17 00:46:08,926] {result_logger:107} INFO - F1-score on REM: 0.672
[2024-10-17 00:46:08,926] {result_logger:108} INFO - 
[2024-10-17 00:46:11,890] {result_logger:103} INFO - precision on Non REM: 0.906
[2024-10-17 00:46:13,860] {result_logger:104} INFO - recall on Non REM: 0.902
[2024-10-17 00:46:15,796] {result_logger:107} INFO - F1-score on Non REM: 0.904
[2024-10-17 00:46:15,797] {result_logger:108} INFO - 
[2024-10-17 00:46:16,280] {result_logger:111} INFO - average precision on sleep stages: 0.799
[2024-10-17 00:46:16,764] {result_logger:113} INFO - average recall on sleep stages: 0.891
[2024-10-17 00:46:17,248] {result_logger:115} INFO - average F1-score on sleep stages: 0.830
[2024-10-17 00:46:17,252] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-10-17 00:46:17,698] {result_logger:103} INFO - precision on Wake: 0.950
[2024-10-17 00:46:17,974] {result_logger:104} INFO - recall on Wake: 0.913
[2024-10-17 00:46:18,248] {result_logger:107} INFO - F1-score on Wake: 0.931
[2024-10-17 00:46:18,248] {result_logger:108} INFO - 
[2024-10-17 00:46:18,691] {result_logger:103} INFO - precision on REM: 0.605
[2024-10-17 00:46:18,962] {result_logger:104} INFO - recall on REM: 0.894
[2024-10-17 00:46:19,235] {result_logger:107} INFO - F1-score on REM: 0.721
[2024-10-17 00:46:19,235] {result_logger:108} INFO - 
[2024-10-17 00:46:19,688] {result_logger:103} INFO - precision on Non REM: 0.917
[2024-10-17 00:46:19,967] {result_logger:104} INFO - recall on Non REM: 0.900
[2024-10-17 00:46:20,245] {result_logger:107} INFO - F1-score on Non REM: 0.909
[2024-10-17 00:46:20,245] {result_logger:108} INFO - 
[2024-10-17 00:46:20,299] {result_logger:111} INFO - average precision on sleep stages: 0.824
[2024-10-17 00:46:20,353] {result_logger:113} INFO - average recall on sleep stages: 0.902
[2024-10-17 00:46:20,407] {result_logger:115} INFO - average F1-score on sleep stages: 0.854
[2024-10-17 00:46:20,408] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-10-17 00:46:20,740] {result_logger:134} INFO - 
[[757412  42307  58055]
 [  6248  85663   4592]
 [ 34833  30297 602127]]
[2024-10-17 00:46:21,076] {result_logger:141} INFO - 
[[ 88.30%   4.93%   6.77%]
 [  6.47%  88.77%   4.76%]
 [  5.22%   4.54%  90.24%]]
[2024-10-17 00:46:21,410] {result_logger:145} INFO - 
[[ 94.86%  26.73%   8.73%]
 [  0.78%  54.13%   0.69%]
 [  4.36%  19.14%  90.58%]]
[2024-10-17 00:46:21,410] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-10-17 00:46:21,448] {result_logger:134} INFO - 
[[126594   3968   8140]
 [  1054  13942    607]
 [  5600   5147  97159]]
[2024-10-17 00:46:21,561] {result_logger:141} INFO - 
[[ 91.27%   2.86%   5.87%]
 [  6.76%  89.35%   3.89%]
 [  5.19%   4.77%  90.04%]]
[2024-10-17 00:46:21,670] {result_logger:145} INFO - 
[[ 95.01%  17.21%   7.69%]
 [  0.79%  60.47%   0.57%]
 [  4.20%  22.32%  91.74%]]
[2024-10-17 00:46:22,282] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-10-17 00:46:22,282] {result_logger:77} INFO - actual:
[2024-10-17 00:46:22,282] {result_logger:78} INFO - 
[[92.77%  0.10%  7.14%]
 [14.73% 66.42% 18.85%]
 [ 7.17%  4.73% 88.10%]]
[2024-10-17 00:46:22,282] {result_logger:79} INFO - predicted:
[2024-10-17 00:46:22,283] {result_logger:80} INFO - 
[[89.31%  2.40%  8.29%]
 [23.95% 54.40% 21.66%]
 [ 8.23%  6.91% 84.86%]]
[2024-10-17 00:46:22,353] {train_model:92} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/step4E_august/Maiken/model_8conv_2fc-best.pth
[2024-10-17 00:46:22,353] {run_experiment_multiple_labs:112} INFO - [epoch   9] execution time: 483.79s	 avg f1-score: 0.8537

[2024-10-17 00:47:57,484] {train_model:80} INFO - Train Epoch: 10 [161792/1621534 (10%)]	lr:2.14e-04	Loss: 0.177215
[2024-10-17 00:48:27,256] {train_model:80} INFO - Train Epoch: 10 [323840/1621534 (20%)]	lr:2.14e-04	Loss: 0.400631
[2024-10-17 00:48:57,724] {train_model:80} INFO - Train Epoch: 10 [485888/1621534 (30%)]	lr:2.14e-04	Loss: 0.214854
[2024-10-17 00:49:27,273] {train_model:80} INFO - Train Epoch: 10 [647936/1621534 (40%)]	lr:2.14e-04	Loss: 0.964003
[2024-10-17 00:49:56,539] {train_model:80} INFO - Train Epoch: 10 [809984/1621534 (50%)]	lr:2.14e-04	Loss: 0.241291
[2024-10-17 00:50:26,320] {train_model:80} INFO - Train Epoch: 10 [972032/1621534 (60%)]	lr:2.14e-04	Loss: 0.248818
[2024-10-17 00:50:56,680] {train_model:80} INFO - Train Epoch: 10 [1134080/1621534 (70%)]	lr:2.14e-04	Loss: 0.236702
[2024-10-17 00:51:26,729] {train_model:80} INFO - Train Epoch: 10 [1296128/1621534 (80%)]	lr:2.14e-04	Loss: 0.135512
[2024-10-17 00:51:56,812] {train_model:80} INFO - Train Epoch: 10 [1458176/1621534 (90%)]	lr:2.14e-04	Loss: 0.223932
[2024-10-17 00:52:27,034] {train_model:80} INFO - Train Epoch: 10 [1620224/1621534 (100%)]	lr:2.14e-04	Loss: 0.285071
[2024-10-17 00:53:56,339] {run_experiment_multiple_labs:78} INFO - 
[2024-10-17 00:53:56,339] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-10-17 00:53:59,287] {result_logger:103} INFO - precision on Wake: 0.953
[2024-10-17 00:54:01,255] {result_logger:104} INFO - recall on Wake: 0.887
[2024-10-17 00:54:03,207] {result_logger:107} INFO - F1-score on Wake: 0.919
[2024-10-17 00:54:03,207] {result_logger:108} INFO - 
[2024-10-17 00:54:05,911] {result_logger:103} INFO - precision on REM: 0.552
[2024-10-17 00:54:07,630] {result_logger:104} INFO - recall on REM: 0.895
[2024-10-17 00:54:09,356] {result_logger:107} INFO - F1-score on REM: 0.683
[2024-10-17 00:54:09,356] {result_logger:108} INFO - 
[2024-10-17 00:54:12,277] {result_logger:103} INFO - precision on Non REM: 0.908
[2024-10-17 00:54:14,193] {result_logger:104} INFO - recall on Non REM: 0.908
[2024-10-17 00:54:16,132] {result_logger:107} INFO - F1-score on Non REM: 0.908
[2024-10-17 00:54:16,132] {result_logger:108} INFO - 
[2024-10-17 00:54:16,600] {result_logger:111} INFO - average precision on sleep stages: 0.804
[2024-10-17 00:54:17,070] {result_logger:113} INFO - average recall on sleep stages: 0.896
[2024-10-17 00:54:17,538] {result_logger:115} INFO - average F1-score on sleep stages: 0.836
[2024-10-17 00:54:17,543] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-10-17 00:54:17,985] {result_logger:103} INFO - precision on Wake: 0.962
[2024-10-17 00:54:18,257] {result_logger:104} INFO - recall on Wake: 0.874
[2024-10-17 00:54:18,532] {result_logger:107} INFO - F1-score on Wake: 0.916
[2024-10-17 00:54:18,532] {result_logger:108} INFO - 
[2024-10-17 00:54:18,960] {result_logger:103} INFO - precision on REM: 0.483
[2024-10-17 00:54:19,225] {result_logger:104} INFO - recall on REM: 0.942
[2024-10-17 00:54:19,495] {result_logger:107} INFO - F1-score on REM: 0.639
[2024-10-17 00:54:19,495] {result_logger:108} INFO - 
[2024-10-17 00:54:19,937] {result_logger:103} INFO - precision on Non REM: 0.920
[2024-10-17 00:54:20,210] {result_logger:104} INFO - recall on Non REM: 0.902
[2024-10-17 00:54:20,485] {result_logger:107} INFO - F1-score on Non REM: 0.911
[2024-10-17 00:54:20,485] {result_logger:108} INFO - 
[2024-10-17 00:54:20,541] {result_logger:111} INFO - average precision on sleep stages: 0.789
[2024-10-17 00:54:20,596] {result_logger:113} INFO - average recall on sleep stages: 0.906
[2024-10-17 00:54:20,651] {result_logger:115} INFO - average F1-score on sleep stages: 0.822
[2024-10-17 00:54:20,652] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-10-17 00:54:20,974] {result_logger:134} INFO - 
[[760775  40488  56511]
 [  5633  86332   4538]
 [ 31851  29654 605752]]
[2024-10-17 00:54:21,298] {result_logger:141} INFO - 
[[ 88.69%   4.72%   6.59%]
 [  5.84%  89.46%   4.70%]
 [  4.77%   4.44%  90.78%]]
[2024-10-17 00:54:21,624] {result_logger:145} INFO - 
[[ 95.30%  25.88%   8.47%]
 [  0.71%  55.17%   0.68%]
 [  3.99%  18.95%  90.84%]]
[2024-10-17 00:54:21,624] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-10-17 00:54:21,663] {result_logger:134} INFO - 
[[121284   9456   7962]
 [   409  14695    499]
 [  4362   6244  97300]]
[2024-10-17 00:54:21,701] {result_logger:141} INFO - 
[[ 87.44%   6.82%   5.74%]
 [  2.62%  94.18%   3.20%]
 [  4.04%   5.79%  90.17%]]
[2024-10-17 00:54:21,740] {result_logger:145} INFO - 
[[ 96.22%  31.11%   7.53%]
 [  0.32%  48.35%   0.47%]
 [  3.46%  20.54%  92.00%]]
[2024-10-17 00:54:22,219] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-10-17 00:54:22,219] {result_logger:77} INFO - actual:
[2024-10-17 00:54:22,219] {result_logger:78} INFO - 
[[92.77%  0.10%  7.14%]
 [14.73% 66.42% 18.85%]
 [ 7.17%  4.73% 88.10%]]
[2024-10-17 00:54:22,219] {result_logger:79} INFO - predicted:
[2024-10-17 00:54:22,219] {result_logger:80} INFO - 
[[87.48%  4.78%  7.74%]
 [27.25% 52.48% 20.27%]
 [ 7.09%  7.96% 84.95%]]
[2024-10-17 00:54:22,219] {run_experiment_multiple_labs:112} INFO - [epoch  10] execution time: 479.87s	 avg f1-score: 0.8220

[2024-10-17 00:55:56,614] {train_model:80} INFO - Train Epoch: 11 [161792/1621534 (10%)]	lr:2.35e-04	Loss: 0.160879
[2024-10-17 00:56:26,118] {train_model:80} INFO - Train Epoch: 11 [323840/1621534 (20%)]	lr:2.35e-04	Loss: 0.195014
[2024-10-17 00:56:55,844] {train_model:80} INFO - Train Epoch: 11 [485888/1621534 (30%)]	lr:2.35e-04	Loss: 0.153826
[2024-10-17 00:57:25,046] {train_model:80} INFO - Train Epoch: 11 [647936/1621534 (40%)]	lr:2.35e-04	Loss: 0.183893
[2024-10-17 00:57:54,863] {train_model:80} INFO - Train Epoch: 11 [809984/1621534 (50%)]	lr:2.35e-04	Loss: 0.201878
[2024-10-17 00:58:24,456] {train_model:80} INFO - Train Epoch: 11 [972032/1621534 (60%)]	lr:2.35e-04	Loss: 0.170769
[2024-10-17 00:58:54,108] {train_model:80} INFO - Train Epoch: 11 [1134080/1621534 (70%)]	lr:2.35e-04	Loss: 0.244864
[2024-10-17 00:59:24,045] {train_model:80} INFO - Train Epoch: 11 [1296128/1621534 (80%)]	lr:2.35e-04	Loss: 0.262333
[2024-10-17 00:59:54,250] {train_model:80} INFO - Train Epoch: 11 [1458176/1621534 (90%)]	lr:2.35e-04	Loss: 0.179224
[2024-10-17 01:00:24,494] {train_model:80} INFO - Train Epoch: 11 [1620224/1621534 (100%)]	lr:2.35e-04	Loss: 0.213658
[2024-10-17 01:01:56,242] {run_experiment_multiple_labs:78} INFO - 
[2024-10-17 01:01:56,242] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-10-17 01:01:59,181] {result_logger:103} INFO - precision on Wake: 0.955
[2024-10-17 01:02:01,162] {result_logger:104} INFO - recall on Wake: 0.892
[2024-10-17 01:02:03,130] {result_logger:107} INFO - F1-score on Wake: 0.923
[2024-10-17 01:02:03,130] {result_logger:108} INFO - 
[2024-10-17 01:02:05,822] {result_logger:103} INFO - precision on REM: 0.563
[2024-10-17 01:02:07,560] {result_logger:104} INFO - recall on REM: 0.898
[2024-10-17 01:02:09,337] {result_logger:107} INFO - F1-score on REM: 0.692
[2024-10-17 01:02:09,337] {result_logger:108} INFO - 
[2024-10-17 01:02:12,266] {result_logger:103} INFO - precision on Non REM: 0.912
[2024-10-17 01:02:14,209] {result_logger:104} INFO - recall on Non REM: 0.911
[2024-10-17 01:02:16,167] {result_logger:107} INFO - F1-score on Non REM: 0.911
[2024-10-17 01:02:16,167] {result_logger:108} INFO - 
[2024-10-17 01:02:16,638] {result_logger:111} INFO - average precision on sleep stages: 0.810
[2024-10-17 01:02:17,110] {result_logger:113} INFO - average recall on sleep stages: 0.900
[2024-10-17 01:02:17,582] {result_logger:115} INFO - average F1-score on sleep stages: 0.842
[2024-10-17 01:02:17,587] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-10-17 01:02:18,023] {result_logger:103} INFO - precision on Wake: 0.963
[2024-10-17 01:02:18,294] {result_logger:104} INFO - recall on Wake: 0.905
[2024-10-17 01:02:18,573] {result_logger:107} INFO - F1-score on Wake: 0.933
[2024-10-17 01:02:18,573] {result_logger:108} INFO - 
[2024-10-17 01:02:19,010] {result_logger:103} INFO - precision on REM: 0.575
[2024-10-17 01:02:19,284] {result_logger:104} INFO - recall on REM: 0.909
[2024-10-17 01:02:19,560] {result_logger:107} INFO - F1-score on REM: 0.704
[2024-10-17 01:02:19,560] {result_logger:108} INFO - 
[2024-10-17 01:02:20,016] {result_logger:103} INFO - precision on Non REM: 0.921
[2024-10-17 01:02:20,296] {result_logger:104} INFO - recall on Non REM: 0.915
[2024-10-17 01:02:20,576] {result_logger:107} INFO - F1-score on Non REM: 0.918
[2024-10-17 01:02:20,577] {result_logger:108} INFO - 
[2024-10-17 01:02:20,630] {result_logger:111} INFO - average precision on sleep stages: 0.820
[2024-10-17 01:02:20,684] {result_logger:113} INFO - average recall on sleep stages: 0.910
[2024-10-17 01:02:20,737] {result_logger:115} INFO - average F1-score on sleep stages: 0.852
[2024-10-17 01:02:20,738] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-10-17 01:02:21,064] {result_logger:134} INFO - 
[[765342  38153  54279]
 [  5320  86622   4561]
 [ 30410  28986 607861]]
[2024-10-17 01:02:21,388] {result_logger:141} INFO - 
[[ 89.22%   4.45%   6.33%]
 [  5.51%  89.76%   4.73%]
 [  4.56%   4.34%  91.10%]]
[2024-10-17 01:02:21,714] {result_logger:145} INFO - 
[[ 95.54%  24.81%   8.14%]
 [  0.66%  56.34%   0.68%]
 [  3.80%  18.85%  91.17%]]
[2024-10-17 01:02:21,714] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-10-17 01:02:21,752] {result_logger:134} INFO - 
[[125584   5321   7797]
 [   762  14190    651]
 [  4031   5174  98701]]
[2024-10-17 01:02:21,790] {result_logger:141} INFO - 
[[ 90.54%   3.84%   5.62%]
 [  4.88%  90.94%   4.17%]
 [  3.74%   4.79%  91.47%]]
[2024-10-17 01:02:21,827] {result_logger:145} INFO - 
[[ 96.32%  21.56%   7.28%]
 [  0.58%  57.48%   0.61%]
 [  3.09%  20.96%  92.12%]]
[2024-10-17 01:02:22,302] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-10-17 01:02:22,302] {result_logger:77} INFO - actual:
[2024-10-17 01:02:22,302] {result_logger:78} INFO - 
[[92.77%  0.10%  7.14%]
 [14.73% 66.42% 18.85%]
 [ 7.17%  4.73% 88.10%]]
[2024-10-17 01:02:22,302] {result_logger:79} INFO - predicted:
[2024-10-17 01:02:22,302] {result_logger:80} INFO - 
[[89.53%  2.94%  7.53%]
 [24.04% 53.49% 22.46%]
 [ 7.21%  7.14% 85.66%]]
[2024-10-17 01:02:22,302] {run_experiment_multiple_labs:112} INFO - [epoch  11] execution time: 480.08s	 avg f1-score: 0.8519

[2024-10-17 01:03:58,070] {train_model:80} INFO - Train Epoch: 12 [161792/1621534 (10%)]	lr:2.56e-04	Loss: 0.212144
[2024-10-17 01:04:27,397] {train_model:80} INFO - Train Epoch: 12 [323840/1621534 (20%)]	lr:2.56e-04	Loss: 0.391988
[2024-10-17 01:04:56,940] {train_model:80} INFO - Train Epoch: 12 [485888/1621534 (30%)]	lr:2.56e-04	Loss: 0.339520
[2024-10-17 01:05:26,394] {train_model:80} INFO - Train Epoch: 12 [647936/1621534 (40%)]	lr:2.56e-04	Loss: 0.270035
[2024-10-17 01:05:56,012] {train_model:80} INFO - Train Epoch: 12 [809984/1621534 (50%)]	lr:2.56e-04	Loss: 0.203874
[2024-10-17 01:06:25,682] {train_model:80} INFO - Train Epoch: 12 [972032/1621534 (60%)]	lr:2.56e-04	Loss: 0.177011
[2024-10-17 01:06:55,583] {train_model:80} INFO - Train Epoch: 12 [1134080/1621534 (70%)]	lr:2.56e-04	Loss: 0.181557
[2024-10-17 01:07:26,366] {train_model:80} INFO - Train Epoch: 12 [1296128/1621534 (80%)]	lr:2.56e-04	Loss: 0.235143
[2024-10-17 01:07:57,317] {train_model:80} INFO - Train Epoch: 12 [1458176/1621534 (90%)]	lr:2.56e-04	Loss: 0.293282
[2024-10-17 01:08:28,134] {train_model:80} INFO - Train Epoch: 12 [1620224/1621534 (100%)]	lr:2.56e-04	Loss: 0.230322
[2024-10-17 01:09:56,988] {run_experiment_multiple_labs:78} INFO - 
[2024-10-17 01:09:56,989] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-10-17 01:09:59,965] {result_logger:103} INFO - precision on Wake: 0.957
[2024-10-17 01:10:01,969] {result_logger:104} INFO - recall on Wake: 0.895
[2024-10-17 01:10:03,970] {result_logger:107} INFO - F1-score on Wake: 0.925
[2024-10-17 01:10:03,970] {result_logger:108} INFO - 
[2024-10-17 01:10:06,740] {result_logger:103} INFO - precision on REM: 0.571
[2024-10-17 01:10:08,501] {result_logger:104} INFO - recall on REM: 0.901
[2024-10-17 01:10:10,286] {result_logger:107} INFO - F1-score on REM: 0.699
[2024-10-17 01:10:10,286] {result_logger:108} INFO - 
[2024-10-17 01:10:13,276] {result_logger:103} INFO - precision on Non REM: 0.914
[2024-10-17 01:10:15,264] {result_logger:104} INFO - recall on Non REM: 0.914
[2024-10-17 01:10:17,217] {result_logger:107} INFO - F1-score on Non REM: 0.914
[2024-10-17 01:10:17,217] {result_logger:108} INFO - 
[2024-10-17 01:10:17,674] {result_logger:111} INFO - average precision on sleep stages: 0.814
[2024-10-17 01:10:18,131] {result_logger:113} INFO - average recall on sleep stages: 0.903
[2024-10-17 01:10:18,587] {result_logger:115} INFO - average F1-score on sleep stages: 0.846
[2024-10-17 01:10:18,592] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-10-17 01:10:19,026] {result_logger:103} INFO - precision on Wake: 0.962
[2024-10-17 01:10:19,298] {result_logger:104} INFO - recall on Wake: 0.908
[2024-10-17 01:10:19,568] {result_logger:107} INFO - F1-score on Wake: 0.934
[2024-10-17 01:10:19,568] {result_logger:108} INFO - 
[2024-10-17 01:10:19,995] {result_logger:103} INFO - precision on REM: 0.595
[2024-10-17 01:10:20,259] {result_logger:104} INFO - recall on REM: 0.913
[2024-10-17 01:10:20,533] {result_logger:107} INFO - F1-score on REM: 0.720
[2024-10-17 01:10:20,533] {result_logger:108} INFO - 
[2024-10-17 01:10:20,979] {result_logger:103} INFO - precision on Non REM: 0.922
[2024-10-17 01:10:21,262] {result_logger:104} INFO - recall on Non REM: 0.917
[2024-10-17 01:10:21,539] {result_logger:107} INFO - F1-score on Non REM: 0.920
[2024-10-17 01:10:21,540] {result_logger:108} INFO - 
[2024-10-17 01:10:21,593] {result_logger:111} INFO - average precision on sleep stages: 0.826
[2024-10-17 01:10:21,647] {result_logger:113} INFO - average recall on sleep stages: 0.912
[2024-10-17 01:10:21,701] {result_logger:115} INFO - average F1-score on sleep stages: 0.858
[2024-10-17 01:10:21,702] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-10-17 01:10:22,018] {result_logger:134} INFO - 
[[767550  37144  53080]
 [  5120  86955   4428]
 [ 29267  28243 609747]]
[2024-10-17 01:10:22,333] {result_logger:141} INFO - 
[[ 89.48%   4.33%   6.19%]
 [  5.31%  90.11%   4.59%]
 [  4.39%   4.23%  91.38%]]
[2024-10-17 01:10:22,648] {result_logger:145} INFO - 
[[ 95.71%  24.38%   7.95%]
 [  0.64%  57.08%   0.66%]
 [  3.65%  18.54%  91.38%]]
[2024-10-17 01:10:22,648] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-10-17 01:10:22,686] {result_logger:134} INFO - 
[[125930   5053   7719]
 [   719  14238    646]
 [  4303   4653  98950]]
[2024-10-17 01:10:22,802] {result_logger:141} INFO - 
[[ 90.79%   3.64%   5.57%]
 [  4.61%  91.25%   4.14%]
 [  3.99%   4.31%  91.70%]]
[2024-10-17 01:10:22,912] {result_logger:145} INFO - 
[[ 96.17%  21.10%   7.19%]
 [  0.55%  59.46%   0.60%]
 [  3.29%  19.43%  92.21%]]
[2024-10-17 01:10:23,530] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-10-17 01:10:23,531] {result_logger:77} INFO - actual:
[2024-10-17 01:10:23,531] {result_logger:78} INFO - 
[[92.77%  0.10%  7.14%]
 [14.73% 66.42% 18.85%]
 [ 7.17%  4.73% 88.10%]]
[2024-10-17 01:10:23,531] {result_logger:79} INFO - predicted:
[2024-10-17 01:10:23,531] {result_logger:80} INFO - 
[[89.66%  2.66%  7.68%]
 [23.71% 54.72% 21.57%]
 [ 7.33%  6.85% 85.82%]]
[2024-10-17 01:10:23,607] {train_model:92} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/step4E_august/Maiken/model_8conv_2fc-best.pth
[2024-10-17 01:10:23,607] {run_experiment_multiple_labs:112} INFO - [epoch  12] execution time: 481.30s	 avg f1-score: 0.8579

[2024-10-17 01:11:59,608] {train_model:80} INFO - Train Epoch: 13 [161792/1621534 (10%)]	lr:2.41e-04	Loss: 0.167001
[2024-10-17 01:12:28,560] {train_model:80} INFO - Train Epoch: 13 [323840/1621534 (20%)]	lr:2.41e-04	Loss: 0.316041
[2024-10-17 01:12:57,514] {train_model:80} INFO - Train Epoch: 13 [485888/1621534 (30%)]	lr:2.41e-04	Loss: 0.174418
[2024-10-17 01:13:26,935] {train_model:80} INFO - Train Epoch: 13 [647936/1621534 (40%)]	lr:2.41e-04	Loss: 0.275331
[2024-10-17 01:13:56,618] {train_model:80} INFO - Train Epoch: 13 [809984/1621534 (50%)]	lr:2.41e-04	Loss: 0.175072
[2024-10-17 01:14:26,726] {train_model:80} INFO - Train Epoch: 13 [972032/1621534 (60%)]	lr:2.41e-04	Loss: 0.164090
[2024-10-17 01:14:57,092] {train_model:80} INFO - Train Epoch: 13 [1134080/1621534 (70%)]	lr:2.41e-04	Loss: 0.473129
[2024-10-17 01:15:27,889] {train_model:80} INFO - Train Epoch: 13 [1296128/1621534 (80%)]	lr:2.41e-04	Loss: 0.137150
[2024-10-17 01:15:58,525] {train_model:80} INFO - Train Epoch: 13 [1458176/1621534 (90%)]	lr:2.41e-04	Loss: 0.140375
[2024-10-17 01:16:29,524] {train_model:80} INFO - Train Epoch: 13 [1620224/1621534 (100%)]	lr:2.41e-04	Loss: 0.229468
[2024-10-17 01:17:58,466] {run_experiment_multiple_labs:78} INFO - 
[2024-10-17 01:17:58,466] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-10-17 01:18:01,471] {result_logger:103} INFO - precision on Wake: 0.959
[2024-10-17 01:18:03,442] {result_logger:104} INFO - recall on Wake: 0.898
[2024-10-17 01:18:05,436] {result_logger:107} INFO - F1-score on Wake: 0.928
[2024-10-17 01:18:05,436] {result_logger:108} INFO - 
[2024-10-17 01:18:08,217] {result_logger:103} INFO - precision on REM: 0.579
[2024-10-17 01:18:09,988] {result_logger:104} INFO - recall on REM: 0.905
[2024-10-17 01:18:11,752] {result_logger:107} INFO - F1-score on REM: 0.706
[2024-10-17 01:18:11,753] {result_logger:108} INFO - 
[2024-10-17 01:18:14,821] {result_logger:103} INFO - precision on Non REM: 0.915
[2024-10-17 01:18:16,785] {result_logger:104} INFO - recall on Non REM: 0.916
[2024-10-17 01:18:18,744] {result_logger:107} INFO - F1-score on Non REM: 0.916
[2024-10-17 01:18:18,744] {result_logger:108} INFO - 
[2024-10-17 01:18:19,211] {result_logger:111} INFO - average precision on sleep stages: 0.818
[2024-10-17 01:18:19,676] {result_logger:113} INFO - average recall on sleep stages: 0.906
[2024-10-17 01:18:20,141] {result_logger:115} INFO - average F1-score on sleep stages: 0.850
[2024-10-17 01:18:20,146] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-10-17 01:18:20,593] {result_logger:103} INFO - precision on Wake: 0.966
[2024-10-17 01:18:20,866] {result_logger:104} INFO - recall on Wake: 0.905
[2024-10-17 01:18:21,137] {result_logger:107} INFO - F1-score on Wake: 0.935
[2024-10-17 01:18:21,137] {result_logger:108} INFO - 
[2024-10-17 01:18:21,578] {result_logger:103} INFO - precision on REM: 0.660
[2024-10-17 01:18:21,851] {result_logger:104} INFO - recall on REM: 0.898
[2024-10-17 01:18:22,122] {result_logger:107} INFO - F1-score on REM: 0.761
[2024-10-17 01:18:22,122] {result_logger:108} INFO - 
[2024-10-17 01:18:22,582] {result_logger:103} INFO - precision on Non REM: 0.905
[2024-10-17 01:18:22,861] {result_logger:104} INFO - recall on Non REM: 0.931
[2024-10-17 01:18:23,139] {result_logger:107} INFO - F1-score on Non REM: 0.918
[2024-10-17 01:18:23,139] {result_logger:108} INFO - 
[2024-10-17 01:18:23,194] {result_logger:111} INFO - average precision on sleep stages: 0.844
[2024-10-17 01:18:23,248] {result_logger:113} INFO - average recall on sleep stages: 0.911
[2024-10-17 01:18:23,302] {result_logger:115} INFO - average F1-score on sleep stages: 0.871
[2024-10-17 01:18:23,303] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-10-17 01:18:23,623] {result_logger:134} INFO - 
[[770190  35502  52082]
 [  4751  87370   4382]
 [ 27991  27985 611281]]
[2024-10-17 01:18:23,945] {result_logger:141} INFO - 
[[ 89.79%   4.14%   6.07%]
 [  4.92%  90.54%   4.54%]
 [  4.19%   4.19%  91.61%]]
[2024-10-17 01:18:24,266] {result_logger:145} INFO - 
[[ 95.92%  23.53%   7.80%]
 [  0.59%  57.92%   0.66%]
 [  3.49%  18.55%  91.54%]]
[2024-10-17 01:18:24,266] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-10-17 01:18:24,305] {result_logger:134} INFO - 
[[125535   3582   9585]
 [   673  14012    918]
 [  3756   3648 100502]]
[2024-10-17 01:18:24,511] {result_logger:141} INFO - 
[[ 90.51%   2.58%   6.91%]
 [  4.31%  89.80%   5.88%]
 [  3.48%   3.38%  93.14%]]
[2024-10-17 01:18:24,622] {result_logger:145} INFO - 
[[ 96.59%  16.86%   8.63%]
 [  0.52%  65.96%   0.83%]
 [  2.89%  17.17%  90.54%]]
[2024-10-17 01:18:25,254] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-10-17 01:18:25,255] {result_logger:77} INFO - actual:
[2024-10-17 01:18:25,255] {result_logger:78} INFO - 
[[92.77%  0.10%  7.14%]
 [14.73% 66.42% 18.85%]
 [ 7.17%  4.73% 88.10%]]
[2024-10-17 01:18:25,255] {result_logger:79} INFO - predicted:
[2024-10-17 01:18:25,255] {result_logger:80} INFO - 
[[89.42%  1.97%  8.61%]
 [22.96% 55.66% 21.38%]
 [ 7.99%  6.18% 85.83%]]
[2024-10-17 01:18:25,328] {train_model:92} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/step4E_august/Maiken/model_8conv_2fc-best.pth
[2024-10-17 01:18:25,328] {run_experiment_multiple_labs:112} INFO - [epoch  13] execution time: 481.72s	 avg f1-score: 0.8711

[2024-10-17 01:20:00,852] {train_model:80} INFO - Train Epoch: 14 [161792/1621534 (10%)]	lr:2.27e-04	Loss: 0.257649
[2024-10-17 01:20:30,126] {train_model:80} INFO - Train Epoch: 14 [323840/1621534 (20%)]	lr:2.27e-04	Loss: 0.422426
[2024-10-17 01:20:59,290] {train_model:80} INFO - Train Epoch: 14 [485888/1621534 (30%)]	lr:2.27e-04	Loss: 0.199229
[2024-10-17 01:21:28,658] {train_model:80} INFO - Train Epoch: 14 [647936/1621534 (40%)]	lr:2.27e-04	Loss: 0.210565
[2024-10-17 01:21:58,975] {train_model:80} INFO - Train Epoch: 14 [809984/1621534 (50%)]	lr:2.27e-04	Loss: 0.186986
[2024-10-17 01:22:29,080] {train_model:80} INFO - Train Epoch: 14 [972032/1621534 (60%)]	lr:2.27e-04	Loss: 0.164918
[2024-10-17 01:22:59,275] {train_model:80} INFO - Train Epoch: 14 [1134080/1621534 (70%)]	lr:2.27e-04	Loss: 0.410444
[2024-10-17 01:23:29,842] {train_model:80} INFO - Train Epoch: 14 [1296128/1621534 (80%)]	lr:2.27e-04	Loss: 0.287734
[2024-10-17 01:24:00,347] {train_model:80} INFO - Train Epoch: 14 [1458176/1621534 (90%)]	lr:2.27e-04	Loss: 0.252742
[2024-10-17 01:24:31,446] {train_model:80} INFO - Train Epoch: 14 [1620224/1621534 (100%)]	lr:2.27e-04	Loss: 0.246288
[2024-10-17 01:26:00,576] {run_experiment_multiple_labs:78} INFO - 
[2024-10-17 01:26:00,577] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-10-17 01:26:03,539] {result_logger:103} INFO - precision on Wake: 0.961
[2024-10-17 01:26:05,442] {result_logger:104} INFO - recall on Wake: 0.901
[2024-10-17 01:26:07,427] {result_logger:107} INFO - F1-score on Wake: 0.930
[2024-10-17 01:26:07,428] {result_logger:108} INFO - 
[2024-10-17 01:26:10,189] {result_logger:103} INFO - precision on REM: 0.588
[2024-10-17 01:26:11,909] {result_logger:104} INFO - recall on REM: 0.907
[2024-10-17 01:26:13,645] {result_logger:107} INFO - F1-score on REM: 0.713
[2024-10-17 01:26:13,645] {result_logger:108} INFO - 
[2024-10-17 01:26:16,655] {result_logger:103} INFO - precision on Non REM: 0.917
[2024-10-17 01:26:18,616] {result_logger:104} INFO - recall on Non REM: 0.918
[2024-10-17 01:26:20,547] {result_logger:107} INFO - F1-score on Non REM: 0.918
[2024-10-17 01:26:20,547] {result_logger:108} INFO - 
[2024-10-17 01:26:21,010] {result_logger:111} INFO - average precision on sleep stages: 0.822
[2024-10-17 01:26:21,474] {result_logger:113} INFO - average recall on sleep stages: 0.909
[2024-10-17 01:26:21,936] {result_logger:115} INFO - average F1-score on sleep stages: 0.853
[2024-10-17 01:26:21,940] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-10-17 01:26:22,392] {result_logger:103} INFO - precision on Wake: 0.969
[2024-10-17 01:26:22,664] {result_logger:104} INFO - recall on Wake: 0.887
[2024-10-17 01:26:22,933] {result_logger:107} INFO - F1-score on Wake: 0.926
[2024-10-17 01:26:22,933] {result_logger:108} INFO - 
[2024-10-17 01:26:23,381] {result_logger:103} INFO - precision on REM: 0.537
[2024-10-17 01:26:23,653] {result_logger:104} INFO - recall on REM: 0.941
[2024-10-17 01:26:23,927] {result_logger:107} INFO - F1-score on REM: 0.684
[2024-10-17 01:26:23,927] {result_logger:108} INFO - 
[2024-10-17 01:26:24,381] {result_logger:103} INFO - precision on Non REM: 0.921
[2024-10-17 01:26:24,656] {result_logger:104} INFO - recall on Non REM: 0.920
[2024-10-17 01:26:24,933] {result_logger:107} INFO - F1-score on Non REM: 0.921
[2024-10-17 01:26:24,933] {result_logger:108} INFO - 
[2024-10-17 01:26:24,988] {result_logger:111} INFO - average precision on sleep stages: 0.809
[2024-10-17 01:26:25,043] {result_logger:113} INFO - average recall on sleep stages: 0.916
[2024-10-17 01:26:25,098] {result_logger:115} INFO - average F1-score on sleep stages: 0.844
[2024-10-17 01:26:25,099] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-10-17 01:26:25,420] {result_logger:134} INFO - 
[[772458  34054  51262]
 [  4583  87542   4378]
 [ 27154  27387 612716]]
[2024-10-17 01:26:25,742] {result_logger:141} INFO - 
[[ 90.05%   3.97%   5.98%]
 [  4.75%  90.71%   4.54%]
 [  4.07%   4.10%  91.83%]]
[2024-10-17 01:26:26,064] {result_logger:145} INFO - 
[[ 96.05%  22.86%   7.67%]
 [  0.57%  58.76%   0.66%]
 [  3.38%  18.38%  91.68%]]
[2024-10-17 01:26:26,064] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-10-17 01:26:26,103] {result_logger:134} INFO - 
[[123094   7677   7931]
 [   330  14687    586]
 [  3633   4971  99302]]
[2024-10-17 01:26:26,141] {result_logger:141} INFO - 
[[ 88.75%   5.53%   5.72%]
 [  2.11%  94.13%   3.76%]
 [  3.37%   4.61%  92.03%]]
[2024-10-17 01:26:26,179] {result_logger:145} INFO - 
[[ 96.88%  28.08%   7.36%]
 [  0.26%  53.73%   0.54%]
 [  2.86%  18.19%  92.10%]]
[2024-10-17 01:26:26,688] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-10-17 01:26:26,688] {result_logger:77} INFO - actual:
[2024-10-17 01:26:26,689] {result_logger:78} INFO - 
[[92.77%  0.10%  7.14%]
 [14.73% 66.42% 18.85%]
 [ 7.17%  4.73% 88.10%]]
[2024-10-17 01:26:26,689] {result_logger:79} INFO - predicted:
[2024-10-17 01:26:26,689] {result_logger:80} INFO - 
[[88.55%  3.85%  7.60%]
 [25.84% 53.66% 20.50%]
 [ 6.94%  7.21% 85.85%]]
[2024-10-17 01:26:26,689] {run_experiment_multiple_labs:112} INFO - [epoch  14] execution time: 481.36s	 avg f1-score: 0.8437

[2024-10-17 01:28:01,733] {train_model:80} INFO - Train Epoch: 15 [161792/1621534 (10%)]	lr:2.14e-04	Loss: 0.225207
[2024-10-17 01:28:30,597] {train_model:80} INFO - Train Epoch: 15 [323840/1621534 (20%)]	lr:2.14e-04	Loss: 0.156055
[2024-10-17 01:29:00,217] {train_model:80} INFO - Train Epoch: 15 [485888/1621534 (30%)]	lr:2.14e-04	Loss: 0.139969
[2024-10-17 01:29:30,166] {train_model:80} INFO - Train Epoch: 15 [647936/1621534 (40%)]	lr:2.14e-04	Loss: 0.166983
[2024-10-17 01:30:00,347] {train_model:80} INFO - Train Epoch: 15 [809984/1621534 (50%)]	lr:2.14e-04	Loss: 0.139170
[2024-10-17 01:30:30,153] {train_model:80} INFO - Train Epoch: 15 [972032/1621534 (60%)]	lr:2.14e-04	Loss: 0.235757
[2024-10-17 01:31:00,108] {train_model:80} INFO - Train Epoch: 15 [1134080/1621534 (70%)]	lr:2.14e-04	Loss: 0.166079
[2024-10-17 01:31:30,229] {train_model:80} INFO - Train Epoch: 15 [1296128/1621534 (80%)]	lr:2.14e-04	Loss: 0.360689
[2024-10-17 01:32:00,687] {train_model:80} INFO - Train Epoch: 15 [1458176/1621534 (90%)]	lr:2.14e-04	Loss: 0.123429
[2024-10-17 01:32:31,414] {train_model:80} INFO - Train Epoch: 15 [1620224/1621534 (100%)]	lr:2.14e-04	Loss: 0.261273
[2024-10-17 01:33:59,101] {run_experiment_multiple_labs:78} INFO - 
[2024-10-17 01:33:59,102] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-10-17 01:34:02,114] {result_logger:103} INFO - precision on Wake: 0.962
[2024-10-17 01:34:04,082] {result_logger:104} INFO - recall on Wake: 0.902
[2024-10-17 01:34:06,042] {result_logger:107} INFO - F1-score on Wake: 0.931
[2024-10-17 01:34:06,042] {result_logger:108} INFO - 
[2024-10-17 01:34:08,836] {result_logger:103} INFO - precision on REM: 0.589
[2024-10-17 01:34:10,599] {result_logger:104} INFO - recall on REM: 0.912
[2024-10-17 01:34:12,390] {result_logger:107} INFO - F1-score on REM: 0.716
[2024-10-17 01:34:12,391] {result_logger:108} INFO - 
[2024-10-17 01:34:15,427] {result_logger:103} INFO - precision on Non REM: 0.919
[2024-10-17 01:34:17,368] {result_logger:104} INFO - recall on Non REM: 0.919
[2024-10-17 01:34:19,315] {result_logger:107} INFO - F1-score on Non REM: 0.919
[2024-10-17 01:34:19,315] {result_logger:108} INFO - 
[2024-10-17 01:34:19,776] {result_logger:111} INFO - average precision on sleep stages: 0.823
[2024-10-17 01:34:20,237] {result_logger:113} INFO - average recall on sleep stages: 0.911
[2024-10-17 01:34:20,698] {result_logger:115} INFO - average F1-score on sleep stages: 0.855
[2024-10-17 01:34:20,703] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-10-17 01:34:21,150] {result_logger:103} INFO - precision on Wake: 0.962
[2024-10-17 01:34:21,421] {result_logger:104} INFO - recall on Wake: 0.923
[2024-10-17 01:34:21,691] {result_logger:107} INFO - F1-score on Wake: 0.942
[2024-10-17 01:34:21,691] {result_logger:108} INFO - 
[2024-10-17 01:34:22,137] {result_logger:103} INFO - precision on REM: 0.636
[2024-10-17 01:34:22,405] {result_logger:104} INFO - recall on REM: 0.908
[2024-10-17 01:34:22,675] {result_logger:107} INFO - F1-score on REM: 0.748
[2024-10-17 01:34:22,675] {result_logger:108} INFO - 
[2024-10-17 01:34:23,135] {result_logger:103} INFO - precision on Non REM: 0.926
[2024-10-17 01:34:23,412] {result_logger:104} INFO - recall on Non REM: 0.917
[2024-10-17 01:34:23,690] {result_logger:107} INFO - F1-score on Non REM: 0.921
[2024-10-17 01:34:23,690] {result_logger:108} INFO - 
[2024-10-17 01:34:23,744] {result_logger:111} INFO - average precision on sleep stages: 0.841
[2024-10-17 01:34:23,798] {result_logger:113} INFO - average recall on sleep stages: 0.916
[2024-10-17 01:34:23,851] {result_logger:115} INFO - average F1-score on sleep stages: 0.871
[2024-10-17 01:34:23,853] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-10-17 01:34:24,175] {result_logger:134} INFO - 
[[773976  33726  50072]
 [  4300  87963   4240]
 [ 26356  27554 613347]]
[2024-10-17 01:34:24,495] {result_logger:141} INFO - 
[[ 90.23%   3.93%   5.84%]
 [  4.46%  91.15%   4.39%]
 [  3.95%   4.13%  91.92%]]
[2024-10-17 01:34:24,815] {result_logger:145} INFO - 
[[ 96.19%  22.60%   7.50%]
 [  0.53%  58.94%   0.64%]
 [  3.28%  18.46%  91.87%]]
[2024-10-17 01:34:24,815] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-10-17 01:34:24,854] {result_logger:134} INFO - 
[[128036   3259   7407]
 [   902  14169    532]
 [  4142   4844  98920]]
[2024-10-17 01:34:24,891] {result_logger:141} INFO - 
[[ 92.31%   2.35%   5.34%]
 [  5.78%  90.81%   3.41%]
 [  3.84%   4.49%  91.67%]]
[2024-10-17 01:34:24,929] {result_logger:145} INFO - 
[[ 96.21%  14.63%   6.93%]
 [  0.68%  63.62%   0.50%]
 [  3.11%  21.75%  92.57%]]
[2024-10-17 01:34:25,425] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-10-17 01:34:25,425] {result_logger:77} INFO - actual:
[2024-10-17 01:34:25,425] {result_logger:78} INFO - 
[[92.77%  0.10%  7.14%]
 [14.73% 66.42% 18.85%]
 [ 7.17%  4.73% 88.10%]]
[2024-10-17 01:34:25,425] {result_logger:79} INFO - predicted:
[2024-10-17 01:34:25,425] {result_logger:80} INFO - 
[[90.40%  1.94%  7.65%]
 [22.52% 55.19% 22.29%]
 [ 7.26%  6.92% 85.82%]]
[2024-10-17 01:34:25,425] {run_experiment_multiple_labs:112} INFO - [epoch  15] execution time: 478.74s	 avg f1-score: 0.8705

[2024-10-17 01:36:00,311] {train_model:80} INFO - Train Epoch: 16 [161792/1621534 (10%)]	lr:2.01e-04	Loss: 0.133802
[2024-10-17 01:36:29,816] {train_model:80} INFO - Train Epoch: 16 [323840/1621534 (20%)]	lr:2.01e-04	Loss: 0.121118
[2024-10-17 01:36:59,266] {train_model:80} INFO - Train Epoch: 16 [485888/1621534 (30%)]	lr:2.01e-04	Loss: 0.181290
[2024-10-17 01:37:28,914] {train_model:80} INFO - Train Epoch: 16 [647936/1621534 (40%)]	lr:2.01e-04	Loss: 0.196331
[2024-10-17 01:37:58,653] {train_model:80} INFO - Train Epoch: 16 [809984/1621534 (50%)]	lr:2.01e-04	Loss: 0.111720
[2024-10-17 01:38:28,666] {train_model:80} INFO - Train Epoch: 16 [972032/1621534 (60%)]	lr:2.01e-04	Loss: 0.174832
[2024-10-17 01:38:58,879] {train_model:80} INFO - Train Epoch: 16 [1134080/1621534 (70%)]	lr:2.01e-04	Loss: 0.195343
[2024-10-17 01:39:29,540] {train_model:80} INFO - Train Epoch: 16 [1296128/1621534 (80%)]	lr:2.01e-04	Loss: 0.145368
[2024-10-17 01:40:00,210] {train_model:80} INFO - Train Epoch: 16 [1458176/1621534 (90%)]	lr:2.01e-04	Loss: 0.089084
[2024-10-17 01:40:30,799] {train_model:80} INFO - Train Epoch: 16 [1620224/1621534 (100%)]	lr:2.01e-04	Loss: 0.134858
[2024-10-17 01:42:00,184] {run_experiment_multiple_labs:78} INFO - 
[2024-10-17 01:42:00,185] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-10-17 01:42:03,156] {result_logger:103} INFO - precision on Wake: 0.962
[2024-10-17 01:42:05,098] {result_logger:104} INFO - recall on Wake: 0.905
[2024-10-17 01:42:07,054] {result_logger:107} INFO - F1-score on Wake: 0.933
[2024-10-17 01:42:07,055] {result_logger:108} INFO - 
[2024-10-17 01:42:09,850] {result_logger:103} INFO - precision on REM: 0.599
[2024-10-17 01:42:11,568] {result_logger:104} INFO - recall on REM: 0.914
[2024-10-17 01:42:13,299] {result_logger:107} INFO - F1-score on REM: 0.724
[2024-10-17 01:42:13,299] {result_logger:108} INFO - 
[2024-10-17 01:42:16,346] {result_logger:103} INFO - precision on Non REM: 0.919
[2024-10-17 01:42:18,328] {result_logger:104} INFO - recall on Non REM: 0.921
[2024-10-17 01:42:20,308] {result_logger:107} INFO - F1-score on Non REM: 0.920
[2024-10-17 01:42:20,308] {result_logger:108} INFO - 
[2024-10-17 01:42:20,782] {result_logger:111} INFO - average precision on sleep stages: 0.827
[2024-10-17 01:42:21,257] {result_logger:113} INFO - average recall on sleep stages: 0.913
[2024-10-17 01:42:21,730] {result_logger:115} INFO - average F1-score on sleep stages: 0.859
[2024-10-17 01:42:21,735] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-10-17 01:42:22,175] {result_logger:103} INFO - precision on Wake: 0.970
[2024-10-17 01:42:22,446] {result_logger:104} INFO - recall on Wake: 0.910
[2024-10-17 01:42:22,715] {result_logger:107} INFO - F1-score on Wake: 0.939
[2024-10-17 01:42:22,715] {result_logger:108} INFO - 
[2024-10-17 01:42:23,160] {result_logger:103} INFO - precision on REM: 0.598
[2024-10-17 01:42:23,428] {result_logger:104} INFO - recall on REM: 0.931
[2024-10-17 01:42:23,696] {result_logger:107} INFO - F1-score on REM: 0.728
[2024-10-17 01:42:23,696] {result_logger:108} INFO - 
[2024-10-17 01:42:24,146] {result_logger:103} INFO - precision on Non REM: 0.922
[2024-10-17 01:42:24,421] {result_logger:104} INFO - recall on Non REM: 0.921
[2024-10-17 01:42:24,698] {result_logger:107} INFO - F1-score on Non REM: 0.921
[2024-10-17 01:42:24,698] {result_logger:108} INFO - 
[2024-10-17 01:42:24,752] {result_logger:111} INFO - average precision on sleep stages: 0.830
[2024-10-17 01:42:24,807] {result_logger:113} INFO - average recall on sleep stages: 0.921
[2024-10-17 01:42:24,861] {result_logger:115} INFO - average F1-score on sleep stages: 0.863
[2024-10-17 01:42:24,862] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-10-17 01:42:25,189] {result_logger:134} INFO - 
[[775899  32154  49721]
 [  4176  88188   4139]
 [ 26092  26867 614298]]
[2024-10-17 01:42:25,517] {result_logger:141} INFO - 
[[ 90.45%   3.75%   5.80%]
 [  4.33%  91.38%   4.29%]
 [  3.91%   4.03%  92.06%]]
[2024-10-17 01:42:25,847] {result_logger:145} INFO - 
[[ 96.25%  21.84%   7.44%]
 [  0.52%  59.91%   0.62%]
 [  3.24%  18.25%  91.94%]]
[2024-10-17 01:42:25,847] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-10-17 01:42:25,885] {result_logger:134} INFO - 
[[126246   4545   7911]
 [   569  14522    512]
 [  3341   5226  99339]]
[2024-10-17 01:42:25,923] {result_logger:141} INFO - 
[[ 91.02%   3.28%   5.70%]
 [  3.65%  93.07%   3.28%]
 [  3.10%   4.84%  92.06%]]
[2024-10-17 01:42:25,961] {result_logger:145} INFO - 
[[ 97.00%  18.71%   7.34%]
 [  0.44%  59.78%   0.48%]
 [  2.57%  21.51%  92.18%]]
[2024-10-17 01:42:26,439] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-10-17 01:42:26,439] {result_logger:77} INFO - actual:
[2024-10-17 01:42:26,439] {result_logger:78} INFO - 
[[92.77%  0.10%  7.14%]
 [14.73% 66.42% 18.85%]
 [ 7.17%  4.73% 88.10%]]
[2024-10-17 01:42:26,439] {result_logger:79} INFO - predicted:
[2024-10-17 01:42:26,440] {result_logger:80} INFO - 
[[89.91%  2.36%  7.72%]
 [22.08% 55.90% 22.03%]
 [ 7.21%  7.09% 85.71%]]
[2024-10-17 01:42:26,440] {run_experiment_multiple_labs:112} INFO - [epoch  16] execution time: 481.01s	 avg f1-score: 0.8628

[2024-10-17 01:44:02,112] {train_model:80} INFO - Train Epoch: 17 [161792/1621534 (10%)]	lr:1.90e-04	Loss: 0.217592
[2024-10-17 01:44:31,178] {train_model:80} INFO - Train Epoch: 17 [323840/1621534 (20%)]	lr:1.90e-04	Loss: 0.218630
[2024-10-17 01:45:00,899] {train_model:80} INFO - Train Epoch: 17 [485888/1621534 (30%)]	lr:1.90e-04	Loss: 0.203795
[2024-10-17 01:45:30,545] {train_model:80} INFO - Train Epoch: 17 [647936/1621534 (40%)]	lr:1.90e-04	Loss: 0.495566
[2024-10-17 01:46:00,465] {train_model:80} INFO - Train Epoch: 17 [809984/1621534 (50%)]	lr:1.90e-04	Loss: 0.252508
[2024-10-17 01:46:30,885] {train_model:80} INFO - Train Epoch: 17 [972032/1621534 (60%)]	lr:1.90e-04	Loss: 0.134909
[2024-10-17 01:47:01,169] {train_model:80} INFO - Train Epoch: 17 [1134080/1621534 (70%)]	lr:1.90e-04	Loss: 0.184551
[2024-10-17 01:47:31,918] {train_model:80} INFO - Train Epoch: 17 [1296128/1621534 (80%)]	lr:1.90e-04	Loss: 0.173234
[2024-10-17 01:48:02,346] {train_model:80} INFO - Train Epoch: 17 [1458176/1621534 (90%)]	lr:1.90e-04	Loss: 0.184287
[2024-10-17 01:48:32,798] {train_model:80} INFO - Train Epoch: 17 [1620224/1621534 (100%)]	lr:1.90e-04	Loss: 0.224592
[2024-10-17 01:50:00,775] {run_experiment_multiple_labs:78} INFO - 
[2024-10-17 01:50:00,775] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-10-17 01:50:03,767] {result_logger:103} INFO - precision on Wake: 0.963
[2024-10-17 01:50:05,726] {result_logger:104} INFO - recall on Wake: 0.906
[2024-10-17 01:50:07,665] {result_logger:107} INFO - F1-score on Wake: 0.934
[2024-10-17 01:50:07,665] {result_logger:108} INFO - 
[2024-10-17 01:50:10,502] {result_logger:103} INFO - precision on REM: 0.604
[2024-10-17 01:50:12,266] {result_logger:104} INFO - recall on REM: 0.915
[2024-10-17 01:50:14,019] {result_logger:107} INFO - F1-score on REM: 0.728
[2024-10-17 01:50:14,019] {result_logger:108} INFO - 
[2024-10-17 01:50:17,122] {result_logger:103} INFO - precision on Non REM: 0.920
[2024-10-17 01:50:19,119] {result_logger:104} INFO - recall on Non REM: 0.922
[2024-10-17 01:50:21,094] {result_logger:107} INFO - F1-score on Non REM: 0.921
[2024-10-17 01:50:21,094] {result_logger:108} INFO - 
[2024-10-17 01:50:21,563] {result_logger:111} INFO - average precision on sleep stages: 0.829
[2024-10-17 01:50:22,031] {result_logger:113} INFO - average recall on sleep stages: 0.914
[2024-10-17 01:50:22,499] {result_logger:115} INFO - average F1-score on sleep stages: 0.861
[2024-10-17 01:50:22,504] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-10-17 01:50:22,948] {result_logger:103} INFO - precision on Wake: 0.965
[2024-10-17 01:50:23,220] {result_logger:104} INFO - recall on Wake: 0.922
[2024-10-17 01:50:23,501] {result_logger:107} INFO - F1-score on Wake: 0.943
[2024-10-17 01:50:23,501] {result_logger:108} INFO - 
[2024-10-17 01:50:23,948] {result_logger:103} INFO - precision on REM: 0.627
[2024-10-17 01:50:24,221] {result_logger:104} INFO - recall on REM: 0.927
[2024-10-17 01:50:24,494] {result_logger:107} INFO - F1-score on REM: 0.748
[2024-10-17 01:50:24,494] {result_logger:108} INFO - 
[2024-10-17 01:50:24,945] {result_logger:103} INFO - precision on Non REM: 0.929
[2024-10-17 01:50:25,223] {result_logger:104} INFO - recall on Non REM: 0.917
[2024-10-17 01:50:25,500] {result_logger:107} INFO - F1-score on Non REM: 0.923
[2024-10-17 01:50:25,500] {result_logger:108} INFO - 
[2024-10-17 01:50:25,552] {result_logger:111} INFO - average precision on sleep stages: 0.840
[2024-10-17 01:50:25,605] {result_logger:113} INFO - average recall on sleep stages: 0.922
[2024-10-17 01:50:25,657] {result_logger:115} INFO - average F1-score on sleep stages: 0.871
[2024-10-17 01:50:25,658] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-10-17 01:50:25,984] {result_logger:134} INFO - 
[[776930  31485  49359]
 [  4017  88347   4139]
 [ 25620  26479 615158]]
[2024-10-17 01:50:26,309] {result_logger:141} INFO - 
[[ 90.58%   3.67%   5.75%]
 [  4.16%  91.55%   4.29%]
 [  3.84%   3.97%  92.19%]]
[2024-10-17 01:50:26,634] {result_logger:145} INFO - 
[[ 96.33%  21.52%   7.38%]
 [  0.50%  60.38%   0.62%]
 [  3.18%  18.10%  92.00%]]
[2024-10-17 01:50:26,634] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-10-17 01:50:26,671] {result_logger:134} INFO - 
[[127917   3730   7055]
 [   646  14458    499]
 [  4049   4873  98984]]
[2024-10-17 01:50:26,786] {result_logger:141} INFO - 
[[ 92.22%   2.69%   5.09%]
 [  4.14%  92.66%   3.20%]
 [  3.75%   4.52%  91.73%]]
[2024-10-17 01:50:26,894] {result_logger:145} INFO - 
[[ 96.46%  16.17%   6.62%]
 [  0.49%  62.69%   0.47%]
 [  3.05%  21.13%  92.91%]]
[2024-10-17 01:50:27,520] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-10-17 01:50:27,520] {result_logger:77} INFO - actual:
[2024-10-17 01:50:27,520] {result_logger:78} INFO - 
[[92.77%  0.10%  7.14%]
 [14.73% 66.42% 18.85%]
 [ 7.17%  4.73% 88.10%]]
[2024-10-17 01:50:27,520] {result_logger:79} INFO - predicted:
[2024-10-17 01:50:27,520] {result_logger:80} INFO - 
[[90.43%  2.06%  7.52%]
 [21.68% 56.19% 22.13%]
 [ 7.23%  6.92% 85.85%]]
[2024-10-17 01:50:27,591] {train_model:92} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/step4E_august/Maiken/model_8conv_2fc-best.pth
[2024-10-17 01:50:27,591] {run_experiment_multiple_labs:112} INFO - [epoch  17] execution time: 481.15s	 avg f1-score: 0.8713

[2024-10-17 01:52:03,486] {train_model:80} INFO - Train Epoch: 18 [161792/1621534 (10%)]	lr:1.79e-04	Loss: 0.254474
[2024-10-17 01:52:32,368] {train_model:80} INFO - Train Epoch: 18 [323840/1621534 (20%)]	lr:1.79e-04	Loss: 0.173928
[2024-10-17 01:53:02,079] {train_model:80} INFO - Train Epoch: 18 [485888/1621534 (30%)]	lr:1.79e-04	Loss: 0.208810
[2024-10-17 01:53:31,575] {train_model:80} INFO - Train Epoch: 18 [647936/1621534 (40%)]	lr:1.79e-04	Loss: 0.158646
[2024-10-17 01:54:01,035] {train_model:80} INFO - Train Epoch: 18 [809984/1621534 (50%)]	lr:1.79e-04	Loss: 0.206491
[2024-10-17 01:54:30,813] {train_model:80} INFO - Train Epoch: 18 [972032/1621534 (60%)]	lr:1.79e-04	Loss: 0.239193
[2024-10-17 01:55:01,442] {train_model:80} INFO - Train Epoch: 18 [1134080/1621534 (70%)]	lr:1.79e-04	Loss: 0.395731
[2024-10-17 01:55:31,758] {train_model:80} INFO - Train Epoch: 18 [1296128/1621534 (80%)]	lr:1.79e-04	Loss: 0.130848
[2024-10-17 01:56:02,378] {train_model:80} INFO - Train Epoch: 18 [1458176/1621534 (90%)]	lr:1.79e-04	Loss: 0.166479
[2024-10-17 01:56:33,026] {train_model:80} INFO - Train Epoch: 18 [1620224/1621534 (100%)]	lr:1.79e-04	Loss: 0.194744
[2024-10-17 01:58:01,949] {run_experiment_multiple_labs:78} INFO - 
[2024-10-17 01:58:01,950] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-10-17 01:58:04,939] {result_logger:103} INFO - precision on Wake: 0.964
[2024-10-17 01:58:06,938] {result_logger:104} INFO - recall on Wake: 0.907
[2024-10-17 01:58:08,906] {result_logger:107} INFO - F1-score on Wake: 0.935
[2024-10-17 01:58:08,906] {result_logger:108} INFO - 
[2024-10-17 01:58:11,677] {result_logger:103} INFO - precision on REM: 0.607
[2024-10-17 01:58:13,426] {result_logger:104} INFO - recall on REM: 0.918
[2024-10-17 01:58:15,175] {result_logger:107} INFO - F1-score on REM: 0.731
[2024-10-17 01:58:15,175] {result_logger:108} INFO - 
[2024-10-17 01:58:18,145] {result_logger:103} INFO - precision on Non REM: 0.921
[2024-10-17 01:58:20,085] {result_logger:104} INFO - recall on Non REM: 0.923
[2024-10-17 01:58:22,015] {result_logger:107} INFO - F1-score on Non REM: 0.922
[2024-10-17 01:58:22,016] {result_logger:108} INFO - 
[2024-10-17 01:58:22,477] {result_logger:111} INFO - average precision on sleep stages: 0.831
[2024-10-17 01:58:22,938] {result_logger:113} INFO - average recall on sleep stages: 0.916
[2024-10-17 01:58:23,399] {result_logger:115} INFO - average F1-score on sleep stages: 0.862
[2024-10-17 01:58:23,404] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-10-17 01:58:23,838] {result_logger:103} INFO - precision on Wake: 0.963
[2024-10-17 01:58:24,106] {result_logger:104} INFO - recall on Wake: 0.924
[2024-10-17 01:58:24,374] {result_logger:107} INFO - F1-score on Wake: 0.943
[2024-10-17 01:58:24,374] {result_logger:108} INFO - 
[2024-10-17 01:58:24,806] {result_logger:103} INFO - precision on REM: 0.668
[2024-10-17 01:58:25,074] {result_logger:104} INFO - recall on REM: 0.912
[2024-10-17 01:58:25,344] {result_logger:107} INFO - F1-score on REM: 0.771
[2024-10-17 01:58:25,344] {result_logger:108} INFO - 
[2024-10-17 01:58:25,784] {result_logger:103} INFO - precision on Non REM: 0.924
[2024-10-17 01:58:26,053] {result_logger:104} INFO - recall on Non REM: 0.924
[2024-10-17 01:58:26,328] {result_logger:107} INFO - F1-score on Non REM: 0.924
[2024-10-17 01:58:26,328] {result_logger:108} INFO - 
[2024-10-17 01:58:26,382] {result_logger:111} INFO - average precision on sleep stages: 0.852
[2024-10-17 01:58:26,435] {result_logger:113} INFO - average recall on sleep stages: 0.920
[2024-10-17 01:58:26,488] {result_logger:115} INFO - average F1-score on sleep stages: 0.880
[2024-10-17 01:58:26,489] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-10-17 01:58:26,805] {result_logger:134} INFO - 
[[777922  31032  48820]
 [  3857  88599   4047]
 [ 25142  26360 615755]]
[2024-10-17 01:58:27,124] {result_logger:141} INFO - 
[[ 90.69%   3.62%   5.69%]
 [  4.00%  91.81%   4.19%]
 [  3.77%   3.95%  92.28%]]
[2024-10-17 01:58:27,442] {result_logger:145} INFO - 
[[ 96.41%  21.26%   7.30%]
 [  0.48%  60.69%   0.61%]
 [  3.12%  18.06%  92.09%]]
[2024-10-17 01:58:27,442] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-10-17 01:58:27,480] {result_logger:134} INFO - 
[[128172   3010   7520]
 [   732  14230    641]
 [  4158   4061  99687]]
[2024-10-17 01:58:27,594] {result_logger:141} INFO - 
[[ 92.41%   2.17%   5.42%]
 [  4.69%  91.20%   4.11%]
 [  3.85%   3.76%  92.38%]]
[2024-10-17 01:58:27,703] {result_logger:145} INFO - 
[[ 96.33%  14.13%   6.97%]
 [  0.55%  66.80%   0.59%]
 [  3.12%  19.06%  92.43%]]
[2024-10-17 01:58:28,314] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-10-17 01:58:28,314] {result_logger:77} INFO - actual:
[2024-10-17 01:58:28,314] {result_logger:78} INFO - 
[[92.77%  0.10%  7.14%]
 [14.73% 66.42% 18.85%]
 [ 7.17%  4.73% 88.10%]]
[2024-10-17 01:58:28,314] {result_logger:79} INFO - predicted:
[2024-10-17 01:58:28,314] {result_logger:80} INFO - 
[[90.44%  1.73%  7.83%]
 [21.43% 57.57% 21.01%]
 [ 7.57%  6.24% 86.19%]]
[2024-10-17 01:58:28,390] {train_model:92} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/step4E_august/Maiken/model_8conv_2fc-best.pth
[2024-10-17 01:58:28,390] {run_experiment_multiple_labs:112} INFO - [epoch  18] execution time: 480.80s	 avg f1-score: 0.8795

[2024-10-17 02:00:03,179] {train_model:80} INFO - Train Epoch: 19 [161792/1621534 (10%)]	lr:1.68e-04	Loss: 0.169979
[2024-10-17 02:00:32,747] {train_model:80} INFO - Train Epoch: 19 [323840/1621534 (20%)]	lr:1.68e-04	Loss: 0.201304
[2024-10-17 02:01:01,720] {train_model:80} INFO - Train Epoch: 19 [485888/1621534 (30%)]	lr:1.68e-04	Loss: 0.241105
[2024-10-17 02:01:30,997] {train_model:80} INFO - Train Epoch: 19 [647936/1621534 (40%)]	lr:1.68e-04	Loss: 0.238639
[2024-10-17 02:02:00,505] {train_model:80} INFO - Train Epoch: 19 [809984/1621534 (50%)]	lr:1.68e-04	Loss: 0.218127
[2024-10-17 02:02:30,247] {train_model:80} INFO - Train Epoch: 19 [972032/1621534 (60%)]	lr:1.68e-04	Loss: 0.192203
[2024-10-17 02:03:00,184] {train_model:80} INFO - Train Epoch: 19 [1134080/1621534 (70%)]	lr:1.68e-04	Loss: 0.250643
[2024-10-17 02:03:30,410] {train_model:80} INFO - Train Epoch: 19 [1296128/1621534 (80%)]	lr:1.68e-04	Loss: 0.302496
[2024-10-17 02:04:00,834] {train_model:80} INFO - Train Epoch: 19 [1458176/1621534 (90%)]	lr:1.68e-04	Loss: 0.228547
[2024-10-17 02:04:31,366] {train_model:80} INFO - Train Epoch: 19 [1620224/1621534 (100%)]	lr:1.68e-04	Loss: 0.146099
[2024-10-17 02:05:59,439] {run_experiment_multiple_labs:78} INFO - 
[2024-10-17 02:05:59,440] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-10-17 02:06:02,370] {result_logger:103} INFO - precision on Wake: 0.965
[2024-10-17 02:06:04,336] {result_logger:104} INFO - recall on Wake: 0.908
[2024-10-17 02:06:06,328] {result_logger:107} INFO - F1-score on Wake: 0.935
[2024-10-17 02:06:06,328] {result_logger:108} INFO - 
[2024-10-17 02:06:09,090] {result_logger:103} INFO - precision on REM: 0.609
[2024-10-17 02:06:10,816] {result_logger:104} INFO - recall on REM: 0.920
[2024-10-17 02:06:12,538] {result_logger:107} INFO - F1-score on REM: 0.733
[2024-10-17 02:06:12,538] {result_logger:108} INFO - 
[2024-10-17 02:06:15,561] {result_logger:103} INFO - precision on Non REM: 0.921
[2024-10-17 02:06:17,533] {result_logger:104} INFO - recall on Non REM: 0.923
[2024-10-17 02:06:19,505] {result_logger:107} INFO - F1-score on Non REM: 0.922
[2024-10-17 02:06:19,505] {result_logger:108} INFO - 
[2024-10-17 02:06:19,988] {result_logger:111} INFO - average precision on sleep stages: 0.832
[2024-10-17 02:06:20,471] {result_logger:113} INFO - average recall on sleep stages: 0.917
[2024-10-17 02:06:20,953] {result_logger:115} INFO - average F1-score on sleep stages: 0.864
[2024-10-17 02:06:20,958] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-10-17 02:06:21,394] {result_logger:103} INFO - precision on Wake: 0.963
[2024-10-17 02:06:21,660] {result_logger:104} INFO - recall on Wake: 0.925
[2024-10-17 02:06:21,931] {result_logger:107} INFO - F1-score on Wake: 0.944
[2024-10-17 02:06:21,931] {result_logger:108} INFO - 
[2024-10-17 02:06:22,362] {result_logger:103} INFO - precision on REM: 0.677
[2024-10-17 02:06:22,627] {result_logger:104} INFO - recall on REM: 0.901
[2024-10-17 02:06:22,897] {result_logger:107} INFO - F1-score on REM: 0.773
[2024-10-17 02:06:22,897] {result_logger:108} INFO - 
[2024-10-17 02:06:23,345] {result_logger:103} INFO - precision on Non REM: 0.927
[2024-10-17 02:06:23,619] {result_logger:104} INFO - recall on Non REM: 0.930
[2024-10-17 02:06:23,894] {result_logger:107} INFO - F1-score on Non REM: 0.929
[2024-10-17 02:06:23,894] {result_logger:108} INFO - 
[2024-10-17 02:06:23,947] {result_logger:111} INFO - average precision on sleep stages: 0.856
[2024-10-17 02:06:24,001] {result_logger:113} INFO - average recall on sleep stages: 0.919
[2024-10-17 02:06:24,055] {result_logger:115} INFO - average F1-score on sleep stages: 0.882
[2024-10-17 02:06:24,056] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-10-17 02:06:24,391] {result_logger:134} INFO - 
[[778450  30531  48793]
 [  3780  88769   3954]
 [ 24815  26346 616096]]
[2024-10-17 02:06:24,725] {result_logger:141} INFO - 
[[ 90.75%   3.56%   5.69%]
 [  3.92%  91.99%   4.10%]
 [  3.72%   3.95%  92.33%]]
[2024-10-17 02:06:25,059] {result_logger:145} INFO - 
[[ 96.46%  20.96%   7.30%]
 [  0.47%  60.95%   0.59%]
 [  3.07%  18.09%  92.11%]]
[2024-10-17 02:06:25,060] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-10-17 02:06:25,097] {result_logger:134} INFO - 
[[128295   3253   7154]
 [   827  14059    717]
 [  4054   3446 100406]]
[2024-10-17 02:06:25,217] {result_logger:141} INFO - 
[[ 92.50%   2.35%   5.16%]
 [  5.30%  90.10%   4.60%]
 [  3.76%   3.19%  93.05%]]
[2024-10-17 02:06:25,338] {result_logger:145} INFO - 
[[ 96.33%  15.67%   6.61%]
 [  0.62%  67.73%   0.66%]
 [  3.04%  16.60%  92.73%]]
[2024-10-17 02:06:25,961] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-10-17 02:06:25,961] {result_logger:77} INFO - actual:
[2024-10-17 02:06:25,962] {result_logger:78} INFO - 
[[92.77%  0.10%  7.14%]
 [14.73% 66.42% 18.85%]
 [ 7.17%  4.73% 88.10%]]
[2024-10-17 02:06:25,962] {result_logger:79} INFO - predicted:
[2024-10-17 02:06:25,962] {result_logger:80} INFO - 
[[90.45%  1.84%  7.72%]
 [23.01% 55.82% 21.17%]
 [ 7.34%  6.21% 86.45%]]
[2024-10-17 02:06:26,039] {train_model:92} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/step4E_august/Maiken/model_8conv_2fc-best.pth
[2024-10-17 02:06:26,039] {run_experiment_multiple_labs:112} INFO - [epoch  19] execution time: 477.65s	 avg f1-score: 0.8820

[2024-10-17 02:08:04,147] {train_model:80} INFO - Train Epoch: 20 [161792/1621534 (10%)]	lr:1.58e-04	Loss: 0.157556
[2024-10-17 02:08:33,143] {train_model:80} INFO - Train Epoch: 20 [323840/1621534 (20%)]	lr:1.58e-04	Loss: 0.188305
[2024-10-17 02:09:02,463] {train_model:80} INFO - Train Epoch: 20 [485888/1621534 (30%)]	lr:1.58e-04	Loss: 0.355853
[2024-10-17 02:09:32,511] {train_model:80} INFO - Train Epoch: 20 [647936/1621534 (40%)]	lr:1.58e-04	Loss: 0.239697
[2024-10-17 02:10:02,790] {train_model:80} INFO - Train Epoch: 20 [809984/1621534 (50%)]	lr:1.58e-04	Loss: 0.203122
[2024-10-17 02:10:33,174] {train_model:80} INFO - Train Epoch: 20 [972032/1621534 (60%)]	lr:1.58e-04	Loss: 0.202394
[2024-10-17 02:11:03,692] {train_model:80} INFO - Train Epoch: 20 [1134080/1621534 (70%)]	lr:1.58e-04	Loss: 0.197560
[2024-10-17 02:11:33,987] {train_model:80} INFO - Train Epoch: 20 [1296128/1621534 (80%)]	lr:1.58e-04	Loss: 0.212224
[2024-10-17 02:12:04,310] {train_model:80} INFO - Train Epoch: 20 [1458176/1621534 (90%)]	lr:1.58e-04	Loss: 0.128578
[2024-10-17 02:12:34,799] {train_model:80} INFO - Train Epoch: 20 [1620224/1621534 (100%)]	lr:1.58e-04	Loss: 0.138487
[2024-10-17 02:14:02,819] {run_experiment_multiple_labs:78} INFO - 
[2024-10-17 02:14:02,821] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-10-17 02:14:05,766] {result_logger:103} INFO - precision on Wake: 0.965
[2024-10-17 02:14:07,719] {result_logger:104} INFO - recall on Wake: 0.909
[2024-10-17 02:14:09,689] {result_logger:107} INFO - F1-score on Wake: 0.936
[2024-10-17 02:14:09,689] {result_logger:108} INFO - 
[2024-10-17 02:14:12,474] {result_logger:103} INFO - precision on REM: 0.616
[2024-10-17 02:14:14,201] {result_logger:104} INFO - recall on REM: 0.922
[2024-10-17 02:14:15,949] {result_logger:107} INFO - F1-score on REM: 0.739
[2024-10-17 02:14:15,949] {result_logger:108} INFO - 
[2024-10-17 02:14:18,990] {result_logger:103} INFO - precision on Non REM: 0.922
[2024-10-17 02:14:20,976] {result_logger:104} INFO - recall on Non REM: 0.924
[2024-10-17 02:14:22,956] {result_logger:107} INFO - F1-score on Non REM: 0.923
[2024-10-17 02:14:22,956] {result_logger:108} INFO - 
[2024-10-17 02:14:23,439] {result_logger:111} INFO - average precision on sleep stages: 0.834
[2024-10-17 02:14:23,920] {result_logger:113} INFO - average recall on sleep stages: 0.918
[2024-10-17 02:14:24,401] {result_logger:115} INFO - average F1-score on sleep stages: 0.866
[2024-10-17 02:14:24,406] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-10-17 02:14:24,846] {result_logger:103} INFO - precision on Wake: 0.969
[2024-10-17 02:14:25,117] {result_logger:104} INFO - recall on Wake: 0.917
[2024-10-17 02:14:25,389] {result_logger:107} INFO - F1-score on Wake: 0.942
[2024-10-17 02:14:25,390] {result_logger:108} INFO - 
[2024-10-17 02:14:25,829] {result_logger:103} INFO - precision on REM: 0.611
[2024-10-17 02:14:26,098] {result_logger:104} INFO - recall on REM: 0.938
[2024-10-17 02:14:26,364] {result_logger:107} INFO - F1-score on REM: 0.740
[2024-10-17 02:14:26,365] {result_logger:108} INFO - 
[2024-10-17 02:14:26,809] {result_logger:103} INFO - precision on Non REM: 0.930
[2024-10-17 02:14:27,085] {result_logger:104} INFO - recall on Non REM: 0.921
[2024-10-17 02:14:27,361] {result_logger:107} INFO - F1-score on Non REM: 0.926
[2024-10-17 02:14:27,361] {result_logger:108} INFO - 
[2024-10-17 02:14:27,415] {result_logger:111} INFO - average precision on sleep stages: 0.836
[2024-10-17 02:14:27,469] {result_logger:113} INFO - average recall on sleep stages: 0.925
[2024-10-17 02:14:27,523] {result_logger:115} INFO - average F1-score on sleep stages: 0.869
[2024-10-17 02:14:27,524] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-10-17 02:14:27,857] {result_logger:134} INFO - 
[[779999  29425  48350]
 [  3607  88961   3935]
 [ 24831  25942 616484]]
[2024-10-17 02:14:28,190] {result_logger:141} INFO - 
[[ 90.93%   3.43%   5.64%]
 [  3.74%  92.18%   4.08%]
 [  3.72%   3.89%  92.39%]]
[2024-10-17 02:14:28,524] {result_logger:145} INFO - 
[[ 96.48%  20.39%   7.23%]
 [  0.45%  61.64%   0.59%]
 [  3.07%  17.97%  92.18%]]
[2024-10-17 02:14:28,524] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-10-17 02:14:28,562] {result_logger:134} INFO - 
[[127177   4520   7005]
 [   450  14639    514]
 [  3686   4799  99421]]
[2024-10-17 02:14:28,600] {result_logger:141} INFO - 
[[ 91.69%   3.26%   5.05%]
 [  2.88%  93.82%   3.29%]
 [  3.42%   4.45%  92.14%]]
[2024-10-17 02:14:28,638] {result_logger:145} INFO - 
[[ 96.85%  18.87%   6.55%]
 [  0.34%  61.10%   0.48%]
 [  2.81%  20.03%  92.97%]]
[2024-10-17 02:14:29,126] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-10-17 02:14:29,126] {result_logger:77} INFO - actual:
[2024-10-17 02:14:29,126] {result_logger:78} INFO - 
[[92.77%  0.10%  7.14%]
 [14.73% 66.42% 18.85%]
 [ 7.17%  4.73% 88.10%]]
[2024-10-17 02:14:29,126] {result_logger:79} INFO - predicted:
[2024-10-17 02:14:29,126] {result_logger:80} INFO - 
[[90.02%  2.43%  7.56%]
 [23.20% 55.35% 21.45%]
 [ 7.06%  7.02% 85.92%]]
[2024-10-17 02:14:29,127] {run_experiment_multiple_labs:112} INFO - [epoch  20] execution time: 483.09s	 avg f1-score: 0.8692

[2024-10-17 02:16:03,832] {train_model:80} INFO - Train Epoch: 21 [161792/1621534 (10%)]	lr:1.49e-04	Loss: 0.233110
[2024-10-17 02:16:32,798] {train_model:80} INFO - Train Epoch: 21 [323840/1621534 (20%)]	lr:1.49e-04	Loss: 0.201922
[2024-10-17 02:17:02,037] {train_model:80} INFO - Train Epoch: 21 [485888/1621534 (30%)]	lr:1.49e-04	Loss: 0.188094
[2024-10-17 02:17:31,530] {train_model:80} INFO - Train Epoch: 21 [647936/1621534 (40%)]	lr:1.49e-04	Loss: 0.193186
[2024-10-17 02:18:01,176] {train_model:80} INFO - Train Epoch: 21 [809984/1621534 (50%)]	lr:1.49e-04	Loss: 0.137566
[2024-10-17 02:18:30,963] {train_model:80} INFO - Train Epoch: 21 [972032/1621534 (60%)]	lr:1.49e-04	Loss: 0.145398
[2024-10-17 02:19:01,124] {train_model:80} INFO - Train Epoch: 21 [1134080/1621534 (70%)]	lr:1.49e-04	Loss: 0.306993
[2024-10-17 02:19:31,501] {train_model:80} INFO - Train Epoch: 21 [1296128/1621534 (80%)]	lr:1.49e-04	Loss: 0.116090
[2024-10-17 02:20:02,259] {train_model:80} INFO - Train Epoch: 21 [1458176/1621534 (90%)]	lr:1.49e-04	Loss: 0.377354
[2024-10-17 02:20:32,726] {train_model:80} INFO - Train Epoch: 21 [1620224/1621534 (100%)]	lr:1.49e-04	Loss: 0.253069
[2024-10-17 02:22:00,776] {run_experiment_multiple_labs:78} INFO - 
[2024-10-17 02:22:00,777] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-10-17 02:22:03,754] {result_logger:103} INFO - precision on Wake: 0.965
[2024-10-17 02:22:05,703] {result_logger:104} INFO - recall on Wake: 0.911
[2024-10-17 02:22:07,684] {result_logger:107} INFO - F1-score on Wake: 0.937
[2024-10-17 02:22:07,684] {result_logger:108} INFO - 
[2024-10-17 02:22:10,468] {result_logger:103} INFO - precision on REM: 0.623
[2024-10-17 02:22:12,246] {result_logger:104} INFO - recall on REM: 0.923
[2024-10-17 02:22:13,965] {result_logger:107} INFO - F1-score on REM: 0.744
[2024-10-17 02:22:13,965] {result_logger:108} INFO - 
[2024-10-17 02:22:17,036] {result_logger:103} INFO - precision on Non REM: 0.922
[2024-10-17 02:22:19,011] {result_logger:104} INFO - recall on Non REM: 0.925
[2024-10-17 02:22:20,990] {result_logger:107} INFO - F1-score on Non REM: 0.924
[2024-10-17 02:22:20,990] {result_logger:108} INFO - 
[2024-10-17 02:22:21,479] {result_logger:111} INFO - average precision on sleep stages: 0.837
[2024-10-17 02:22:21,967] {result_logger:113} INFO - average recall on sleep stages: 0.920
[2024-10-17 02:22:22,454] {result_logger:115} INFO - average F1-score on sleep stages: 0.868
[2024-10-17 02:22:22,458] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-10-17 02:22:22,899] {result_logger:103} INFO - precision on Wake: 0.968
[2024-10-17 02:22:23,170] {result_logger:104} INFO - recall on Wake: 0.914
[2024-10-17 02:22:23,440] {result_logger:107} INFO - F1-score on Wake: 0.940
[2024-10-17 02:22:23,440] {result_logger:108} INFO - 
[2024-10-17 02:22:23,879] {result_logger:103} INFO - precision on REM: 0.594
[2024-10-17 02:22:24,152] {result_logger:104} INFO - recall on REM: 0.943
[2024-10-17 02:22:24,425] {result_logger:107} INFO - F1-score on REM: 0.729
[2024-10-17 02:22:24,425] {result_logger:108} INFO - 
[2024-10-17 02:22:24,889] {result_logger:103} INFO - precision on Non REM: 0.934
[2024-10-17 02:22:25,166] {result_logger:104} INFO - recall on Non REM: 0.922
[2024-10-17 02:22:25,443] {result_logger:107} INFO - F1-score on Non REM: 0.928
[2024-10-17 02:22:25,443] {result_logger:108} INFO - 
[2024-10-17 02:22:25,498] {result_logger:111} INFO - average precision on sleep stages: 0.832
[2024-10-17 02:22:25,552] {result_logger:113} INFO - average recall on sleep stages: 0.926
[2024-10-17 02:22:25,607] {result_logger:115} INFO - average F1-score on sleep stages: 0.866
[2024-10-17 02:22:25,608] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-10-17 02:22:25,946] {result_logger:134} INFO - 
[[781075  28587  48112]
 [  3583  89119   3801]
 [ 24558  25413 617286]]
[2024-10-17 02:22:26,283] {result_logger:141} INFO - 
[[ 91.06%   3.33%   5.61%]
 [  3.71%  92.35%   3.94%]
 [  3.68%   3.81%  92.51%]]
[2024-10-17 02:22:26,619] {result_logger:145} INFO - 
[[ 96.52%  19.97%   7.19%]
 [  0.44%  62.27%   0.57%]
 [  3.03%  17.76%  92.24%]]
[2024-10-17 02:22:26,620] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-10-17 02:22:26,658] {result_logger:134} INFO - 
[[126740   5426   6536]
 [   394  14711    498]
 [  3851   4619  99436]]
[2024-10-17 02:22:26,697] {result_logger:141} INFO - 
[[ 91.38%   3.91%   4.71%]
 [  2.53%  94.28%   3.19%]
 [  3.57%   4.28%  92.15%]]
[2024-10-17 02:22:26,735] {result_logger:145} INFO - 
[[ 96.76%  21.92%   6.14%]
 [  0.30%  59.42%   0.47%]
 [  2.94%  18.66%  93.39%]]
[2024-10-17 02:22:27,234] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-10-17 02:22:27,234] {result_logger:77} INFO - actual:
[2024-10-17 02:22:27,234] {result_logger:78} INFO - 
[[92.77%  0.10%  7.14%]
 [14.73% 66.42% 18.85%]
 [ 7.17%  4.73% 88.10%]]
[2024-10-17 02:22:27,234] {result_logger:79} INFO - predicted:
[2024-10-17 02:22:27,234] {result_logger:80} INFO - 
[[89.88%  2.81%  7.32%]
 [23.38% 55.40% 21.23%]
 [ 7.02%  6.92% 86.06%]]
[2024-10-17 02:22:27,234] {run_experiment_multiple_labs:112} INFO - [epoch  21] execution time: 478.11s	 avg f1-score: 0.8655

[2024-10-17 02:24:01,956] {train_model:80} INFO - Train Epoch: 22 [161792/1621534 (10%)]	lr:1.40e-04	Loss: 0.123307
[2024-10-17 02:24:30,951] {train_model:80} INFO - Train Epoch: 22 [323840/1621534 (20%)]	lr:1.40e-04	Loss: 0.186018
[2024-10-17 02:24:59,798] {train_model:80} INFO - Train Epoch: 22 [485888/1621534 (30%)]	lr:1.40e-04	Loss: 0.194293
[2024-10-17 02:25:29,468] {train_model:80} INFO - Train Epoch: 22 [647936/1621534 (40%)]	lr:1.40e-04	Loss: 0.334839
[2024-10-17 02:25:59,358] {train_model:80} INFO - Train Epoch: 22 [809984/1621534 (50%)]	lr:1.40e-04	Loss: 0.197936
[2024-10-17 02:26:29,962] {train_model:80} INFO - Train Epoch: 22 [972032/1621534 (60%)]	lr:1.40e-04	Loss: 0.196766
[2024-10-17 02:27:00,170] {train_model:80} INFO - Train Epoch: 22 [1134080/1621534 (70%)]	lr:1.40e-04	Loss: 0.168753
[2024-10-17 02:27:30,560] {train_model:80} INFO - Train Epoch: 22 [1296128/1621534 (80%)]	lr:1.40e-04	Loss: 0.129996
[2024-10-17 02:28:01,065] {train_model:80} INFO - Train Epoch: 22 [1458176/1621534 (90%)]	lr:1.40e-04	Loss: 0.197510
[2024-10-17 02:28:31,687] {train_model:80} INFO - Train Epoch: 22 [1620224/1621534 (100%)]	lr:1.40e-04	Loss: 0.299232
[2024-10-17 02:29:59,413] {run_experiment_multiple_labs:78} INFO - 
[2024-10-17 02:29:59,414] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-10-17 02:30:02,436] {result_logger:103} INFO - precision on Wake: 0.966
[2024-10-17 02:30:04,422] {result_logger:104} INFO - recall on Wake: 0.911
[2024-10-17 02:30:06,496] {result_logger:107} INFO - F1-score on Wake: 0.937
[2024-10-17 02:30:06,496] {result_logger:108} INFO - 
[2024-10-17 02:30:09,381] {result_logger:103} INFO - precision on REM: 0.625
[2024-10-17 02:30:11,194] {result_logger:104} INFO - recall on REM: 0.924
[2024-10-17 02:30:12,991] {result_logger:107} INFO - F1-score on REM: 0.746
[2024-10-17 02:30:12,991] {result_logger:108} INFO - 
[2024-10-17 02:30:16,102] {result_logger:103} INFO - precision on Non REM: 0.923
[2024-10-17 02:30:18,131] {result_logger:104} INFO - recall on Non REM: 0.926
[2024-10-17 02:30:20,166] {result_logger:107} INFO - F1-score on Non REM: 0.924
[2024-10-17 02:30:20,166] {result_logger:108} INFO - 
[2024-10-17 02:30:20,632] {result_logger:111} INFO - average precision on sleep stages: 0.838
[2024-10-17 02:30:21,099] {result_logger:113} INFO - average recall on sleep stages: 0.920
[2024-10-17 02:30:21,568] {result_logger:115} INFO - average F1-score on sleep stages: 0.869
[2024-10-17 02:30:21,574] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-10-17 02:30:22,038] {result_logger:103} INFO - precision on Wake: 0.965
[2024-10-17 02:30:22,321] {result_logger:104} INFO - recall on Wake: 0.913
[2024-10-17 02:30:22,607] {result_logger:107} INFO - F1-score on Wake: 0.939
[2024-10-17 02:30:22,607] {result_logger:108} INFO - 
[2024-10-17 02:30:23,064] {result_logger:103} INFO - precision on REM: 0.641
[2024-10-17 02:30:23,346] {result_logger:104} INFO - recall on REM: 0.927
[2024-10-17 02:30:23,626] {result_logger:107} INFO - F1-score on REM: 0.758
[2024-10-17 02:30:23,626] {result_logger:108} INFO - 
[2024-10-17 02:30:24,103] {result_logger:103} INFO - precision on Non REM: 0.923
[2024-10-17 02:30:24,395] {result_logger:104} INFO - recall on Non REM: 0.928
[2024-10-17 02:30:24,685] {result_logger:107} INFO - F1-score on Non REM: 0.925
[2024-10-17 02:30:24,685] {result_logger:108} INFO - 
[2024-10-17 02:30:24,738] {result_logger:111} INFO - average precision on sleep stages: 0.843
[2024-10-17 02:30:24,794] {result_logger:113} INFO - average recall on sleep stages: 0.923
[2024-10-17 02:30:24,848] {result_logger:115} INFO - average F1-score on sleep stages: 0.874
[2024-10-17 02:30:24,849] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-10-17 02:30:25,175] {result_logger:134} INFO - 
[[781340  28542  47892]
 [  3486  89201   3816]
 [ 24318  25033 617906]]
[2024-10-17 02:30:25,498] {result_logger:141} INFO - 
[[ 91.09%   3.33%   5.58%]
 [  3.61%  92.43%   3.95%]
 [  3.64%   3.75%  92.60%]]
[2024-10-17 02:30:25,822] {result_logger:145} INFO - 
[[ 96.56%  19.99%   7.15%]
 [  0.43%  62.48%   0.57%]
 [  3.01%  17.53%  92.28%]]
[2024-10-17 02:30:25,823] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-10-17 02:30:25,861] {result_logger:134} INFO - 
[[126663   4353   7686]
 [   494  14470    639]
 [  4046   3749 100111]]
[2024-10-17 02:30:25,899] {result_logger:141} INFO - 
[[ 91.32%   3.14%   5.54%]
 [  3.17%  92.74%   4.10%]
 [  3.75%   3.47%  92.78%]]
[2024-10-17 02:30:25,937] {result_logger:145} INFO - 
[[ 96.54%  19.28%   7.09%]
 [  0.38%  64.11%   0.59%]
 [  3.08%  16.61%  92.32%]]
[2024-10-17 02:30:26,424] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-10-17 02:30:26,424] {result_logger:77} INFO - actual:
[2024-10-17 02:30:26,425] {result_logger:78} INFO - 
[[92.77%  0.10%  7.14%]
 [14.73% 66.42% 18.85%]
 [ 7.17%  4.73% 88.10%]]
[2024-10-17 02:30:26,425] {result_logger:79} INFO - predicted:
[2024-10-17 02:30:26,425] {result_logger:80} INFO - 
[[90.03%  2.29%  7.68%]
 [22.82% 56.11% 21.07%]
 [ 7.32%  6.36% 86.32%]]
[2024-10-17 02:30:26,425] {run_experiment_multiple_labs:112} INFO - [epoch  22] execution time: 479.19s	 avg f1-score: 0.8741

[2024-10-17 02:32:01,394] {train_model:80} INFO - Train Epoch: 23 [161792/1621534 (10%)]	lr:1.32e-04	Loss: 0.215580
[2024-10-17 02:32:29,836] {train_model:80} INFO - Train Epoch: 23 [323840/1621534 (20%)]	lr:1.32e-04	Loss: 0.192136
[2024-10-17 02:32:58,758] {train_model:80} INFO - Train Epoch: 23 [485888/1621534 (30%)]	lr:1.32e-04	Loss: 0.445086
[2024-10-17 02:33:29,203] {train_model:80} INFO - Train Epoch: 23 [647936/1621534 (40%)]	lr:1.32e-04	Loss: 0.160819
[2024-10-17 02:33:59,736] {train_model:80} INFO - Train Epoch: 23 [809984/1621534 (50%)]	lr:1.32e-04	Loss: 0.254381
[2024-10-17 02:34:29,801] {train_model:80} INFO - Train Epoch: 23 [972032/1621534 (60%)]	lr:1.32e-04	Loss: 0.092229
[2024-10-17 02:35:00,418] {train_model:80} INFO - Train Epoch: 23 [1134080/1621534 (70%)]	lr:1.32e-04	Loss: 0.277513
[2024-10-17 02:35:31,094] {train_model:80} INFO - Train Epoch: 23 [1296128/1621534 (80%)]	lr:1.32e-04	Loss: 0.119710
[2024-10-17 02:36:01,934] {train_model:80} INFO - Train Epoch: 23 [1458176/1621534 (90%)]	lr:1.32e-04	Loss: 0.105940
[2024-10-17 02:36:32,772] {train_model:80} INFO - Train Epoch: 23 [1620224/1621534 (100%)]	lr:1.32e-04	Loss: 0.168912
[2024-10-17 02:38:01,162] {run_experiment_multiple_labs:78} INFO - 
[2024-10-17 02:38:01,163] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-10-17 02:38:04,203] {result_logger:103} INFO - precision on Wake: 0.966
[2024-10-17 02:38:06,173] {result_logger:104} INFO - recall on Wake: 0.912
[2024-10-17 02:38:08,166] {result_logger:107} INFO - F1-score on Wake: 0.938
[2024-10-17 02:38:08,166] {result_logger:108} INFO - 
[2024-10-17 02:38:10,946] {result_logger:103} INFO - precision on REM: 0.630
[2024-10-17 02:38:12,705] {result_logger:104} INFO - recall on REM: 0.926
[2024-10-17 02:38:14,447] {result_logger:107} INFO - F1-score on REM: 0.750
[2024-10-17 02:38:14,447] {result_logger:108} INFO - 
[2024-10-17 02:38:17,466] {result_logger:103} INFO - precision on Non REM: 0.923
[2024-10-17 02:38:19,436] {result_logger:104} INFO - recall on Non REM: 0.927
[2024-10-17 02:38:21,383] {result_logger:107} INFO - F1-score on Non REM: 0.925
[2024-10-17 02:38:21,383] {result_logger:108} INFO - 
[2024-10-17 02:38:21,855] {result_logger:111} INFO - average precision on sleep stages: 0.840
[2024-10-17 02:38:22,326] {result_logger:113} INFO - average recall on sleep stages: 0.922
[2024-10-17 02:38:22,799] {result_logger:115} INFO - average F1-score on sleep stages: 0.871
[2024-10-17 02:38:22,804] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-10-17 02:38:23,245] {result_logger:103} INFO - precision on Wake: 0.971
[2024-10-17 02:38:23,516] {result_logger:104} INFO - recall on Wake: 0.917
[2024-10-17 02:38:23,789] {result_logger:107} INFO - F1-score on Wake: 0.943
[2024-10-17 02:38:23,789] {result_logger:108} INFO - 
[2024-10-17 02:38:24,230] {result_logger:103} INFO - precision on REM: 0.661
[2024-10-17 02:38:24,495] {result_logger:104} INFO - recall on REM: 0.929
[2024-10-17 02:38:24,757] {result_logger:107} INFO - F1-score on REM: 0.772
[2024-10-17 02:38:24,757] {result_logger:108} INFO - 
[2024-10-17 02:38:25,202] {result_logger:103} INFO - precision on Non REM: 0.924
[2024-10-17 02:38:25,473] {result_logger:104} INFO - recall on Non REM: 0.935
[2024-10-17 02:38:25,746] {result_logger:107} INFO - F1-score on Non REM: 0.930
[2024-10-17 02:38:25,746] {result_logger:108} INFO - 
[2024-10-17 02:38:25,800] {result_logger:111} INFO - average precision on sleep stages: 0.852
[2024-10-17 02:38:25,853] {result_logger:113} INFO - average recall on sleep stages: 0.927
[2024-10-17 02:38:25,907] {result_logger:115} INFO - average F1-score on sleep stages: 0.882
[2024-10-17 02:38:25,908] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-10-17 02:38:26,235] {result_logger:134} INFO - 
[[782471  27501  47802]
 [  3445  89323   3735]
 [ 23859  24932 618466]]
[2024-10-17 02:38:26,561] {result_logger:141} INFO - 
[[ 91.22%   3.21%   5.57%]
 [  3.57%  92.56%   3.87%]
 [  3.58%   3.74%  92.69%]]
[2024-10-17 02:38:26,888] {result_logger:145} INFO - 
[[ 96.63%  19.40%   7.13%]
 [  0.43%  63.01%   0.56%]
 [  2.95%  17.59%  92.31%]]
[2024-10-17 02:38:26,888] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-10-17 02:38:26,926] {result_logger:134} INFO - 
[[127191   3892   7619]
 [   426  14489    688]
 [  3418   3546 100942]]
[2024-10-17 02:38:26,964] {result_logger:141} INFO - 
[[ 91.70%   2.81%   5.49%]
 [  2.73%  92.86%   4.41%]
 [  3.17%   3.29%  93.55%]]
[2024-10-17 02:38:27,002] {result_logger:145} INFO - 
[[ 97.07%  17.75%   6.97%]
 [  0.33%  66.08%   0.63%]
 [  2.61%  16.17%  92.40%]]
[2024-10-17 02:38:27,491] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-10-17 02:38:27,491] {result_logger:77} INFO - actual:
[2024-10-17 02:38:27,491] {result_logger:78} INFO - 
[[92.77%  0.10%  7.14%]
 [14.73% 66.42% 18.85%]
 [ 7.17%  4.73% 88.10%]]
[2024-10-17 02:38:27,491] {result_logger:79} INFO - predicted:
[2024-10-17 02:38:27,491] {result_logger:80} INFO - 
[[90.55%  2.09%  7.36%]
 [21.85% 56.88% 21.27%]
 [ 6.95%  6.15% 86.90%]]
[2024-10-17 02:38:27,491] {run_experiment_multiple_labs:112} INFO - [epoch  23] execution time: 481.07s	 avg f1-score: 0.8816

[2024-10-17 02:40:02,009] {train_model:80} INFO - Train Epoch: 24 [161792/1621534 (10%)]	lr:1.25e-04	Loss: 0.128088
[2024-10-17 02:40:31,550] {train_model:80} INFO - Train Epoch: 24 [323840/1621534 (20%)]	lr:1.25e-04	Loss: 0.277047
[2024-10-17 02:41:00,927] {train_model:80} INFO - Train Epoch: 24 [485888/1621534 (30%)]	lr:1.25e-04	Loss: 0.112953
[2024-10-17 02:41:30,614] {train_model:80} INFO - Train Epoch: 24 [647936/1621534 (40%)]	lr:1.25e-04	Loss: 0.212240
[2024-10-17 02:42:01,317] {train_model:80} INFO - Train Epoch: 24 [809984/1621534 (50%)]	lr:1.25e-04	Loss: 0.165802
[2024-10-17 02:42:31,171] {train_model:80} INFO - Train Epoch: 24 [972032/1621534 (60%)]	lr:1.25e-04	Loss: 0.201409
[2024-10-17 02:43:00,952] {train_model:80} INFO - Train Epoch: 24 [1134080/1621534 (70%)]	lr:1.25e-04	Loss: 0.293812
[2024-10-17 02:43:31,323] {train_model:80} INFO - Train Epoch: 24 [1296128/1621534 (80%)]	lr:1.25e-04	Loss: 0.200445
[2024-10-17 02:44:01,329] {train_model:80} INFO - Train Epoch: 24 [1458176/1621534 (90%)]	lr:1.25e-04	Loss: 0.196153
[2024-10-17 02:44:31,891] {train_model:80} INFO - Train Epoch: 24 [1620224/1621534 (100%)]	lr:1.25e-04	Loss: 0.136514
[2024-10-17 02:45:59,952] {run_experiment_multiple_labs:78} INFO - 
[2024-10-17 02:45:59,953] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-10-17 02:46:02,949] {result_logger:103} INFO - precision on Wake: 0.966
[2024-10-17 02:46:04,910] {result_logger:104} INFO - recall on Wake: 0.913
[2024-10-17 02:46:06,895] {result_logger:107} INFO - F1-score on Wake: 0.939
[2024-10-17 02:46:06,896] {result_logger:108} INFO - 
[2024-10-17 02:46:09,726] {result_logger:103} INFO - precision on REM: 0.633
[2024-10-17 02:46:11,501] {result_logger:104} INFO - recall on REM: 0.927
[2024-10-17 02:46:13,268] {result_logger:107} INFO - F1-score on REM: 0.752
[2024-10-17 02:46:13,268] {result_logger:108} INFO - 
[2024-10-17 02:46:16,287] {result_logger:103} INFO - precision on Non REM: 0.924
[2024-10-17 02:46:18,310] {result_logger:104} INFO - recall on Non REM: 0.927
[2024-10-17 02:46:20,318] {result_logger:107} INFO - F1-score on Non REM: 0.925
[2024-10-17 02:46:20,318] {result_logger:108} INFO - 
[2024-10-17 02:46:20,772] {result_logger:111} INFO - average precision on sleep stages: 0.841
[2024-10-17 02:46:21,225] {result_logger:113} INFO - average recall on sleep stages: 0.922
[2024-10-17 02:46:21,681] {result_logger:115} INFO - average F1-score on sleep stages: 0.872
[2024-10-17 02:46:21,686] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-10-17 02:46:22,145] {result_logger:103} INFO - precision on Wake: 0.964
[2024-10-17 02:46:22,426] {result_logger:104} INFO - recall on Wake: 0.926
[2024-10-17 02:46:22,707] {result_logger:107} INFO - F1-score on Wake: 0.945
[2024-10-17 02:46:22,707] {result_logger:108} INFO - 
[2024-10-17 02:46:23,162] {result_logger:103} INFO - precision on REM: 0.632
[2024-10-17 02:46:23,441] {result_logger:104} INFO - recall on REM: 0.940
[2024-10-17 02:46:23,719] {result_logger:107} INFO - F1-score on REM: 0.756
[2024-10-17 02:46:23,719] {result_logger:108} INFO - 
[2024-10-17 02:46:24,183] {result_logger:103} INFO - precision on Non REM: 0.936
[2024-10-17 02:46:24,471] {result_logger:104} INFO - recall on Non REM: 0.917
[2024-10-17 02:46:24,762] {result_logger:107} INFO - F1-score on Non REM: 0.926
[2024-10-17 02:46:24,762] {result_logger:108} INFO - 
[2024-10-17 02:46:24,817] {result_logger:111} INFO - average precision on sleep stages: 0.844
[2024-10-17 02:46:24,871] {result_logger:113} INFO - average recall on sleep stages: 0.928
[2024-10-17 02:46:24,926] {result_logger:115} INFO - average F1-score on sleep stages: 0.876
[2024-10-17 02:46:24,927] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-10-17 02:46:25,236] {result_logger:134} INFO - 
[[783245  27164  47365]
 [  3336  89427   3740]
 [ 24127  24721 618409]]
[2024-10-17 02:46:25,551] {result_logger:141} INFO - 
[[ 91.31%   3.17%   5.52%]
 [  3.46%  92.67%   3.88%]
 [  3.62%   3.70%  92.68%]]
[2024-10-17 02:46:25,863] {result_logger:145} INFO - 
[[ 96.61%  19.22%   7.07%]
 [  0.41%  63.28%   0.56%]
 [  2.98%  17.49%  92.37%]]
[2024-10-17 02:46:25,863] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-10-17 02:46:25,901] {result_logger:134} INFO - 
[[128452   3964   6286]
 [   445  14666    492]
 [  4370   4560  98976]]
[2024-10-17 02:46:25,940] {result_logger:141} INFO - 
[[ 92.61%   2.86%   4.53%]
 [  2.85%  93.99%   3.15%]
 [  4.05%   4.23%  91.72%]]
[2024-10-17 02:46:25,978] {result_logger:145} INFO - 
[[ 96.39%  17.09%   5.94%]
 [  0.33%  63.24%   0.47%]
 [  3.28%  19.66%  93.59%]]
[2024-10-17 02:46:26,471] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-10-17 02:46:26,471] {result_logger:77} INFO - actual:
[2024-10-17 02:46:26,471] {result_logger:78} INFO - 
[[92.77%  0.10%  7.14%]
 [14.73% 66.42% 18.85%]
 [ 7.17%  4.73% 88.10%]]
[2024-10-17 02:46:26,471] {result_logger:79} INFO - predicted:
[2024-10-17 02:46:26,472] {result_logger:80} INFO - 
[[90.23%  2.16%  7.61%]
 [22.42% 56.94% 20.63%]
 [ 7.39%  6.72% 85.89%]]
[2024-10-17 02:46:26,472] {run_experiment_multiple_labs:112} INFO - [epoch  24] execution time: 478.98s	 avg f1-score: 0.8757

[2024-10-17 02:48:01,322] {train_model:80} INFO - Train Epoch: 25 [161792/1621534 (10%)]	lr:1.17e-04	Loss: 0.122736
[2024-10-17 02:48:30,333] {train_model:80} INFO - Train Epoch: 25 [323840/1621534 (20%)]	lr:1.17e-04	Loss: 0.108565
[2024-10-17 02:48:59,659] {train_model:80} INFO - Train Epoch: 25 [485888/1621534 (30%)]	lr:1.17e-04	Loss: 0.240089
[2024-10-17 02:49:29,033] {train_model:80} INFO - Train Epoch: 25 [647936/1621534 (40%)]	lr:1.17e-04	Loss: 0.139046
[2024-10-17 02:49:58,569] {train_model:80} INFO - Train Epoch: 25 [809984/1621534 (50%)]	lr:1.17e-04	Loss: 0.163529
[2024-10-17 02:50:28,398] {train_model:80} INFO - Train Epoch: 25 [972032/1621534 (60%)]	lr:1.17e-04	Loss: 0.245906
[2024-10-17 02:50:58,363] {train_model:80} INFO - Train Epoch: 25 [1134080/1621534 (70%)]	lr:1.17e-04	Loss: 0.563234
[2024-10-17 02:51:28,873] {train_model:80} INFO - Train Epoch: 25 [1296128/1621534 (80%)]	lr:1.17e-04	Loss: 0.307134
[2024-10-17 02:51:59,679] {train_model:80} INFO - Train Epoch: 25 [1458176/1621534 (90%)]	lr:1.17e-04	Loss: 0.385726
[2024-10-17 02:52:30,685] {train_model:80} INFO - Train Epoch: 25 [1620224/1621534 (100%)]	lr:1.17e-04	Loss: 0.330409
[2024-10-17 02:53:58,948] {run_experiment_multiple_labs:78} INFO - 
[2024-10-17 02:53:58,949] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-10-17 02:54:01,937] {result_logger:103} INFO - precision on Wake: 0.967
[2024-10-17 02:54:03,886] {result_logger:104} INFO - recall on Wake: 0.915
[2024-10-17 02:54:05,866] {result_logger:107} INFO - F1-score on Wake: 0.940
[2024-10-17 02:54:05,866] {result_logger:108} INFO - 
[2024-10-17 02:54:08,644] {result_logger:103} INFO - precision on REM: 0.639
[2024-10-17 02:54:10,412] {result_logger:104} INFO - recall on REM: 0.928
[2024-10-17 02:54:12,178] {result_logger:107} INFO - F1-score on REM: 0.757
[2024-10-17 02:54:12,178] {result_logger:108} INFO - 
[2024-10-17 02:54:15,219] {result_logger:103} INFO - precision on Non REM: 0.924
[2024-10-17 02:54:17,171] {result_logger:104} INFO - recall on Non REM: 0.928
[2024-10-17 02:54:19,137] {result_logger:107} INFO - F1-score on Non REM: 0.926
[2024-10-17 02:54:19,137] {result_logger:108} INFO - 
[2024-10-17 02:54:19,592] {result_logger:111} INFO - average precision on sleep stages: 0.843
[2024-10-17 02:54:20,047] {result_logger:113} INFO - average recall on sleep stages: 0.923
[2024-10-17 02:54:20,501] {result_logger:115} INFO - average F1-score on sleep stages: 0.874
[2024-10-17 02:54:20,506] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-10-17 02:54:20,950] {result_logger:103} INFO - precision on Wake: 0.970
[2024-10-17 02:54:21,223] {result_logger:104} INFO - recall on Wake: 0.922
[2024-10-17 02:54:21,492] {result_logger:107} INFO - F1-score on Wake: 0.945
[2024-10-17 02:54:21,492] {result_logger:108} INFO - 
[2024-10-17 02:54:21,944] {result_logger:103} INFO - precision on REM: 0.651
[2024-10-17 02:54:22,216] {result_logger:104} INFO - recall on REM: 0.935
[2024-10-17 02:54:22,489] {result_logger:107} INFO - F1-score on REM: 0.768
[2024-10-17 02:54:22,489] {result_logger:108} INFO - 
[2024-10-17 02:54:22,938] {result_logger:103} INFO - precision on Non REM: 0.928
[2024-10-17 02:54:23,218] {result_logger:104} INFO - recall on Non REM: 0.930
[2024-10-17 02:54:23,498] {result_logger:107} INFO - F1-score on Non REM: 0.929
[2024-10-17 02:54:23,498] {result_logger:108} INFO - 
[2024-10-17 02:54:23,553] {result_logger:111} INFO - average precision on sleep stages: 0.850
[2024-10-17 02:54:23,607] {result_logger:113} INFO - average recall on sleep stages: 0.929
[2024-10-17 02:54:23,661] {result_logger:115} INFO - average F1-score on sleep stages: 0.881
[2024-10-17 02:54:23,662] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-10-17 02:54:23,977] {result_logger:134} INFO - 
[[784467  26370  46937]
 [  3283  89549   3671]
 [ 23858  24268 619131]]
[2024-10-17 02:54:24,291] {result_logger:141} INFO - 
[[ 91.45%   3.07%   5.47%]
 [  3.40%  92.79%   3.80%]
 [  3.58%   3.64%  92.79%]]
[2024-10-17 02:54:24,606] {result_logger:145} INFO - 
[[ 96.66%  18.81%   7.01%]
 [  0.40%  63.88%   0.55%]
 [  2.94%  17.31%  92.44%]]
[2024-10-17 02:54:24,606] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-10-17 02:54:24,644] {result_logger:134} INFO - 
[[127815   3653   7234]
 [   500  14589    514]
 [  3430   4164 100312]]
[2024-10-17 02:54:24,682] {result_logger:141} INFO - 
[[ 92.15%   2.63%   5.22%]
 [  3.20%  93.50%   3.29%]
 [  3.18%   3.86%  92.96%]]
[2024-10-17 02:54:24,720] {result_logger:145} INFO - 
[[ 97.02%  16.30%   6.69%]
 [  0.38%  65.11%   0.48%]
 [  2.60%  18.58%  92.83%]]
[2024-10-17 02:54:25,210] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-10-17 02:54:25,211] {result_logger:77} INFO - actual:
[2024-10-17 02:54:25,211] {result_logger:78} INFO - 
[[92.77%  0.10%  7.14%]
 [14.73% 66.42% 18.85%]
 [ 7.17%  4.73% 88.10%]]
[2024-10-17 02:54:25,211] {result_logger:79} INFO - predicted:
[2024-10-17 02:54:25,211] {result_logger:80} INFO - 
[[90.59%  1.98%  7.43%]
 [22.02% 56.40% 21.57%]
 [ 6.91%  6.63% 86.47%]]
[2024-10-17 02:54:25,211] {run_experiment_multiple_labs:112} INFO - [epoch  25] execution time: 478.74s	 avg f1-score: 0.8806

[2024-10-17 02:54:25,376] {result_logger:56} INFO - final F1-scores on train:
	Wake                : [0.5314057892101869, 0.7750907268580172, 0.8470953856791229, 0.8626810867406098, 0.8781577080384881, 0.8908542374772184, 0.9028579353761084, 0.9096201440323637, 0.9146013293750344, 0.9187920772110217, 0.9227402664261781, 0.9249200613841806, 0.9275452729140499, 0.9295696851144636, 0.9311515959398606, 0.9326039805497911, 0.9336187716339379, 0.9346120460504777, 0.9351767369305612, 0.9362547720546798, 0.9371082010090043, 0.9374666300321912, 0.9384683748423585, 0.9388713812914973, 0.9398292302181287]
	REM                 : [0.19001915037838985, 0.39367241087517046, 0.5181691161793905, 0.5555315141475803, 0.5900251297760332, 0.6181141159213149, 0.6495408270565418, 0.6642123025003835, 0.672473211131609, 0.6825284512030738, 0.6922449892913084, 0.6988687737346542, 0.7064197930142303, 0.7132137881589989, 0.7158855078007372, 0.7237066701680673, 0.7276928018977489, 0.7307314820160499, 0.7331766804735927, 0.7387836283534926, 0.743829865371293, 0.7455815178097535, 0.7497974892868684, 0.752071988730736, 0.7566775106679624]
	Non REM             : [0.6886146627782381, 0.8058658231346836, 0.8484985877070798, 0.8668352414256507, 0.8781557915996276, 0.8860227556851558, 0.893801437869417, 0.8991183095118526, 0.9040735538437168, 0.9081344289378723, 0.9113645257197003, 0.9138126895824091, 0.9157754070780418, 0.9175052953213244, 0.9189297304100033, 0.9200106333986064, 0.9209551819616997, 0.9218724150914865, 0.9222303719781454, 0.9228622796262946, 0.9237655411027373, 0.9244063189342877, 0.9249749487758551, 0.9252280308295138, 0.9261523594685399]
	avg                 : [0.4700132007889383, 0.6582096536226237, 0.7379210298551978, 0.7616826141046137, 0.7821128764713831, 0.7983303696945631, 0.8154000667673557, 0.8243169186815332, 0.8303826981167868, 0.8364849857839892, 0.8421165938123956, 0.8458671749004146, 0.8499134910021073, 0.8534295895315956, 0.8553222780502004, 0.8587737613721549, 0.8607555851644623, 0.8624053143860047, 0.8635279297940999, 0.8659668933448224, 0.8682345358276783, 0.8691514889254108, 0.8710802709683606, 0.872057133617249, 0.8742197001182103]
[2024-10-17 02:54:25,376] {result_logger:56} INFO - final F1-scores on valid:
	Wake                : [0.5709641905203383, 0.7064935868993202, 0.8156957672280283, 0.8829011345218801, 0.8867536440659087, 0.8937504448448569, 0.9121196731840654, 0.9235251061338018, 0.9310093767236625, 0.9161910733238403, 0.9334359054404098, 0.9340117335548517, 0.934506040957918, 0.9263580913534443, 0.9421963191086974, 0.9391277179775197, 0.9429443375572215, 0.9432595928820594, 0.9437688963432127, 0.941999518545266, 0.9399044077022622, 0.9385746836850003, 0.9430741796638947, 0.9446076574903758, 0.9452129252681671]
	REM                 : [0.31762988991059665, 0.5963512763596005, 0.5836649981687217, 0.60482296200447, 0.5568759936406995, 0.5622949209156106, 0.6677200794847854, 0.6757359821492838, 0.7212622866011381, 0.6389408235140659, 0.7044281175536139, 0.720054618555137, 0.7605916677975302, 0.6841026596487958, 0.7481980198019802, 0.7279927812312011, 0.7478791640802813, 0.7711901148926944, 0.7733010643271637, 0.7400722934202876, 0.7290071607324264, 0.7580877537655534, 0.7721289634958699, 0.756115794086562, 0.7676602909837144]
	Non REM             : [0.013415161524801487, 0.0007411112963889351, 0.5981152101894439, 0.8279276113963281, 0.8796346942762259, 0.8851970181043662, 0.902144216851208, 0.9010944950668965, 0.9088264456625446, 0.9107630097300939, 0.9179140219943734, 0.9195199353222967, 0.9181996336410687, 0.920635067794646, 0.9211929318091867, 0.9212215071313316, 0.9231687526813527, 0.9240802024527934, 0.9288982019862803, 0.9255094346648298, 0.9276784714706872, 0.925488347154043, 0.9296769588542745, 0.9264813254703734, 0.9289610401637295]
	avg                 : [0.3006697473185788, 0.43452865818510317, 0.665825325195398, 0.7718839026408927, 0.774421443994278, 0.7804141279549445, 0.8273279898400197, 0.8334518611166607, 0.8536993696624484, 0.8219649688560001, 0.8519260149961324, 0.8578620958107618, 0.8710991141321722, 0.8436986062656286, 0.8705290902399548, 0.8627806687800175, 0.8713307514396185, 0.8795099700758491, 0.881989387552219, 0.8691937488767945, 0.8655300133017919, 0.8740502615348656, 0.8816267006713464, 0.875734925682437, 0.8806114188052035]
[2024-10-17 02:54:25,536] {logger:50} INFO - 
[2024-10-17 02:54:25,536] {logger:51} INFO - ================================================================================
[2024-10-17 02:54:25,536] {logger:52} INFO - finished training
[2024-10-17 02:54:25,536] {logger:53} INFO - ================================================================================
[2024-10-17 02:54:25,536] {logger:54} INFO - 
[2024-10-17 02:54:25,537] {logger:50} INFO - 
[2024-10-17 02:54:25,537] {logger:51} INFO - ================================================================================
[2024-10-17 02:54:25,537] {logger:52} INFO - best model on epoch: 19 	f1-score: 0.8820
[2024-10-17 02:54:25,537] {logger:53} INFO - ================================================================================
[2024-10-17 02:54:25,537] {logger:54} INFO - 
