[2024-08-05 10:35:17,180] {logger:43} INFO - run_experiment.py, args: Namespace(experiment='exp002_E_weighted')
================================================================================
[2024-08-05 10:35:17,181] {logger:44} INFO - config:
[2024-08-05 10:35:17,181] {logger:45} INFO - parameter name      | parameter value
[2024-08-05 10:35:17,181] {logger:46} INFO - experiment          : exp002_E_weighted
[2024-08-05 10:35:17,181] {logger:46} INFO - RUN_NAME            : exp002_E_weighted_2024-08-05_10-35-17
[2024-08-05 10:35:17,181] {logger:46} INFO - DEVICE              : cuda
[2024-08-05 10:35:17,181] {logger:46} INFO - EXPERIMENT_DIR      : /home/s202283/code/grieger_validation/results/exp002_E_weighted
[2024-08-05 10:35:17,181] {logger:46} INFO - MODELS_DIR          : /home/s202283/code/grieger_validation/results/exp002_E_weighted/models
[2024-08-05 10:35:17,181] {logger:46} INFO - VISUALS_DIR         : /home/s202283/code/grieger_validation/results/exp002_E_weighted/visuals/exp002_E_weighted_2024-08-05_10-35-17
[2024-08-05 10:35:17,181] {logger:46} INFO - DATA_DIR            : /scratch/s202283/data/mice-data-tuebingen/data
[2024-08-05 10:35:17,181] {logger:46} INFO - SAMPLE_DURATION     : 10
[2024-08-05 10:35:17,181] {logger:46} INFO - SAMPLING_RATE       : 64
[2024-08-05 10:35:17,181] {logger:46} INFO - SCORING_MAP         : {'Wake': [1, 17], 'REM': [3, 19], 'Non REM': [2, 18], 'Pre REM': [4, 20], 'Artifact': [8, 24]}
[2024-08-05 10:35:17,181] {logger:46} INFO - STAGE_MAP           : {'Wake': 'Wake', 'REM': 'REM', 'Non REM': 'Non REM', 'Pre REM': 'Non REM', 'Artifact': None}
[2024-08-05 10:35:17,181] {logger:46} INFO - DATA_SPLIT          : {'train': ['M19', 'M20', 'M21', 'M22', 'M23', 'M24', 'M25', 'M26', 'M27', 'M28', 'M29', 'M31', 'M32', 'M33'], 'valid': ['M34', 'M35'], 'test': ['M36', 'M37']}
[2024-08-05 10:35:17,181] {logger:46} INFO - DATA_FILE           : /home/s202283/code/grieger_validation/cache/dataset/data_tuebingen_main_stages.h5
[2024-08-05 10:35:17,181] {logger:46} INFO - STAGES              : ['Wake', 'REM', 'Non REM']
[2024-08-05 10:35:17,182] {logger:46} INFO - BALANCED_TRAINING   : False
[2024-08-05 10:35:17,182] {logger:46} INFO - BALANCING_WEIGHTS   : [0.3, 0.18, 0.24, 0.14, 0.14]
[2024-08-05 10:35:17,182] {logger:46} INFO - CHANNELS            : ['EEG_PR']
[2024-08-05 10:35:17,182] {logger:46} INFO - SAMPLES_LEFT        : 1
[2024-08-05 10:35:17,182] {logger:46} INFO - SAMPLES_RIGHT       : 1
[2024-08-05 10:35:17,182] {logger:46} INFO - LOG_INTERVAL        : 10
[2024-08-05 10:35:17,182] {logger:46} INFO - EXTRA_SAFE_MODELS   : False
[2024-08-05 10:35:17,182] {logger:46} INFO - BATCH_SIZE          : 256
[2024-08-05 10:35:17,182] {logger:46} INFO - DATA_FRACTION       : 1.0
[2024-08-05 10:35:17,182] {logger:46} INFO - DATA_FRACTION_STRAT : None
[2024-08-05 10:35:17,182] {logger:46} INFO - EPOCHS              : 50
[2024-08-05 10:35:17,182] {logger:46} INFO - WARMUP_EPOCHS       : 12
[2024-08-05 10:35:17,182] {logger:46} INFO - S_OPTIM_MODE        : exp
[2024-08-05 10:35:17,182] {logger:46} INFO - S_OPTIM_PARAS       : [0.06]
[2024-08-05 10:35:17,182] {logger:46} INFO - LEARNING_RATE       : 0.000256
[2024-08-05 10:35:17,182] {logger:46} INFO - OPTIMIZER           : <class 'torch.optim.adam.Adam'>
[2024-08-05 10:35:17,182] {logger:46} INFO - OPTIM_PARAS         : {}
[2024-08-05 10:35:17,182] {logger:46} INFO - L1_WEIGHT_DECAY     : 0
[2024-08-05 10:35:17,182] {logger:46} INFO - L2_WEIGHT_DECAY     : 0.0001
[2024-08-05 10:35:17,182] {logger:46} INFO - BATCH_SIZE_EVAL     : 512
[2024-08-05 10:35:17,182] {logger:46} INFO - FILTERS             : 96
[2024-08-05 10:35:17,182] {logger:46} INFO - CLASSIFIER_DROPOUT  : [0.2, 0.2]
[2024-08-05 10:35:17,182] {logger:46} INFO - FEATURE_EXTR_DROPOUT: [0.0, 0.2, 0.0, 0.2, 0.0, 0.2, 0.0, 0.2]
[2024-08-05 10:35:17,182] {logger:46} INFO - MODEL_NAME          : model_8conv_2fc
[2024-08-05 10:35:17,182] {logger:46} INFO - GAIN                : 0.0
[2024-08-05 10:35:17,183] {logger:46} INFO - FLIP                : 0.0
[2024-08-05 10:35:17,183] {logger:46} INFO - FLIP_ALL            : 0.0
[2024-08-05 10:35:17,183] {logger:46} INFO - WINDOW_WARP_SIZE    : 0.0
[2024-08-05 10:35:17,183] {logger:46} INFO - FLIP_HORI           : 0.0
[2024-08-05 10:35:17,183] {logger:46} INFO - TIME_SHIFT          : 0.0
[2024-08-05 10:35:17,183] {logger:50} INFO - 
[2024-08-05 10:35:17,183] {logger:51} INFO - ================================================================================
[2024-08-05 10:35:17,183] {logger:52} INFO - start training with model: model_8conv_2fc
[2024-08-05 10:35:17,183] {logger:53} INFO - ================================================================================
[2024-08-05 10:35:17,183] {logger:54} INFO - 
[2024-08-05 10:35:26,291] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:35:26,320] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:35:27,708] {dataloader:120} INFO - data distribution in database for dataset valid:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 20704
[2024-08-05 10:35:27,712] {dataloader:147} INFO - data distribution after processing:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 20704
[2024-08-05 10:35:28,803] {run_experiment:48} INFO - classifier:
Model(
  (feature_extractor): Sequential(
    (0): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): Conv1d(1, 96, kernel_size=(5,), stride=(1,))
    (2): ReLU(inplace=True)
    (3): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): Dropout(p=0.0, inplace=False)
    (5): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (6): ReLU(inplace=True)
    (7): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): Dropout(p=0.2, inplace=False)
    (9): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (10): ReLU(inplace=True)
    (11): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (12): Dropout(p=0.0, inplace=False)
    (13): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (14): ReLU(inplace=True)
    (15): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (16): Dropout(p=0.2, inplace=False)
    (17): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (18): ReLU(inplace=True)
    (19): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (20): Dropout(p=0.0, inplace=False)
    (21): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (22): ReLU(inplace=True)
    (23): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (24): Dropout(p=0.2, inplace=False)
    (25): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (26): ReLU(inplace=True)
    (27): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (28): Dropout(p=0.0, inplace=False)
    (29): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (30): ReLU(inplace=True)
    (31): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (32): Dropout(p=0.2, inplace=False)
  )
  (classifier): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=10848, out_features=80, bias=True)
    (2): ReLU(inplace=True)
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=80, out_features=3, bias=True)
  )
)
[2024-08-05 10:35:43,091] {train_model:82} INFO - Train Epoch: 1 [36352/366120 (10%)]	lr:2.56e-05	Loss: 63.461376
[2024-08-05 10:35:51,930] {train_model:82} INFO - Train Epoch: 1 [72960/366120 (20%)]	lr:2.56e-05	Loss: 48.469185
[2024-08-05 10:36:00,824] {train_model:82} INFO - Train Epoch: 1 [109568/366120 (30%)]	lr:2.56e-05	Loss: 59.577164
[2024-08-05 10:36:09,725] {train_model:82} INFO - Train Epoch: 1 [146176/366120 (40%)]	lr:2.56e-05	Loss: 64.103897
[2024-08-05 10:36:18,684] {train_model:82} INFO - Train Epoch: 1 [182784/366120 (50%)]	lr:2.56e-05	Loss: 44.824772
[2024-08-05 10:36:27,691] {train_model:82} INFO - Train Epoch: 1 [219392/366120 (60%)]	lr:2.56e-05	Loss: 63.347435
[2024-08-05 10:36:36,745] {train_model:82} INFO - Train Epoch: 1 [256000/366120 (70%)]	lr:2.56e-05	Loss: 51.456215
[2024-08-05 10:36:45,819] {train_model:82} INFO - Train Epoch: 1 [292608/366120 (80%)]	lr:2.56e-05	Loss: 50.040154
[2024-08-05 10:36:54,929] {train_model:82} INFO - Train Epoch: 1 [329216/366120 (90%)]	lr:2.56e-05	Loss: 46.100594
[2024-08-05 10:37:04,020] {train_model:82} INFO - Train Epoch: 1 [365824/366120 (100%)]	lr:2.56e-05	Loss: 23.786318
[2024-08-05 10:37:09,214] {run_experiment:79} INFO - 
[2024-08-05 10:37:09,214] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 10:37:09,841] {result_logger:103} INFO - precision on Wake: 0.679
[2024-08-05 10:37:10,248] {result_logger:104} INFO - recall on Wake: 0.533
[2024-08-05 10:37:10,657] {result_logger:107} INFO - F1-score on Wake: 0.597
[2024-08-05 10:37:10,657] {result_logger:108} INFO - 
[2024-08-05 10:37:11,238] {result_logger:103} INFO - precision on REM: 0.087
[2024-08-05 10:37:11,611] {result_logger:104} INFO - recall on REM: 0.535
[2024-08-05 10:37:11,985] {result_logger:107} INFO - F1-score on REM: 0.149
[2024-08-05 10:37:11,985] {result_logger:108} INFO - 
[2024-08-05 10:37:12,587] {result_logger:103} INFO - precision on Non REM: 0.722
[2024-08-05 10:37:12,982] {result_logger:104} INFO - recall on Non REM: 0.459
[2024-08-05 10:37:13,379] {result_logger:107} INFO - F1-score on Non REM: 0.561
[2024-08-05 10:37:13,379] {result_logger:108} INFO - 
[2024-08-05 10:37:13,479] {result_logger:111} INFO - average precision on sleep stages: 0.496
[2024-08-05 10:37:13,575] {result_logger:113} INFO - average recall on sleep stages: 0.509
[2024-08-05 10:37:13,671] {result_logger:115} INFO - average F1-score on sleep stages: 0.436
[2024-08-05 10:37:13,673] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 10:37:13,753] {result_logger:103} INFO - precision on Wake: 0.634
[2024-08-05 10:37:13,803] {result_logger:104} INFO - recall on Wake: 0.887
[2024-08-05 10:37:13,855] {result_logger:107} INFO - F1-score on Wake: 0.739
[2024-08-05 10:37:13,855] {result_logger:108} INFO - 
[2024-08-05 10:37:13,934] {result_logger:103} INFO - precision on REM: 0.269
[2024-08-05 10:37:13,983] {result_logger:104} INFO - recall on REM: 0.725
[2024-08-05 10:37:14,032] {result_logger:107} INFO - F1-score on REM: 0.393
[2024-08-05 10:37:14,032] {result_logger:108} INFO - 
[2024-08-05 10:37:14,110] {result_logger:103} INFO - precision on Non REM: 0.989
[2024-08-05 10:37:14,160] {result_logger:104} INFO - recall on Non REM: 0.241
[2024-08-05 10:37:14,209] {result_logger:107} INFO - F1-score on Non REM: 0.387
[2024-08-05 10:37:14,209] {result_logger:108} INFO - 
[2024-08-05 10:37:14,220] {result_logger:111} INFO - average precision on sleep stages: 0.631
[2024-08-05 10:37:14,231] {result_logger:113} INFO - average recall on sleep stages: 0.618
[2024-08-05 10:37:14,242] {result_logger:115} INFO - average F1-score on sleep stages: 0.507
[2024-08-05 10:37:14,243] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 10:37:14,308] {result_logger:134} INFO - 
[[108544  72093  23110]
 [  6432   9945   2229]
 [ 44888  32922  65957]]
[2024-08-05 10:37:14,373] {result_logger:141} INFO - 
[[ 53.27%  35.38%  11.34%]
 [ 34.57%  53.45%  11.98%]
 [ 31.22%  22.90%  45.88%]]
[2024-08-05 10:37:14,437] {result_logger:145} INFO - 
[[ 67.90%  62.71%  25.31%]
 [  4.02%   8.65%   2.44%]
 [ 28.08%  28.64%  72.25%]]
[2024-08-05 10:37:14,437] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 10:37:14,445] {result_logger:134} INFO - 
[[25184  3150    48]
 [  691  1846     8]
 [13856  1859  4988]]
[2024-08-05 10:37:14,565] {result_logger:141} INFO - 
[[ 88.73%  11.10%   0.17%]
 [ 27.15%  72.53%   0.31%]
 [ 66.93%   8.98%  24.09%]]
[2024-08-05 10:37:14,654] {result_logger:145} INFO - 
[[ 63.39%  45.95%   0.95%]
 [  1.74%  26.93%   0.16%]
 [ 34.87%  27.12%  98.89%]]
[2024-08-05 10:37:14,905] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 10:37:14,905] {result_logger:77} INFO - actual:
[2024-08-05 10:37:14,905] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 10:37:14,905] {result_logger:79} INFO - predicted:
[2024-08-05 10:37:14,906] {result_logger:80} INFO - 
[[86.50%  9.47%  4.03%]
 [57.94% 38.54%  3.52%]
 [27.58%  8.94% 63.48%]]
[2024-08-05 10:37:14,960] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_E_weighted/model_8conv_2fc-best.pth
[2024-08-05 10:37:14,960] {run_experiment:113} INFO - [epoch   1] execution time: 106.16s	 avg f1-score: 0.5066

[2024-08-05 10:37:14,960] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:37:14,986] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:37:29,384] {train_model:82} INFO - Train Epoch: 2 [36352/366120 (10%)]	lr:4.65e-05	Loss: 21.273439
[2024-08-05 10:37:38,385] {train_model:82} INFO - Train Epoch: 2 [72960/366120 (20%)]	lr:4.65e-05	Loss: 19.343666
[2024-08-05 10:37:47,424] {train_model:82} INFO - Train Epoch: 2 [109568/366120 (30%)]	lr:4.65e-05	Loss: 17.751312
[2024-08-05 10:37:56,490] {train_model:82} INFO - Train Epoch: 2 [146176/366120 (40%)]	lr:4.65e-05	Loss: 15.376050
[2024-08-05 10:38:05,656] {train_model:82} INFO - Train Epoch: 2 [182784/366120 (50%)]	lr:4.65e-05	Loss: 12.904439
[2024-08-05 10:38:14,853] {train_model:82} INFO - Train Epoch: 2 [219392/366120 (60%)]	lr:4.65e-05	Loss: 11.645517
[2024-08-05 10:38:24,084] {train_model:82} INFO - Train Epoch: 2 [256000/366120 (70%)]	lr:4.65e-05	Loss: 9.924358
[2024-08-05 10:38:33,281] {train_model:82} INFO - Train Epoch: 2 [292608/366120 (80%)]	lr:4.65e-05	Loss: 13.932875
[2024-08-05 10:38:42,468] {train_model:82} INFO - Train Epoch: 2 [329216/366120 (90%)]	lr:4.65e-05	Loss: 8.680980
[2024-08-05 10:38:51,709] {train_model:82} INFO - Train Epoch: 2 [365824/366120 (100%)]	lr:4.65e-05	Loss: 21.552128
[2024-08-05 10:38:56,727] {run_experiment:79} INFO - 
[2024-08-05 10:38:56,727] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 10:38:57,358] {result_logger:103} INFO - precision on Wake: 0.839
[2024-08-05 10:38:57,766] {result_logger:104} INFO - recall on Wake: 0.668
[2024-08-05 10:38:58,175] {result_logger:107} INFO - F1-score on Wake: 0.744
[2024-08-05 10:38:58,175] {result_logger:108} INFO - 
[2024-08-05 10:38:58,751] {result_logger:103} INFO - precision on REM: 0.226
[2024-08-05 10:38:59,116] {result_logger:104} INFO - recall on REM: 0.781
[2024-08-05 10:38:59,481] {result_logger:107} INFO - F1-score on REM: 0.351
[2024-08-05 10:38:59,481] {result_logger:108} INFO - 
[2024-08-05 10:39:00,096] {result_logger:103} INFO - precision on Non REM: 0.802
[2024-08-05 10:39:00,498] {result_logger:104} INFO - recall on Non REM: 0.780
[2024-08-05 10:39:00,902] {result_logger:107} INFO - F1-score on Non REM: 0.791
[2024-08-05 10:39:00,902] {result_logger:108} INFO - 
[2024-08-05 10:39:00,997] {result_logger:111} INFO - average precision on sleep stages: 0.622
[2024-08-05 10:39:01,091] {result_logger:113} INFO - average recall on sleep stages: 0.743
[2024-08-05 10:39:01,185] {result_logger:115} INFO - average F1-score on sleep stages: 0.628
[2024-08-05 10:39:01,186] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 10:39:01,268] {result_logger:103} INFO - precision on Wake: 0.782
[2024-08-05 10:39:01,320] {result_logger:104} INFO - recall on Wake: 0.796
[2024-08-05 10:39:01,371] {result_logger:107} INFO - F1-score on Wake: 0.789
[2024-08-05 10:39:01,372] {result_logger:108} INFO - 
[2024-08-05 10:39:01,450] {result_logger:103} INFO - precision on REM: 0.429
[2024-08-05 10:39:01,498] {result_logger:104} INFO - recall on REM: 0.691
[2024-08-05 10:39:01,547] {result_logger:107} INFO - F1-score on REM: 0.529
[2024-08-05 10:39:01,547] {result_logger:108} INFO - 
[2024-08-05 10:39:01,628] {result_logger:103} INFO - precision on Non REM: 0.793
[2024-08-05 10:39:01,680] {result_logger:104} INFO - recall on Non REM: 0.714
[2024-08-05 10:39:01,731] {result_logger:107} INFO - F1-score on Non REM: 0.751
[2024-08-05 10:39:01,731] {result_logger:108} INFO - 
[2024-08-05 10:39:01,742] {result_logger:111} INFO - average precision on sleep stages: 0.668
[2024-08-05 10:39:01,753] {result_logger:113} INFO - average recall on sleep stages: 0.733
[2024-08-05 10:39:01,764] {result_logger:115} INFO - average F1-score on sleep stages: 0.690
[2024-08-05 10:39:01,764] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 10:39:01,828] {result_logger:134} INFO - 
[[136031  41009  26707]
 [  3092  14528    986]
 [ 22928   8726 112113]]
[2024-08-05 10:39:01,891] {result_logger:141} INFO - 
[[ 66.76%  20.13%  13.11%]
 [ 16.62%  78.08%   5.30%]
 [ 15.95%   6.07%  77.98%]]
[2024-08-05 10:39:01,954] {result_logger:145} INFO - 
[[ 83.94%  63.81%  19.10%]
 [  1.91%  22.61%   0.71%]
 [ 14.15%  13.58%  80.19%]]
[2024-08-05 10:39:01,954] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 10:39:01,961] {result_logger:134} INFO - 
[[22585  1966  3831]
 [  757  1758    30]
 [ 5550   378 14775]]
[2024-08-05 10:39:02,054] {result_logger:141} INFO - 
[[ 79.58%   6.93%  13.50%]
 [ 29.74%  69.08%   1.18%]
 [ 26.81%   1.83%  71.37%]]
[2024-08-05 10:39:02,143] {result_logger:145} INFO - 
[[ 78.17%  47.93%  20.56%]
 [  2.62%  42.86%   0.16%]
 [ 19.21%   9.22%  79.28%]]
[2024-08-05 10:39:02,394] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 10:39:02,395] {result_logger:77} INFO - actual:
[2024-08-05 10:39:02,395] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 10:39:02,395] {result_logger:79} INFO - predicted:
[2024-08-05 10:39:02,395] {result_logger:80} INFO - 
[[75.14%  6.51% 18.35%]
 [49.99% 47.04%  2.97%]
 [27.53%  1.57% 70.90%]]
[2024-08-05 10:39:02,451] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_E_weighted/model_8conv_2fc-best.pth
[2024-08-05 10:39:02,452] {run_experiment:113} INFO - [epoch   2] execution time: 107.49s	 avg f1-score: 0.6896

[2024-08-05 10:39:02,452] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:39:02,477] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:39:16,941] {train_model:82} INFO - Train Epoch: 3 [36352/366120 (10%)]	lr:6.75e-05	Loss: 3.750484
[2024-08-05 10:39:26,003] {train_model:82} INFO - Train Epoch: 3 [72960/366120 (20%)]	lr:6.75e-05	Loss: 3.371323
[2024-08-05 10:39:35,048] {train_model:82} INFO - Train Epoch: 3 [109568/366120 (30%)]	lr:6.75e-05	Loss: 6.473537
[2024-08-05 10:39:44,115] {train_model:82} INFO - Train Epoch: 3 [146176/366120 (40%)]	lr:6.75e-05	Loss: 8.281404
[2024-08-05 10:39:53,218] {train_model:82} INFO - Train Epoch: 3 [182784/366120 (50%)]	lr:6.75e-05	Loss: 5.355965
[2024-08-05 10:40:02,414] {train_model:82} INFO - Train Epoch: 3 [219392/366120 (60%)]	lr:6.75e-05	Loss: 0.824427
[2024-08-05 10:40:11,530] {train_model:82} INFO - Train Epoch: 3 [256000/366120 (70%)]	lr:6.75e-05	Loss: 2.242359
[2024-08-05 10:40:20,681] {train_model:82} INFO - Train Epoch: 3 [292608/366120 (80%)]	lr:6.75e-05	Loss: 1.703802
[2024-08-05 10:40:29,845] {train_model:82} INFO - Train Epoch: 3 [329216/366120 (90%)]	lr:6.75e-05	Loss: 1.640089
[2024-08-05 10:40:38,983] {train_model:82} INFO - Train Epoch: 3 [365824/366120 (100%)]	lr:6.75e-05	Loss: 1.558633
[2024-08-05 10:40:44,486] {run_experiment:79} INFO - 
[2024-08-05 10:40:44,486] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 10:40:45,132] {result_logger:103} INFO - precision on Wake: 0.870
[2024-08-05 10:40:45,541] {result_logger:104} INFO - recall on Wake: 0.769
[2024-08-05 10:40:45,949] {result_logger:107} INFO - F1-score on Wake: 0.817
[2024-08-05 10:40:45,949] {result_logger:108} INFO - 
[2024-08-05 10:40:46,533] {result_logger:103} INFO - precision on REM: 0.315
[2024-08-05 10:40:46,892] {result_logger:104} INFO - recall on REM: 0.785
[2024-08-05 10:40:47,251] {result_logger:107} INFO - F1-score on REM: 0.449
[2024-08-05 10:40:47,252] {result_logger:108} INFO - 
[2024-08-05 10:40:47,878] {result_logger:103} INFO - precision on Non REM: 0.853
[2024-08-05 10:40:48,278] {result_logger:104} INFO - recall on Non REM: 0.828
[2024-08-05 10:40:48,679] {result_logger:107} INFO - F1-score on Non REM: 0.840
[2024-08-05 10:40:48,679] {result_logger:108} INFO - 
[2024-08-05 10:40:48,773] {result_logger:111} INFO - average precision on sleep stages: 0.679
[2024-08-05 10:40:48,868] {result_logger:113} INFO - average recall on sleep stages: 0.794
[2024-08-05 10:40:48,962] {result_logger:115} INFO - average F1-score on sleep stages: 0.702
[2024-08-05 10:40:48,963] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 10:40:49,048] {result_logger:103} INFO - precision on Wake: 0.725
[2024-08-05 10:40:49,098] {result_logger:104} INFO - recall on Wake: 0.966
[2024-08-05 10:40:49,147] {result_logger:107} INFO - F1-score on Wake: 0.828
[2024-08-05 10:40:49,147] {result_logger:108} INFO - 
[2024-08-05 10:40:49,228] {result_logger:103} INFO - precision on REM: 0.635
[2024-08-05 10:40:49,276] {result_logger:104} INFO - recall on REM: 0.881
[2024-08-05 10:40:49,325] {result_logger:107} INFO - F1-score on REM: 0.738
[2024-08-05 10:40:49,325] {result_logger:108} INFO - 
[2024-08-05 10:40:49,406] {result_logger:103} INFO - precision on Non REM: 0.983
[2024-08-05 10:40:49,455] {result_logger:104} INFO - recall on Non REM: 0.488
[2024-08-05 10:40:49,505] {result_logger:107} INFO - F1-score on Non REM: 0.652
[2024-08-05 10:40:49,505] {result_logger:108} INFO - 
[2024-08-05 10:40:49,515] {result_logger:111} INFO - average precision on sleep stages: 0.781
[2024-08-05 10:40:49,526] {result_logger:113} INFO - average recall on sleep stages: 0.779
[2024-08-05 10:40:49,537] {result_logger:115} INFO - average F1-score on sleep stages: 0.740
[2024-08-05 10:40:49,537] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 10:40:49,601] {result_logger:134} INFO - 
[[156712  27358  19677]
 [  3115  14613    878]
 [ 20213   4452 119102]]
[2024-08-05 10:40:49,665] {result_logger:141} INFO - 
[[ 76.91%  13.43%   9.66%]
 [ 16.74%  78.54%   4.72%]
 [ 14.06%   3.10%  82.84%]]
[2024-08-05 10:40:49,729] {result_logger:145} INFO - 
[[ 87.04%  58.93%  14.09%]
 [  1.73%  31.48%   0.63%]
 [ 11.23%   9.59%  85.28%]]
[2024-08-05 10:40:49,729] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 10:40:49,736] {result_logger:134} INFO - 
[[27424   801   157]
 [  286  2243    16]
 [10110   490 10103]]
[2024-08-05 10:40:49,830] {result_logger:141} INFO - 
[[ 96.62%   2.82%   0.55%]
 [ 11.24%  88.13%   0.63%]
 [ 48.83%   2.37%  48.80%]]
[2024-08-05 10:40:49,918] {result_logger:145} INFO - 
[[ 72.51%  22.67%   1.53%]
 [  0.76%  63.47%   0.16%]
 [ 26.73%  13.87%  98.32%]]
[2024-08-05 10:40:50,167] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 10:40:50,167] {result_logger:77} INFO - actual:
[2024-08-05 10:40:50,167] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 10:40:50,167] {result_logger:79} INFO - predicted:
[2024-08-05 10:40:50,168] {result_logger:80} INFO - 
[[93.06%  2.35%  4.59%]
 [31.44% 67.83%  0.74%]
 [14.72%  2.43% 82.84%]]
[2024-08-05 10:40:50,224] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_E_weighted/model_8conv_2fc-best.pth
[2024-08-05 10:40:50,224] {run_experiment:113} INFO - [epoch   3] execution time: 107.77s	 avg f1-score: 0.7396

[2024-08-05 10:40:50,224] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:40:50,250] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:41:04,544] {train_model:82} INFO - Train Epoch: 4 [36352/366120 (10%)]	lr:8.84e-05	Loss: 1.532764
[2024-08-05 10:41:13,527] {train_model:82} INFO - Train Epoch: 4 [72960/366120 (20%)]	lr:8.84e-05	Loss: 0.918413
[2024-08-05 10:41:22,561] {train_model:82} INFO - Train Epoch: 4 [109568/366120 (30%)]	lr:8.84e-05	Loss: 3.102243
[2024-08-05 10:41:31,621] {train_model:82} INFO - Train Epoch: 4 [146176/366120 (40%)]	lr:8.84e-05	Loss: 2.463122
[2024-08-05 10:41:40,702] {train_model:82} INFO - Train Epoch: 4 [182784/366120 (50%)]	lr:8.84e-05	Loss: 0.530383
[2024-08-05 10:41:49,837] {train_model:82} INFO - Train Epoch: 4 [219392/366120 (60%)]	lr:8.84e-05	Loss: 1.764823
[2024-08-05 10:41:59,113] {train_model:82} INFO - Train Epoch: 4 [256000/366120 (70%)]	lr:8.84e-05	Loss: 0.295241
[2024-08-05 10:42:08,403] {train_model:82} INFO - Train Epoch: 4 [292608/366120 (80%)]	lr:8.84e-05	Loss: 0.551526
[2024-08-05 10:42:17,709] {train_model:82} INFO - Train Epoch: 4 [329216/366120 (90%)]	lr:8.84e-05	Loss: 0.585405
[2024-08-05 10:42:26,965] {train_model:82} INFO - Train Epoch: 4 [365824/366120 (100%)]	lr:8.84e-05	Loss: 0.292006
[2024-08-05 10:42:32,084] {run_experiment:79} INFO - 
[2024-08-05 10:42:32,085] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 10:42:32,755] {result_logger:103} INFO - precision on Wake: 0.896
[2024-08-05 10:42:33,165] {result_logger:104} INFO - recall on Wake: 0.871
[2024-08-05 10:42:33,573] {result_logger:107} INFO - F1-score on Wake: 0.883
[2024-08-05 10:42:33,573] {result_logger:108} INFO - 
[2024-08-05 10:42:34,160] {result_logger:103} INFO - precision on REM: 0.470
[2024-08-05 10:42:34,516] {result_logger:104} INFO - recall on REM: 0.811
[2024-08-05 10:42:34,874] {result_logger:107} INFO - F1-score on REM: 0.595
[2024-08-05 10:42:34,874] {result_logger:108} INFO - 
[2024-08-05 10:42:35,508] {result_logger:103} INFO - precision on Non REM: 0.899
[2024-08-05 10:42:35,908] {result_logger:104} INFO - recall on Non REM: 0.850
[2024-08-05 10:42:36,312] {result_logger:107} INFO - F1-score on Non REM: 0.874
[2024-08-05 10:42:36,312] {result_logger:108} INFO - 
[2024-08-05 10:42:36,406] {result_logger:111} INFO - average precision on sleep stages: 0.755
[2024-08-05 10:42:36,500] {result_logger:113} INFO - average recall on sleep stages: 0.844
[2024-08-05 10:42:36,594] {result_logger:115} INFO - average F1-score on sleep stages: 0.784
[2024-08-05 10:42:36,595] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 10:42:36,681] {result_logger:103} INFO - precision on Wake: 0.615
[2024-08-05 10:42:36,732] {result_logger:104} INFO - recall on Wake: 0.797
[2024-08-05 10:42:36,781] {result_logger:107} INFO - F1-score on Wake: 0.694
[2024-08-05 10:42:36,781] {result_logger:108} INFO - 
[2024-08-05 10:42:36,863] {result_logger:103} INFO - precision on REM: 0.258
[2024-08-05 10:42:36,911] {result_logger:104} INFO - recall on REM: 0.835
[2024-08-05 10:42:36,961] {result_logger:107} INFO - F1-score on REM: 0.394
[2024-08-05 10:42:36,961] {result_logger:108} INFO - 
[2024-08-05 10:42:37,043] {result_logger:103} INFO - precision on Non REM: 0.994
[2024-08-05 10:42:37,093] {result_logger:104} INFO - recall on Non REM: 0.316
[2024-08-05 10:42:37,143] {result_logger:107} INFO - F1-score on Non REM: 0.480
[2024-08-05 10:42:37,143] {result_logger:108} INFO - 
[2024-08-05 10:42:37,153] {result_logger:111} INFO - average precision on sleep stages: 0.622
[2024-08-05 10:42:37,164] {result_logger:113} INFO - average recall on sleep stages: 0.649
[2024-08-05 10:42:37,175] {result_logger:115} INFO - average F1-score on sleep stages: 0.523
[2024-08-05 10:42:37,175] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 10:42:37,239] {result_logger:134} INFO - 
[[177370  13346  13031]
 [  2763  15088    755]
 [ 17871   3644 122252]]
[2024-08-05 10:42:37,303] {result_logger:141} INFO - 
[[ 87.05%   6.55%   6.40%]
 [ 14.85%  81.09%   4.06%]
 [ 12.43%   2.53%  85.03%]]
[2024-08-05 10:42:37,367] {result_logger:145} INFO - 
[[ 89.58%  41.60%   9.58%]
 [  1.40%  47.04%   0.55%]
 [  9.03%  11.36%  89.87%]]
[2024-08-05 10:42:37,367] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 10:42:37,375] {result_logger:134} INFO - 
[[22630  5725    27]
 [  408  2125    12]
 [13763   395  6545]]
[2024-08-05 10:42:37,383] {result_logger:141} INFO - 
[[ 79.73%  20.17%   0.10%]
 [ 16.03%  83.50%   0.47%]
 [ 66.48%   1.91%  31.61%]]
[2024-08-05 10:42:37,390] {result_logger:145} INFO - 
[[ 61.49%  69.44%   0.41%]
 [  1.11%  25.77%   0.18%]
 [ 37.40%   4.79%  99.41%]]
[2024-08-05 10:42:37,478] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 10:42:37,478] {result_logger:77} INFO - actual:
[2024-08-05 10:42:37,479] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 10:42:37,479] {result_logger:79} INFO - predicted:
[2024-08-05 10:42:37,479] {result_logger:80} INFO - 
[[91.55%  4.64%  3.81%]
 [22.87% 77.03%  0.11%]
 [18.61%  2.84% 78.55%]]
[2024-08-05 10:42:37,479] {run_experiment:113} INFO - [epoch   4] execution time: 107.25s	 avg f1-score: 0.5227

[2024-08-05 10:42:37,479] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:42:37,504] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:42:52,057] {train_model:82} INFO - Train Epoch: 5 [36352/366120 (10%)]	lr:1.09e-04	Loss: 0.373327
[2024-08-05 10:43:01,134] {train_model:82} INFO - Train Epoch: 5 [72960/366120 (20%)]	lr:1.09e-04	Loss: 2.582238
[2024-08-05 10:43:10,239] {train_model:82} INFO - Train Epoch: 5 [109568/366120 (30%)]	lr:1.09e-04	Loss: 0.562328
[2024-08-05 10:43:19,355] {train_model:82} INFO - Train Epoch: 5 [146176/366120 (40%)]	lr:1.09e-04	Loss: 0.387382
[2024-08-05 10:43:28,441] {train_model:82} INFO - Train Epoch: 5 [182784/366120 (50%)]	lr:1.09e-04	Loss: 0.474832
[2024-08-05 10:43:37,544] {train_model:82} INFO - Train Epoch: 5 [219392/366120 (60%)]	lr:1.09e-04	Loss: 0.601465
[2024-08-05 10:43:46,677] {train_model:82} INFO - Train Epoch: 5 [256000/366120 (70%)]	lr:1.09e-04	Loss: 0.227812
[2024-08-05 10:43:55,833] {train_model:82} INFO - Train Epoch: 5 [292608/366120 (80%)]	lr:1.09e-04	Loss: 0.246049
[2024-08-05 10:44:05,008] {train_model:82} INFO - Train Epoch: 5 [329216/366120 (90%)]	lr:1.09e-04	Loss: 0.414328
[2024-08-05 10:44:14,164] {train_model:82} INFO - Train Epoch: 5 [365824/366120 (100%)]	lr:1.09e-04	Loss: 0.303189
[2024-08-05 10:44:19,225] {run_experiment:79} INFO - 
[2024-08-05 10:44:19,225] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 10:44:19,897] {result_logger:103} INFO - precision on Wake: 0.941
[2024-08-05 10:44:20,312] {result_logger:104} INFO - recall on Wake: 0.908
[2024-08-05 10:44:20,726] {result_logger:107} INFO - F1-score on Wake: 0.924
[2024-08-05 10:44:20,726] {result_logger:108} INFO - 
[2024-08-05 10:44:21,314] {result_logger:103} INFO - precision on REM: 0.603
[2024-08-05 10:44:21,672] {result_logger:104} INFO - recall on REM: 0.873
[2024-08-05 10:44:22,033] {result_logger:107} INFO - F1-score on REM: 0.713
[2024-08-05 10:44:22,033] {result_logger:108} INFO - 
[2024-08-05 10:44:22,674] {result_logger:103} INFO - precision on Non REM: 0.910
[2024-08-05 10:44:23,080] {result_logger:104} INFO - recall on Non REM: 0.904
[2024-08-05 10:44:23,486] {result_logger:107} INFO - F1-score on Non REM: 0.907
[2024-08-05 10:44:23,487] {result_logger:108} INFO - 
[2024-08-05 10:44:23,580] {result_logger:111} INFO - average precision on sleep stages: 0.818
[2024-08-05 10:44:23,675] {result_logger:113} INFO - average recall on sleep stages: 0.895
[2024-08-05 10:44:23,768] {result_logger:115} INFO - average F1-score on sleep stages: 0.848
[2024-08-05 10:44:23,769] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 10:44:23,849] {result_logger:103} INFO - precision on Wake: 0.781
[2024-08-05 10:44:23,900] {result_logger:104} INFO - recall on Wake: 0.661
[2024-08-05 10:44:23,951] {result_logger:107} INFO - F1-score on Wake: 0.716
[2024-08-05 10:44:23,951] {result_logger:108} INFO - 
[2024-08-05 10:44:24,032] {result_logger:103} INFO - precision on REM: 0.182
[2024-08-05 10:44:24,082] {result_logger:104} INFO - recall on REM: 0.974
[2024-08-05 10:44:24,132] {result_logger:107} INFO - F1-score on REM: 0.307
[2024-08-05 10:44:24,132] {result_logger:108} INFO - 
[2024-08-05 10:44:24,212] {result_logger:103} INFO - precision on Non REM: 0.989
[2024-08-05 10:44:24,262] {result_logger:104} INFO - recall on Non REM: 0.668
[2024-08-05 10:44:24,312] {result_logger:107} INFO - F1-score on Non REM: 0.797
[2024-08-05 10:44:24,312] {result_logger:108} INFO - 
[2024-08-05 10:44:24,323] {result_logger:111} INFO - average precision on sleep stages: 0.651
[2024-08-05 10:44:24,333] {result_logger:113} INFO - average recall on sleep stages: 0.768
[2024-08-05 10:44:24,344] {result_logger:115} INFO - average F1-score on sleep stages: 0.607
[2024-08-05 10:44:24,344] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 10:44:24,408] {result_logger:134} INFO - 
[[184906   6772  12069]
 [  1647  16234    725]
 [  9863   3911 129993]]
[2024-08-05 10:44:24,472] {result_logger:141} INFO - 
[[ 90.75%   3.32%   5.92%]
 [  8.85%  87.25%   3.90%]
 [  6.86%   2.72%  90.42%]]
[2024-08-05 10:44:24,536] {result_logger:145} INFO - 
[[ 94.14%  25.16%   8.45%]
 [  0.84%  60.31%   0.51%]
 [  5.02%  14.53%  91.04%]]
[2024-08-05 10:44:24,536] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 10:44:24,544] {result_logger:134} INFO - 
[[18757  9485   140]
 [   51  2480    14]
 [ 5215  1660 13828]]
[2024-08-05 10:44:24,551] {result_logger:141} INFO - 
[[ 66.09%  33.42%   0.49%]
 [  2.00%  97.45%   0.55%]
 [ 25.19%   8.02%  66.79%]]
[2024-08-05 10:44:24,559] {result_logger:145} INFO - 
[[ 78.08%  69.61%   1.00%]
 [  0.21%  18.20%   0.10%]
 [ 21.71%  12.18%  98.90%]]
[2024-08-05 10:44:24,649] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 10:44:24,649] {result_logger:77} INFO - actual:
[2024-08-05 10:44:24,649] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 10:44:24,649] {result_logger:79} INFO - predicted:
[2024-08-05 10:44:24,649] {result_logger:80} INFO - 
[[83.71%  6.83%  9.46%]
 [16.97% 81.59%  1.44%]
 [11.45%  6.21% 82.34%]]
[2024-08-05 10:44:24,649] {run_experiment:113} INFO - [epoch   5] execution time: 107.17s	 avg f1-score: 0.6066

[2024-08-05 10:44:24,649] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:44:24,675] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:44:39,002] {train_model:82} INFO - Train Epoch: 6 [36352/366120 (10%)]	lr:1.30e-04	Loss: 0.253406
[2024-08-05 10:44:48,058] {train_model:82} INFO - Train Epoch: 6 [72960/366120 (20%)]	lr:1.30e-04	Loss: 4.493705
[2024-08-05 10:44:57,109] {train_model:82} INFO - Train Epoch: 6 [109568/366120 (30%)]	lr:1.30e-04	Loss: 11.842642
[2024-08-05 10:45:06,181] {train_model:82} INFO - Train Epoch: 6 [146176/366120 (40%)]	lr:1.30e-04	Loss: 0.180234
[2024-08-05 10:45:15,398] {train_model:82} INFO - Train Epoch: 6 [182784/366120 (50%)]	lr:1.30e-04	Loss: 0.139584
[2024-08-05 10:45:24,680] {train_model:82} INFO - Train Epoch: 6 [219392/366120 (60%)]	lr:1.30e-04	Loss: 6.158135
[2024-08-05 10:45:33,927] {train_model:82} INFO - Train Epoch: 6 [256000/366120 (70%)]	lr:1.30e-04	Loss: 0.669315
[2024-08-05 10:45:43,085] {train_model:82} INFO - Train Epoch: 6 [292608/366120 (80%)]	lr:1.30e-04	Loss: 0.158174
[2024-08-05 10:45:52,251] {train_model:82} INFO - Train Epoch: 6 [329216/366120 (90%)]	lr:1.30e-04	Loss: 0.176591
[2024-08-05 10:46:01,428] {train_model:82} INFO - Train Epoch: 6 [365824/366120 (100%)]	lr:1.30e-04	Loss: 0.151044
[2024-08-05 10:46:06,935] {run_experiment:79} INFO - 
[2024-08-05 10:46:06,935] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 10:46:07,587] {result_logger:103} INFO - precision on Wake: 0.967
[2024-08-05 10:46:08,002] {result_logger:104} INFO - recall on Wake: 0.936
[2024-08-05 10:46:08,415] {result_logger:107} INFO - F1-score on Wake: 0.951
[2024-08-05 10:46:08,415] {result_logger:108} INFO - 
[2024-08-05 10:46:09,000] {result_logger:103} INFO - precision on REM: 0.675
[2024-08-05 10:46:09,357] {result_logger:104} INFO - recall on REM: 0.915
[2024-08-05 10:46:09,714] {result_logger:107} INFO - F1-score on REM: 0.776
[2024-08-05 10:46:09,715] {result_logger:108} INFO - 
[2024-08-05 10:46:10,348] {result_logger:103} INFO - precision on Non REM: 0.932
[2024-08-05 10:46:10,752] {result_logger:104} INFO - recall on Non REM: 0.931
[2024-08-05 10:46:11,155] {result_logger:107} INFO - F1-score on Non REM: 0.931
[2024-08-05 10:46:11,155] {result_logger:108} INFO - 
[2024-08-05 10:46:11,247] {result_logger:111} INFO - average precision on sleep stages: 0.858
[2024-08-05 10:46:11,338] {result_logger:113} INFO - average recall on sleep stages: 0.927
[2024-08-05 10:46:11,430] {result_logger:115} INFO - average F1-score on sleep stages: 0.886
[2024-08-05 10:46:11,431] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 10:46:11,514] {result_logger:103} INFO - precision on Wake: 0.935
[2024-08-05 10:46:11,564] {result_logger:104} INFO - recall on Wake: 0.928
[2024-08-05 10:46:11,614] {result_logger:107} INFO - F1-score on Wake: 0.931
[2024-08-05 10:46:11,614] {result_logger:108} INFO - 
[2024-08-05 10:46:11,696] {result_logger:103} INFO - precision on REM: 0.434
[2024-08-05 10:46:11,745] {result_logger:104} INFO - recall on REM: 0.988
[2024-08-05 10:46:11,794] {result_logger:107} INFO - F1-score on REM: 0.603
[2024-08-05 10:46:11,794] {result_logger:108} INFO - 
[2024-08-05 10:46:11,877] {result_logger:103} INFO - precision on Non REM: 0.979
[2024-08-05 10:46:11,927] {result_logger:104} INFO - recall on Non REM: 0.836
[2024-08-05 10:46:11,977] {result_logger:107} INFO - F1-score on Non REM: 0.902
[2024-08-05 10:46:11,977] {result_logger:108} INFO - 
[2024-08-05 10:46:11,988] {result_logger:111} INFO - average precision on sleep stages: 0.783
[2024-08-05 10:46:11,998] {result_logger:113} INFO - average recall on sleep stages: 0.917
[2024-08-05 10:46:12,009] {result_logger:115} INFO - average F1-score on sleep stages: 0.812
[2024-08-05 10:46:12,009] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 10:46:12,072] {result_logger:134} INFO - 
[[190653   3944   9150]
 [   896  17016    694]
 [  5593   4266 133908]]
[2024-08-05 10:46:12,135] {result_logger:141} INFO - 
[[ 93.57%   1.94%   4.49%]
 [  4.82%  91.45%   3.73%]
 [  3.89%   2.97%  93.14%]]
[2024-08-05 10:46:12,197] {result_logger:145} INFO - 
[[ 96.71%  15.63%   6.37%]
 [  0.45%  67.45%   0.48%]
 [  2.84%  16.91%  93.15%]]
[2024-08-05 10:46:12,197] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 10:46:12,204] {result_logger:134} INFO - 
[[26328  1703   351]
 [   16  2515    14]
 [ 1809  1578 17316]]
[2024-08-05 10:46:12,301] {result_logger:141} INFO - 
[[ 92.76%   6.00%   1.24%]
 [  0.63%  98.82%   0.55%]
 [  8.74%   7.62%  83.64%]]
[2024-08-05 10:46:12,391] {result_logger:145} INFO - 
[[ 93.52%  29.38%   1.99%]
 [  0.06%  43.39%   0.08%]
 [  6.43%  27.23%  97.94%]]
[2024-08-05 10:46:12,648] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 10:46:12,648] {result_logger:77} INFO - actual:
[2024-08-05 10:46:12,649] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 10:46:12,649] {result_logger:79} INFO - predicted:
[2024-08-05 10:46:12,649] {result_logger:80} INFO - 
[[91.67%  2.74%  5.59%]
 [24.45% 69.10%  6.45%]
 [ 5.24%  5.77% 88.98%]]
[2024-08-05 10:46:12,705] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_E_weighted/model_8conv_2fc-best.pth
[2024-08-05 10:46:12,706] {run_experiment:113} INFO - [epoch   6] execution time: 108.06s	 avg f1-score: 0.8122

[2024-08-05 10:46:12,706] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:46:12,732] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:46:27,101] {train_model:82} INFO - Train Epoch: 7 [36352/366120 (10%)]	lr:1.51e-04	Loss: 0.099423
[2024-08-05 10:46:36,167] {train_model:82} INFO - Train Epoch: 7 [72960/366120 (20%)]	lr:1.51e-04	Loss: 0.099283
[2024-08-05 10:46:45,293] {train_model:82} INFO - Train Epoch: 7 [109568/366120 (30%)]	lr:1.51e-04	Loss: 0.271434
[2024-08-05 10:46:54,459] {train_model:82} INFO - Train Epoch: 7 [146176/366120 (40%)]	lr:1.51e-04	Loss: 1.108769
[2024-08-05 10:47:03,656] {train_model:82} INFO - Train Epoch: 7 [182784/366120 (50%)]	lr:1.51e-04	Loss: 2.402522
[2024-08-05 10:47:12,869] {train_model:82} INFO - Train Epoch: 7 [219392/366120 (60%)]	lr:1.51e-04	Loss: 0.129457
[2024-08-05 10:47:22,099] {train_model:82} INFO - Train Epoch: 7 [256000/366120 (70%)]	lr:1.51e-04	Loss: 0.139485
[2024-08-05 10:47:31,355] {train_model:82} INFO - Train Epoch: 7 [292608/366120 (80%)]	lr:1.51e-04	Loss: 0.401301
[2024-08-05 10:47:40,563] {train_model:82} INFO - Train Epoch: 7 [329216/366120 (90%)]	lr:1.51e-04	Loss: 0.484204
[2024-08-05 10:47:49,763] {train_model:82} INFO - Train Epoch: 7 [365824/366120 (100%)]	lr:1.51e-04	Loss: 0.116880
[2024-08-05 10:47:55,319] {run_experiment:79} INFO - 
[2024-08-05 10:47:55,319] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 10:47:55,991] {result_logger:103} INFO - precision on Wake: 0.973
[2024-08-05 10:47:56,404] {result_logger:104} INFO - recall on Wake: 0.946
[2024-08-05 10:47:56,816] {result_logger:107} INFO - F1-score on Wake: 0.959
[2024-08-05 10:47:56,816] {result_logger:108} INFO - 
[2024-08-05 10:47:57,405] {result_logger:103} INFO - precision on REM: 0.700
[2024-08-05 10:47:57,763] {result_logger:104} INFO - recall on REM: 0.933
[2024-08-05 10:47:58,122] {result_logger:107} INFO - F1-score on REM: 0.800
[2024-08-05 10:47:58,122] {result_logger:108} INFO - 
[2024-08-05 10:47:58,759] {result_logger:103} INFO - precision on Non REM: 0.940
[2024-08-05 10:47:59,164] {result_logger:104} INFO - recall on Non REM: 0.936
[2024-08-05 10:47:59,569] {result_logger:107} INFO - F1-score on Non REM: 0.938
[2024-08-05 10:47:59,569] {result_logger:108} INFO - 
[2024-08-05 10:47:59,662] {result_logger:111} INFO - average precision on sleep stages: 0.871
[2024-08-05 10:47:59,755] {result_logger:113} INFO - average recall on sleep stages: 0.939
[2024-08-05 10:47:59,848] {result_logger:115} INFO - average F1-score on sleep stages: 0.899
[2024-08-05 10:47:59,849] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 10:47:59,935] {result_logger:103} INFO - precision on Wake: 0.941
[2024-08-05 10:47:59,985] {result_logger:104} INFO - recall on Wake: 0.858
[2024-08-05 10:48:00,035] {result_logger:107} INFO - F1-score on Wake: 0.898
[2024-08-05 10:48:00,035] {result_logger:108} INFO - 
[2024-08-05 10:48:00,117] {result_logger:103} INFO - precision on REM: 0.317
[2024-08-05 10:48:00,167] {result_logger:104} INFO - recall on REM: 0.993
[2024-08-05 10:48:00,218] {result_logger:107} INFO - F1-score on REM: 0.480
[2024-08-05 10:48:00,218] {result_logger:108} INFO - 
[2024-08-05 10:48:00,301] {result_logger:103} INFO - precision on Non REM: 0.984
[2024-08-05 10:48:00,351] {result_logger:104} INFO - recall on Non REM: 0.844
[2024-08-05 10:48:00,401] {result_logger:107} INFO - F1-score on Non REM: 0.909
[2024-08-05 10:48:00,401] {result_logger:108} INFO - 
[2024-08-05 10:48:00,412] {result_logger:111} INFO - average precision on sleep stages: 0.747
[2024-08-05 10:48:00,422] {result_logger:113} INFO - average recall on sleep stages: 0.898
[2024-08-05 10:48:00,433] {result_logger:115} INFO - average F1-score on sleep stages: 0.762
[2024-08-05 10:48:00,434] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 10:48:00,498] {result_logger:134} INFO - 
[[192734   3112   7901]
 [   612  17366    628]
 [  4825   4335 134607]]
[2024-08-05 10:48:00,561] {result_logger:141} INFO - 
[[ 94.59%   1.53%   3.88%]
 [  3.29%  93.34%   3.38%]
 [  3.36%   3.02%  93.63%]]
[2024-08-05 10:48:00,624] {result_logger:145} INFO - 
[[ 97.26%  12.54%   5.52%]
 [  0.31%  69.99%   0.44%]
 [  2.43%  17.47%  94.04%]]
[2024-08-05 10:48:00,624] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 10:48:00,632] {result_logger:134} INFO - 
[[24353  3759   270]
 [    2  2526    17]
 [ 1525  1696 17482]]
[2024-08-05 10:48:00,639] {result_logger:141} INFO - 
[[ 85.80%  13.24%   0.95%]
 [  0.08%  99.25%   0.67%]
 [  7.37%   8.19%  84.44%]]
[2024-08-05 10:48:00,646] {result_logger:145} INFO - 
[[ 94.10%  47.10%   1.52%]
 [  0.01%  31.65%   0.10%]
 [  5.89%  21.25%  98.38%]]
[2024-08-05 10:48:00,737] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 10:48:00,737] {result_logger:77} INFO - actual:
[2024-08-05 10:48:00,737] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 10:48:00,737] {result_logger:79} INFO - predicted:
[2024-08-05 10:48:00,737] {result_logger:80} INFO - 
[[87.71%  6.21%  6.08%]
 [28.30% 66.45%  5.25%]
 [ 5.18%  6.03% 88.78%]]
[2024-08-05 10:48:00,737] {run_experiment:113} INFO - [epoch   7] execution time: 108.03s	 avg f1-score: 0.7621

[2024-08-05 10:48:00,737] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:48:00,763] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:48:15,004] {train_model:82} INFO - Train Epoch: 8 [36352/366120 (10%)]	lr:1.72e-04	Loss: 0.220297
[2024-08-05 10:48:24,028] {train_model:82} INFO - Train Epoch: 8 [72960/366120 (20%)]	lr:1.72e-04	Loss: 0.583543
[2024-08-05 10:48:33,097] {train_model:82} INFO - Train Epoch: 8 [109568/366120 (30%)]	lr:1.72e-04	Loss: 0.160729
[2024-08-05 10:48:42,208] {train_model:82} INFO - Train Epoch: 8 [146176/366120 (40%)]	lr:1.72e-04	Loss: 0.160421
[2024-08-05 10:48:51,309] {train_model:82} INFO - Train Epoch: 8 [182784/366120 (50%)]	lr:1.72e-04	Loss: 0.546840
[2024-08-05 10:49:00,469] {train_model:82} INFO - Train Epoch: 8 [219392/366120 (60%)]	lr:1.72e-04	Loss: 6.309229
[2024-08-05 10:49:09,681] {train_model:82} INFO - Train Epoch: 8 [256000/366120 (70%)]	lr:1.72e-04	Loss: 0.122234
[2024-08-05 10:49:18,908] {train_model:82} INFO - Train Epoch: 8 [292608/366120 (80%)]	lr:1.72e-04	Loss: 6.892679
[2024-08-05 10:49:28,230] {train_model:82} INFO - Train Epoch: 8 [329216/366120 (90%)]	lr:1.72e-04	Loss: 0.137867
[2024-08-05 10:49:37,521] {train_model:82} INFO - Train Epoch: 8 [365824/366120 (100%)]	lr:1.72e-04	Loss: 0.177186
[2024-08-05 10:49:42,542] {run_experiment:79} INFO - 
[2024-08-05 10:49:42,542] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 10:49:43,170] {result_logger:103} INFO - precision on Wake: 0.975
[2024-08-05 10:49:43,579] {result_logger:104} INFO - recall on Wake: 0.951
[2024-08-05 10:49:43,987] {result_logger:107} INFO - F1-score on Wake: 0.963
[2024-08-05 10:49:43,987] {result_logger:108} INFO - 
[2024-08-05 10:49:44,549] {result_logger:103} INFO - precision on REM: 0.724
[2024-08-05 10:49:44,903] {result_logger:104} INFO - recall on REM: 0.938
[2024-08-05 10:49:45,257] {result_logger:107} INFO - F1-score on REM: 0.817
[2024-08-05 10:49:45,257] {result_logger:108} INFO - 
[2024-08-05 10:49:45,866] {result_logger:103} INFO - precision on Non REM: 0.944
[2024-08-05 10:49:46,264] {result_logger:104} INFO - recall on Non REM: 0.939
[2024-08-05 10:49:46,662] {result_logger:107} INFO - F1-score on Non REM: 0.941
[2024-08-05 10:49:46,662] {result_logger:108} INFO - 
[2024-08-05 10:49:46,753] {result_logger:111} INFO - average precision on sleep stages: 0.881
[2024-08-05 10:49:46,847] {result_logger:113} INFO - average recall on sleep stages: 0.943
[2024-08-05 10:49:46,938] {result_logger:115} INFO - average F1-score on sleep stages: 0.907
[2024-08-05 10:49:46,939] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 10:49:47,019] {result_logger:103} INFO - precision on Wake: 0.902
[2024-08-05 10:49:47,069] {result_logger:104} INFO - recall on Wake: 0.994
[2024-08-05 10:49:47,119] {result_logger:107} INFO - F1-score on Wake: 0.946
[2024-08-05 10:49:47,119] {result_logger:108} INFO - 
[2024-08-05 10:49:47,198] {result_logger:103} INFO - precision on REM: 0.694
[2024-08-05 10:49:47,245] {result_logger:104} INFO - recall on REM: 0.974
[2024-08-05 10:49:47,293] {result_logger:107} INFO - F1-score on REM: 0.810
[2024-08-05 10:49:47,294] {result_logger:108} INFO - 
[2024-08-05 10:49:47,373] {result_logger:103} INFO - precision on Non REM: 0.994
[2024-08-05 10:49:47,423] {result_logger:104} INFO - recall on Non REM: 0.805
[2024-08-05 10:49:47,474] {result_logger:107} INFO - F1-score on Non REM: 0.890
[2024-08-05 10:49:47,474] {result_logger:108} INFO - 
[2024-08-05 10:49:47,484] {result_logger:111} INFO - average precision on sleep stages: 0.863
[2024-08-05 10:49:47,495] {result_logger:113} INFO - average recall on sleep stages: 0.924
[2024-08-05 10:49:47,506] {result_logger:115} INFO - average F1-score on sleep stages: 0.882
[2024-08-05 10:49:47,506] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 10:49:47,568] {result_logger:134} INFO - 
[[193852   2434   7461]
 [   531  17450    625]
 [  4512   4214 135041]]
[2024-08-05 10:49:47,629] {result_logger:141} INFO - 
[[ 95.14%   1.19%   3.66%]
 [  2.85%  93.79%   3.36%]
 [  3.14%   2.93%  93.93%]]
[2024-08-05 10:49:47,690] {result_logger:145} INFO - 
[[ 97.46%  10.10%   5.21%]
 [  0.27%  72.41%   0.44%]
 [  2.27%  17.49%  94.35%]]
[2024-08-05 10:49:47,690] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 10:49:47,697] {result_logger:134} INFO - 
[[28221    73    88]
 [   52  2478    15]
 [ 3015  1022 16666]]
[2024-08-05 10:49:47,792] {result_logger:141} INFO - 
[[ 99.43%   0.26%   0.31%]
 [  2.04%  97.37%   0.59%]
 [ 14.56%   4.94%  80.50%]]
[2024-08-05 10:49:47,882] {result_logger:145} INFO - 
[[ 90.20%   2.04%   0.52%]
 [  0.17%  69.35%   0.09%]
 [  9.64%  28.60%  99.39%]]
[2024-08-05 10:49:48,134] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 10:49:48,134] {result_logger:77} INFO - actual:
[2024-08-05 10:49:48,135] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 10:49:48,135] {result_logger:79} INFO - predicted:
[2024-08-05 10:49:48,135] {result_logger:80} INFO - 
[[93.77%  0.22%  6.01%]
 [19.20% 76.88%  3.92%]
 [ 7.53%  4.51% 87.96%]]
[2024-08-05 10:49:48,191] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_E_weighted/model_8conv_2fc-best.pth
[2024-08-05 10:49:48,191] {run_experiment:113} INFO - [epoch   8] execution time: 107.45s	 avg f1-score: 0.8818

[2024-08-05 10:49:48,191] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:49:48,217] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:50:02,531] {train_model:82} INFO - Train Epoch: 9 [36352/366120 (10%)]	lr:1.93e-04	Loss: 0.184119
[2024-08-05 10:50:11,553] {train_model:82} INFO - Train Epoch: 9 [72960/366120 (20%)]	lr:1.93e-04	Loss: 0.143895
[2024-08-05 10:50:20,652] {train_model:82} INFO - Train Epoch: 9 [109568/366120 (30%)]	lr:1.93e-04	Loss: 4.104191
[2024-08-05 10:50:29,810] {train_model:82} INFO - Train Epoch: 9 [146176/366120 (40%)]	lr:1.93e-04	Loss: 0.233818
[2024-08-05 10:50:38,944] {train_model:82} INFO - Train Epoch: 9 [182784/366120 (50%)]	lr:1.93e-04	Loss: 0.375504
[2024-08-05 10:50:48,085] {train_model:82} INFO - Train Epoch: 9 [219392/366120 (60%)]	lr:1.93e-04	Loss: 0.149228
[2024-08-05 10:50:57,255] {train_model:82} INFO - Train Epoch: 9 [256000/366120 (70%)]	lr:1.93e-04	Loss: 0.326506
[2024-08-05 10:51:06,441] {train_model:82} INFO - Train Epoch: 9 [292608/366120 (80%)]	lr:1.93e-04	Loss: 0.084138
[2024-08-05 10:51:15,642] {train_model:82} INFO - Train Epoch: 9 [329216/366120 (90%)]	lr:1.93e-04	Loss: 0.502342
[2024-08-05 10:51:24,804] {train_model:82} INFO - Train Epoch: 9 [365824/366120 (100%)]	lr:1.93e-04	Loss: 0.097418
[2024-08-05 10:51:29,741] {run_experiment:79} INFO - 
[2024-08-05 10:51:29,741] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 10:51:30,410] {result_logger:103} INFO - precision on Wake: 0.977
[2024-08-05 10:51:30,820] {result_logger:104} INFO - recall on Wake: 0.957
[2024-08-05 10:51:31,232] {result_logger:107} INFO - F1-score on Wake: 0.967
[2024-08-05 10:51:31,232] {result_logger:108} INFO - 
[2024-08-05 10:51:31,814] {result_logger:103} INFO - precision on REM: 0.739
[2024-08-05 10:51:32,167] {result_logger:104} INFO - recall on REM: 0.946
[2024-08-05 10:51:32,523] {result_logger:107} INFO - F1-score on REM: 0.830
[2024-08-05 10:51:32,523] {result_logger:108} INFO - 
[2024-08-05 10:51:33,154] {result_logger:103} INFO - precision on Non REM: 0.950
[2024-08-05 10:51:33,555] {result_logger:104} INFO - recall on Non REM: 0.942
[2024-08-05 10:51:33,957] {result_logger:107} INFO - F1-score on Non REM: 0.946
[2024-08-05 10:51:33,957] {result_logger:108} INFO - 
[2024-08-05 10:51:34,050] {result_logger:111} INFO - average precision on sleep stages: 0.889
[2024-08-05 10:51:34,144] {result_logger:113} INFO - average recall on sleep stages: 0.949
[2024-08-05 10:51:34,239] {result_logger:115} INFO - average F1-score on sleep stages: 0.914
[2024-08-05 10:51:34,241] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 10:51:34,325] {result_logger:103} INFO - precision on Wake: 0.939
[2024-08-05 10:51:34,374] {result_logger:104} INFO - recall on Wake: 0.839
[2024-08-05 10:51:34,424] {result_logger:107} INFO - F1-score on Wake: 0.886
[2024-08-05 10:51:34,425] {result_logger:108} INFO - 
[2024-08-05 10:51:34,505] {result_logger:103} INFO - precision on REM: 0.322
[2024-08-05 10:51:34,554] {result_logger:104} INFO - recall on REM: 0.992
[2024-08-05 10:51:34,603] {result_logger:107} INFO - F1-score on REM: 0.486
[2024-08-05 10:51:34,603] {result_logger:108} INFO - 
[2024-08-05 10:51:34,686] {result_logger:103} INFO - precision on Non REM: 0.981
[2024-08-05 10:51:34,736] {result_logger:104} INFO - recall on Non REM: 0.873
[2024-08-05 10:51:34,787] {result_logger:107} INFO - F1-score on Non REM: 0.924
[2024-08-05 10:51:34,787] {result_logger:108} INFO - 
[2024-08-05 10:51:34,798] {result_logger:111} INFO - average precision on sleep stages: 0.747
[2024-08-05 10:51:34,809] {result_logger:113} INFO - average recall on sleep stages: 0.901
[2024-08-05 10:51:34,820] {result_logger:115} INFO - average F1-score on sleep stages: 0.765
[2024-08-05 10:51:34,820] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 10:51:34,884] {result_logger:134} INFO - 
[[195039   2144   6564]
 [   437  17603    566]
 [  4230   4064 135473]]
[2024-08-05 10:51:34,948] {result_logger:141} INFO - 
[[ 95.73%   1.05%   3.22%]
 [  2.35%  94.61%   3.04%]
 [  2.94%   2.83%  94.23%]]
[2024-08-05 10:51:35,011] {result_logger:145} INFO - 
[[ 97.66%   9.00%   4.60%]
 [  0.22%  73.93%   0.40%]
 [  2.12%  17.07%  95.00%]]
[2024-08-05 10:51:35,011] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 10:51:35,018] {result_logger:134} INFO - 
[[23817  4243   322]
 [    1  2524    20]
 [ 1555  1083 18065]]
[2024-08-05 10:51:35,026] {result_logger:141} INFO - 
[[ 83.92%  14.95%   1.13%]
 [  0.04%  99.17%   0.79%]
 [  7.51%   5.23%  87.26%]]
[2024-08-05 10:51:35,034] {result_logger:145} INFO - 
[[ 93.87%  54.05%   1.75%]
 [  0.00%  32.15%   0.11%]
 [  6.13%  13.80%  98.14%]]
[2024-08-05 10:51:35,123] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 10:51:35,123] {result_logger:77} INFO - actual:
[2024-08-05 10:51:35,123] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 10:51:35,123] {result_logger:79} INFO - predicted:
[2024-08-05 10:51:35,123] {result_logger:80} INFO - 
[[87.30%  6.19%  6.51%]
 [26.76% 69.44%  3.80%]
 [ 6.09%  4.50% 89.41%]]
[2024-08-05 10:51:35,123] {run_experiment:113} INFO - [epoch   9] execution time: 106.93s	 avg f1-score: 0.7652

[2024-08-05 10:51:35,123] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:51:35,149] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:51:49,446] {train_model:82} INFO - Train Epoch: 10 [36352/366120 (10%)]	lr:2.14e-04	Loss: 0.206045
[2024-08-05 10:51:58,502] {train_model:82} INFO - Train Epoch: 10 [72960/366120 (20%)]	lr:2.14e-04	Loss: 0.133434
[2024-08-05 10:52:07,546] {train_model:82} INFO - Train Epoch: 10 [109568/366120 (30%)]	lr:2.14e-04	Loss: 0.169865
[2024-08-05 10:52:16,615] {train_model:82} INFO - Train Epoch: 10 [146176/366120 (40%)]	lr:2.14e-04	Loss: 0.118116
[2024-08-05 10:52:25,719] {train_model:82} INFO - Train Epoch: 10 [182784/366120 (50%)]	lr:2.14e-04	Loss: 0.154476
[2024-08-05 10:52:34,856] {train_model:82} INFO - Train Epoch: 10 [219392/366120 (60%)]	lr:2.14e-04	Loss: 0.149015
[2024-08-05 10:52:44,086] {train_model:82} INFO - Train Epoch: 10 [256000/366120 (70%)]	lr:2.14e-04	Loss: 0.068721
[2024-08-05 10:52:53,357] {train_model:82} INFO - Train Epoch: 10 [292608/366120 (80%)]	lr:2.14e-04	Loss: 0.177125
[2024-08-05 10:53:02,668] {train_model:82} INFO - Train Epoch: 10 [329216/366120 (90%)]	lr:2.14e-04	Loss: 0.161168
[2024-08-05 10:53:11,934] {train_model:82} INFO - Train Epoch: 10 [365824/366120 (100%)]	lr:2.14e-04	Loss: 0.214606
[2024-08-05 10:53:17,282] {run_experiment:79} INFO - 
[2024-08-05 10:53:17,282] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 10:53:17,918] {result_logger:103} INFO - precision on Wake: 0.978
[2024-08-05 10:53:18,326] {result_logger:104} INFO - recall on Wake: 0.961
[2024-08-05 10:53:18,734] {result_logger:107} INFO - F1-score on Wake: 0.970
[2024-08-05 10:53:18,734] {result_logger:108} INFO - 
[2024-08-05 10:53:19,304] {result_logger:103} INFO - precision on REM: 0.754
[2024-08-05 10:53:19,658] {result_logger:104} INFO - recall on REM: 0.954
[2024-08-05 10:53:20,013] {result_logger:107} INFO - F1-score on REM: 0.842
[2024-08-05 10:53:20,013] {result_logger:108} INFO - 
[2024-08-05 10:53:20,627] {result_logger:103} INFO - precision on Non REM: 0.954
[2024-08-05 10:53:21,026] {result_logger:104} INFO - recall on Non REM: 0.944
[2024-08-05 10:53:21,425] {result_logger:107} INFO - F1-score on Non REM: 0.949
[2024-08-05 10:53:21,425] {result_logger:108} INFO - 
[2024-08-05 10:53:21,514] {result_logger:111} INFO - average precision on sleep stages: 0.895
[2024-08-05 10:53:21,601] {result_logger:113} INFO - average recall on sleep stages: 0.953
[2024-08-05 10:53:21,687] {result_logger:115} INFO - average F1-score on sleep stages: 0.920
[2024-08-05 10:53:21,689] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 10:53:21,768] {result_logger:103} INFO - precision on Wake: 0.948
[2024-08-05 10:53:21,817] {result_logger:104} INFO - recall on Wake: 0.986
[2024-08-05 10:53:21,866] {result_logger:107} INFO - F1-score on Wake: 0.966
[2024-08-05 10:53:21,866] {result_logger:108} INFO - 
[2024-08-05 10:53:21,944] {result_logger:103} INFO - precision on REM: 0.700
[2024-08-05 10:53:21,993] {result_logger:104} INFO - recall on REM: 0.982
[2024-08-05 10:53:22,042] {result_logger:107} INFO - F1-score on REM: 0.817
[2024-08-05 10:53:22,043] {result_logger:108} INFO - 
[2024-08-05 10:53:22,123] {result_logger:103} INFO - precision on Non REM: 0.984
[2024-08-05 10:53:22,174] {result_logger:104} INFO - recall on Non REM: 0.882
[2024-08-05 10:53:22,225] {result_logger:107} INFO - F1-score on Non REM: 0.930
[2024-08-05 10:53:22,225] {result_logger:108} INFO - 
[2024-08-05 10:53:22,235] {result_logger:111} INFO - average precision on sleep stages: 0.877
[2024-08-05 10:53:22,246] {result_logger:113} INFO - average recall on sleep stages: 0.950
[2024-08-05 10:53:22,256] {result_logger:115} INFO - average F1-score on sleep stages: 0.905
[2024-08-05 10:53:22,256] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 10:53:22,316] {result_logger:134} INFO - 
[[195887   1899   5961]
 [   327  17746    533]
 [  4115   3891 135761]]
[2024-08-05 10:53:22,375] {result_logger:141} INFO - 
[[ 96.14%   0.93%   2.93%]
 [  1.76%  95.38%   2.86%]
 [  2.86%   2.71%  94.43%]]
[2024-08-05 10:53:22,436] {result_logger:145} INFO - 
[[ 97.78%   8.07%   4.19%]
 [  0.16%  75.40%   0.37%]
 [  2.05%  16.53%  95.43%]]
[2024-08-05 10:53:22,436] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 10:53:22,443] {result_logger:134} INFO - 
[[27974   137   271]
 [   22  2499    24]
 [ 1513   934 18256]]
[2024-08-05 10:53:22,539] {result_logger:141} INFO - 
[[ 98.56%   0.48%   0.95%]
 [  0.86%  98.19%   0.94%]
 [  7.31%   4.51%  88.18%]]
[2024-08-05 10:53:22,628] {result_logger:145} INFO - 
[[ 94.80%   3.84%   1.46%]
 [  0.07%  70.00%   0.13%]
 [  5.13%  26.16%  98.41%]]
[2024-08-05 10:53:22,977] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 10:53:22,978] {result_logger:77} INFO - actual:
[2024-08-05 10:53:22,978] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 10:53:22,978] {result_logger:79} INFO - predicted:
[2024-08-05 10:53:22,978] {result_logger:80} INFO - 
[[94.30%  0.32%  5.38%]
 [18.21% 76.50%  5.29%]
 [ 5.56%  4.01% 90.43%]]
[2024-08-05 10:53:23,034] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_E_weighted/model_8conv_2fc-best.pth
[2024-08-05 10:53:23,034] {run_experiment:113} INFO - [epoch  10] execution time: 107.91s	 avg f1-score: 0.9046

[2024-08-05 10:53:23,034] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:53:23,060] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:53:37,689] {train_model:82} INFO - Train Epoch: 11 [36352/366120 (10%)]	lr:2.35e-04	Loss: 0.127800
[2024-08-05 10:53:46,732] {train_model:82} INFO - Train Epoch: 11 [72960/366120 (20%)]	lr:2.35e-04	Loss: 0.211179
[2024-08-05 10:53:55,810] {train_model:82} INFO - Train Epoch: 11 [109568/366120 (30%)]	lr:2.35e-04	Loss: 0.106465
[2024-08-05 10:54:04,957] {train_model:82} INFO - Train Epoch: 11 [146176/366120 (40%)]	lr:2.35e-04	Loss: 0.071188
[2024-08-05 10:54:14,129] {train_model:82} INFO - Train Epoch: 11 [182784/366120 (50%)]	lr:2.35e-04	Loss: 0.123934
[2024-08-05 10:54:23,323] {train_model:82} INFO - Train Epoch: 11 [219392/366120 (60%)]	lr:2.35e-04	Loss: 0.263894
[2024-08-05 10:54:32,497] {train_model:82} INFO - Train Epoch: 11 [256000/366120 (70%)]	lr:2.35e-04	Loss: 0.075208
[2024-08-05 10:54:41,673] {train_model:82} INFO - Train Epoch: 11 [292608/366120 (80%)]	lr:2.35e-04	Loss: 0.151028
[2024-08-05 10:54:50,859] {train_model:82} INFO - Train Epoch: 11 [329216/366120 (90%)]	lr:2.35e-04	Loss: 0.099677
[2024-08-05 10:55:00,039] {train_model:82} INFO - Train Epoch: 11 [365824/366120 (100%)]	lr:2.35e-04	Loss: 0.065257
[2024-08-05 10:55:05,087] {run_experiment:79} INFO - 
[2024-08-05 10:55:05,087] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 10:55:05,744] {result_logger:103} INFO - precision on Wake: 0.979
[2024-08-05 10:55:06,155] {result_logger:104} INFO - recall on Wake: 0.965
[2024-08-05 10:55:06,569] {result_logger:107} INFO - F1-score on Wake: 0.972
[2024-08-05 10:55:06,569] {result_logger:108} INFO - 
[2024-08-05 10:55:07,158] {result_logger:103} INFO - precision on REM: 0.762
[2024-08-05 10:55:07,520] {result_logger:104} INFO - recall on REM: 0.958
[2024-08-05 10:55:07,877] {result_logger:107} INFO - F1-score on REM: 0.849
[2024-08-05 10:55:07,877] {result_logger:108} INFO - 
[2024-08-05 10:55:08,509] {result_logger:103} INFO - precision on Non REM: 0.957
[2024-08-05 10:55:08,907] {result_logger:104} INFO - recall on Non REM: 0.945
[2024-08-05 10:55:09,306] {result_logger:107} INFO - F1-score on Non REM: 0.951
[2024-08-05 10:55:09,306] {result_logger:108} INFO - 
[2024-08-05 10:55:09,395] {result_logger:111} INFO - average precision on sleep stages: 0.899
[2024-08-05 10:55:09,486] {result_logger:113} INFO - average recall on sleep stages: 0.956
[2024-08-05 10:55:09,575] {result_logger:115} INFO - average F1-score on sleep stages: 0.924
[2024-08-05 10:55:09,576] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 10:55:09,659] {result_logger:103} INFO - precision on Wake: 0.962
[2024-08-05 10:55:09,709] {result_logger:104} INFO - recall on Wake: 0.979
[2024-08-05 10:55:09,758] {result_logger:107} INFO - F1-score on Wake: 0.970
[2024-08-05 10:55:09,758] {result_logger:108} INFO - 
[2024-08-05 10:55:09,840] {result_logger:103} INFO - precision on REM: 0.726
[2024-08-05 10:55:09,888] {result_logger:104} INFO - recall on REM: 0.974
[2024-08-05 10:55:09,937] {result_logger:107} INFO - F1-score on REM: 0.832
[2024-08-05 10:55:09,937] {result_logger:108} INFO - 
[2024-08-05 10:55:10,019] {result_logger:103} INFO - precision on Non REM: 0.977
[2024-08-05 10:55:10,069] {result_logger:104} INFO - recall on Non REM: 0.913
[2024-08-05 10:55:10,119] {result_logger:107} INFO - F1-score on Non REM: 0.944
[2024-08-05 10:55:10,119] {result_logger:108} INFO - 
[2024-08-05 10:55:10,130] {result_logger:111} INFO - average precision on sleep stages: 0.888
[2024-08-05 10:55:10,140] {result_logger:113} INFO - average recall on sleep stages: 0.955
[2024-08-05 10:55:10,151] {result_logger:115} INFO - average F1-score on sleep stages: 0.915
[2024-08-05 10:55:10,151] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 10:55:10,212] {result_logger:134} INFO - 
[[196520   1664   5563]
 [   292  17821    493]
 [  4008   3891 135868]]
[2024-08-05 10:55:10,272] {result_logger:141} INFO - 
[[ 96.45%   0.82%   2.73%]
 [  1.57%  95.78%   2.65%]
 [  2.79%   2.71%  94.51%]]
[2024-08-05 10:55:10,332] {result_logger:145} INFO - 
[[ 97.86%   7.12%   3.92%]
 [  0.15%  76.24%   0.35%]
 [  2.00%  16.65%  95.73%]]
[2024-08-05 10:55:10,332] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 10:55:10,340] {result_logger:134} INFO - 
[[27776   181   425]
 [   43  2479    23]
 [ 1052   755 18896]]
[2024-08-05 10:55:10,435] {result_logger:141} INFO - 
[[ 97.86%   0.64%   1.50%]
 [  1.69%  97.41%   0.90%]
 [  5.08%   3.65%  91.27%]]
[2024-08-05 10:55:10,525] {result_logger:145} INFO - 
[[ 96.21%   5.30%   2.20%]
 [  0.15%  72.59%   0.12%]
 [  3.64%  22.11%  97.68%]]
[2024-08-05 10:55:10,789] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 10:55:10,789] {result_logger:77} INFO - actual:
[2024-08-05 10:55:10,789] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 10:55:10,789] {result_logger:79} INFO - predicted:
[2024-08-05 10:55:10,789] {result_logger:80} INFO - 
[[94.00%  0.46%  5.53%]
 [19.21% 76.13%  4.66%]
 [ 5.56%  3.52% 90.92%]]
[2024-08-05 10:55:10,848] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_E_weighted/model_8conv_2fc-best.pth
[2024-08-05 10:55:10,848] {run_experiment:113} INFO - [epoch  11] execution time: 107.81s	 avg f1-score: 0.9153

[2024-08-05 10:55:10,848] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:55:10,874] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:55:25,568] {train_model:82} INFO - Train Epoch: 12 [36352/366120 (10%)]	lr:2.56e-04	Loss: 0.266066
[2024-08-05 10:55:34,602] {train_model:82} INFO - Train Epoch: 12 [72960/366120 (20%)]	lr:2.56e-04	Loss: 0.089489
[2024-08-05 10:55:43,653] {train_model:82} INFO - Train Epoch: 12 [109568/366120 (30%)]	lr:2.56e-04	Loss: 0.087514
[2024-08-05 10:55:52,734] {train_model:82} INFO - Train Epoch: 12 [146176/366120 (40%)]	lr:2.56e-04	Loss: 0.071970
[2024-08-05 10:56:01,830] {train_model:82} INFO - Train Epoch: 12 [182784/366120 (50%)]	lr:2.56e-04	Loss: 0.098650
[2024-08-05 10:56:10,952] {train_model:82} INFO - Train Epoch: 12 [219392/366120 (60%)]	lr:2.56e-04	Loss: 0.070816
[2024-08-05 10:56:20,100] {train_model:82} INFO - Train Epoch: 12 [256000/366120 (70%)]	lr:2.56e-04	Loss: 0.119873
[2024-08-05 10:56:29,281] {train_model:82} INFO - Train Epoch: 12 [292608/366120 (80%)]	lr:2.56e-04	Loss: 0.121979
[2024-08-05 10:56:38,466] {train_model:82} INFO - Train Epoch: 12 [329216/366120 (90%)]	lr:2.56e-04	Loss: 0.113697
[2024-08-05 10:56:47,599] {train_model:82} INFO - Train Epoch: 12 [365824/366120 (100%)]	lr:2.56e-04	Loss: 0.358297
[2024-08-05 10:56:52,595] {run_experiment:79} INFO - 
[2024-08-05 10:56:52,595] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 10:56:53,234] {result_logger:103} INFO - precision on Wake: 0.980
[2024-08-05 10:56:53,642] {result_logger:104} INFO - recall on Wake: 0.968
[2024-08-05 10:56:54,050] {result_logger:107} INFO - F1-score on Wake: 0.974
[2024-08-05 10:56:54,050] {result_logger:108} INFO - 
[2024-08-05 10:56:54,615] {result_logger:103} INFO - precision on REM: 0.770
[2024-08-05 10:56:54,968] {result_logger:104} INFO - recall on REM: 0.965
[2024-08-05 10:56:55,321] {result_logger:107} INFO - F1-score on REM: 0.857
[2024-08-05 10:56:55,322] {result_logger:108} INFO - 
[2024-08-05 10:56:55,942] {result_logger:103} INFO - precision on Non REM: 0.962
[2024-08-05 10:56:56,345] {result_logger:104} INFO - recall on Non REM: 0.946
[2024-08-05 10:56:56,746] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2024-08-05 10:56:56,746] {result_logger:108} INFO - 
[2024-08-05 10:56:56,837] {result_logger:111} INFO - average precision on sleep stages: 0.904
[2024-08-05 10:56:56,927] {result_logger:113} INFO - average recall on sleep stages: 0.960
[2024-08-05 10:56:57,018] {result_logger:115} INFO - average F1-score on sleep stages: 0.928
[2024-08-05 10:56:57,019] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 10:56:57,100] {result_logger:103} INFO - precision on Wake: 0.978
[2024-08-05 10:56:57,150] {result_logger:104} INFO - recall on Wake: 0.971
[2024-08-05 10:56:57,200] {result_logger:107} INFO - F1-score on Wake: 0.974
[2024-08-05 10:56:57,200] {result_logger:108} INFO - 
[2024-08-05 10:56:57,278] {result_logger:103} INFO - precision on REM: 0.716
[2024-08-05 10:56:57,326] {result_logger:104} INFO - recall on REM: 0.984
[2024-08-05 10:56:57,374] {result_logger:107} INFO - F1-score on REM: 0.829
[2024-08-05 10:56:57,374] {result_logger:108} INFO - 
[2024-08-05 10:56:57,454] {result_logger:103} INFO - precision on Non REM: 0.974
[2024-08-05 10:56:57,505] {result_logger:104} INFO - recall on Non REM: 0.938
[2024-08-05 10:56:57,555] {result_logger:107} INFO - F1-score on Non REM: 0.955
[2024-08-05 10:56:57,555] {result_logger:108} INFO - 
[2024-08-05 10:56:57,566] {result_logger:111} INFO - average precision on sleep stages: 0.889
[2024-08-05 10:56:57,576] {result_logger:113} INFO - average recall on sleep stages: 0.964
[2024-08-05 10:56:57,587] {result_logger:115} INFO - average F1-score on sleep stages: 0.919
[2024-08-05 10:56:57,587] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 10:56:57,649] {result_logger:134} INFO - 
[[197279   1449   5019]
 [   225  17962    419]
 [  3839   3907 136021]]
[2024-08-05 10:56:57,711] {result_logger:141} INFO - 
[[ 96.83%   0.71%   2.46%]
 [  1.21%  96.54%   2.25%]
 [  2.67%   2.72%  94.61%]]
[2024-08-05 10:56:57,773] {result_logger:145} INFO - 
[[ 97.98%   6.21%   3.55%]
 [  0.11%  77.03%   0.30%]
 [  1.91%  16.76%  96.16%]]
[2024-08-05 10:56:57,773] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 10:56:57,780] {result_logger:134} INFO - 
[[27562   324   496]
 [    8  2505    32]
 [  617   672 19414]]
[2024-08-05 10:56:57,874] {result_logger:141} INFO - 
[[ 97.11%   1.14%   1.75%]
 [  0.31%  98.43%   1.26%]
 [  2.98%   3.25%  93.77%]]
[2024-08-05 10:56:57,963] {result_logger:145} INFO - 
[[ 97.78%   9.25%   2.49%]
 [  0.03%  71.55%   0.16%]
 [  2.19%  19.19%  97.35%]]
[2024-08-05 10:56:58,216] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 10:56:58,217] {result_logger:77} INFO - actual:
[2024-08-05 10:56:58,217] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 10:56:58,217] {result_logger:79} INFO - predicted:
[2024-08-05 10:56:58,217] {result_logger:80} INFO - 
[[94.75%  0.69%  4.56%]
 [18.94% 75.52%  5.54%]
 [ 4.09%  3.32% 92.58%]]
[2024-08-05 10:56:58,273] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_E_weighted/model_8conv_2fc-best.pth
[2024-08-05 10:56:58,273] {run_experiment:113} INFO - [epoch  12] execution time: 107.42s	 avg f1-score: 0.9195

[2024-08-05 10:56:58,273] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:56:58,298] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:57:12,612] {train_model:82} INFO - Train Epoch: 13 [36352/366120 (10%)]	lr:2.41e-04	Loss: 0.098547
[2024-08-05 10:57:21,725] {train_model:82} INFO - Train Epoch: 13 [72960/366120 (20%)]	lr:2.41e-04	Loss: 0.125211
[2024-08-05 10:57:30,924] {train_model:82} INFO - Train Epoch: 13 [109568/366120 (30%)]	lr:2.41e-04	Loss: 0.085322
[2024-08-05 10:57:40,152] {train_model:82} INFO - Train Epoch: 13 [146176/366120 (40%)]	lr:2.41e-04	Loss: 0.135340
[2024-08-05 10:57:49,407] {train_model:82} INFO - Train Epoch: 13 [182784/366120 (50%)]	lr:2.41e-04	Loss: 0.161248
[2024-08-05 10:57:58,679] {train_model:82} INFO - Train Epoch: 13 [219392/366120 (60%)]	lr:2.41e-04	Loss: 0.140226
[2024-08-05 10:58:07,957] {train_model:82} INFO - Train Epoch: 13 [256000/366120 (70%)]	lr:2.41e-04	Loss: 0.131484
[2024-08-05 10:58:17,248] {train_model:82} INFO - Train Epoch: 13 [292608/366120 (80%)]	lr:2.41e-04	Loss: 0.182746
[2024-08-05 10:58:26,543] {train_model:82} INFO - Train Epoch: 13 [329216/366120 (90%)]	lr:2.41e-04	Loss: 0.127662
[2024-08-05 10:58:35,815] {train_model:82} INFO - Train Epoch: 13 [365824/366120 (100%)]	lr:2.41e-04	Loss: 0.067364
[2024-08-05 10:58:40,887] {run_experiment:79} INFO - 
[2024-08-05 10:58:40,887] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 10:58:41,554] {result_logger:103} INFO - precision on Wake: 0.981
[2024-08-05 10:58:41,964] {result_logger:104} INFO - recall on Wake: 0.971
[2024-08-05 10:58:42,376] {result_logger:107} INFO - F1-score on Wake: 0.976
[2024-08-05 10:58:42,376] {result_logger:108} INFO - 
[2024-08-05 10:58:42,952] {result_logger:103} INFO - precision on REM: 0.786
[2024-08-05 10:58:43,309] {result_logger:104} INFO - recall on REM: 0.968
[2024-08-05 10:58:43,662] {result_logger:107} INFO - F1-score on REM: 0.868
[2024-08-05 10:58:43,662] {result_logger:108} INFO - 
[2024-08-05 10:58:44,292] {result_logger:103} INFO - precision on Non REM: 0.964
[2024-08-05 10:58:44,693] {result_logger:104} INFO - recall on Non REM: 0.950
[2024-08-05 10:58:45,095] {result_logger:107} INFO - F1-score on Non REM: 0.957
[2024-08-05 10:58:45,095] {result_logger:108} INFO - 
[2024-08-05 10:58:45,187] {result_logger:111} INFO - average precision on sleep stages: 0.911
[2024-08-05 10:58:45,279] {result_logger:113} INFO - average recall on sleep stages: 0.963
[2024-08-05 10:58:45,371] {result_logger:115} INFO - average F1-score on sleep stages: 0.934
[2024-08-05 10:58:45,372] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 10:58:45,461] {result_logger:103} INFO - precision on Wake: 0.980
[2024-08-05 10:58:45,511] {result_logger:104} INFO - recall on Wake: 0.973
[2024-08-05 10:58:45,561] {result_logger:107} INFO - F1-score on Wake: 0.977
[2024-08-05 10:58:45,561] {result_logger:108} INFO - 
[2024-08-05 10:58:45,640] {result_logger:103} INFO - precision on REM: 0.697
[2024-08-05 10:58:45,689] {result_logger:104} INFO - recall on REM: 0.988
[2024-08-05 10:58:45,737] {result_logger:107} INFO - F1-score on REM: 0.817
[2024-08-05 10:58:45,737] {result_logger:108} INFO - 
[2024-08-05 10:58:45,818] {result_logger:103} INFO - precision on Non REM: 0.968
[2024-08-05 10:58:45,868] {result_logger:104} INFO - recall on Non REM: 0.928
[2024-08-05 10:58:45,919] {result_logger:107} INFO - F1-score on Non REM: 0.947
[2024-08-05 10:58:45,919] {result_logger:108} INFO - 
[2024-08-05 10:58:45,929] {result_logger:111} INFO - average precision on sleep stages: 0.882
[2024-08-05 10:58:45,938] {result_logger:113} INFO - average recall on sleep stages: 0.963
[2024-08-05 10:58:45,948] {result_logger:115} INFO - average F1-score on sleep stages: 0.914
[2024-08-05 10:58:45,948] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 10:58:46,011] {result_logger:134} INFO - 
[[197792   1260   4695]
 [   201  18007    398]
 [  3558   3631 136578]]
[2024-08-05 10:58:46,074] {result_logger:141} INFO - 
[[ 97.08%   0.62%   2.30%]
 [  1.08%  96.78%   2.14%]
 [  2.47%   2.53%  95.00%]]
[2024-08-05 10:58:46,137] {result_logger:145} INFO - 
[[ 98.13%   5.50%   3.31%]
 [  0.10%  78.64%   0.28%]
 [  1.77%  15.86%  96.41%]]
[2024-08-05 10:58:46,137] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 10:58:46,144] {result_logger:134} INFO - 
[[27618   153   611]
 [    7  2514    24]
 [  554   942 19207]]
[2024-08-05 10:58:46,151] {result_logger:141} INFO - 
[[ 97.31%   0.54%   2.15%]
 [  0.28%  98.78%   0.94%]
 [  2.68%   4.55%  92.77%]]
[2024-08-05 10:58:46,159] {result_logger:145} INFO - 
[[ 98.01%   4.24%   3.08%]
 [  0.02%  69.66%   0.12%]
 [  1.97%  26.10%  96.80%]]
[2024-08-05 10:58:46,249] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 10:58:46,249] {result_logger:77} INFO - actual:
[2024-08-05 10:58:46,249] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 10:58:46,249] {result_logger:79} INFO - predicted:
[2024-08-05 10:58:46,249] {result_logger:80} INFO - 
[[94.96%  0.27%  4.77%]
 [16.15% 76.56%  7.29%]
 [ 4.21%  3.88% 91.91%]]
[2024-08-05 10:58:46,249] {run_experiment:113} INFO - [epoch  13] execution time: 107.98s	 avg f1-score: 0.9137

[2024-08-05 10:58:46,250] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:58:46,275] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:59:00,622] {train_model:82} INFO - Train Epoch: 14 [36352/366120 (10%)]	lr:2.27e-04	Loss: 0.085636
[2024-08-05 10:59:09,708] {train_model:82} INFO - Train Epoch: 14 [72960/366120 (20%)]	lr:2.27e-04	Loss: 0.184522
[2024-08-05 10:59:18,820] {train_model:82} INFO - Train Epoch: 14 [109568/366120 (30%)]	lr:2.27e-04	Loss: 0.065503
[2024-08-05 10:59:27,973] {train_model:82} INFO - Train Epoch: 14 [146176/366120 (40%)]	lr:2.27e-04	Loss: 0.090396
[2024-08-05 10:59:37,148] {train_model:82} INFO - Train Epoch: 14 [182784/366120 (50%)]	lr:2.27e-04	Loss: 0.075346
[2024-08-05 10:59:46,339] {train_model:82} INFO - Train Epoch: 14 [219392/366120 (60%)]	lr:2.27e-04	Loss: 0.085779
[2024-08-05 10:59:55,566] {train_model:82} INFO - Train Epoch: 14 [256000/366120 (70%)]	lr:2.27e-04	Loss: 0.138867
[2024-08-05 11:00:04,843] {train_model:82} INFO - Train Epoch: 14 [292608/366120 (80%)]	lr:2.27e-04	Loss: 0.057527
[2024-08-05 11:00:14,084] {train_model:82} INFO - Train Epoch: 14 [329216/366120 (90%)]	lr:2.27e-04	Loss: 0.053167
[2024-08-05 11:00:23,290] {train_model:82} INFO - Train Epoch: 14 [365824/366120 (100%)]	lr:2.27e-04	Loss: 0.054735
[2024-08-05 11:00:28,415] {run_experiment:79} INFO - 
[2024-08-05 11:00:28,415] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:00:29,081] {result_logger:103} INFO - precision on Wake: 0.983
[2024-08-05 11:00:29,490] {result_logger:104} INFO - recall on Wake: 0.972
[2024-08-05 11:00:29,898] {result_logger:107} INFO - F1-score on Wake: 0.977
[2024-08-05 11:00:29,898] {result_logger:108} INFO - 
[2024-08-05 11:00:30,480] {result_logger:103} INFO - precision on REM: 0.800
[2024-08-05 11:00:30,835] {result_logger:104} INFO - recall on REM: 0.971
[2024-08-05 11:00:31,189] {result_logger:107} INFO - F1-score on REM: 0.877
[2024-08-05 11:00:31,189] {result_logger:108} INFO - 
[2024-08-05 11:00:31,811] {result_logger:103} INFO - precision on Non REM: 0.965
[2024-08-05 11:00:32,205] {result_logger:104} INFO - recall on Non REM: 0.954
[2024-08-05 11:00:32,600] {result_logger:107} INFO - F1-score on Non REM: 0.959
[2024-08-05 11:00:32,600] {result_logger:108} INFO - 
[2024-08-05 11:00:32,689] {result_logger:111} INFO - average precision on sleep stages: 0.916
[2024-08-05 11:00:32,778] {result_logger:113} INFO - average recall on sleep stages: 0.965
[2024-08-05 11:00:32,867] {result_logger:115} INFO - average F1-score on sleep stages: 0.938
[2024-08-05 11:00:32,868] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:00:32,954] {result_logger:103} INFO - precision on Wake: 0.969
[2024-08-05 11:00:33,004] {result_logger:104} INFO - recall on Wake: 0.949
[2024-08-05 11:00:33,055] {result_logger:107} INFO - F1-score on Wake: 0.959
[2024-08-05 11:00:33,055] {result_logger:108} INFO - 
[2024-08-05 11:00:33,134] {result_logger:103} INFO - precision on REM: 0.619
[2024-08-05 11:00:33,183] {result_logger:104} INFO - recall on REM: 0.974
[2024-08-05 11:00:33,231] {result_logger:107} INFO - F1-score on REM: 0.757
[2024-08-05 11:00:33,231] {result_logger:108} INFO - 
[2024-08-05 11:00:33,312] {result_logger:103} INFO - precision on Non REM: 0.976
[2024-08-05 11:00:33,363] {result_logger:104} INFO - recall on Non REM: 0.935
[2024-08-05 11:00:33,412] {result_logger:107} INFO - F1-score on Non REM: 0.955
[2024-08-05 11:00:33,412] {result_logger:108} INFO - 
[2024-08-05 11:00:33,423] {result_logger:111} INFO - average precision on sleep stages: 0.854
[2024-08-05 11:00:33,433] {result_logger:113} INFO - average recall on sleep stages: 0.952
[2024-08-05 11:00:33,444] {result_logger:115} INFO - average F1-score on sleep stages: 0.890
[2024-08-05 11:00:33,444] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:00:33,504] {result_logger:134} INFO - 
[[197972   1177   4598]
 [   169  18058    379]
 [  3330   3349 137088]]
[2024-08-05 11:00:33,564] {result_logger:141} INFO - 
[[ 97.17%   0.58%   2.26%]
 [  0.91%  97.05%   2.04%]
 [  2.32%   2.33%  95.35%]]
[2024-08-05 11:00:33,623] {result_logger:145} INFO - 
[[ 98.26%   5.21%   3.24%]
 [  0.08%  79.96%   0.27%]
 [  1.65%  14.83%  96.50%]]
[2024-08-05 11:00:33,624] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:00:33,631] {result_logger:134} INFO - 
[[26924  1037   421]
 [   10  2478    57]
 [  852   491 19360]]
[2024-08-05 11:00:33,638] {result_logger:141} INFO - 
[[ 94.86%   3.65%   1.48%]
 [  0.39%  97.37%   2.24%]
 [  4.12%   2.37%  93.51%]]
[2024-08-05 11:00:33,646] {result_logger:145} INFO - 
[[ 96.90%  25.89%   2.12%]
 [  0.04%  61.86%   0.29%]
 [  3.07%  12.26%  97.59%]]
[2024-08-05 11:00:33,735] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:00:33,735] {result_logger:77} INFO - actual:
[2024-08-05 11:00:33,735] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:00:33,735] {result_logger:79} INFO - predicted:
[2024-08-05 11:00:33,735] {result_logger:80} INFO - 
[[92.96%  1.88%  5.16%]
 [24.66% 72.12%  3.22%]
 [ 4.87%  3.00% 92.13%]]
[2024-08-05 11:00:33,735] {run_experiment:113} INFO - [epoch  14] execution time: 107.49s	 avg f1-score: 0.8901

[2024-08-05 11:00:33,736] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:00:33,761] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:00:48,117] {train_model:82} INFO - Train Epoch: 15 [36352/366120 (10%)]	lr:2.14e-04	Loss: 0.055064
[2024-08-05 11:00:57,155] {train_model:82} INFO - Train Epoch: 15 [72960/366120 (20%)]	lr:2.14e-04	Loss: 0.088417
[2024-08-05 11:01:06,194] {train_model:82} INFO - Train Epoch: 15 [109568/366120 (30%)]	lr:2.14e-04	Loss: 0.046934
[2024-08-05 11:01:15,315] {train_model:82} INFO - Train Epoch: 15 [146176/366120 (40%)]	lr:2.14e-04	Loss: 0.122961
[2024-08-05 11:01:24,494] {train_model:82} INFO - Train Epoch: 15 [182784/366120 (50%)]	lr:2.14e-04	Loss: 0.077229
[2024-08-05 11:01:33,695] {train_model:82} INFO - Train Epoch: 15 [219392/366120 (60%)]	lr:2.14e-04	Loss: 0.162257
[2024-08-05 11:01:42,904] {train_model:82} INFO - Train Epoch: 15 [256000/366120 (70%)]	lr:2.14e-04	Loss: 0.085278
[2024-08-05 11:01:52,128] {train_model:82} INFO - Train Epoch: 15 [292608/366120 (80%)]	lr:2.14e-04	Loss: 0.123405
[2024-08-05 11:02:01,367] {train_model:82} INFO - Train Epoch: 15 [329216/366120 (90%)]	lr:2.14e-04	Loss: 0.146204
[2024-08-05 11:02:10,593] {train_model:82} INFO - Train Epoch: 15 [365824/366120 (100%)]	lr:2.14e-04	Loss: 0.080348
[2024-08-05 11:02:15,697] {run_experiment:79} INFO - 
[2024-08-05 11:02:15,697] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:02:16,361] {result_logger:103} INFO - precision on Wake: 0.983
[2024-08-05 11:02:16,771] {result_logger:104} INFO - recall on Wake: 0.973
[2024-08-05 11:02:17,181] {result_logger:107} INFO - F1-score on Wake: 0.978
[2024-08-05 11:02:17,182] {result_logger:108} INFO - 
[2024-08-05 11:02:17,762] {result_logger:103} INFO - precision on REM: 0.803
[2024-08-05 11:02:18,115] {result_logger:104} INFO - recall on REM: 0.972
[2024-08-05 11:02:18,468] {result_logger:107} INFO - F1-score on REM: 0.880
[2024-08-05 11:02:18,468] {result_logger:108} INFO - 
[2024-08-05 11:02:19,100] {result_logger:103} INFO - precision on Non REM: 0.967
[2024-08-05 11:02:19,501] {result_logger:104} INFO - recall on Non REM: 0.954
[2024-08-05 11:02:19,902] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2024-08-05 11:02:19,902] {result_logger:108} INFO - 
[2024-08-05 11:02:19,991] {result_logger:111} INFO - average precision on sleep stages: 0.918
[2024-08-05 11:02:20,080] {result_logger:113} INFO - average recall on sleep stages: 0.966
[2024-08-05 11:02:20,169] {result_logger:115} INFO - average F1-score on sleep stages: 0.939
[2024-08-05 11:02:20,171] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:02:20,255] {result_logger:103} INFO - precision on Wake: 0.977
[2024-08-05 11:02:20,305] {result_logger:104} INFO - recall on Wake: 0.975
[2024-08-05 11:02:20,354] {result_logger:107} INFO - F1-score on Wake: 0.976
[2024-08-05 11:02:20,355] {result_logger:108} INFO - 
[2024-08-05 11:02:20,434] {result_logger:103} INFO - precision on REM: 0.758
[2024-08-05 11:02:20,482] {result_logger:104} INFO - recall on REM: 0.965
[2024-08-05 11:02:20,530] {result_logger:107} INFO - F1-score on REM: 0.849
[2024-08-05 11:02:20,530] {result_logger:108} INFO - 
[2024-08-05 11:02:20,611] {result_logger:103} INFO - precision on Non REM: 0.971
[2024-08-05 11:02:20,660] {result_logger:104} INFO - recall on Non REM: 0.942
[2024-08-05 11:02:20,711] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2024-08-05 11:02:20,711] {result_logger:108} INFO - 
[2024-08-05 11:02:20,721] {result_logger:111} INFO - average precision on sleep stages: 0.902
[2024-08-05 11:02:20,731] {result_logger:113} INFO - average recall on sleep stages: 0.960
[2024-08-05 11:02:20,742] {result_logger:115} INFO - average F1-score on sleep stages: 0.927
[2024-08-05 11:02:20,742] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:02:20,803] {result_logger:134} INFO - 
[[198304   1092   4351]
 [   144  18083    379]
 [  3249   3337 137181]]
[2024-08-05 11:02:20,864] {result_logger:141} INFO - 
[[ 97.33%   0.54%   2.14%]
 [  0.77%  97.19%   2.04%]
 [  2.26%   2.32%  95.42%]]
[2024-08-05 11:02:20,925] {result_logger:145} INFO - 
[[ 98.32%   4.85%   3.07%]
 [  0.07%  80.33%   0.27%]
 [  1.61%  14.82%  96.67%]]
[2024-08-05 11:02:20,925] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:02:20,932] {result_logger:134} INFO - 
[[27675   169   538]
 [   52  2455    38]
 [  592   614 19497]]
[2024-08-05 11:02:21,027] {result_logger:141} INFO - 
[[ 97.51%   0.60%   1.90%]
 [  2.04%  96.46%   1.49%]
 [  2.86%   2.97%  94.17%]]
[2024-08-05 11:02:21,115] {result_logger:145} INFO - 
[[ 97.73%   5.22%   2.68%]
 [  0.18%  75.82%   0.19%]
 [  2.09%  18.96%  97.13%]]
[2024-08-05 11:02:21,362] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:02:21,363] {result_logger:77} INFO - actual:
[2024-08-05 11:02:21,363] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:02:21,363] {result_logger:79} INFO - predicted:
[2024-08-05 11:02:21,363] {result_logger:80} INFO - 
[[94.96%  0.40%  4.64%]
 [18.10% 76.00%  5.90%]
 [ 4.19%  3.30% 92.50%]]
[2024-08-05 11:02:21,419] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_E_weighted/model_8conv_2fc-best.pth
[2024-08-05 11:02:21,419] {run_experiment:113} INFO - [epoch  15] execution time: 107.68s	 avg f1-score: 0.9272

[2024-08-05 11:02:21,419] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:02:21,445] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:02:35,987] {train_model:82} INFO - Train Epoch: 16 [36352/366120 (10%)]	lr:2.01e-04	Loss: 0.044966
[2024-08-05 11:02:45,066] {train_model:82} INFO - Train Epoch: 16 [72960/366120 (20%)]	lr:2.01e-04	Loss: 0.041484
[2024-08-05 11:02:54,130] {train_model:82} INFO - Train Epoch: 16 [109568/366120 (30%)]	lr:2.01e-04	Loss: 0.054499
[2024-08-05 11:03:03,317] {train_model:82} INFO - Train Epoch: 16 [146176/366120 (40%)]	lr:2.01e-04	Loss: 0.111531
[2024-08-05 11:03:12,476] {train_model:82} INFO - Train Epoch: 16 [182784/366120 (50%)]	lr:2.01e-04	Loss: 0.068132
[2024-08-05 11:03:21,565] {train_model:82} INFO - Train Epoch: 16 [219392/366120 (60%)]	lr:2.01e-04	Loss: 0.108572
[2024-08-05 11:03:30,679] {train_model:82} INFO - Train Epoch: 16 [256000/366120 (70%)]	lr:2.01e-04	Loss: 0.082738
[2024-08-05 11:03:39,875] {train_model:82} INFO - Train Epoch: 16 [292608/366120 (80%)]	lr:2.01e-04	Loss: 0.047547
[2024-08-05 11:03:49,062] {train_model:82} INFO - Train Epoch: 16 [329216/366120 (90%)]	lr:2.01e-04	Loss: 0.081466
[2024-08-05 11:03:58,222] {train_model:82} INFO - Train Epoch: 16 [365824/366120 (100%)]	lr:2.01e-04	Loss: 0.040959
[2024-08-05 11:04:03,379] {run_experiment:79} INFO - 
[2024-08-05 11:04:03,379] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:04:04,017] {result_logger:103} INFO - precision on Wake: 0.984
[2024-08-05 11:04:04,423] {result_logger:104} INFO - recall on Wake: 0.974
[2024-08-05 11:04:04,829] {result_logger:107} INFO - F1-score on Wake: 0.979
[2024-08-05 11:04:04,829] {result_logger:108} INFO - 
[2024-08-05 11:04:05,394] {result_logger:103} INFO - precision on REM: 0.818
[2024-08-05 11:04:05,752] {result_logger:104} INFO - recall on REM: 0.974
[2024-08-05 11:04:06,105] {result_logger:107} INFO - F1-score on REM: 0.889
[2024-08-05 11:04:06,105] {result_logger:108} INFO - 
[2024-08-05 11:04:06,734] {result_logger:103} INFO - precision on Non REM: 0.967
[2024-08-05 11:04:07,130] {result_logger:104} INFO - recall on Non REM: 0.956
[2024-08-05 11:04:07,527] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2024-08-05 11:04:07,527] {result_logger:108} INFO - 
[2024-08-05 11:04:07,616] {result_logger:111} INFO - average precision on sleep stages: 0.923
[2024-08-05 11:04:07,705] {result_logger:113} INFO - average recall on sleep stages: 0.968
[2024-08-05 11:04:07,794] {result_logger:115} INFO - average F1-score on sleep stages: 0.943
[2024-08-05 11:04:07,795] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:04:07,877] {result_logger:103} INFO - precision on Wake: 0.973
[2024-08-05 11:04:07,927] {result_logger:104} INFO - recall on Wake: 0.974
[2024-08-05 11:04:07,977] {result_logger:107} INFO - F1-score on Wake: 0.974
[2024-08-05 11:04:07,977] {result_logger:108} INFO - 
[2024-08-05 11:04:08,055] {result_logger:103} INFO - precision on REM: 0.775
[2024-08-05 11:04:08,106] {result_logger:104} INFO - recall on REM: 0.970
[2024-08-05 11:04:08,154] {result_logger:107} INFO - F1-score on REM: 0.861
[2024-08-05 11:04:08,154] {result_logger:108} INFO - 
[2024-08-05 11:04:08,236] {result_logger:103} INFO - precision on Non REM: 0.975
[2024-08-05 11:04:08,286] {result_logger:104} INFO - recall on Non REM: 0.943
[2024-08-05 11:04:08,336] {result_logger:107} INFO - F1-score on Non REM: 0.959
[2024-08-05 11:04:08,336] {result_logger:108} INFO - 
[2024-08-05 11:04:08,346] {result_logger:111} INFO - average precision on sleep stages: 0.908
[2024-08-05 11:04:08,357] {result_logger:113} INFO - average recall on sleep stages: 0.962
[2024-08-05 11:04:08,368] {result_logger:115} INFO - average F1-score on sleep stages: 0.931
[2024-08-05 11:04:08,368] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:04:08,429] {result_logger:134} INFO - 
[[198521    948   4278]
 [   117  18116    373]
 [  3199   3082 137486]]
[2024-08-05 11:04:08,490] {result_logger:141} INFO - 
[[ 97.44%   0.47%   2.10%]
 [  0.63%  97.37%   2.00%]
 [  2.23%   2.14%  95.63%]]
[2024-08-05 11:04:08,550] {result_logger:145} INFO - 
[[ 98.36%   4.28%   3.01%]
 [  0.06%  81.80%   0.26%]
 [  1.58%  13.92%  96.73%]]
[2024-08-05 11:04:08,550] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:04:08,557] {result_logger:134} INFO - 
[[27654   304   424]
 [    5  2468    72]
 [  767   414 19522]]
[2024-08-05 11:04:08,650] {result_logger:141} INFO - 
[[ 97.43%   1.07%   1.49%]
 [  0.20%  96.97%   2.83%]
 [  3.70%   2.00%  94.30%]]
[2024-08-05 11:04:08,739] {result_logger:145} INFO - 
[[ 97.28%   9.54%   2.12%]
 [  0.02%  77.46%   0.36%]
 [  2.70%  12.99%  97.52%]]
[2024-08-05 11:04:08,990] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:04:08,990] {result_logger:77} INFO - actual:
[2024-08-05 11:04:08,990] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:04:08,990] {result_logger:79} INFO - predicted:
[2024-08-05 11:04:08,990] {result_logger:80} INFO - 
[[94.48%  0.51%  5.00%]
 [17.58% 77.12%  5.30%]
 [ 5.04%  2.91% 92.05%]]
[2024-08-05 11:04:09,046] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_E_weighted/model_8conv_2fc-best.pth
[2024-08-05 11:04:09,046] {run_experiment:113} INFO - [epoch  16] execution time: 107.63s	 avg f1-score: 0.9312

[2024-08-05 11:04:09,046] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:04:09,072] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:04:23,537] {train_model:82} INFO - Train Epoch: 17 [36352/366120 (10%)]	lr:1.90e-04	Loss: 0.121575
[2024-08-05 11:04:32,564] {train_model:82} INFO - Train Epoch: 17 [72960/366120 (20%)]	lr:1.90e-04	Loss: 0.052654
[2024-08-05 11:04:41,668] {train_model:82} INFO - Train Epoch: 17 [109568/366120 (30%)]	lr:1.90e-04	Loss: 0.108919
[2024-08-05 11:04:50,760] {train_model:82} INFO - Train Epoch: 17 [146176/366120 (40%)]	lr:1.90e-04	Loss: 0.042524
[2024-08-05 11:04:59,868] {train_model:82} INFO - Train Epoch: 17 [182784/366120 (50%)]	lr:1.90e-04	Loss: 0.042831
[2024-08-05 11:05:09,025] {train_model:82} INFO - Train Epoch: 17 [219392/366120 (60%)]	lr:1.90e-04	Loss: 0.053573
[2024-08-05 11:05:18,202] {train_model:82} INFO - Train Epoch: 17 [256000/366120 (70%)]	lr:1.90e-04	Loss: 0.114557
[2024-08-05 11:05:27,438] {train_model:82} INFO - Train Epoch: 17 [292608/366120 (80%)]	lr:1.90e-04	Loss: 0.063399
[2024-08-05 11:05:36,682] {train_model:82} INFO - Train Epoch: 17 [329216/366120 (90%)]	lr:1.90e-04	Loss: 0.125222
[2024-08-05 11:05:45,846] {train_model:82} INFO - Train Epoch: 17 [365824/366120 (100%)]	lr:1.90e-04	Loss: 0.098510
[2024-08-05 11:05:51,285] {run_experiment:79} INFO - 
[2024-08-05 11:05:51,286] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:05:51,941] {result_logger:103} INFO - precision on Wake: 0.984
[2024-08-05 11:05:52,349] {result_logger:104} INFO - recall on Wake: 0.975
[2024-08-05 11:05:52,757] {result_logger:107} INFO - F1-score on Wake: 0.980
[2024-08-05 11:05:52,757] {result_logger:108} INFO - 
[2024-08-05 11:05:53,343] {result_logger:103} INFO - precision on REM: 0.827
[2024-08-05 11:05:53,700] {result_logger:104} INFO - recall on REM: 0.975
[2024-08-05 11:05:54,052] {result_logger:107} INFO - F1-score on REM: 0.895
[2024-08-05 11:05:54,052] {result_logger:108} INFO - 
[2024-08-05 11:05:54,688] {result_logger:103} INFO - precision on Non REM: 0.968
[2024-08-05 11:05:55,088] {result_logger:104} INFO - recall on Non REM: 0.958
[2024-08-05 11:05:55,489] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2024-08-05 11:05:55,489] {result_logger:108} INFO - 
[2024-08-05 11:05:55,581] {result_logger:111} INFO - average precision on sleep stages: 0.927
[2024-08-05 11:05:55,675] {result_logger:113} INFO - average recall on sleep stages: 0.969
[2024-08-05 11:05:55,768] {result_logger:115} INFO - average F1-score on sleep stages: 0.946
[2024-08-05 11:05:55,769] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:05:55,852] {result_logger:103} INFO - precision on Wake: 0.974
[2024-08-05 11:05:55,901] {result_logger:104} INFO - recall on Wake: 0.984
[2024-08-05 11:05:55,952] {result_logger:107} INFO - F1-score on Wake: 0.979
[2024-08-05 11:05:55,952] {result_logger:108} INFO - 
[2024-08-05 11:05:56,032] {result_logger:103} INFO - precision on REM: 0.792
[2024-08-05 11:05:56,080] {result_logger:104} INFO - recall on REM: 0.976
[2024-08-05 11:05:56,128] {result_logger:107} INFO - F1-score on REM: 0.875
[2024-08-05 11:05:56,128] {result_logger:108} INFO - 
[2024-08-05 11:05:56,211] {result_logger:103} INFO - precision on Non REM: 0.978
[2024-08-05 11:05:56,262] {result_logger:104} INFO - recall on Non REM: 0.937
[2024-08-05 11:05:56,312] {result_logger:107} INFO - F1-score on Non REM: 0.957
[2024-08-05 11:05:56,312] {result_logger:108} INFO - 
[2024-08-05 11:05:56,323] {result_logger:111} INFO - average precision on sleep stages: 0.915
[2024-08-05 11:05:56,333] {result_logger:113} INFO - average recall on sleep stages: 0.966
[2024-08-05 11:05:56,344] {result_logger:115} INFO - average F1-score on sleep stages: 0.937
[2024-08-05 11:05:56,344] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:05:56,408] {result_logger:134} INFO - 
[[198750    843   4154]
 [   106  18136    364]
 [  3075   2939 137753]]
[2024-08-05 11:05:56,471] {result_logger:141} INFO - 
[[ 97.55%   0.41%   2.04%]
 [  0.57%  97.47%   1.96%]
 [  2.14%   2.04%  95.82%]]
[2024-08-05 11:05:56,533] {result_logger:145} INFO - 
[[ 98.42%   3.85%   2.92%]
 [  0.05%  82.74%   0.26%]
 [  1.52%  13.41%  96.82%]]
[2024-08-05 11:05:56,534] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:05:56,541] {result_logger:134} INFO - 
[[27919    73   390]
 [   15  2485    45]
 [  724   580 19399]]
[2024-08-05 11:05:56,723] {result_logger:141} INFO - 
[[ 98.37%   0.26%   1.37%]
 [  0.59%  97.64%   1.77%]
 [  3.50%   2.80%  93.70%]]
[2024-08-05 11:05:56,814] {result_logger:145} INFO - 
[[ 97.42%   2.33%   1.97%]
 [  0.05%  79.19%   0.23%]
 [  2.53%  18.48%  97.81%]]
[2024-08-05 11:05:57,072] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:05:57,072] {result_logger:77} INFO - actual:
[2024-08-05 11:05:57,072] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:05:57,072] {result_logger:79} INFO - predicted:
[2024-08-05 11:05:57,072] {result_logger:80} INFO - 
[[95.25%  0.13%  4.62%]
 [16.35% 78.55%  5.10%]
 [ 4.28%  3.21% 92.51%]]
[2024-08-05 11:05:57,130] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_E_weighted/model_8conv_2fc-best.pth
[2024-08-05 11:05:57,130] {run_experiment:113} INFO - [epoch  17] execution time: 108.08s	 avg f1-score: 0.9369

[2024-08-05 11:05:57,130] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:05:57,157] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:06:11,583] {train_model:82} INFO - Train Epoch: 18 [36352/366120 (10%)]	lr:1.79e-04	Loss: 0.061234
[2024-08-05 11:06:20,644] {train_model:82} INFO - Train Epoch: 18 [72960/366120 (20%)]	lr:1.79e-04	Loss: 0.151893
[2024-08-05 11:06:29,683] {train_model:82} INFO - Train Epoch: 18 [109568/366120 (30%)]	lr:1.79e-04	Loss: 0.033268
[2024-08-05 11:06:38,785] {train_model:82} INFO - Train Epoch: 18 [146176/366120 (40%)]	lr:1.79e-04	Loss: 0.075507
[2024-08-05 11:06:47,957] {train_model:82} INFO - Train Epoch: 18 [182784/366120 (50%)]	lr:1.79e-04	Loss: 0.112954
[2024-08-05 11:06:57,152] {train_model:82} INFO - Train Epoch: 18 [219392/366120 (60%)]	lr:1.79e-04	Loss: 0.065255
[2024-08-05 11:07:06,382] {train_model:82} INFO - Train Epoch: 18 [256000/366120 (70%)]	lr:1.79e-04	Loss: 0.059252
[2024-08-05 11:07:15,600] {train_model:82} INFO - Train Epoch: 18 [292608/366120 (80%)]	lr:1.79e-04	Loss: 0.100499
[2024-08-05 11:07:24,842] {train_model:82} INFO - Train Epoch: 18 [329216/366120 (90%)]	lr:1.79e-04	Loss: 0.156051
[2024-08-05 11:07:34,083] {train_model:82} INFO - Train Epoch: 18 [365824/366120 (100%)]	lr:1.79e-04	Loss: 0.088243
[2024-08-05 11:07:39,557] {run_experiment:79} INFO - 
[2024-08-05 11:07:39,557] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:07:40,208] {result_logger:103} INFO - precision on Wake: 0.984
[2024-08-05 11:07:40,617] {result_logger:104} INFO - recall on Wake: 0.976
[2024-08-05 11:07:41,026] {result_logger:107} INFO - F1-score on Wake: 0.980
[2024-08-05 11:07:41,026] {result_logger:108} INFO - 
[2024-08-05 11:07:41,605] {result_logger:103} INFO - precision on REM: 0.837
[2024-08-05 11:07:41,961] {result_logger:104} INFO - recall on REM: 0.976
[2024-08-05 11:07:42,314] {result_logger:107} INFO - F1-score on REM: 0.901
[2024-08-05 11:07:42,314] {result_logger:108} INFO - 
[2024-08-05 11:07:42,941] {result_logger:103} INFO - precision on Non REM: 0.969
[2024-08-05 11:07:43,337] {result_logger:104} INFO - recall on Non REM: 0.959
[2024-08-05 11:07:43,734] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2024-08-05 11:07:43,734] {result_logger:108} INFO - 
[2024-08-05 11:07:43,823] {result_logger:111} INFO - average precision on sleep stages: 0.930
[2024-08-05 11:07:43,913] {result_logger:113} INFO - average recall on sleep stages: 0.971
[2024-08-05 11:07:44,003] {result_logger:115} INFO - average F1-score on sleep stages: 0.949
[2024-08-05 11:07:44,004] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:07:44,083] {result_logger:103} INFO - precision on Wake: 0.978
[2024-08-05 11:07:44,132] {result_logger:104} INFO - recall on Wake: 0.976
[2024-08-05 11:07:44,182] {result_logger:107} INFO - F1-score on Wake: 0.977
[2024-08-05 11:07:44,182] {result_logger:108} INFO - 
[2024-08-05 11:07:44,267] {result_logger:103} INFO - precision on REM: 0.759
[2024-08-05 11:07:44,315] {result_logger:104} INFO - recall on REM: 0.982
[2024-08-05 11:07:44,363] {result_logger:107} INFO - F1-score on REM: 0.856
[2024-08-05 11:07:44,363] {result_logger:108} INFO - 
[2024-08-05 11:07:44,443] {result_logger:103} INFO - precision on Non REM: 0.971
[2024-08-05 11:07:44,493] {result_logger:104} INFO - recall on Non REM: 0.939
[2024-08-05 11:07:44,543] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2024-08-05 11:07:44,544] {result_logger:108} INFO - 
[2024-08-05 11:07:44,554] {result_logger:111} INFO - average precision on sleep stages: 0.903
[2024-08-05 11:07:44,564] {result_logger:113} INFO - average recall on sleep stages: 0.966
[2024-08-05 11:07:44,575] {result_logger:115} INFO - average F1-score on sleep stages: 0.929
[2024-08-05 11:07:44,575] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:07:44,637] {result_logger:134} INFO - 
[[198920    726   4101]
 [   112  18163    331]
 [  3042   2815 137910]]
[2024-08-05 11:07:44,698] {result_logger:141} INFO - 
[[ 97.63%   0.36%   2.01%]
 [  0.60%  97.62%   1.78%]
 [  2.12%   1.96%  95.93%]]
[2024-08-05 11:07:44,759] {result_logger:145} INFO - 
[[ 98.44%   3.35%   2.88%]
 [  0.06%  83.69%   0.23%]
 [  1.51%  12.97%  96.89%]]
[2024-08-05 11:07:44,759] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:07:44,767] {result_logger:134} INFO - 
[[27703   133   546]
 [   10  2500    35]
 [  611   662 19430]]
[2024-08-05 11:07:44,774] {result_logger:141} INFO - 
[[ 97.61%   0.47%   1.92%]
 [  0.39%  98.23%   1.38%]
 [  2.95%   3.20%  93.85%]]
[2024-08-05 11:07:44,781] {result_logger:145} INFO - 
[[ 97.81%   4.04%   2.73%]
 [  0.04%  75.87%   0.17%]
 [  2.16%  20.09%  97.10%]]
[2024-08-05 11:07:44,871] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:07:44,871] {result_logger:77} INFO - actual:
[2024-08-05 11:07:44,872] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:07:44,872] {result_logger:79} INFO - predicted:
[2024-08-05 11:07:44,872] {result_logger:80} INFO - 
[[95.06%  0.22%  4.71%]
 [15.42% 78.24%  6.34%]
 [ 4.45%  3.27% 92.28%]]
[2024-08-05 11:07:44,872] {run_experiment:113} INFO - [epoch  18] execution time: 107.74s	 avg f1-score: 0.9292

[2024-08-05 11:07:44,872] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:07:44,897] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:07:59,253] {train_model:82} INFO - Train Epoch: 19 [36352/366120 (10%)]	lr:1.68e-04	Loss: 0.064778
[2024-08-05 11:08:08,348] {train_model:82} INFO - Train Epoch: 19 [72960/366120 (20%)]	lr:1.68e-04	Loss: 0.057785
[2024-08-05 11:08:17,462] {train_model:82} INFO - Train Epoch: 19 [109568/366120 (30%)]	lr:1.68e-04	Loss: 0.053323
[2024-08-05 11:08:26,614] {train_model:82} INFO - Train Epoch: 19 [146176/366120 (40%)]	lr:1.68e-04	Loss: 0.047308
[2024-08-05 11:08:35,820] {train_model:82} INFO - Train Epoch: 19 [182784/366120 (50%)]	lr:1.68e-04	Loss: 0.052563
[2024-08-05 11:08:44,911] {train_model:82} INFO - Train Epoch: 19 [219392/366120 (60%)]	lr:1.68e-04	Loss: 0.071504
[2024-08-05 11:08:54,030] {train_model:82} INFO - Train Epoch: 19 [256000/366120 (70%)]	lr:1.68e-04	Loss: 0.047508
[2024-08-05 11:09:03,233] {train_model:82} INFO - Train Epoch: 19 [292608/366120 (80%)]	lr:1.68e-04	Loss: 0.047680
[2024-08-05 11:09:12,470] {train_model:82} INFO - Train Epoch: 19 [329216/366120 (90%)]	lr:1.68e-04	Loss: 0.057803
[2024-08-05 11:09:21,650] {train_model:82} INFO - Train Epoch: 19 [365824/366120 (100%)]	lr:1.68e-04	Loss: 0.060758
[2024-08-05 11:09:27,006] {run_experiment:79} INFO - 
[2024-08-05 11:09:27,006] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:09:27,656] {result_logger:103} INFO - precision on Wake: 0.985
[2024-08-05 11:09:28,063] {result_logger:104} INFO - recall on Wake: 0.977
[2024-08-05 11:09:28,471] {result_logger:107} INFO - F1-score on Wake: 0.981
[2024-08-05 11:09:28,472] {result_logger:108} INFO - 
[2024-08-05 11:09:29,062] {result_logger:103} INFO - precision on REM: 0.845
[2024-08-05 11:09:29,414] {result_logger:104} INFO - recall on REM: 0.980
[2024-08-05 11:09:29,766] {result_logger:107} INFO - F1-score on REM: 0.907
[2024-08-05 11:09:29,766] {result_logger:108} INFO - 
[2024-08-05 11:09:30,395] {result_logger:103} INFO - precision on Non REM: 0.970
[2024-08-05 11:09:30,795] {result_logger:104} INFO - recall on Non REM: 0.961
[2024-08-05 11:09:31,193] {result_logger:107} INFO - F1-score on Non REM: 0.966
[2024-08-05 11:09:31,193] {result_logger:108} INFO - 
[2024-08-05 11:09:31,281] {result_logger:111} INFO - average precision on sleep stages: 0.933
[2024-08-05 11:09:31,368] {result_logger:113} INFO - average recall on sleep stages: 0.973
[2024-08-05 11:09:31,455] {result_logger:115} INFO - average F1-score on sleep stages: 0.951
[2024-08-05 11:09:31,456] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:09:31,538] {result_logger:103} INFO - precision on Wake: 0.971
[2024-08-05 11:09:31,588] {result_logger:104} INFO - recall on Wake: 0.981
[2024-08-05 11:09:31,636] {result_logger:107} INFO - F1-score on Wake: 0.976
[2024-08-05 11:09:31,636] {result_logger:108} INFO - 
[2024-08-05 11:09:31,717] {result_logger:103} INFO - precision on REM: 0.797
[2024-08-05 11:09:31,766] {result_logger:104} INFO - recall on REM: 0.975
[2024-08-05 11:09:31,818] {result_logger:107} INFO - F1-score on REM: 0.877
[2024-08-05 11:09:31,818] {result_logger:108} INFO - 
[2024-08-05 11:09:31,899] {result_logger:103} INFO - precision on Non REM: 0.978
[2024-08-05 11:09:31,950] {result_logger:104} INFO - recall on Non REM: 0.938
[2024-08-05 11:09:32,000] {result_logger:107} INFO - F1-score on Non REM: 0.958
[2024-08-05 11:09:32,001] {result_logger:108} INFO - 
[2024-08-05 11:09:32,011] {result_logger:111} INFO - average precision on sleep stages: 0.915
[2024-08-05 11:09:32,021] {result_logger:113} INFO - average recall on sleep stages: 0.965
[2024-08-05 11:09:32,031] {result_logger:115} INFO - average F1-score on sleep stages: 0.937
[2024-08-05 11:09:32,032] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:09:32,093] {result_logger:134} INFO - 
[[199152    692   3903]
 [    67  18225    314]
 [  2927   2662 138178]]
[2024-08-05 11:09:32,152] {result_logger:141} INFO - 
[[ 97.74%   0.34%   1.92%]
 [  0.36%  97.95%   1.69%]
 [  2.04%   1.85%  96.11%]]
[2024-08-05 11:09:32,211] {result_logger:145} INFO - 
[[ 98.52%   3.21%   2.74%]
 [  0.03%  84.46%   0.22%]
 [  1.45%  12.34%  97.04%]]
[2024-08-05 11:09:32,211] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:09:32,219] {result_logger:134} INFO - 
[[27833   168   381]
 [   15  2482    48]
 [  823   463 19417]]
[2024-08-05 11:09:32,314] {result_logger:141} INFO - 
[[ 98.07%   0.59%   1.34%]
 [  0.59%  97.52%   1.89%]
 [  3.98%   2.24%  93.79%]]
[2024-08-05 11:09:32,402] {result_logger:145} INFO - 
[[ 97.08%   5.40%   1.92%]
 [  0.05%  79.73%   0.24%]
 [  2.87%  14.87%  97.84%]]
[2024-08-05 11:09:32,660] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:09:32,660] {result_logger:77} INFO - actual:
[2024-08-05 11:09:32,660] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:09:32,660] {result_logger:79} INFO - predicted:
[2024-08-05 11:09:32,660] {result_logger:80} INFO - 
[[94.50%  0.37%  5.13%]
 [18.02% 77.67%  4.30%]
 [ 5.12%  2.97% 91.91%]]
[2024-08-05 11:09:32,716] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_E_weighted/model_8conv_2fc-best.pth
[2024-08-05 11:09:32,716] {run_experiment:113} INFO - [epoch  19] execution time: 107.84s	 avg f1-score: 0.9369

[2024-08-05 11:09:32,716] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:09:32,742] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:09:47,364] {train_model:82} INFO - Train Epoch: 20 [36352/366120 (10%)]	lr:1.58e-04	Loss: 0.085269
[2024-08-05 11:09:56,399] {train_model:82} INFO - Train Epoch: 20 [72960/366120 (20%)]	lr:1.58e-04	Loss: 0.100701
[2024-08-05 11:10:05,482] {train_model:82} INFO - Train Epoch: 20 [109568/366120 (30%)]	lr:1.58e-04	Loss: 0.095863
[2024-08-05 11:10:14,600] {train_model:82} INFO - Train Epoch: 20 [146176/366120 (40%)]	lr:1.58e-04	Loss: 0.094754
[2024-08-05 11:10:23,702] {train_model:82} INFO - Train Epoch: 20 [182784/366120 (50%)]	lr:1.58e-04	Loss: 0.101342
[2024-08-05 11:10:32,825] {train_model:82} INFO - Train Epoch: 20 [219392/366120 (60%)]	lr:1.58e-04	Loss: 0.103084
[2024-08-05 11:10:41,970] {train_model:82} INFO - Train Epoch: 20 [256000/366120 (70%)]	lr:1.58e-04	Loss: 0.044002
[2024-08-05 11:10:51,173] {train_model:82} INFO - Train Epoch: 20 [292608/366120 (80%)]	lr:1.58e-04	Loss: 0.056984
[2024-08-05 11:11:00,424] {train_model:82} INFO - Train Epoch: 20 [329216/366120 (90%)]	lr:1.58e-04	Loss: 0.084921
[2024-08-05 11:11:09,599] {train_model:82} INFO - Train Epoch: 20 [365824/366120 (100%)]	lr:1.58e-04	Loss: 0.041974
[2024-08-05 11:11:14,768] {run_experiment:79} INFO - 
[2024-08-05 11:11:14,769] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:11:15,436] {result_logger:103} INFO - precision on Wake: 0.985
[2024-08-05 11:11:15,849] {result_logger:104} INFO - recall on Wake: 0.978
[2024-08-05 11:11:16,256] {result_logger:107} INFO - F1-score on Wake: 0.982
[2024-08-05 11:11:16,257] {result_logger:108} INFO - 
[2024-08-05 11:11:16,824] {result_logger:103} INFO - precision on REM: 0.849
[2024-08-05 11:11:17,177] {result_logger:104} INFO - recall on REM: 0.981
[2024-08-05 11:11:17,529] {result_logger:107} INFO - F1-score on REM: 0.910
[2024-08-05 11:11:17,530] {result_logger:108} INFO - 
[2024-08-05 11:11:18,147] {result_logger:103} INFO - precision on Non REM: 0.971
[2024-08-05 11:11:18,548] {result_logger:104} INFO - recall on Non REM: 0.962
[2024-08-05 11:11:18,948] {result_logger:107} INFO - F1-score on Non REM: 0.967
[2024-08-05 11:11:18,948] {result_logger:108} INFO - 
[2024-08-05 11:11:19,040] {result_logger:111} INFO - average precision on sleep stages: 0.935
[2024-08-05 11:11:19,131] {result_logger:113} INFO - average recall on sleep stages: 0.974
[2024-08-05 11:11:19,222] {result_logger:115} INFO - average F1-score on sleep stages: 0.953
[2024-08-05 11:11:19,224] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:11:19,305] {result_logger:103} INFO - precision on Wake: 0.983
[2024-08-05 11:11:19,355] {result_logger:104} INFO - recall on Wake: 0.954
[2024-08-05 11:11:19,405] {result_logger:107} INFO - F1-score on Wake: 0.968
[2024-08-05 11:11:19,405] {result_logger:108} INFO - 
[2024-08-05 11:11:19,483] {result_logger:103} INFO - precision on REM: 0.753
[2024-08-05 11:11:19,531] {result_logger:104} INFO - recall on REM: 0.967
[2024-08-05 11:11:19,579] {result_logger:107} INFO - F1-score on REM: 0.847
[2024-08-05 11:11:19,579] {result_logger:108} INFO - 
[2024-08-05 11:11:19,658] {result_logger:103} INFO - precision on Non REM: 0.951
[2024-08-05 11:11:19,708] {result_logger:104} INFO - recall on Non REM: 0.957
[2024-08-05 11:11:19,757] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2024-08-05 11:11:19,757] {result_logger:108} INFO - 
[2024-08-05 11:11:19,770] {result_logger:111} INFO - average precision on sleep stages: 0.896
[2024-08-05 11:11:19,780] {result_logger:113} INFO - average recall on sleep stages: 0.959
[2024-08-05 11:11:19,790] {result_logger:115} INFO - average F1-score on sleep stages: 0.923
[2024-08-05 11:11:19,791] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:11:19,854] {result_logger:134} INFO - 
[[199278    649   3820]
 [    81  18245    280]
 [  2853   2601 138313]]
[2024-08-05 11:11:19,916] {result_logger:141} INFO - 
[[ 97.81%   0.32%   1.87%]
 [  0.44%  98.06%   1.50%]
 [  1.98%   1.81%  96.21%]]
[2024-08-05 11:11:19,978] {result_logger:145} INFO - 
[[ 98.55%   3.02%   2.68%]
 [  0.04%  84.88%   0.20%]
 [  1.41%  12.10%  97.12%]]
[2024-08-05 11:11:19,978] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:11:19,985] {result_logger:134} INFO - 
[[27068   376   938]
 [    7  2460    78]
 [  456   429 19818]]
[2024-08-05 11:11:19,992] {result_logger:141} INFO - 
[[ 95.37%   1.32%   3.30%]
 [  0.28%  96.66%   3.06%]
 [  2.20%   2.07%  95.73%]]
[2024-08-05 11:11:19,999] {result_logger:145} INFO - 
[[ 98.32%  11.52%   4.50%]
 [  0.03%  75.34%   0.37%]
 [  1.66%  13.14%  95.12%]]
[2024-08-05 11:11:20,087] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:11:20,087] {result_logger:77} INFO - actual:
[2024-08-05 11:11:20,087] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:11:20,087] {result_logger:79} INFO - predicted:
[2024-08-05 11:11:20,087] {result_logger:80} INFO - 
[[94.17%  0.85%  4.98%]
 [19.66% 74.85%  5.48%]
 [ 4.63%  2.82% 92.56%]]
[2024-08-05 11:11:20,087] {run_experiment:113} INFO - [epoch  20] execution time: 107.37s	 avg f1-score: 0.9231

[2024-08-05 11:11:20,087] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:11:20,113] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:11:34,463] {train_model:82} INFO - Train Epoch: 21 [36352/366120 (10%)]	lr:1.49e-04	Loss: 0.136158
[2024-08-05 11:11:43,486] {train_model:82} INFO - Train Epoch: 21 [72960/366120 (20%)]	lr:1.49e-04	Loss: 0.034689
[2024-08-05 11:11:52,565] {train_model:82} INFO - Train Epoch: 21 [109568/366120 (30%)]	lr:1.49e-04	Loss: 0.153673
[2024-08-05 11:12:01,701] {train_model:82} INFO - Train Epoch: 21 [146176/366120 (40%)]	lr:1.49e-04	Loss: 0.078265
[2024-08-05 11:12:10,808] {train_model:82} INFO - Train Epoch: 21 [182784/366120 (50%)]	lr:1.49e-04	Loss: 0.090746
[2024-08-05 11:12:19,927] {train_model:82} INFO - Train Epoch: 21 [219392/366120 (60%)]	lr:1.49e-04	Loss: 0.065276
[2024-08-05 11:12:29,105] {train_model:82} INFO - Train Epoch: 21 [256000/366120 (70%)]	lr:1.49e-04	Loss: 0.065139
[2024-08-05 11:12:38,347] {train_model:82} INFO - Train Epoch: 21 [292608/366120 (80%)]	lr:1.49e-04	Loss: 0.079021
[2024-08-05 11:12:47,597] {train_model:82} INFO - Train Epoch: 21 [329216/366120 (90%)]	lr:1.49e-04	Loss: 0.556049
[2024-08-05 11:12:56,809] {train_model:82} INFO - Train Epoch: 21 [365824/366120 (100%)]	lr:1.49e-04	Loss: 0.091665
[2024-08-05 11:13:02,153] {run_experiment:79} INFO - 
[2024-08-05 11:13:02,153] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:13:02,792] {result_logger:103} INFO - precision on Wake: 0.986
[2024-08-05 11:13:03,199] {result_logger:104} INFO - recall on Wake: 0.979
[2024-08-05 11:13:03,608] {result_logger:107} INFO - F1-score on Wake: 0.983
[2024-08-05 11:13:03,609] {result_logger:108} INFO - 
[2024-08-05 11:13:04,175] {result_logger:103} INFO - precision on REM: 0.860
[2024-08-05 11:13:04,528] {result_logger:104} INFO - recall on REM: 0.983
[2024-08-05 11:13:04,880] {result_logger:107} INFO - F1-score on REM: 0.917
[2024-08-05 11:13:04,881] {result_logger:108} INFO - 
[2024-08-05 11:13:05,496] {result_logger:103} INFO - precision on Non REM: 0.973
[2024-08-05 11:13:05,892] {result_logger:104} INFO - recall on Non REM: 0.964
[2024-08-05 11:13:06,288] {result_logger:107} INFO - F1-score on Non REM: 0.968
[2024-08-05 11:13:06,289] {result_logger:108} INFO - 
[2024-08-05 11:13:06,377] {result_logger:111} INFO - average precision on sleep stages: 0.939
[2024-08-05 11:13:06,465] {result_logger:113} INFO - average recall on sleep stages: 0.976
[2024-08-05 11:13:06,553] {result_logger:115} INFO - average F1-score on sleep stages: 0.956
[2024-08-05 11:13:06,554] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:13:06,635] {result_logger:103} INFO - precision on Wake: 0.973
[2024-08-05 11:13:06,685] {result_logger:104} INFO - recall on Wake: 0.984
[2024-08-05 11:13:06,735] {result_logger:107} INFO - F1-score on Wake: 0.978
[2024-08-05 11:13:06,735] {result_logger:108} INFO - 
[2024-08-05 11:13:06,815] {result_logger:103} INFO - precision on REM: 0.786
[2024-08-05 11:13:06,864] {result_logger:104} INFO - recall on REM: 0.978
[2024-08-05 11:13:06,912] {result_logger:107} INFO - F1-score on REM: 0.871
[2024-08-05 11:13:06,912] {result_logger:108} INFO - 
[2024-08-05 11:13:06,992] {result_logger:103} INFO - precision on Non REM: 0.978
[2024-08-05 11:13:07,042] {result_logger:104} INFO - recall on Non REM: 0.934
[2024-08-05 11:13:07,091] {result_logger:107} INFO - F1-score on Non REM: 0.955
[2024-08-05 11:13:07,091] {result_logger:108} INFO - 
[2024-08-05 11:13:07,102] {result_logger:111} INFO - average precision on sleep stages: 0.912
[2024-08-05 11:13:07,112] {result_logger:113} INFO - average recall on sleep stages: 0.965
[2024-08-05 11:13:07,123] {result_logger:115} INFO - average F1-score on sleep stages: 0.935
[2024-08-05 11:13:07,123] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:13:07,184] {result_logger:134} INFO - 
[[199532    587   3628]
 [    63  18297    246]
 [  2776   2399 138592]]
[2024-08-05 11:13:07,243] {result_logger:141} INFO - 
[[ 97.93%   0.29%   1.78%]
 [  0.34%  98.34%   1.32%]
 [  1.93%   1.67%  96.40%]]
[2024-08-05 11:13:07,303] {result_logger:145} INFO - 
[[ 98.60%   2.76%   2.55%]
 [  0.03%  85.97%   0.17%]
 [  1.37%  11.27%  97.28%]]
[2024-08-05 11:13:07,303] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:13:07,311] {result_logger:134} INFO - 
[[27914    67   401]
 [   19  2489    37]
 [  759   611 19333]]
[2024-08-05 11:13:07,318] {result_logger:141} INFO - 
[[ 98.35%   0.24%   1.41%]
 [  0.75%  97.80%   1.45%]
 [  3.67%   2.95%  93.38%]]
[2024-08-05 11:13:07,326] {result_logger:145} INFO - 
[[ 97.29%   2.12%   2.03%]
 [  0.07%  78.59%   0.19%]
 [  2.65%  19.29%  97.78%]]
[2024-08-05 11:13:07,413] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:13:07,413] {result_logger:77} INFO - actual:
[2024-08-05 11:13:07,414] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:13:07,414] {result_logger:79} INFO - predicted:
[2024-08-05 11:13:07,414] {result_logger:80} INFO - 
[[95.16%  0.11%  4.73%]
 [15.09% 78.21%  6.69%]
 [ 4.60%  3.33% 92.06%]]
[2024-08-05 11:13:07,414] {run_experiment:113} INFO - [epoch  21] execution time: 107.33s	 avg f1-score: 0.9350

[2024-08-05 11:13:07,414] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:13:07,439] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:13:21,787] {train_model:82} INFO - Train Epoch: 22 [36352/366120 (10%)]	lr:1.40e-04	Loss: 0.033024
[2024-08-05 11:13:30,862] {train_model:82} INFO - Train Epoch: 22 [72960/366120 (20%)]	lr:1.40e-04	Loss: 0.076886
[2024-08-05 11:13:39,929] {train_model:82} INFO - Train Epoch: 22 [109568/366120 (30%)]	lr:1.40e-04	Loss: 0.128617
[2024-08-05 11:13:49,001] {train_model:82} INFO - Train Epoch: 22 [146176/366120 (40%)]	lr:1.40e-04	Loss: 0.042298
[2024-08-05 11:13:58,065] {train_model:82} INFO - Train Epoch: 22 [182784/366120 (50%)]	lr:1.40e-04	Loss: 0.061710
[2024-08-05 11:14:07,193] {train_model:82} INFO - Train Epoch: 22 [219392/366120 (60%)]	lr:1.40e-04	Loss: 0.030758
[2024-08-05 11:14:16,345] {train_model:82} INFO - Train Epoch: 22 [256000/366120 (70%)]	lr:1.40e-04	Loss: 0.017502
[2024-08-05 11:14:25,590] {train_model:82} INFO - Train Epoch: 22 [292608/366120 (80%)]	lr:1.40e-04	Loss: 0.045174
[2024-08-05 11:14:34,867] {train_model:82} INFO - Train Epoch: 22 [329216/366120 (90%)]	lr:1.40e-04	Loss: 0.059858
[2024-08-05 11:14:44,092] {train_model:82} INFO - Train Epoch: 22 [365824/366120 (100%)]	lr:1.40e-04	Loss: 0.059393
[2024-08-05 11:14:49,052] {run_experiment:79} INFO - 
[2024-08-05 11:14:49,052] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:14:49,695] {result_logger:103} INFO - precision on Wake: 0.986
[2024-08-05 11:14:50,108] {result_logger:104} INFO - recall on Wake: 0.980
[2024-08-05 11:14:50,517] {result_logger:107} INFO - F1-score on Wake: 0.983
[2024-08-05 11:14:50,517] {result_logger:108} INFO - 
[2024-08-05 11:14:51,084] {result_logger:103} INFO - precision on REM: 0.869
[2024-08-05 11:14:51,438] {result_logger:104} INFO - recall on REM: 0.984
[2024-08-05 11:14:51,790] {result_logger:107} INFO - F1-score on REM: 0.923
[2024-08-05 11:14:51,790] {result_logger:108} INFO - 
[2024-08-05 11:14:52,407] {result_logger:103} INFO - precision on Non REM: 0.974
[2024-08-05 11:14:52,804] {result_logger:104} INFO - recall on Non REM: 0.966
[2024-08-05 11:14:53,203] {result_logger:107} INFO - F1-score on Non REM: 0.970
[2024-08-05 11:14:53,203] {result_logger:108} INFO - 
[2024-08-05 11:14:53,290] {result_logger:111} INFO - average precision on sleep stages: 0.943
[2024-08-05 11:14:53,377] {result_logger:113} INFO - average recall on sleep stages: 0.977
[2024-08-05 11:14:53,465] {result_logger:115} INFO - average F1-score on sleep stages: 0.959
[2024-08-05 11:14:53,466] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:14:53,546] {result_logger:103} INFO - precision on Wake: 0.984
[2024-08-05 11:14:53,595] {result_logger:104} INFO - recall on Wake: 0.978
[2024-08-05 11:14:53,644] {result_logger:107} INFO - F1-score on Wake: 0.981
[2024-08-05 11:14:53,644] {result_logger:108} INFO - 
[2024-08-05 11:14:53,722] {result_logger:103} INFO - precision on REM: 0.823
[2024-08-05 11:14:53,770] {result_logger:104} INFO - recall on REM: 0.963
[2024-08-05 11:14:53,817] {result_logger:107} INFO - F1-score on REM: 0.887
[2024-08-05 11:14:53,817] {result_logger:108} INFO - 
[2024-08-05 11:14:53,897] {result_logger:103} INFO - precision on Non REM: 0.969
[2024-08-05 11:14:53,947] {result_logger:104} INFO - recall on Non REM: 0.958
[2024-08-05 11:14:53,996] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2024-08-05 11:14:53,997] {result_logger:108} INFO - 
[2024-08-05 11:14:54,007] {result_logger:111} INFO - average precision on sleep stages: 0.926
[2024-08-05 11:14:54,017] {result_logger:113} INFO - average recall on sleep stages: 0.966
[2024-08-05 11:14:54,027] {result_logger:115} INFO - average F1-score on sleep stages: 0.944
[2024-08-05 11:14:54,027] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:14:54,087] {result_logger:134} INFO - 
[[199728    517   3502]
 [    67  18309    230]
 [  2671   2235 138861]]
[2024-08-05 11:14:54,147] {result_logger:141} INFO - 
[[ 98.03%   0.25%   1.72%]
 [  0.36%  98.40%   1.24%]
 [  1.86%   1.55%  96.59%]]
[2024-08-05 11:14:54,206] {result_logger:145} INFO - 
[[ 98.65%   2.45%   2.46%]
 [  0.03%  86.93%   0.16%]
 [  1.32%  10.61%  97.38%]]
[2024-08-05 11:14:54,206] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:14:54,213] {result_logger:134} INFO - 
[[27745    97   540]
 [    8  2451    86]
 [  433   431 19839]]
[2024-08-05 11:14:54,306] {result_logger:141} INFO - 
[[ 97.76%   0.34%   1.90%]
 [  0.31%  96.31%   3.38%]
 [  2.09%   2.08%  95.83%]]
[2024-08-05 11:14:54,395] {result_logger:145} INFO - 
[[ 98.44%   3.26%   2.64%]
 [  0.03%  82.28%   0.42%]
 [  1.54%  14.47%  96.94%]]
[2024-08-05 11:14:54,648] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:14:54,648] {result_logger:77} INFO - actual:
[2024-08-05 11:14:54,649] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:14:54,649] {result_logger:79} INFO - predicted:
[2024-08-05 11:14:54,649] {result_logger:80} INFO - 
[[95.36%  0.13%  4.51%]
 [15.07% 78.25%  6.68%]
 [ 4.20%  2.98% 92.82%]]
[2024-08-05 11:14:54,704] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_E_weighted/model_8conv_2fc-best.pth
[2024-08-05 11:14:54,705] {run_experiment:113} INFO - [epoch  22] execution time: 107.29s	 avg f1-score: 0.9441

[2024-08-05 11:14:54,705] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:14:54,730] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:15:08,949] {train_model:82} INFO - Train Epoch: 23 [36352/366120 (10%)]	lr:1.32e-04	Loss: 0.031650
[2024-08-05 11:15:17,959] {train_model:82} INFO - Train Epoch: 23 [72960/366120 (20%)]	lr:1.32e-04	Loss: 0.070727
[2024-08-05 11:15:27,044] {train_model:82} INFO - Train Epoch: 23 [109568/366120 (30%)]	lr:1.32e-04	Loss: 0.097204
[2024-08-05 11:15:36,167] {train_model:82} INFO - Train Epoch: 23 [146176/366120 (40%)]	lr:1.32e-04	Loss: 0.092158
[2024-08-05 11:15:45,272] {train_model:82} INFO - Train Epoch: 23 [182784/366120 (50%)]	lr:1.32e-04	Loss: 0.039322
[2024-08-05 11:15:54,389] {train_model:82} INFO - Train Epoch: 23 [219392/366120 (60%)]	lr:1.32e-04	Loss: 0.063046
[2024-08-05 11:16:03,619] {train_model:82} INFO - Train Epoch: 23 [256000/366120 (70%)]	lr:1.32e-04	Loss: 0.063210
[2024-08-05 11:16:12,859] {train_model:82} INFO - Train Epoch: 23 [292608/366120 (80%)]	lr:1.32e-04	Loss: 0.102212
[2024-08-05 11:16:22,127] {train_model:82} INFO - Train Epoch: 23 [329216/366120 (90%)]	lr:1.32e-04	Loss: 0.043695
[2024-08-05 11:16:31,314] {train_model:82} INFO - Train Epoch: 23 [365824/366120 (100%)]	lr:1.32e-04	Loss: 0.062136
[2024-08-05 11:16:36,507] {run_experiment:79} INFO - 
[2024-08-05 11:16:36,507] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:16:37,156] {result_logger:103} INFO - precision on Wake: 0.987
[2024-08-05 11:16:37,563] {result_logger:104} INFO - recall on Wake: 0.981
[2024-08-05 11:16:37,977] {result_logger:107} INFO - F1-score on Wake: 0.984
[2024-08-05 11:16:37,977] {result_logger:108} INFO - 
[2024-08-05 11:16:38,549] {result_logger:103} INFO - precision on REM: 0.877
[2024-08-05 11:16:38,902] {result_logger:104} INFO - recall on REM: 0.987
[2024-08-05 11:16:39,255] {result_logger:107} INFO - F1-score on REM: 0.929
[2024-08-05 11:16:39,255] {result_logger:108} INFO - 
[2024-08-05 11:16:39,880] {result_logger:103} INFO - precision on Non REM: 0.974
[2024-08-05 11:16:40,276] {result_logger:104} INFO - recall on Non REM: 0.968
[2024-08-05 11:16:40,673] {result_logger:107} INFO - F1-score on Non REM: 0.971
[2024-08-05 11:16:40,673] {result_logger:108} INFO - 
[2024-08-05 11:16:40,764] {result_logger:111} INFO - average precision on sleep stages: 0.946
[2024-08-05 11:16:40,853] {result_logger:113} INFO - average recall on sleep stages: 0.978
[2024-08-05 11:16:40,943] {result_logger:115} INFO - average F1-score on sleep stages: 0.961
[2024-08-05 11:16:40,944] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:16:41,030] {result_logger:103} INFO - precision on Wake: 0.978
[2024-08-05 11:16:41,079] {result_logger:104} INFO - recall on Wake: 0.982
[2024-08-05 11:16:41,129] {result_logger:107} INFO - F1-score on Wake: 0.980
[2024-08-05 11:16:41,129] {result_logger:108} INFO - 
[2024-08-05 11:16:41,207] {result_logger:103} INFO - precision on REM: 0.825
[2024-08-05 11:16:41,255] {result_logger:104} INFO - recall on REM: 0.968
[2024-08-05 11:16:41,302] {result_logger:107} INFO - F1-score on REM: 0.891
[2024-08-05 11:16:41,302] {result_logger:108} INFO - 
[2024-08-05 11:16:41,384] {result_logger:103} INFO - precision on Non REM: 0.975
[2024-08-05 11:16:41,434] {result_logger:104} INFO - recall on Non REM: 0.949
[2024-08-05 11:16:41,485] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2024-08-05 11:16:41,485] {result_logger:108} INFO - 
[2024-08-05 11:16:41,495] {result_logger:111} INFO - average precision on sleep stages: 0.926
[2024-08-05 11:16:41,505] {result_logger:113} INFO - average recall on sleep stages: 0.966
[2024-08-05 11:16:41,516] {result_logger:115} INFO - average F1-score on sleep stages: 0.944
[2024-08-05 11:16:41,516] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:16:41,578] {result_logger:134} INFO - 
[[199835    445   3467]
 [    52  18358    196]
 [  2532   2118 139117]]
[2024-08-05 11:16:41,640] {result_logger:141} INFO - 
[[ 98.08%   0.22%   1.70%]
 [  0.28%  98.67%   1.05%]
 [  1.76%   1.47%  96.77%]]
[2024-08-05 11:16:41,701] {result_logger:145} INFO - 
[[ 98.72%   2.13%   2.43%]
 [  0.03%  87.75%   0.14%]
 [  1.25%  10.12%  97.43%]]
[2024-08-05 11:16:41,701] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:16:41,708] {result_logger:134} INFO - 
[[27878    69   435]
 [   14  2463    68]
 [  613   452 19638]]
[2024-08-05 11:16:41,801] {result_logger:141} INFO - 
[[ 98.22%   0.24%   1.53%]
 [  0.55%  96.78%   2.67%]
 [  2.96%   2.18%  94.86%]]
[2024-08-05 11:16:41,889] {result_logger:145} INFO - 
[[ 97.80%   2.31%   2.16%]
 [  0.05%  82.54%   0.34%]
 [  2.15%  15.15%  97.50%]]
[2024-08-05 11:16:42,142] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:16:42,142] {result_logger:77} INFO - actual:
[2024-08-05 11:16:42,142] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:16:42,142] {result_logger:79} INFO - predicted:
[2024-08-05 11:16:42,143] {result_logger:80} INFO - 
[[95.37%  0.12%  4.51%]
 [15.88% 79.39%  4.73%]
 [ 4.21%  2.88% 92.91%]]
[2024-08-05 11:16:42,197] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_E_weighted/model_8conv_2fc-best.pth
[2024-08-05 11:16:42,197] {run_experiment:113} INFO - [epoch  23] execution time: 107.49s	 avg f1-score: 0.9442

[2024-08-05 11:16:42,197] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:16:42,223] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:16:56,565] {train_model:82} INFO - Train Epoch: 24 [36352/366120 (10%)]	lr:1.25e-04	Loss: 0.022168
[2024-08-05 11:17:05,638] {train_model:82} INFO - Train Epoch: 24 [72960/366120 (20%)]	lr:1.25e-04	Loss: 0.039304
[2024-08-05 11:17:14,747] {train_model:82} INFO - Train Epoch: 24 [109568/366120 (30%)]	lr:1.25e-04	Loss: 0.037545
[2024-08-05 11:17:23,886] {train_model:82} INFO - Train Epoch: 24 [146176/366120 (40%)]	lr:1.25e-04	Loss: 0.074576
[2024-08-05 11:17:33,055] {train_model:82} INFO - Train Epoch: 24 [182784/366120 (50%)]	lr:1.25e-04	Loss: 0.055527
[2024-08-05 11:17:42,248] {train_model:82} INFO - Train Epoch: 24 [219392/366120 (60%)]	lr:1.25e-04	Loss: 0.083081
[2024-08-05 11:17:51,464] {train_model:82} INFO - Train Epoch: 24 [256000/366120 (70%)]	lr:1.25e-04	Loss: 0.030765
[2024-08-05 11:18:00,721] {train_model:82} INFO - Train Epoch: 24 [292608/366120 (80%)]	lr:1.25e-04	Loss: 0.034078
[2024-08-05 11:18:09,995] {train_model:82} INFO - Train Epoch: 24 [329216/366120 (90%)]	lr:1.25e-04	Loss: 0.041158
[2024-08-05 11:18:19,219] {train_model:82} INFO - Train Epoch: 24 [365824/366120 (100%)]	lr:1.25e-04	Loss: 0.079104
[2024-08-05 11:18:24,214] {run_experiment:79} INFO - 
[2024-08-05 11:18:24,214] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:18:24,877] {result_logger:103} INFO - precision on Wake: 0.988
[2024-08-05 11:18:25,290] {result_logger:104} INFO - recall on Wake: 0.982
[2024-08-05 11:18:25,697] {result_logger:107} INFO - F1-score on Wake: 0.985
[2024-08-05 11:18:25,697] {result_logger:108} INFO - 
[2024-08-05 11:18:26,281] {result_logger:103} INFO - precision on REM: 0.885
[2024-08-05 11:18:26,633] {result_logger:104} INFO - recall on REM: 0.987
[2024-08-05 11:18:26,984] {result_logger:107} INFO - F1-score on REM: 0.933
[2024-08-05 11:18:26,984] {result_logger:108} INFO - 
[2024-08-05 11:18:27,610] {result_logger:103} INFO - precision on Non REM: 0.975
[2024-08-05 11:18:28,007] {result_logger:104} INFO - recall on Non REM: 0.970
[2024-08-05 11:18:28,404] {result_logger:107} INFO - F1-score on Non REM: 0.972
[2024-08-05 11:18:28,404] {result_logger:108} INFO - 
[2024-08-05 11:18:28,491] {result_logger:111} INFO - average precision on sleep stages: 0.949
[2024-08-05 11:18:28,579] {result_logger:113} INFO - average recall on sleep stages: 0.980
[2024-08-05 11:18:28,667] {result_logger:115} INFO - average F1-score on sleep stages: 0.964
[2024-08-05 11:18:28,668] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:18:28,751] {result_logger:103} INFO - precision on Wake: 0.978
[2024-08-05 11:18:28,800] {result_logger:104} INFO - recall on Wake: 0.981
[2024-08-05 11:18:28,850] {result_logger:107} INFO - F1-score on Wake: 0.980
[2024-08-05 11:18:28,850] {result_logger:108} INFO - 
[2024-08-05 11:18:28,930] {result_logger:103} INFO - precision on REM: 0.836
[2024-08-05 11:18:28,978] {result_logger:104} INFO - recall on REM: 0.960
[2024-08-05 11:18:29,025] {result_logger:107} INFO - F1-score on REM: 0.894
[2024-08-05 11:18:29,025] {result_logger:108} INFO - 
[2024-08-05 11:18:29,107] {result_logger:103} INFO - precision on Non REM: 0.974
[2024-08-05 11:18:29,156] {result_logger:104} INFO - recall on Non REM: 0.951
[2024-08-05 11:18:29,205] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2024-08-05 11:18:29,205] {result_logger:108} INFO - 
[2024-08-05 11:18:29,216] {result_logger:111} INFO - average precision on sleep stages: 0.929
[2024-08-05 11:18:29,226] {result_logger:113} INFO - average recall on sleep stages: 0.964
[2024-08-05 11:18:29,236] {result_logger:115} INFO - average F1-score on sleep stages: 0.945
[2024-08-05 11:18:29,236] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:18:29,297] {result_logger:134} INFO - 
[[200007    404   3336]
 [    50  18372    184]
 [  2383   1989 139395]]
[2024-08-05 11:18:29,356] {result_logger:141} INFO - 
[[ 98.16%   0.20%   1.64%]
 [  0.27%  98.74%   0.99%]
 [  1.66%   1.38%  96.96%]]
[2024-08-05 11:18:29,416] {result_logger:145} INFO - 
[[ 98.80%   1.95%   2.33%]
 [  0.02%  88.48%   0.13%]
 [  1.18%   9.58%  97.54%]]
[2024-08-05 11:18:29,416] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:18:29,424] {result_logger:134} INFO - 
[[27854    87   441]
 [   16  2444    85]
 [  617   393 19693]]
[2024-08-05 11:18:29,516] {result_logger:141} INFO - 
[[ 98.14%   0.31%   1.55%]
 [  0.63%  96.03%   3.34%]
 [  2.98%   1.90%  95.12%]]
[2024-08-05 11:18:29,605] {result_logger:145} INFO - 
[[ 97.78%   2.98%   2.18%]
 [  0.06%  83.58%   0.42%]
 [  2.17%  13.44%  97.40%]]
[2024-08-05 11:18:29,935] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:18:29,935] {result_logger:77} INFO - actual:
[2024-08-05 11:18:29,935] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:18:29,935] {result_logger:79} INFO - predicted:
[2024-08-05 11:18:29,935] {result_logger:80} INFO - 
[[95.06%  0.15%  4.79%]
 [15.97% 78.49%  5.54%]
 [ 4.65%  2.89% 92.45%]]
[2024-08-05 11:18:29,991] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_E_weighted/model_8conv_2fc-best.pth
[2024-08-05 11:18:29,991] {run_experiment:113} INFO - [epoch  24] execution time: 107.79s	 avg f1-score: 0.9453

[2024-08-05 11:18:29,991] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:18:30,018] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:18:44,391] {train_model:82} INFO - Train Epoch: 25 [36352/366120 (10%)]	lr:1.17e-04	Loss: 0.028847
[2024-08-05 11:18:53,401] {train_model:82} INFO - Train Epoch: 25 [72960/366120 (20%)]	lr:1.17e-04	Loss: 0.080787
[2024-08-05 11:19:02,451] {train_model:82} INFO - Train Epoch: 25 [109568/366120 (30%)]	lr:1.17e-04	Loss: 0.045876
[2024-08-05 11:19:11,520] {train_model:82} INFO - Train Epoch: 25 [146176/366120 (40%)]	lr:1.17e-04	Loss: 0.046638
[2024-08-05 11:19:20,603] {train_model:82} INFO - Train Epoch: 25 [182784/366120 (50%)]	lr:1.17e-04	Loss: 0.029793
[2024-08-05 11:19:29,696] {train_model:82} INFO - Train Epoch: 25 [219392/366120 (60%)]	lr:1.17e-04	Loss: 0.072048
[2024-08-05 11:19:38,823] {train_model:82} INFO - Train Epoch: 25 [256000/366120 (70%)]	lr:1.17e-04	Loss: 0.069145
[2024-08-05 11:19:47,978] {train_model:82} INFO - Train Epoch: 25 [292608/366120 (80%)]	lr:1.17e-04	Loss: 0.053916
[2024-08-05 11:19:57,164] {train_model:82} INFO - Train Epoch: 25 [329216/366120 (90%)]	lr:1.17e-04	Loss: 0.033104
[2024-08-05 11:20:06,337] {train_model:82} INFO - Train Epoch: 25 [365824/366120 (100%)]	lr:1.17e-04	Loss: 0.099164
[2024-08-05 11:20:11,722] {run_experiment:79} INFO - 
[2024-08-05 11:20:11,722] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:20:12,356] {result_logger:103} INFO - precision on Wake: 0.988
[2024-08-05 11:20:12,773] {result_logger:104} INFO - recall on Wake: 0.982
[2024-08-05 11:20:13,183] {result_logger:107} INFO - F1-score on Wake: 0.985
[2024-08-05 11:20:13,183] {result_logger:108} INFO - 
[2024-08-05 11:20:13,746] {result_logger:103} INFO - precision on REM: 0.889
[2024-08-05 11:20:14,098] {result_logger:104} INFO - recall on REM: 0.989
[2024-08-05 11:20:14,450] {result_logger:107} INFO - F1-score on REM: 0.936
[2024-08-05 11:20:14,450] {result_logger:108} INFO - 
[2024-08-05 11:20:15,061] {result_logger:103} INFO - precision on Non REM: 0.976
[2024-08-05 11:20:15,458] {result_logger:104} INFO - recall on Non REM: 0.971
[2024-08-05 11:20:15,855] {result_logger:107} INFO - F1-score on Non REM: 0.974
[2024-08-05 11:20:15,855] {result_logger:108} INFO - 
[2024-08-05 11:20:15,944] {result_logger:111} INFO - average precision on sleep stages: 0.951
[2024-08-05 11:20:16,033] {result_logger:113} INFO - average recall on sleep stages: 0.981
[2024-08-05 11:20:16,121] {result_logger:115} INFO - average F1-score on sleep stages: 0.965
[2024-08-05 11:20:16,122] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:20:16,202] {result_logger:103} INFO - precision on Wake: 0.984
[2024-08-05 11:20:16,251] {result_logger:104} INFO - recall on Wake: 0.970
[2024-08-05 11:20:16,300] {result_logger:107} INFO - F1-score on Wake: 0.977
[2024-08-05 11:20:16,301] {result_logger:108} INFO - 
[2024-08-05 11:20:16,378] {result_logger:103} INFO - precision on REM: 0.821
[2024-08-05 11:20:16,426] {result_logger:104} INFO - recall on REM: 0.955
[2024-08-05 11:20:16,474] {result_logger:107} INFO - F1-score on REM: 0.883
[2024-08-05 11:20:16,474] {result_logger:108} INFO - 
[2024-08-05 11:20:16,554] {result_logger:103} INFO - precision on Non REM: 0.963
[2024-08-05 11:20:16,603] {result_logger:104} INFO - recall on Non REM: 0.963
[2024-08-05 11:20:16,653] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2024-08-05 11:20:16,653] {result_logger:108} INFO - 
[2024-08-05 11:20:16,663] {result_logger:111} INFO - average precision on sleep stages: 0.923
[2024-08-05 11:20:16,672] {result_logger:113} INFO - average recall on sleep stages: 0.962
[2024-08-05 11:20:16,683] {result_logger:115} INFO - average F1-score on sleep stages: 0.941
[2024-08-05 11:20:16,683] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:20:16,745] {result_logger:134} INFO - 
[[200094    441   3212]
 [    49  18393    164]
 [  2316   1851 139600]]
[2024-08-05 11:20:16,805] {result_logger:141} INFO - 
[[ 98.21%   0.22%   1.58%]
 [  0.26%  98.86%   0.88%]
 [  1.61%   1.29%  97.10%]]
[2024-08-05 11:20:16,865] {result_logger:145} INFO - 
[[ 98.83%   2.13%   2.25%]
 [  0.02%  88.92%   0.11%]
 [  1.14%   8.95%  97.64%]]
[2024-08-05 11:20:16,865] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:20:16,872] {result_logger:134} INFO - 
[[27521   187   674]
 [   15  2430   100]
 [  426   344 19933]]
[2024-08-05 11:20:16,879] {result_logger:141} INFO - 
[[ 96.97%   0.66%   2.37%]
 [  0.59%  95.48%   3.93%]
 [  2.06%   1.66%  96.28%]]
[2024-08-05 11:20:16,886] {result_logger:145} INFO - 
[[ 98.42%   6.32%   3.25%]
 [  0.05%  82.07%   0.48%]
 [  1.52%  11.62%  96.26%]]
[2024-08-05 11:20:16,978] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:20:16,978] {result_logger:77} INFO - actual:
[2024-08-05 11:20:16,978] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:20:16,978] {result_logger:79} INFO - predicted:
[2024-08-05 11:20:16,978] {result_logger:80} INFO - 
[[95.06%  0.40%  4.53%]
 [17.12% 77.24%  5.64%]
 [ 4.22%  2.71% 93.07%]]
[2024-08-05 11:20:16,979] {run_experiment:113} INFO - [epoch  25] execution time: 106.99s	 avg f1-score: 0.9408

[2024-08-05 11:20:16,979] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:20:17,004] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:20:31,284] {train_model:82} INFO - Train Epoch: 26 [36352/366120 (10%)]	lr:1.11e-04	Loss: 0.050162
[2024-08-05 11:20:40,300] {train_model:82} INFO - Train Epoch: 26 [72960/366120 (20%)]	lr:1.11e-04	Loss: 0.020207
[2024-08-05 11:20:49,341] {train_model:82} INFO - Train Epoch: 26 [109568/366120 (30%)]	lr:1.11e-04	Loss: 0.040403
[2024-08-05 11:20:58,468] {train_model:82} INFO - Train Epoch: 26 [146176/366120 (40%)]	lr:1.11e-04	Loss: 0.013307
[2024-08-05 11:21:07,552] {train_model:82} INFO - Train Epoch: 26 [182784/366120 (50%)]	lr:1.11e-04	Loss: 0.018085
[2024-08-05 11:21:16,647] {train_model:82} INFO - Train Epoch: 26 [219392/366120 (60%)]	lr:1.11e-04	Loss: 0.034142
[2024-08-05 11:21:25,845] {train_model:82} INFO - Train Epoch: 26 [256000/366120 (70%)]	lr:1.11e-04	Loss: 0.035980
[2024-08-05 11:21:35,046] {train_model:82} INFO - Train Epoch: 26 [292608/366120 (80%)]	lr:1.11e-04	Loss: 0.018870
[2024-08-05 11:21:44,218] {train_model:82} INFO - Train Epoch: 26 [329216/366120 (90%)]	lr:1.11e-04	Loss: 0.055619
[2024-08-05 11:21:53,390] {train_model:82} INFO - Train Epoch: 26 [365824/366120 (100%)]	lr:1.11e-04	Loss: 0.158919
[2024-08-05 11:21:58,593] {run_experiment:79} INFO - 
[2024-08-05 11:21:58,593] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:21:59,228] {result_logger:103} INFO - precision on Wake: 0.989
[2024-08-05 11:21:59,637] {result_logger:104} INFO - recall on Wake: 0.983
[2024-08-05 11:22:00,046] {result_logger:107} INFO - F1-score on Wake: 0.986
[2024-08-05 11:22:00,046] {result_logger:108} INFO - 
[2024-08-05 11:22:00,608] {result_logger:103} INFO - precision on REM: 0.899
[2024-08-05 11:22:00,964] {result_logger:104} INFO - recall on REM: 0.990
[2024-08-05 11:22:01,316] {result_logger:107} INFO - F1-score on REM: 0.942
[2024-08-05 11:22:01,317] {result_logger:108} INFO - 
[2024-08-05 11:22:01,931] {result_logger:103} INFO - precision on Non REM: 0.977
[2024-08-05 11:22:02,331] {result_logger:104} INFO - recall on Non REM: 0.972
[2024-08-05 11:22:02,732] {result_logger:107} INFO - F1-score on Non REM: 0.975
[2024-08-05 11:22:02,732] {result_logger:108} INFO - 
[2024-08-05 11:22:02,825] {result_logger:111} INFO - average precision on sleep stages: 0.955
[2024-08-05 11:22:02,917] {result_logger:113} INFO - average recall on sleep stages: 0.982
[2024-08-05 11:22:03,010] {result_logger:115} INFO - average F1-score on sleep stages: 0.968
[2024-08-05 11:22:03,011] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:22:03,090] {result_logger:103} INFO - precision on Wake: 0.982
[2024-08-05 11:22:03,139] {result_logger:104} INFO - recall on Wake: 0.978
[2024-08-05 11:22:03,188] {result_logger:107} INFO - F1-score on Wake: 0.980
[2024-08-05 11:22:03,188] {result_logger:108} INFO - 
[2024-08-05 11:22:03,268] {result_logger:103} INFO - precision on REM: 0.869
[2024-08-05 11:22:03,316] {result_logger:104} INFO - recall on REM: 0.949
[2024-08-05 11:22:03,364] {result_logger:107} INFO - F1-score on REM: 0.907
[2024-08-05 11:22:03,364] {result_logger:108} INFO - 
[2024-08-05 11:22:03,444] {result_logger:103} INFO - precision on Non REM: 0.968
[2024-08-05 11:22:03,493] {result_logger:104} INFO - recall on Non REM: 0.961
[2024-08-05 11:22:03,543] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2024-08-05 11:22:03,543] {result_logger:108} INFO - 
[2024-08-05 11:22:03,554] {result_logger:111} INFO - average precision on sleep stages: 0.939
[2024-08-05 11:22:03,563] {result_logger:113} INFO - average recall on sleep stages: 0.963
[2024-08-05 11:22:03,574] {result_logger:115} INFO - average F1-score on sleep stages: 0.950
[2024-08-05 11:22:03,574] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:22:03,638] {result_logger:134} INFO - 
[[200292    350   3105]
 [    34  18416    156]
 [  2262   1729 139776]]
[2024-08-05 11:22:03,701] {result_logger:141} INFO - 
[[ 98.30%   0.17%   1.52%]
 [  0.18%  98.98%   0.84%]
 [  1.57%   1.20%  97.22%]]
[2024-08-05 11:22:03,764] {result_logger:145} INFO - 
[[ 98.87%   1.71%   2.17%]
 [  0.02%  89.86%   0.11%]
 [  1.12%   8.44%  97.72%]]
[2024-08-05 11:22:03,764] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:22:03,771] {result_logger:134} INFO - 
[[27762    53   567]
 [   30  2414   101]
 [  492   310 19901]]
[2024-08-05 11:22:03,864] {result_logger:141} INFO - 
[[ 97.82%   0.19%   2.00%]
 [  1.18%  94.85%   3.97%]
 [  2.38%   1.50%  96.13%]]
[2024-08-05 11:22:03,953] {result_logger:145} INFO - 
[[ 98.15%   1.91%   2.76%]
 [  0.11%  86.93%   0.49%]
 [  1.74%  11.16%  96.75%]]
[2024-08-05 11:22:04,205] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:22:04,205] {result_logger:77} INFO - actual:
[2024-08-05 11:22:04,205] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:22:04,205] {result_logger:79} INFO - predicted:
[2024-08-05 11:22:04,205] {result_logger:80} INFO - 
[[95.44%  0.09%  4.48%]
 [14.87% 79.87%  5.26%]
 [ 4.27%  2.60% 93.14%]]
[2024-08-05 11:22:04,261] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_E_weighted/model_8conv_2fc-best.pth
[2024-08-05 11:22:04,262] {run_experiment:113} INFO - [epoch  26] execution time: 107.28s	 avg f1-score: 0.9505

[2024-08-05 11:22:04,262] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:22:04,288] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:22:18,591] {train_model:82} INFO - Train Epoch: 27 [36352/366120 (10%)]	lr:1.04e-04	Loss: 0.054327
[2024-08-05 11:22:27,611] {train_model:82} INFO - Train Epoch: 27 [72960/366120 (20%)]	lr:1.04e-04	Loss: 0.022119
[2024-08-05 11:22:36,656] {train_model:82} INFO - Train Epoch: 27 [109568/366120 (30%)]	lr:1.04e-04	Loss: 0.028649
[2024-08-05 11:22:45,828] {train_model:82} INFO - Train Epoch: 27 [146176/366120 (40%)]	lr:1.04e-04	Loss: 0.104203
[2024-08-05 11:22:54,963] {train_model:82} INFO - Train Epoch: 27 [182784/366120 (50%)]	lr:1.04e-04	Loss: 0.029109
[2024-08-05 11:23:04,120] {train_model:82} INFO - Train Epoch: 27 [219392/366120 (60%)]	lr:1.04e-04	Loss: 0.028368
[2024-08-05 11:23:13,305] {train_model:82} INFO - Train Epoch: 27 [256000/366120 (70%)]	lr:1.04e-04	Loss: 0.059997
[2024-08-05 11:23:22,487] {train_model:82} INFO - Train Epoch: 27 [292608/366120 (80%)]	lr:1.04e-04	Loss: 0.033626
[2024-08-05 11:23:31,682] {train_model:82} INFO - Train Epoch: 27 [329216/366120 (90%)]	lr:1.04e-04	Loss: 0.046459
[2024-08-05 11:23:40,890] {train_model:82} INFO - Train Epoch: 27 [365824/366120 (100%)]	lr:1.04e-04	Loss: 0.041037
[2024-08-05 11:23:46,459] {run_experiment:79} INFO - 
[2024-08-05 11:23:46,460] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:23:47,129] {result_logger:103} INFO - precision on Wake: 0.989
[2024-08-05 11:23:47,537] {result_logger:104} INFO - recall on Wake: 0.984
[2024-08-05 11:23:47,946] {result_logger:107} INFO - F1-score on Wake: 0.987
[2024-08-05 11:23:47,946] {result_logger:108} INFO - 
[2024-08-05 11:23:48,509] {result_logger:103} INFO - precision on REM: 0.908
[2024-08-05 11:23:48,863] {result_logger:104} INFO - recall on REM: 0.990
[2024-08-05 11:23:49,216] {result_logger:107} INFO - F1-score on REM: 0.947
[2024-08-05 11:23:49,216] {result_logger:108} INFO - 
[2024-08-05 11:23:49,847] {result_logger:103} INFO - precision on Non REM: 0.979
[2024-08-05 11:23:50,245] {result_logger:104} INFO - recall on Non REM: 0.974
[2024-08-05 11:23:50,645] {result_logger:107} INFO - F1-score on Non REM: 0.976
[2024-08-05 11:23:50,645] {result_logger:108} INFO - 
[2024-08-05 11:23:50,735] {result_logger:111} INFO - average precision on sleep stages: 0.959
[2024-08-05 11:23:50,823] {result_logger:113} INFO - average recall on sleep stages: 0.983
[2024-08-05 11:23:50,913] {result_logger:115} INFO - average F1-score on sleep stages: 0.970
[2024-08-05 11:23:50,914] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:23:50,999] {result_logger:103} INFO - precision on Wake: 0.982
[2024-08-05 11:23:51,049] {result_logger:104} INFO - recall on Wake: 0.973
[2024-08-05 11:23:51,099] {result_logger:107} INFO - F1-score on Wake: 0.978
[2024-08-05 11:23:51,099] {result_logger:108} INFO - 
[2024-08-05 11:23:51,177] {result_logger:103} INFO - precision on REM: 0.818
[2024-08-05 11:23:51,225] {result_logger:104} INFO - recall on REM: 0.960
[2024-08-05 11:23:51,273] {result_logger:107} INFO - F1-score on REM: 0.883
[2024-08-05 11:23:51,273] {result_logger:108} INFO - 
[2024-08-05 11:23:51,355] {result_logger:103} INFO - precision on Non REM: 0.963
[2024-08-05 11:23:51,406] {result_logger:104} INFO - recall on Non REM: 0.955
[2024-08-05 11:23:51,454] {result_logger:107} INFO - F1-score on Non REM: 0.959
[2024-08-05 11:23:51,454] {result_logger:108} INFO - 
[2024-08-05 11:23:51,464] {result_logger:111} INFO - average precision on sleep stages: 0.921
[2024-08-05 11:23:51,474] {result_logger:113} INFO - average recall on sleep stages: 0.963
[2024-08-05 11:23:51,484] {result_logger:115} INFO - average F1-score on sleep stages: 0.940
[2024-08-05 11:23:51,484] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:23:51,546] {result_logger:134} INFO - 
[[200556    307   2884]
 [    38  18422    146]
 [  2175   1554 140038]]
[2024-08-05 11:23:51,608] {result_logger:141} INFO - 
[[ 98.43%   0.15%   1.42%]
 [  0.20%  99.01%   0.78%]
 [  1.51%   1.08%  97.41%]]
[2024-08-05 11:23:51,669] {result_logger:145} INFO - 
[[ 98.91%   1.51%   2.02%]
 [  0.02%  90.82%   0.10%]
 [  1.07%   7.66%  97.88%]]
[2024-08-05 11:23:51,669] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:23:51,676] {result_logger:134} INFO - 
[[27613    82   687]
 [   36  2443    66]
 [  464   463 19776]]
[2024-08-05 11:23:51,683] {result_logger:141} INFO - 
[[ 97.29%   0.29%   2.42%]
 [  1.41%  95.99%   2.59%]
 [  2.24%   2.24%  95.52%]]
[2024-08-05 11:23:51,690] {result_logger:145} INFO - 
[[ 98.22%   2.74%   3.35%]
 [  0.13%  81.76%   0.32%]
 [  1.65%  15.50%  96.33%]]
[2024-08-05 11:23:51,778] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:23:51,778] {result_logger:77} INFO - actual:
[2024-08-05 11:23:51,778] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:23:51,778] {result_logger:79} INFO - predicted:
[2024-08-05 11:23:51,778] {result_logger:80} INFO - 
[[95.27%  0.16%  4.57%]
 [14.49% 78.95%  6.56%]
 [ 4.37%  2.84% 92.79%]]
[2024-08-05 11:23:51,778] {run_experiment:113} INFO - [epoch  27] execution time: 107.52s	 avg f1-score: 0.9400

[2024-08-05 11:23:51,778] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:23:51,804] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:24:06,376] {train_model:82} INFO - Train Epoch: 28 [36352/366120 (10%)]	lr:9.80e-05	Loss: 0.036654
[2024-08-05 11:24:15,396] {train_model:82} INFO - Train Epoch: 28 [72960/366120 (20%)]	lr:9.80e-05	Loss: 0.040992
[2024-08-05 11:24:24,435] {train_model:82} INFO - Train Epoch: 28 [109568/366120 (30%)]	lr:9.80e-05	Loss: 0.060605
[2024-08-05 11:24:33,550] {train_model:82} INFO - Train Epoch: 28 [146176/366120 (40%)]	lr:9.80e-05	Loss: 0.022349
[2024-08-05 11:24:42,717] {train_model:82} INFO - Train Epoch: 28 [182784/366120 (50%)]	lr:9.80e-05	Loss: 0.014435
[2024-08-05 11:24:51,846] {train_model:82} INFO - Train Epoch: 28 [219392/366120 (60%)]	lr:9.80e-05	Loss: 0.040530
[2024-08-05 11:25:00,979] {train_model:82} INFO - Train Epoch: 28 [256000/366120 (70%)]	lr:9.80e-05	Loss: 0.041442
[2024-08-05 11:25:10,144] {train_model:82} INFO - Train Epoch: 28 [292608/366120 (80%)]	lr:9.80e-05	Loss: 0.018648
[2024-08-05 11:25:19,311] {train_model:82} INFO - Train Epoch: 28 [329216/366120 (90%)]	lr:9.80e-05	Loss: 0.035851
[2024-08-05 11:25:28,467] {train_model:82} INFO - Train Epoch: 28 [365824/366120 (100%)]	lr:9.80e-05	Loss: 0.016755
[2024-08-05 11:25:33,862] {run_experiment:79} INFO - 
[2024-08-05 11:25:33,862] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:25:34,528] {result_logger:103} INFO - precision on Wake: 0.990
[2024-08-05 11:25:34,938] {result_logger:104} INFO - recall on Wake: 0.985
[2024-08-05 11:25:35,348] {result_logger:107} INFO - F1-score on Wake: 0.987
[2024-08-05 11:25:35,349] {result_logger:108} INFO - 
[2024-08-05 11:25:35,916] {result_logger:103} INFO - precision on REM: 0.912
[2024-08-05 11:25:36,270] {result_logger:104} INFO - recall on REM: 0.991
[2024-08-05 11:25:36,624] {result_logger:107} INFO - F1-score on REM: 0.950
[2024-08-05 11:25:36,624] {result_logger:108} INFO - 
[2024-08-05 11:25:37,261] {result_logger:103} INFO - precision on Non REM: 0.979
[2024-08-05 11:25:37,662] {result_logger:104} INFO - recall on Non REM: 0.976
[2024-08-05 11:25:38,064] {result_logger:107} INFO - F1-score on Non REM: 0.978
[2024-08-05 11:25:38,064] {result_logger:108} INFO - 
[2024-08-05 11:25:38,156] {result_logger:111} INFO - average precision on sleep stages: 0.960
[2024-08-05 11:25:38,248] {result_logger:113} INFO - average recall on sleep stages: 0.984
[2024-08-05 11:25:38,340] {result_logger:115} INFO - average F1-score on sleep stages: 0.972
[2024-08-05 11:25:38,341] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:25:38,426] {result_logger:103} INFO - precision on Wake: 0.972
[2024-08-05 11:25:38,476] {result_logger:104} INFO - recall on Wake: 0.982
[2024-08-05 11:25:38,525] {result_logger:107} INFO - F1-score on Wake: 0.977
[2024-08-05 11:25:38,525] {result_logger:108} INFO - 
[2024-08-05 11:25:38,603] {result_logger:103} INFO - precision on REM: 0.860
[2024-08-05 11:25:38,652] {result_logger:104} INFO - recall on REM: 0.950
[2024-08-05 11:25:38,700] {result_logger:107} INFO - F1-score on REM: 0.902
[2024-08-05 11:25:38,700] {result_logger:108} INFO - 
[2024-08-05 11:25:38,783] {result_logger:103} INFO - precision on Non REM: 0.974
[2024-08-05 11:25:38,832] {result_logger:104} INFO - recall on Non REM: 0.948
[2024-08-05 11:25:38,881] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2024-08-05 11:25:38,882] {result_logger:108} INFO - 
[2024-08-05 11:25:38,891] {result_logger:111} INFO - average precision on sleep stages: 0.935
[2024-08-05 11:25:38,902] {result_logger:113} INFO - average recall on sleep stages: 0.960
[2024-08-05 11:25:38,912] {result_logger:115} INFO - average F1-score on sleep stages: 0.947
[2024-08-05 11:25:38,912] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:25:38,975] {result_logger:134} INFO - 
[[200606    320   2821]
 [    44  18432    130]
 [  2006   1454 140307]]
[2024-08-05 11:25:39,038] {result_logger:141} INFO - 
[[ 98.46%   0.16%   1.38%]
 [  0.24%  99.06%   0.70%]
 [  1.40%   1.01%  97.59%]]
[2024-08-05 11:25:39,101] {result_logger:145} INFO - 
[[ 98.99%   1.58%   1.97%]
 [  0.02%  91.22%   0.09%]
 [  0.99%   7.20%  97.94%]]
[2024-08-05 11:25:39,101] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:25:39,108] {result_logger:134} INFO - 
[[27869    92   421]
 [   15  2417   113]
 [  781   303 19619]]
[2024-08-05 11:25:39,116] {result_logger:141} INFO - 
[[ 98.19%   0.32%   1.48%]
 [  0.59%  94.97%   4.44%]
 [  3.77%   1.46%  94.76%]]
[2024-08-05 11:25:39,123] {result_logger:145} INFO - 
[[ 97.22%   3.27%   2.09%]
 [  0.05%  85.95%   0.56%]
 [  2.72%  10.78%  97.35%]]
[2024-08-05 11:25:39,211] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:25:39,211] {result_logger:77} INFO - actual:
[2024-08-05 11:25:39,211] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:25:39,212] {result_logger:79} INFO - predicted:
[2024-08-05 11:25:39,212] {result_logger:80} INFO - 
[[94.86%  0.16%  4.97%]
 [16.00% 79.20%  4.80%]
 [ 5.08%  2.67% 92.25%]]
[2024-08-05 11:25:39,212] {run_experiment:113} INFO - [epoch  28] execution time: 107.43s	 avg f1-score: 0.9466

[2024-08-05 11:25:39,212] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:25:39,237] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:25:53,468] {train_model:82} INFO - Train Epoch: 29 [36352/366120 (10%)]	lr:9.23e-05	Loss: 0.050818
[2024-08-05 11:26:02,522] {train_model:82} INFO - Train Epoch: 29 [72960/366120 (20%)]	lr:9.23e-05	Loss: 0.039332
[2024-08-05 11:26:11,572] {train_model:82} INFO - Train Epoch: 29 [109568/366120 (30%)]	lr:9.23e-05	Loss: 0.005628
[2024-08-05 11:26:20,657] {train_model:82} INFO - Train Epoch: 29 [146176/366120 (40%)]	lr:9.23e-05	Loss: 0.041254
[2024-08-05 11:26:29,778] {train_model:82} INFO - Train Epoch: 29 [182784/366120 (50%)]	lr:9.23e-05	Loss: 0.036131
[2024-08-05 11:26:38,892] {train_model:82} INFO - Train Epoch: 29 [219392/366120 (60%)]	lr:9.23e-05	Loss: 0.018058
[2024-08-05 11:26:48,028] {train_model:82} INFO - Train Epoch: 29 [256000/366120 (70%)]	lr:9.23e-05	Loss: 0.026666
[2024-08-05 11:26:57,213] {train_model:82} INFO - Train Epoch: 29 [292608/366120 (80%)]	lr:9.23e-05	Loss: 0.016697
[2024-08-05 11:27:06,395] {train_model:82} INFO - Train Epoch: 29 [329216/366120 (90%)]	lr:9.23e-05	Loss: 0.039367
[2024-08-05 11:27:15,555] {train_model:82} INFO - Train Epoch: 29 [365824/366120 (100%)]	lr:9.23e-05	Loss: 0.045041
[2024-08-05 11:27:20,405] {run_experiment:79} INFO - 
[2024-08-05 11:27:20,405] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:27:21,052] {result_logger:103} INFO - precision on Wake: 0.991
[2024-08-05 11:27:21,461] {result_logger:104} INFO - recall on Wake: 0.985
[2024-08-05 11:27:21,873] {result_logger:107} INFO - F1-score on Wake: 0.988
[2024-08-05 11:27:21,873] {result_logger:108} INFO - 
[2024-08-05 11:27:22,443] {result_logger:103} INFO - precision on REM: 0.919
[2024-08-05 11:27:22,795] {result_logger:104} INFO - recall on REM: 0.992
[2024-08-05 11:27:23,147] {result_logger:107} INFO - F1-score on REM: 0.954
[2024-08-05 11:27:23,147] {result_logger:108} INFO - 
[2024-08-05 11:27:23,765] {result_logger:103} INFO - precision on Non REM: 0.980
[2024-08-05 11:27:24,164] {result_logger:104} INFO - recall on Non REM: 0.978
[2024-08-05 11:27:24,564] {result_logger:107} INFO - F1-score on Non REM: 0.979
[2024-08-05 11:27:24,564] {result_logger:108} INFO - 
[2024-08-05 11:27:24,655] {result_logger:111} INFO - average precision on sleep stages: 0.963
[2024-08-05 11:27:24,745] {result_logger:113} INFO - average recall on sleep stages: 0.985
[2024-08-05 11:27:24,835] {result_logger:115} INFO - average F1-score on sleep stages: 0.974
[2024-08-05 11:27:24,837] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:27:24,918] {result_logger:103} INFO - precision on Wake: 0.980
[2024-08-05 11:27:24,968] {result_logger:104} INFO - recall on Wake: 0.979
[2024-08-05 11:27:25,018] {result_logger:107} INFO - F1-score on Wake: 0.980
[2024-08-05 11:27:25,018] {result_logger:108} INFO - 
[2024-08-05 11:27:25,096] {result_logger:103} INFO - precision on REM: 0.847
[2024-08-05 11:27:25,144] {result_logger:104} INFO - recall on REM: 0.952
[2024-08-05 11:27:25,192] {result_logger:107} INFO - F1-score on REM: 0.897
[2024-08-05 11:27:25,192] {result_logger:108} INFO - 
[2024-08-05 11:27:25,272] {result_logger:103} INFO - precision on Non REM: 0.970
[2024-08-05 11:27:25,322] {result_logger:104} INFO - recall on Non REM: 0.958
[2024-08-05 11:27:25,373] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2024-08-05 11:27:25,373] {result_logger:108} INFO - 
[2024-08-05 11:27:25,383] {result_logger:111} INFO - average precision on sleep stages: 0.933
[2024-08-05 11:27:25,394] {result_logger:113} INFO - average recall on sleep stages: 0.963
[2024-08-05 11:27:25,404] {result_logger:115} INFO - average F1-score on sleep stages: 0.947
[2024-08-05 11:27:25,404] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:27:25,467] {result_logger:134} INFO - 
[[200759    276   2712]
 [    40  18453    113]
 [  1864   1340 140563]]
[2024-08-05 11:27:25,528] {result_logger:141} INFO - 
[[ 98.53%   0.14%   1.33%]
 [  0.21%  99.18%   0.61%]
 [  1.30%   0.93%  97.77%]]
[2024-08-05 11:27:25,590] {result_logger:145} INFO - 
[[ 99.06%   1.38%   1.89%]
 [  0.02%  91.95%   0.08%]
 [  0.92%   6.68%  98.03%]]
[2024-08-05 11:27:25,590] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:27:25,597] {result_logger:134} INFO - 
[[27774   110   498]
 [   12  2424   109]
 [  542   327 19834]]
[2024-08-05 11:27:25,604] {result_logger:141} INFO - 
[[ 97.86%   0.39%   1.75%]
 [  0.47%  95.25%   4.28%]
 [  2.62%   1.58%  95.80%]]
[2024-08-05 11:27:25,612] {result_logger:145} INFO - 
[[ 98.04%   3.84%   2.44%]
 [  0.04%  84.73%   0.53%]
 [  1.91%  11.43%  97.03%]]
[2024-08-05 11:27:25,700] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:27:25,700] {result_logger:77} INFO - actual:
[2024-08-05 11:27:25,700] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:27:25,700] {result_logger:79} INFO - predicted:
[2024-08-05 11:27:25,700] {result_logger:80} INFO - 
[[95.07%  0.20%  4.73%]
 [16.15% 78.54%  5.31%]
 [ 4.57%  2.72% 92.71%]]
[2024-08-05 11:27:25,700] {run_experiment:113} INFO - [epoch  29] execution time: 106.49s	 avg f1-score: 0.9468

[2024-08-05 11:27:25,700] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:27:25,725] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:27:40,318] {train_model:82} INFO - Train Epoch: 30 [36352/366120 (10%)]	lr:8.69e-05	Loss: 0.035054
[2024-08-05 11:27:49,350] {train_model:82} INFO - Train Epoch: 30 [72960/366120 (20%)]	lr:8.69e-05	Loss: 0.055276
[2024-08-05 11:27:58,405] {train_model:82} INFO - Train Epoch: 30 [109568/366120 (30%)]	lr:8.69e-05	Loss: 0.043424
[2024-08-05 11:28:07,492] {train_model:82} INFO - Train Epoch: 30 [146176/366120 (40%)]	lr:8.69e-05	Loss: 0.028767
[2024-08-05 11:28:16,602] {train_model:82} INFO - Train Epoch: 30 [182784/366120 (50%)]	lr:8.69e-05	Loss: 0.046638
[2024-08-05 11:28:25,714] {train_model:82} INFO - Train Epoch: 30 [219392/366120 (60%)]	lr:8.69e-05	Loss: 0.039797
[2024-08-05 11:28:34,853] {train_model:82} INFO - Train Epoch: 30 [256000/366120 (70%)]	lr:8.69e-05	Loss: 0.037196
[2024-08-05 11:28:44,018] {train_model:82} INFO - Train Epoch: 30 [292608/366120 (80%)]	lr:8.69e-05	Loss: 0.051841
[2024-08-05 11:28:53,199] {train_model:82} INFO - Train Epoch: 30 [329216/366120 (90%)]	lr:8.69e-05	Loss: 0.033475
[2024-08-05 11:29:02,372] {train_model:82} INFO - Train Epoch: 30 [365824/366120 (100%)]	lr:8.69e-05	Loss: 0.059848
[2024-08-05 11:29:07,539] {run_experiment:79} INFO - 
[2024-08-05 11:29:07,539] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:29:08,181] {result_logger:103} INFO - precision on Wake: 0.991
[2024-08-05 11:29:08,591] {result_logger:104} INFO - recall on Wake: 0.986
[2024-08-05 11:29:09,001] {result_logger:107} INFO - F1-score on Wake: 0.988
[2024-08-05 11:29:09,002] {result_logger:108} INFO - 
[2024-08-05 11:29:09,583] {result_logger:103} INFO - precision on REM: 0.928
[2024-08-05 11:29:09,934] {result_logger:104} INFO - recall on REM: 0.993
[2024-08-05 11:29:10,286] {result_logger:107} INFO - F1-score on REM: 0.959
[2024-08-05 11:29:10,286] {result_logger:108} INFO - 
[2024-08-05 11:29:10,905] {result_logger:103} INFO - precision on Non REM: 0.982
[2024-08-05 11:29:11,306] {result_logger:104} INFO - recall on Non REM: 0.979
[2024-08-05 11:29:11,708] {result_logger:107} INFO - F1-score on Non REM: 0.980
[2024-08-05 11:29:11,708] {result_logger:108} INFO - 
[2024-08-05 11:29:11,800] {result_logger:111} INFO - average precision on sleep stages: 0.967
[2024-08-05 11:29:11,891] {result_logger:113} INFO - average recall on sleep stages: 0.986
[2024-08-05 11:29:11,982] {result_logger:115} INFO - average F1-score on sleep stages: 0.976
[2024-08-05 11:29:11,983] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:29:12,065] {result_logger:103} INFO - precision on Wake: 0.981
[2024-08-05 11:29:12,115] {result_logger:104} INFO - recall on Wake: 0.977
[2024-08-05 11:29:12,165] {result_logger:107} INFO - F1-score on Wake: 0.979
[2024-08-05 11:29:12,165] {result_logger:108} INFO - 
[2024-08-05 11:29:12,245] {result_logger:103} INFO - precision on REM: 0.866
[2024-08-05 11:29:12,293] {result_logger:104} INFO - recall on REM: 0.941
[2024-08-05 11:29:12,341] {result_logger:107} INFO - F1-score on REM: 0.902
[2024-08-05 11:29:12,341] {result_logger:108} INFO - 
[2024-08-05 11:29:12,422] {result_logger:103} INFO - precision on Non REM: 0.967
[2024-08-05 11:29:12,472] {result_logger:104} INFO - recall on Non REM: 0.962
[2024-08-05 11:29:12,521] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2024-08-05 11:29:12,521] {result_logger:108} INFO - 
[2024-08-05 11:29:12,532] {result_logger:111} INFO - average precision on sleep stages: 0.938
[2024-08-05 11:29:12,542] {result_logger:113} INFO - average recall on sleep stages: 0.960
[2024-08-05 11:29:12,553] {result_logger:115} INFO - average F1-score on sleep stages: 0.949
[2024-08-05 11:29:12,553] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:29:12,616] {result_logger:134} INFO - 
[[200926    279   2542]
 [    37  18468    101]
 [  1827   1149 140791]]
[2024-08-05 11:29:12,679] {result_logger:141} INFO - 
[[ 98.62%   0.14%   1.25%]
 [  0.20%  99.26%   0.54%]
 [  1.27%   0.80%  97.93%]]
[2024-08-05 11:29:12,741] {result_logger:145} INFO - 
[[ 99.08%   1.40%   1.77%]
 [  0.02%  92.82%   0.07%]
 [  0.90%   5.78%  98.16%]]
[2024-08-05 11:29:12,741] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:29:12,748] {result_logger:134} INFO - 
[[27729   108   545]
 [   17  2396   132]
 [  529   262 19912]]
[2024-08-05 11:29:12,756] {result_logger:141} INFO - 
[[ 97.70%   0.38%   1.92%]
 [  0.67%  94.15%   5.19%]
 [  2.56%   1.27%  96.18%]]
[2024-08-05 11:29:12,763] {result_logger:145} INFO - 
[[ 98.07%   3.90%   2.65%]
 [  0.06%  86.62%   0.64%]
 [  1.87%   9.47%  96.71%]]
[2024-08-05 11:29:12,851] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:29:12,851] {result_logger:77} INFO - actual:
[2024-08-05 11:29:12,851] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:29:12,851] {result_logger:79} INFO - predicted:
[2024-08-05 11:29:12,851] {result_logger:80} INFO - 
[[95.01%  0.21%  4.78%]
 [16.88% 78.60%  4.52%]
 [ 4.58%  2.59% 92.83%]]
[2024-08-05 11:29:12,851] {run_experiment:113} INFO - [epoch  30] execution time: 107.15s	 avg f1-score: 0.9485

[2024-08-05 11:29:12,851] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:29:12,877] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:29:27,153] {train_model:82} INFO - Train Epoch: 31 [36352/366120 (10%)]	lr:8.19e-05	Loss: 0.035561
[2024-08-05 11:29:36,255] {train_model:82} INFO - Train Epoch: 31 [72960/366120 (20%)]	lr:8.19e-05	Loss: 0.066162
[2024-08-05 11:29:45,336] {train_model:82} INFO - Train Epoch: 31 [109568/366120 (30%)]	lr:8.19e-05	Loss: 0.010051
[2024-08-05 11:29:54,447] {train_model:82} INFO - Train Epoch: 31 [146176/366120 (40%)]	lr:8.19e-05	Loss: 0.028254
[2024-08-05 11:30:03,567] {train_model:82} INFO - Train Epoch: 31 [182784/366120 (50%)]	lr:8.19e-05	Loss: 0.050674
[2024-08-05 11:30:12,705] {train_model:82} INFO - Train Epoch: 31 [219392/366120 (60%)]	lr:8.19e-05	Loss: 0.031792
[2024-08-05 11:30:21,884] {train_model:82} INFO - Train Epoch: 31 [256000/366120 (70%)]	lr:8.19e-05	Loss: 0.059319
[2024-08-05 11:30:31,064] {train_model:82} INFO - Train Epoch: 31 [292608/366120 (80%)]	lr:8.19e-05	Loss: 0.061171
[2024-08-05 11:30:40,266] {train_model:82} INFO - Train Epoch: 31 [329216/366120 (90%)]	lr:8.19e-05	Loss: 0.036598
[2024-08-05 11:30:49,436] {train_model:82} INFO - Train Epoch: 31 [365824/366120 (100%)]	lr:8.19e-05	Loss: 0.048014
[2024-08-05 11:30:54,376] {run_experiment:79} INFO - 
[2024-08-05 11:30:54,376] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:30:55,043] {result_logger:103} INFO - precision on Wake: 0.991
[2024-08-05 11:30:55,455] {result_logger:104} INFO - recall on Wake: 0.987
[2024-08-05 11:30:55,865] {result_logger:107} INFO - F1-score on Wake: 0.989
[2024-08-05 11:30:55,866] {result_logger:108} INFO - 
[2024-08-05 11:30:56,449] {result_logger:103} INFO - precision on REM: 0.934
[2024-08-05 11:30:56,801] {result_logger:104} INFO - recall on REM: 0.993
[2024-08-05 11:30:57,154] {result_logger:107} INFO - F1-score on REM: 0.963
[2024-08-05 11:30:57,154] {result_logger:108} INFO - 
[2024-08-05 11:30:57,791] {result_logger:103} INFO - precision on Non REM: 0.982
[2024-08-05 11:30:58,193] {result_logger:104} INFO - recall on Non REM: 0.980
[2024-08-05 11:30:58,594] {result_logger:107} INFO - F1-score on Non REM: 0.981
[2024-08-05 11:30:58,594] {result_logger:108} INFO - 
[2024-08-05 11:30:58,692] {result_logger:111} INFO - average precision on sleep stages: 0.969
[2024-08-05 11:30:58,784] {result_logger:113} INFO - average recall on sleep stages: 0.987
[2024-08-05 11:30:58,877] {result_logger:115} INFO - average F1-score on sleep stages: 0.978
[2024-08-05 11:30:58,880] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:30:58,966] {result_logger:103} INFO - precision on Wake: 0.984
[2024-08-05 11:30:59,015] {result_logger:104} INFO - recall on Wake: 0.979
[2024-08-05 11:30:59,064] {result_logger:107} INFO - F1-score on Wake: 0.981
[2024-08-05 11:30:59,064] {result_logger:108} INFO - 
[2024-08-05 11:30:59,145] {result_logger:103} INFO - precision on REM: 0.867
[2024-08-05 11:30:59,193] {result_logger:104} INFO - recall on REM: 0.944
[2024-08-05 11:30:59,241] {result_logger:107} INFO - F1-score on REM: 0.904
[2024-08-05 11:30:59,241] {result_logger:108} INFO - 
[2024-08-05 11:30:59,324] {result_logger:103} INFO - precision on Non REM: 0.968
[2024-08-05 11:30:59,374] {result_logger:104} INFO - recall on Non REM: 0.964
[2024-08-05 11:30:59,424] {result_logger:107} INFO - F1-score on Non REM: 0.966
[2024-08-05 11:30:59,424] {result_logger:108} INFO - 
[2024-08-05 11:30:59,434] {result_logger:111} INFO - average precision on sleep stages: 0.940
[2024-08-05 11:30:59,444] {result_logger:113} INFO - average recall on sleep stages: 0.962
[2024-08-05 11:30:59,455] {result_logger:115} INFO - average F1-score on sleep stages: 0.950
[2024-08-05 11:30:59,455] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:30:59,519] {result_logger:134} INFO - 
[[201017    235   2495]
 [    33  18478     95]
 [  1736   1072 140959]]
[2024-08-05 11:30:59,582] {result_logger:141} INFO - 
[[ 98.66%   0.12%   1.22%]
 [  0.18%  99.31%   0.51%]
 [  1.21%   0.75%  98.05%]]
[2024-08-05 11:30:59,645] {result_logger:145} INFO - 
[[ 99.13%   1.19%   1.74%]
 [  0.02%  93.39%   0.07%]
 [  0.86%   5.42%  98.20%]]
[2024-08-05 11:30:59,646] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:30:59,653] {result_logger:134} INFO - 
[[27786    75   521]
 [   13  2402   130]
 [  452   294 19957]]
[2024-08-05 11:30:59,660] {result_logger:141} INFO - 
[[ 97.90%   0.26%   1.84%]
 [  0.51%  94.38%   5.11%]
 [  2.18%   1.42%  96.40%]]
[2024-08-05 11:30:59,668] {result_logger:145} INFO - 
[[ 98.35%   2.71%   2.53%]
 [  0.05%  86.68%   0.63%]
 [  1.60%  10.61%  96.84%]]
[2024-08-05 11:30:59,756] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:30:59,756] {result_logger:77} INFO - actual:
[2024-08-05 11:30:59,756] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:30:59,756] {result_logger:79} INFO - predicted:
[2024-08-05 11:30:59,756] {result_logger:80} INFO - 
[[95.48%  0.13%  4.39%]
 [15.41% 79.00%  5.59%]
 [ 4.12%  2.64% 93.24%]]
[2024-08-05 11:30:59,756] {run_experiment:113} INFO - [epoch  31] execution time: 106.90s	 avg f1-score: 0.9504

[2024-08-05 11:30:59,756] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:30:59,781] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:31:14,056] {train_model:82} INFO - Train Epoch: 32 [36352/366120 (10%)]	lr:7.71e-05	Loss: 0.025683
[2024-08-05 11:31:23,115] {train_model:82} INFO - Train Epoch: 32 [72960/366120 (20%)]	lr:7.71e-05	Loss: 0.052261
[2024-08-05 11:31:32,215] {train_model:82} INFO - Train Epoch: 32 [109568/366120 (30%)]	lr:7.71e-05	Loss: 0.035149
[2024-08-05 11:31:41,337] {train_model:82} INFO - Train Epoch: 32 [146176/366120 (40%)]	lr:7.71e-05	Loss: 0.093158
[2024-08-05 11:31:50,464] {train_model:82} INFO - Train Epoch: 32 [182784/366120 (50%)]	lr:7.71e-05	Loss: 0.026978
[2024-08-05 11:31:59,604] {train_model:82} INFO - Train Epoch: 32 [219392/366120 (60%)]	lr:7.71e-05	Loss: 0.032271
[2024-08-05 11:32:08,768] {train_model:82} INFO - Train Epoch: 32 [256000/366120 (70%)]	lr:7.71e-05	Loss: 0.014235
[2024-08-05 11:32:17,978] {train_model:82} INFO - Train Epoch: 32 [292608/366120 (80%)]	lr:7.71e-05	Loss: 0.069371
[2024-08-05 11:32:27,198] {train_model:82} INFO - Train Epoch: 32 [329216/366120 (90%)]	lr:7.71e-05	Loss: 0.032902
[2024-08-05 11:32:36,355] {train_model:82} INFO - Train Epoch: 32 [365824/366120 (100%)]	lr:7.71e-05	Loss: 0.059244
[2024-08-05 11:32:41,692] {run_experiment:79} INFO - 
[2024-08-05 11:32:41,692] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:32:42,343] {result_logger:103} INFO - precision on Wake: 0.992
[2024-08-05 11:32:42,759] {result_logger:104} INFO - recall on Wake: 0.987
[2024-08-05 11:32:43,175] {result_logger:107} INFO - F1-score on Wake: 0.990
[2024-08-05 11:32:43,175] {result_logger:108} INFO - 
[2024-08-05 11:32:43,766] {result_logger:103} INFO - precision on REM: 0.935
[2024-08-05 11:32:44,123] {result_logger:104} INFO - recall on REM: 0.994
[2024-08-05 11:32:44,481] {result_logger:107} INFO - F1-score on REM: 0.964
[2024-08-05 11:32:44,481] {result_logger:108} INFO - 
[2024-08-05 11:32:45,106] {result_logger:103} INFO - precision on Non REM: 0.983
[2024-08-05 11:32:45,512] {result_logger:104} INFO - recall on Non REM: 0.982
[2024-08-05 11:32:45,918] {result_logger:107} INFO - F1-score on Non REM: 0.982
[2024-08-05 11:32:45,918] {result_logger:108} INFO - 
[2024-08-05 11:32:46,011] {result_logger:111} INFO - average precision on sleep stages: 0.970
[2024-08-05 11:32:46,104] {result_logger:113} INFO - average recall on sleep stages: 0.988
[2024-08-05 11:32:46,197] {result_logger:115} INFO - average F1-score on sleep stages: 0.978
[2024-08-05 11:32:46,198] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:32:46,280] {result_logger:103} INFO - precision on Wake: 0.980
[2024-08-05 11:32:46,330] {result_logger:104} INFO - recall on Wake: 0.982
[2024-08-05 11:32:46,379] {result_logger:107} INFO - F1-score on Wake: 0.981
[2024-08-05 11:32:46,379] {result_logger:108} INFO - 
[2024-08-05 11:32:46,460] {result_logger:103} INFO - precision on REM: 0.887
[2024-08-05 11:32:46,509] {result_logger:104} INFO - recall on REM: 0.925
[2024-08-05 11:32:46,557] {result_logger:107} INFO - F1-score on REM: 0.906
[2024-08-05 11:32:46,557] {result_logger:108} INFO - 
[2024-08-05 11:32:46,638] {result_logger:103} INFO - precision on Non REM: 0.970
[2024-08-05 11:32:46,688] {result_logger:104} INFO - recall on Non REM: 0.963
[2024-08-05 11:32:46,738] {result_logger:107} INFO - F1-score on Non REM: 0.966
[2024-08-05 11:32:46,738] {result_logger:108} INFO - 
[2024-08-05 11:32:46,748] {result_logger:111} INFO - average precision on sleep stages: 0.946
[2024-08-05 11:32:46,759] {result_logger:113} INFO - average recall on sleep stages: 0.957
[2024-08-05 11:32:46,768] {result_logger:115} INFO - average F1-score on sleep stages: 0.951
[2024-08-05 11:32:46,768] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:32:46,832] {result_logger:134} INFO - 
[[201155    255   2337]
 [    24  18493     89]
 [  1625   1030 141112]]
[2024-08-05 11:32:46,895] {result_logger:141} INFO - 
[[ 98.73%   0.13%   1.15%]
 [  0.13%  99.39%   0.48%]
 [  1.13%   0.72%  98.15%]]
[2024-08-05 11:32:46,959] {result_logger:145} INFO - 
[[ 99.19%   1.29%   1.63%]
 [  0.01%  93.50%   0.06%]
 [  0.80%   5.21%  98.31%]]
[2024-08-05 11:32:46,959] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:32:46,966] {result_logger:134} INFO - 
[[27859    72   451]
 [   21  2355   169]
 [  545   227 19931]]
[2024-08-05 11:32:47,060] {result_logger:141} INFO - 
[[ 98.16%   0.25%   1.59%]
 [  0.83%  92.53%   6.64%]
 [  2.63%   1.10%  96.27%]]
[2024-08-05 11:32:47,149] {result_logger:145} INFO - 
[[ 98.01%   2.71%   2.19%]
 [  0.07%  88.73%   0.82%]
 [  1.92%   8.55%  96.98%]]
[2024-08-05 11:32:47,403] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:32:47,403] {result_logger:77} INFO - actual:
[2024-08-05 11:32:47,403] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:32:47,403] {result_logger:79} INFO - predicted:
[2024-08-05 11:32:47,404] {result_logger:80} INFO - 
[[95.12%  0.12%  4.76%]
 [16.73% 79.01%  4.26%]
 [ 4.59%  2.54% 92.86%]]
[2024-08-05 11:32:47,460] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_E_weighted/model_8conv_2fc-best.pth
[2024-08-05 11:32:47,460] {run_experiment:113} INFO - [epoch  32] execution time: 107.70s	 avg f1-score: 0.9510

[2024-08-05 11:32:47,460] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:32:47,486] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:33:01,861] {train_model:82} INFO - Train Epoch: 33 [36352/366120 (10%)]	lr:7.26e-05	Loss: 0.081529
[2024-08-05 11:33:10,954] {train_model:82} INFO - Train Epoch: 33 [72960/366120 (20%)]	lr:7.26e-05	Loss: 0.025236
[2024-08-05 11:33:20,002] {train_model:82} INFO - Train Epoch: 33 [109568/366120 (30%)]	lr:7.26e-05	Loss: 0.021224
[2024-08-05 11:33:29,124] {train_model:82} INFO - Train Epoch: 33 [146176/366120 (40%)]	lr:7.26e-05	Loss: 0.068500
[2024-08-05 11:33:38,278] {train_model:82} INFO - Train Epoch: 33 [182784/366120 (50%)]	lr:7.26e-05	Loss: 0.017884
[2024-08-05 11:33:47,453] {train_model:82} INFO - Train Epoch: 33 [219392/366120 (60%)]	lr:7.26e-05	Loss: 0.030641
[2024-08-05 11:33:56,692] {train_model:82} INFO - Train Epoch: 33 [256000/366120 (70%)]	lr:7.26e-05	Loss: 0.035437
[2024-08-05 11:34:05,949] {train_model:82} INFO - Train Epoch: 33 [292608/366120 (80%)]	lr:7.26e-05	Loss: 0.048229
[2024-08-05 11:34:15,218] {train_model:82} INFO - Train Epoch: 33 [329216/366120 (90%)]	lr:7.26e-05	Loss: 0.030212
[2024-08-05 11:34:24,371] {train_model:82} INFO - Train Epoch: 33 [365824/366120 (100%)]	lr:7.26e-05	Loss: 0.036766
[2024-08-05 11:34:29,579] {run_experiment:79} INFO - 
[2024-08-05 11:34:29,579] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:34:30,219] {result_logger:103} INFO - precision on Wake: 0.992
[2024-08-05 11:34:30,632] {result_logger:104} INFO - recall on Wake: 0.988
[2024-08-05 11:34:31,044] {result_logger:107} INFO - F1-score on Wake: 0.990
[2024-08-05 11:34:31,044] {result_logger:108} INFO - 
[2024-08-05 11:34:31,633] {result_logger:103} INFO - precision on REM: 0.939
[2024-08-05 11:34:31,987] {result_logger:104} INFO - recall on REM: 0.994
[2024-08-05 11:34:32,342] {result_logger:107} INFO - F1-score on REM: 0.966
[2024-08-05 11:34:32,342] {result_logger:108} INFO - 
[2024-08-05 11:34:32,969] {result_logger:103} INFO - precision on Non REM: 0.984
[2024-08-05 11:34:33,374] {result_logger:104} INFO - recall on Non REM: 0.982
[2024-08-05 11:34:33,779] {result_logger:107} INFO - F1-score on Non REM: 0.983
[2024-08-05 11:34:33,779] {result_logger:108} INFO - 
[2024-08-05 11:34:33,865] {result_logger:111} INFO - average precision on sleep stages: 0.972
[2024-08-05 11:34:33,951] {result_logger:113} INFO - average recall on sleep stages: 0.988
[2024-08-05 11:34:34,037] {result_logger:115} INFO - average F1-score on sleep stages: 0.980
[2024-08-05 11:34:34,039] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:34:34,120] {result_logger:103} INFO - precision on Wake: 0.980
[2024-08-05 11:34:34,169] {result_logger:104} INFO - recall on Wake: 0.979
[2024-08-05 11:34:34,219] {result_logger:107} INFO - F1-score on Wake: 0.980
[2024-08-05 11:34:34,219] {result_logger:108} INFO - 
[2024-08-05 11:34:34,301] {result_logger:103} INFO - precision on REM: 0.874
[2024-08-05 11:34:34,349] {result_logger:104} INFO - recall on REM: 0.934
[2024-08-05 11:34:34,397] {result_logger:107} INFO - F1-score on REM: 0.903
[2024-08-05 11:34:34,397] {result_logger:108} INFO - 
[2024-08-05 11:34:34,479] {result_logger:103} INFO - precision on Non REM: 0.969
[2024-08-05 11:34:34,528] {result_logger:104} INFO - recall on Non REM: 0.961
[2024-08-05 11:34:34,579] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2024-08-05 11:34:34,579] {result_logger:108} INFO - 
[2024-08-05 11:34:34,589] {result_logger:111} INFO - average precision on sleep stages: 0.941
[2024-08-05 11:34:34,599] {result_logger:113} INFO - average recall on sleep stages: 0.958
[2024-08-05 11:34:34,609] {result_logger:115} INFO - average F1-score on sleep stages: 0.949
[2024-08-05 11:34:34,609] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:34:34,669] {result_logger:134} INFO - 
[[201274    218   2255]
 [    27  18494     85]
 [  1614    973 141180]]
[2024-08-05 11:34:34,727] {result_logger:141} INFO - 
[[ 98.79%   0.11%   1.11%]
 [  0.15%  99.40%   0.46%]
 [  1.12%   0.68%  98.20%]]
[2024-08-05 11:34:34,785] {result_logger:145} INFO - 
[[ 99.19%   1.11%   1.57%]
 [  0.01%  93.95%   0.06%]
 [  0.80%   4.94%  98.37%]]
[2024-08-05 11:34:34,786] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:34:34,793] {result_logger:134} INFO - 
[[27797    91   494]
 [   20  2378   147]
 [  558   253 19892]]
[2024-08-05 11:34:34,800] {result_logger:141} INFO - 
[[ 97.94%   0.32%   1.74%]
 [  0.79%  93.44%   5.78%]
 [  2.70%   1.22%  96.08%]]
[2024-08-05 11:34:34,807] {result_logger:145} INFO - 
[[ 97.96%   3.34%   2.41%]
 [  0.07%  87.36%   0.72%]
 [  1.97%   9.29%  96.88%]]
[2024-08-05 11:34:34,896] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:34:34,896] {result_logger:77} INFO - actual:
[2024-08-05 11:34:34,896] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:34:34,896] {result_logger:79} INFO - predicted:
[2024-08-05 11:34:34,897] {result_logger:80} INFO - 
[[95.27%  0.19%  4.54%]
 [16.64% 78.91%  4.45%]
 [ 4.33%  2.53% 93.14%]]
[2024-08-05 11:34:34,897] {run_experiment:113} INFO - [epoch  33] execution time: 107.44s	 avg f1-score: 0.9491

[2024-08-05 11:34:34,897] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:34:34,923] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:34:49,200] {train_model:82} INFO - Train Epoch: 34 [36352/366120 (10%)]	lr:6.84e-05	Loss: 0.013409
[2024-08-05 11:34:58,288] {train_model:82} INFO - Train Epoch: 34 [72960/366120 (20%)]	lr:6.84e-05	Loss: 0.050973
[2024-08-05 11:35:07,403] {train_model:82} INFO - Train Epoch: 34 [109568/366120 (30%)]	lr:6.84e-05	Loss: 0.045086
[2024-08-05 11:35:16,550] {train_model:82} INFO - Train Epoch: 34 [146176/366120 (40%)]	lr:6.84e-05	Loss: 0.019122
[2024-08-05 11:35:25,754] {train_model:82} INFO - Train Epoch: 34 [182784/366120 (50%)]	lr:6.84e-05	Loss: 0.009072
[2024-08-05 11:35:34,999] {train_model:82} INFO - Train Epoch: 34 [219392/366120 (60%)]	lr:6.84e-05	Loss: 0.059875
[2024-08-05 11:35:44,280] {train_model:82} INFO - Train Epoch: 34 [256000/366120 (70%)]	lr:6.84e-05	Loss: 0.029797
[2024-08-05 11:35:53,585] {train_model:82} INFO - Train Epoch: 34 [292608/366120 (80%)]	lr:6.84e-05	Loss: 0.044554
[2024-08-05 11:36:02,950] {train_model:82} INFO - Train Epoch: 34 [329216/366120 (90%)]	lr:6.84e-05	Loss: 0.026225
[2024-08-05 11:36:12,108] {train_model:82} INFO - Train Epoch: 34 [365824/366120 (100%)]	lr:6.84e-05	Loss: 0.036460
[2024-08-05 11:36:17,449] {run_experiment:79} INFO - 
[2024-08-05 11:36:17,449] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:36:18,116] {result_logger:103} INFO - precision on Wake: 0.993
[2024-08-05 11:36:18,525] {result_logger:104} INFO - recall on Wake: 0.989
[2024-08-05 11:36:18,934] {result_logger:107} INFO - F1-score on Wake: 0.991
[2024-08-05 11:36:18,934] {result_logger:108} INFO - 
[2024-08-05 11:36:19,517] {result_logger:103} INFO - precision on REM: 0.945
[2024-08-05 11:36:19,869] {result_logger:104} INFO - recall on REM: 0.994
[2024-08-05 11:36:20,221] {result_logger:107} INFO - F1-score on REM: 0.969
[2024-08-05 11:36:20,221] {result_logger:108} INFO - 
[2024-08-05 11:36:20,852] {result_logger:103} INFO - precision on Non REM: 0.985
[2024-08-05 11:36:21,251] {result_logger:104} INFO - recall on Non REM: 0.984
[2024-08-05 11:36:21,648] {result_logger:107} INFO - F1-score on Non REM: 0.984
[2024-08-05 11:36:21,648] {result_logger:108} INFO - 
[2024-08-05 11:36:21,736] {result_logger:111} INFO - average precision on sleep stages: 0.974
[2024-08-05 11:36:21,824] {result_logger:113} INFO - average recall on sleep stages: 0.989
[2024-08-05 11:36:21,912] {result_logger:115} INFO - average F1-score on sleep stages: 0.981
[2024-08-05 11:36:21,913] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:36:21,998] {result_logger:103} INFO - precision on Wake: 0.981
[2024-08-05 11:36:22,048] {result_logger:104} INFO - recall on Wake: 0.978
[2024-08-05 11:36:22,096] {result_logger:107} INFO - F1-score on Wake: 0.979
[2024-08-05 11:36:22,096] {result_logger:108} INFO - 
[2024-08-05 11:36:22,177] {result_logger:103} INFO - precision on REM: 0.862
[2024-08-05 11:36:22,225] {result_logger:104} INFO - recall on REM: 0.941
[2024-08-05 11:36:22,273] {result_logger:107} INFO - F1-score on REM: 0.900
[2024-08-05 11:36:22,273] {result_logger:108} INFO - 
[2024-08-05 11:36:22,356] {result_logger:103} INFO - precision on Non REM: 0.967
[2024-08-05 11:36:22,406] {result_logger:104} INFO - recall on Non REM: 0.960
[2024-08-05 11:36:22,456] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2024-08-05 11:36:22,457] {result_logger:108} INFO - 
[2024-08-05 11:36:22,467] {result_logger:111} INFO - average precision on sleep stages: 0.937
[2024-08-05 11:36:22,478] {result_logger:113} INFO - average recall on sleep stages: 0.960
[2024-08-05 11:36:22,488] {result_logger:115} INFO - average F1-score on sleep stages: 0.948
[2024-08-05 11:36:22,488] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:36:22,549] {result_logger:134} INFO - 
[[201483    210   2054]
 [    18  18495     93]
 [  1484    865 141418]]
[2024-08-05 11:36:22,610] {result_logger:141} INFO - 
[[ 98.89%   0.10%   1.01%]
 [  0.10%  99.40%   0.50%]
 [  1.03%   0.60%  98.37%]]
[2024-08-05 11:36:22,670] {result_logger:145} INFO - 
[[ 99.26%   1.07%   1.43%]
 [  0.01%  94.51%   0.06%]
 [  0.73%   4.42%  98.50%]]
[2024-08-05 11:36:22,670] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:36:22,677] {result_logger:134} INFO - 
[[27753    75   554]
 [   24  2396   125]
 [  517   307 19879]]
[2024-08-05 11:36:22,685] {result_logger:141} INFO - 
[[ 97.78%   0.26%   1.95%]
 [  0.94%  94.15%   4.91%]
 [  2.50%   1.48%  96.02%]]
[2024-08-05 11:36:22,692] {result_logger:145} INFO - 
[[ 98.09%   2.70%   2.69%]
 [  0.08%  86.25%   0.61%]
 [  1.83%  11.05%  96.70%]]
[2024-08-05 11:36:22,779] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:36:22,780] {result_logger:77} INFO - actual:
[2024-08-05 11:36:22,780] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:36:22,780] {result_logger:79} INFO - predicted:
[2024-08-05 11:36:22,780] {result_logger:80} INFO - 
[[94.96%  0.16%  4.88%]
 [16.45% 78.65%  4.90%]
 [ 4.71%  2.67% 92.63%]]
[2024-08-05 11:36:22,780] {run_experiment:113} INFO - [epoch  34] execution time: 107.88s	 avg f1-score: 0.9477

[2024-08-05 11:36:22,780] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:36:22,805] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:36:37,295] {train_model:82} INFO - Train Epoch: 35 [36352/366120 (10%)]	lr:6.44e-05	Loss: 0.014952
[2024-08-05 11:36:46,385] {train_model:82} INFO - Train Epoch: 35 [72960/366120 (20%)]	lr:6.44e-05	Loss: 0.030629
[2024-08-05 11:36:55,506] {train_model:82} INFO - Train Epoch: 35 [109568/366120 (30%)]	lr:6.44e-05	Loss: 0.016877
[2024-08-05 11:37:04,659] {train_model:82} INFO - Train Epoch: 35 [146176/366120 (40%)]	lr:6.44e-05	Loss: 0.026945
[2024-08-05 11:37:13,840] {train_model:82} INFO - Train Epoch: 35 [182784/366120 (50%)]	lr:6.44e-05	Loss: 0.039579
[2024-08-05 11:37:23,019] {train_model:82} INFO - Train Epoch: 35 [219392/366120 (60%)]	lr:6.44e-05	Loss: 0.034875
[2024-08-05 11:37:32,221] {train_model:82} INFO - Train Epoch: 35 [256000/366120 (70%)]	lr:6.44e-05	Loss: 0.028150
[2024-08-05 11:37:41,462] {train_model:82} INFO - Train Epoch: 35 [292608/366120 (80%)]	lr:6.44e-05	Loss: 0.024948
[2024-08-05 11:37:50,639] {train_model:82} INFO - Train Epoch: 35 [329216/366120 (90%)]	lr:6.44e-05	Loss: 0.036614
[2024-08-05 11:37:59,797] {train_model:82} INFO - Train Epoch: 35 [365824/366120 (100%)]	lr:6.44e-05	Loss: 0.009373
[2024-08-05 11:38:04,990] {run_experiment:79} INFO - 
[2024-08-05 11:38:04,991] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:38:05,660] {result_logger:103} INFO - precision on Wake: 0.993
[2024-08-05 11:38:06,074] {result_logger:104} INFO - recall on Wake: 0.989
[2024-08-05 11:38:06,488] {result_logger:107} INFO - F1-score on Wake: 0.991
[2024-08-05 11:38:06,488] {result_logger:108} INFO - 
[2024-08-05 11:38:07,076] {result_logger:103} INFO - precision on REM: 0.947
[2024-08-05 11:38:07,432] {result_logger:104} INFO - recall on REM: 0.994
[2024-08-05 11:38:07,792] {result_logger:107} INFO - F1-score on REM: 0.970
[2024-08-05 11:38:07,792] {result_logger:108} INFO - 
[2024-08-05 11:38:08,411] {result_logger:103} INFO - precision on Non REM: 0.985
[2024-08-05 11:38:08,817] {result_logger:104} INFO - recall on Non REM: 0.985
[2024-08-05 11:38:09,219] {result_logger:107} INFO - F1-score on Non REM: 0.985
[2024-08-05 11:38:09,219] {result_logger:108} INFO - 
[2024-08-05 11:38:09,307] {result_logger:111} INFO - average precision on sleep stages: 0.975
[2024-08-05 11:38:09,396] {result_logger:113} INFO - average recall on sleep stages: 0.989
[2024-08-05 11:38:09,485] {result_logger:115} INFO - average F1-score on sleep stages: 0.982
[2024-08-05 11:38:09,486] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:38:09,568] {result_logger:103} INFO - precision on Wake: 0.981
[2024-08-05 11:38:09,617] {result_logger:104} INFO - recall on Wake: 0.976
[2024-08-05 11:38:09,667] {result_logger:107} INFO - F1-score on Wake: 0.979
[2024-08-05 11:38:09,667] {result_logger:108} INFO - 
[2024-08-05 11:38:09,748] {result_logger:103} INFO - precision on REM: 0.855
[2024-08-05 11:38:09,796] {result_logger:104} INFO - recall on REM: 0.941
[2024-08-05 11:38:09,843] {result_logger:107} INFO - F1-score on REM: 0.896
[2024-08-05 11:38:09,844] {result_logger:108} INFO - 
[2024-08-05 11:38:09,924] {result_logger:103} INFO - precision on Non REM: 0.965
[2024-08-05 11:38:09,973] {result_logger:104} INFO - recall on Non REM: 0.960
[2024-08-05 11:38:10,022] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2024-08-05 11:38:10,022] {result_logger:108} INFO - 
[2024-08-05 11:38:10,032] {result_logger:111} INFO - average precision on sleep stages: 0.934
[2024-08-05 11:38:10,042] {result_logger:113} INFO - average recall on sleep stages: 0.959
[2024-08-05 11:38:10,053] {result_logger:115} INFO - average F1-score on sleep stages: 0.946
[2024-08-05 11:38:10,053] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:38:10,115] {result_logger:134} INFO - 
[[201531    182   2034]
 [    24  18495     87]
 [  1379    846 141542]]
[2024-08-05 11:38:10,175] {result_logger:141} INFO - 
[[ 98.91%   0.09%   1.00%]
 [  0.13%  99.40%   0.47%]
 [  0.96%   0.59%  98.45%]]
[2024-08-05 11:38:10,236] {result_logger:145} INFO - 
[[ 99.31%   0.93%   1.42%]
 [  0.01%  94.73%   0.06%]
 [  0.68%   4.33%  98.52%]]
[2024-08-05 11:38:10,236] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:38:10,243] {result_logger:134} INFO - 
[[27700    96   586]
 [   10  2394   141]
 [  520   309 19874]]
[2024-08-05 11:38:10,251] {result_logger:141} INFO - 
[[ 97.60%   0.34%   2.06%]
 [  0.39%  94.07%   5.54%]
 [  2.51%   1.49%  96.00%]]
[2024-08-05 11:38:10,258] {result_logger:145} INFO - 
[[ 98.12%   3.43%   2.84%]
 [  0.04%  85.53%   0.68%]
 [  1.84%  11.04%  96.47%]]
[2024-08-05 11:38:10,345] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:38:10,345] {result_logger:77} INFO - actual:
[2024-08-05 11:38:10,345] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:38:10,345] {result_logger:79} INFO - predicted:
[2024-08-05 11:38:10,345] {result_logger:80} INFO - 
[[95.24%  0.16%  4.61%]
 [15.40% 78.71%  5.89%]
 [ 4.43%  2.68% 92.89%]]
[2024-08-05 11:38:10,345] {run_experiment:113} INFO - [epoch  35] execution time: 107.57s	 avg f1-score: 0.9456

[2024-08-05 11:38:10,345] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:38:10,371] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:38:24,682] {train_model:82} INFO - Train Epoch: 36 [36352/366120 (10%)]	lr:6.07e-05	Loss: 0.073846
[2024-08-05 11:38:33,763] {train_model:82} INFO - Train Epoch: 36 [72960/366120 (20%)]	lr:6.07e-05	Loss: 0.022468
[2024-08-05 11:38:42,857] {train_model:82} INFO - Train Epoch: 36 [109568/366120 (30%)]	lr:6.07e-05	Loss: 0.020733
[2024-08-05 11:38:52,006] {train_model:82} INFO - Train Epoch: 36 [146176/366120 (40%)]	lr:6.07e-05	Loss: 0.055800
[2024-08-05 11:39:01,182] {train_model:82} INFO - Train Epoch: 36 [182784/366120 (50%)]	lr:6.07e-05	Loss: 0.039013
[2024-08-05 11:39:10,362] {train_model:82} INFO - Train Epoch: 36 [219392/366120 (60%)]	lr:6.07e-05	Loss: 0.049730
[2024-08-05 11:39:19,566] {train_model:82} INFO - Train Epoch: 36 [256000/366120 (70%)]	lr:6.07e-05	Loss: 0.009253
[2024-08-05 11:39:28,816] {train_model:82} INFO - Train Epoch: 36 [292608/366120 (80%)]	lr:6.07e-05	Loss: 0.025933
[2024-08-05 11:39:38,079] {train_model:82} INFO - Train Epoch: 36 [329216/366120 (90%)]	lr:6.07e-05	Loss: 0.006748
[2024-08-05 11:39:47,300] {train_model:82} INFO - Train Epoch: 36 [365824/366120 (100%)]	lr:6.07e-05	Loss: 0.012877
[2024-08-05 11:39:52,338] {run_experiment:79} INFO - 
[2024-08-05 11:39:52,338] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:39:53,007] {result_logger:103} INFO - precision on Wake: 0.993
[2024-08-05 11:39:53,418] {result_logger:104} INFO - recall on Wake: 0.990
[2024-08-05 11:39:53,826] {result_logger:107} INFO - F1-score on Wake: 0.991
[2024-08-05 11:39:53,826] {result_logger:108} INFO - 
[2024-08-05 11:39:54,394] {result_logger:103} INFO - precision on REM: 0.952
[2024-08-05 11:39:54,747] {result_logger:104} INFO - recall on REM: 0.995
[2024-08-05 11:39:55,100] {result_logger:107} INFO - F1-score on REM: 0.973
[2024-08-05 11:39:55,100] {result_logger:108} INFO - 
[2024-08-05 11:39:55,735] {result_logger:103} INFO - precision on Non REM: 0.986
[2024-08-05 11:39:56,137] {result_logger:104} INFO - recall on Non REM: 0.986
[2024-08-05 11:39:56,538] {result_logger:107} INFO - F1-score on Non REM: 0.986
[2024-08-05 11:39:56,539] {result_logger:108} INFO - 
[2024-08-05 11:39:56,630] {result_logger:111} INFO - average precision on sleep stages: 0.977
[2024-08-05 11:39:56,722] {result_logger:113} INFO - average recall on sleep stages: 0.990
[2024-08-05 11:39:56,813] {result_logger:115} INFO - average F1-score on sleep stages: 0.983
[2024-08-05 11:39:56,814] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:39:56,898] {result_logger:103} INFO - precision on Wake: 0.980
[2024-08-05 11:39:56,948] {result_logger:104} INFO - recall on Wake: 0.982
[2024-08-05 11:39:56,998] {result_logger:107} INFO - F1-score on Wake: 0.981
[2024-08-05 11:39:56,998] {result_logger:108} INFO - 
[2024-08-05 11:39:57,076] {result_logger:103} INFO - precision on REM: 0.871
[2024-08-05 11:39:57,124] {result_logger:104} INFO - recall on REM: 0.938
[2024-08-05 11:39:57,171] {result_logger:107} INFO - F1-score on REM: 0.903
[2024-08-05 11:39:57,172] {result_logger:108} INFO - 
[2024-08-05 11:39:57,254] {result_logger:103} INFO - precision on Non REM: 0.970
[2024-08-05 11:39:57,303] {result_logger:104} INFO - recall on Non REM: 0.959
[2024-08-05 11:39:57,353] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2024-08-05 11:39:57,354] {result_logger:108} INFO - 
[2024-08-05 11:39:57,363] {result_logger:111} INFO - average precision on sleep stages: 0.941
[2024-08-05 11:39:57,374] {result_logger:113} INFO - average recall on sleep stages: 0.960
[2024-08-05 11:39:57,384] {result_logger:115} INFO - average F1-score on sleep stages: 0.950
[2024-08-05 11:39:57,385] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:39:57,447] {result_logger:134} INFO - 
[[201640    187   1920]
 [    23  18508     75]
 [  1343    738 141686]]
[2024-08-05 11:39:57,510] {result_logger:141} INFO - 
[[ 98.97%   0.09%   0.94%]
 [  0.12%  99.47%   0.40%]
 [  0.93%   0.51%  98.55%]]
[2024-08-05 11:39:57,573] {result_logger:145} INFO - 
[[ 99.33%   0.96%   1.34%]
 [  0.01%  95.24%   0.05%]
 [  0.66%   3.80%  98.61%]]
[2024-08-05 11:39:57,573] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:39:57,580] {result_logger:134} INFO - 
[[27858    50   474]
 [   16  2387   142]
 [  539   302 19862]]
[2024-08-05 11:39:57,587] {result_logger:141} INFO - 
[[ 98.15%   0.18%   1.67%]
 [  0.63%  93.79%   5.58%]
 [  2.60%   1.46%  95.94%]]
[2024-08-05 11:39:57,594] {result_logger:145} INFO - 
[[ 98.05%   1.83%   2.31%]
 [  0.06%  87.15%   0.69%]
 [  1.90%  11.03%  96.99%]]
[2024-08-05 11:39:57,686] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:39:57,686] {result_logger:77} INFO - actual:
[2024-08-05 11:39:57,686] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:39:57,686] {result_logger:79} INFO - predicted:
[2024-08-05 11:39:57,686] {result_logger:80} INFO - 
[[95.29%  0.08%  4.63%]
 [15.74% 78.82%  5.44%]
 [ 4.43%  2.72% 92.85%]]
[2024-08-05 11:39:57,686] {run_experiment:113} INFO - [epoch  36] execution time: 107.34s	 avg f1-score: 0.9497

[2024-08-05 11:39:57,686] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:39:57,712] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:40:12,098] {train_model:82} INFO - Train Epoch: 37 [36352/366120 (10%)]	lr:5.71e-05	Loss: 0.023953
[2024-08-05 11:40:21,173] {train_model:82} INFO - Train Epoch: 37 [72960/366120 (20%)]	lr:5.71e-05	Loss: 0.030787
[2024-08-05 11:40:30,273] {train_model:82} INFO - Train Epoch: 37 [109568/366120 (30%)]	lr:5.71e-05	Loss: 0.021057
[2024-08-05 11:40:39,345] {train_model:82} INFO - Train Epoch: 37 [146176/366120 (40%)]	lr:5.71e-05	Loss: 0.024838
[2024-08-05 11:40:48,431] {train_model:82} INFO - Train Epoch: 37 [182784/366120 (50%)]	lr:5.71e-05	Loss: 0.030854
[2024-08-05 11:40:57,626] {train_model:82} INFO - Train Epoch: 37 [219392/366120 (60%)]	lr:5.71e-05	Loss: 0.037578
[2024-08-05 11:41:06,911] {train_model:82} INFO - Train Epoch: 37 [256000/366120 (70%)]	lr:5.71e-05	Loss: 0.035361
[2024-08-05 11:41:16,087] {train_model:82} INFO - Train Epoch: 37 [292608/366120 (80%)]	lr:5.71e-05	Loss: 0.011542
[2024-08-05 11:41:25,262] {train_model:82} INFO - Train Epoch: 37 [329216/366120 (90%)]	lr:5.71e-05	Loss: 0.021017
[2024-08-05 11:41:34,414] {train_model:82} INFO - Train Epoch: 37 [365824/366120 (100%)]	lr:5.71e-05	Loss: 0.028015
[2024-08-05 11:41:39,464] {run_experiment:79} INFO - 
[2024-08-05 11:41:39,464] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:41:40,130] {result_logger:103} INFO - precision on Wake: 0.994
[2024-08-05 11:41:40,538] {result_logger:104} INFO - recall on Wake: 0.990
[2024-08-05 11:41:40,947] {result_logger:107} INFO - F1-score on Wake: 0.992
[2024-08-05 11:41:40,947] {result_logger:108} INFO - 
[2024-08-05 11:41:41,514] {result_logger:103} INFO - precision on REM: 0.956
[2024-08-05 11:41:41,865] {result_logger:104} INFO - recall on REM: 0.996
[2024-08-05 11:41:42,216] {result_logger:107} INFO - F1-score on REM: 0.975
[2024-08-05 11:41:42,216] {result_logger:108} INFO - 
[2024-08-05 11:41:42,850] {result_logger:103} INFO - precision on Non REM: 0.987
[2024-08-05 11:41:43,252] {result_logger:104} INFO - recall on Non REM: 0.986
[2024-08-05 11:41:43,653] {result_logger:107} INFO - F1-score on Non REM: 0.987
[2024-08-05 11:41:43,654] {result_logger:108} INFO - 
[2024-08-05 11:41:43,745] {result_logger:111} INFO - average precision on sleep stages: 0.979
[2024-08-05 11:41:43,836] {result_logger:113} INFO - average recall on sleep stages: 0.991
[2024-08-05 11:41:43,927] {result_logger:115} INFO - average F1-score on sleep stages: 0.985
[2024-08-05 11:41:43,928] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:41:44,013] {result_logger:103} INFO - precision on Wake: 0.976
[2024-08-05 11:41:44,062] {result_logger:104} INFO - recall on Wake: 0.981
[2024-08-05 11:41:44,112] {result_logger:107} INFO - F1-score on Wake: 0.979
[2024-08-05 11:41:44,112] {result_logger:108} INFO - 
[2024-08-05 11:41:44,190] {result_logger:103} INFO - precision on REM: 0.852
[2024-08-05 11:41:44,238] {result_logger:104} INFO - recall on REM: 0.942
[2024-08-05 11:41:44,286] {result_logger:107} INFO - F1-score on REM: 0.895
[2024-08-05 11:41:44,286] {result_logger:108} INFO - 
[2024-08-05 11:41:44,369] {result_logger:103} INFO - precision on Non REM: 0.971
[2024-08-05 11:41:44,418] {result_logger:104} INFO - recall on Non REM: 0.952
[2024-08-05 11:41:44,469] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2024-08-05 11:41:44,469] {result_logger:108} INFO - 
[2024-08-05 11:41:44,479] {result_logger:111} INFO - average precision on sleep stages: 0.933
[2024-08-05 11:41:44,489] {result_logger:113} INFO - average recall on sleep stages: 0.959
[2024-08-05 11:41:44,500] {result_logger:115} INFO - average F1-score on sleep stages: 0.945
[2024-08-05 11:41:44,500] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:41:44,562] {result_logger:134} INFO - 
[[201744    171   1832]
 [    15  18527     64]
 [  1273    683 141811]]
[2024-08-05 11:41:44,625] {result_logger:141} INFO - 
[[ 99.02%   0.08%   0.90%]
 [  0.08%  99.58%   0.34%]
 [  0.89%   0.48%  98.64%]]
[2024-08-05 11:41:44,688] {result_logger:145} INFO - 
[[ 99.37%   0.88%   1.27%]
 [  0.01%  95.59%   0.04%]
 [  0.63%   3.52%  98.68%]]
[2024-08-05 11:41:44,688] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:41:44,694] {result_logger:134} INFO - 
[[27848    84   450]
 [   14  2398   133]
 [  658   332 19713]]
[2024-08-05 11:41:44,702] {result_logger:141} INFO - 
[[ 98.12%   0.30%   1.59%]
 [  0.55%  94.22%   5.23%]
 [  3.18%   1.60%  95.22%]]
[2024-08-05 11:41:44,709] {result_logger:145} INFO - 
[[ 97.64%   2.99%   2.22%]
 [  0.05%  85.22%   0.66%]
 [  2.31%  11.80%  97.13%]]
[2024-08-05 11:41:44,797] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:41:44,797] {result_logger:77} INFO - actual:
[2024-08-05 11:41:44,797] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:41:44,797] {result_logger:79} INFO - predicted:
[2024-08-05 11:41:44,797] {result_logger:80} INFO - 
[[94.98%  0.16%  4.86%]
 [16.45% 78.78%  4.76%]
 [ 4.77%  2.72% 92.51%]]
[2024-08-05 11:41:44,797] {run_experiment:113} INFO - [epoch  37] execution time: 107.11s	 avg f1-score: 0.9451

[2024-08-05 11:41:44,797] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:41:44,823] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:41:59,140] {train_model:82} INFO - Train Epoch: 38 [36352/366120 (10%)]	lr:5.38e-05	Loss: 0.015347
[2024-08-05 11:42:08,149] {train_model:82} INFO - Train Epoch: 38 [72960/366120 (20%)]	lr:5.38e-05	Loss: 0.033330
[2024-08-05 11:42:17,250] {train_model:82} INFO - Train Epoch: 38 [109568/366120 (30%)]	lr:5.38e-05	Loss: 0.011507
[2024-08-05 11:42:26,374] {train_model:82} INFO - Train Epoch: 38 [146176/366120 (40%)]	lr:5.38e-05	Loss: 0.030422
[2024-08-05 11:42:35,467] {train_model:82} INFO - Train Epoch: 38 [182784/366120 (50%)]	lr:5.38e-05	Loss: 0.026661
[2024-08-05 11:42:44,600] {train_model:82} INFO - Train Epoch: 38 [219392/366120 (60%)]	lr:5.38e-05	Loss: 0.034526
[2024-08-05 11:42:53,753] {train_model:82} INFO - Train Epoch: 38 [256000/366120 (70%)]	lr:5.38e-05	Loss: 0.022762
[2024-08-05 11:43:02,978] {train_model:82} INFO - Train Epoch: 38 [292608/366120 (80%)]	lr:5.38e-05	Loss: 0.054518
[2024-08-05 11:43:12,219] {train_model:82} INFO - Train Epoch: 38 [329216/366120 (90%)]	lr:5.38e-05	Loss: 0.014100
[2024-08-05 11:43:21,408] {train_model:82} INFO - Train Epoch: 38 [365824/366120 (100%)]	lr:5.38e-05	Loss: 0.018824
[2024-08-05 11:43:26,493] {run_experiment:79} INFO - 
[2024-08-05 11:43:26,493] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:43:27,135] {result_logger:103} INFO - precision on Wake: 0.994
[2024-08-05 11:43:27,543] {result_logger:104} INFO - recall on Wake: 0.991
[2024-08-05 11:43:27,955] {result_logger:107} INFO - F1-score on Wake: 0.992
[2024-08-05 11:43:27,955] {result_logger:108} INFO - 
[2024-08-05 11:43:28,520] {result_logger:103} INFO - precision on REM: 0.959
[2024-08-05 11:43:28,873] {result_logger:104} INFO - recall on REM: 0.995
[2024-08-05 11:43:29,226] {result_logger:107} INFO - F1-score on REM: 0.977
[2024-08-05 11:43:29,226] {result_logger:108} INFO - 
[2024-08-05 11:43:29,845] {result_logger:103} INFO - precision on Non REM: 0.988
[2024-08-05 11:43:30,249] {result_logger:104} INFO - recall on Non REM: 0.987
[2024-08-05 11:43:30,652] {result_logger:107} INFO - F1-score on Non REM: 0.987
[2024-08-05 11:43:30,652] {result_logger:108} INFO - 
[2024-08-05 11:43:30,745] {result_logger:111} INFO - average precision on sleep stages: 0.980
[2024-08-05 11:43:30,836] {result_logger:113} INFO - average recall on sleep stages: 0.991
[2024-08-05 11:43:30,928] {result_logger:115} INFO - average F1-score on sleep stages: 0.985
[2024-08-05 11:43:30,929] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:43:31,009] {result_logger:103} INFO - precision on Wake: 0.984
[2024-08-05 11:43:31,059] {result_logger:104} INFO - recall on Wake: 0.976
[2024-08-05 11:43:31,109] {result_logger:107} INFO - F1-score on Wake: 0.980
[2024-08-05 11:43:31,109] {result_logger:108} INFO - 
[2024-08-05 11:43:31,187] {result_logger:103} INFO - precision on REM: 0.856
[2024-08-05 11:43:31,235] {result_logger:104} INFO - recall on REM: 0.947
[2024-08-05 11:43:31,283] {result_logger:107} INFO - F1-score on REM: 0.899
[2024-08-05 11:43:31,283] {result_logger:108} INFO - 
[2024-08-05 11:43:31,363] {result_logger:103} INFO - precision on Non REM: 0.966
[2024-08-05 11:43:31,412] {result_logger:104} INFO - recall on Non REM: 0.963
[2024-08-05 11:43:31,463] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2024-08-05 11:43:31,463] {result_logger:108} INFO - 
[2024-08-05 11:43:31,473] {result_logger:111} INFO - average precision on sleep stages: 0.935
[2024-08-05 11:43:31,484] {result_logger:113} INFO - average recall on sleep stages: 0.962
[2024-08-05 11:43:31,494] {result_logger:115} INFO - average F1-score on sleep stages: 0.948
[2024-08-05 11:43:31,495] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:43:31,558] {result_logger:134} INFO - 
[[201859    167   1721]
 [    19  18520     67]
 [  1201    632 141934]]
[2024-08-05 11:43:31,621] {result_logger:141} INFO - 
[[ 99.07%   0.08%   0.84%]
 [  0.10%  99.54%   0.36%]
 [  0.84%   0.44%  98.73%]]
[2024-08-05 11:43:31,683] {result_logger:145} INFO - 
[[ 99.40%   0.86%   1.20%]
 [  0.01%  95.86%   0.05%]
 [  0.59%   3.27%  98.76%]]
[2024-08-05 11:43:31,683] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:43:31,690] {result_logger:134} INFO - 
[[27713    83   586]
 [   16  2411   118]
 [  440   323 19940]]
[2024-08-05 11:43:31,698] {result_logger:141} INFO - 
[[ 97.64%   0.29%   2.06%]
 [  0.63%  94.73%   4.64%]
 [  2.13%   1.56%  96.31%]]
[2024-08-05 11:43:31,705] {result_logger:145} INFO - 
[[ 98.38%   2.95%   2.84%]
 [  0.06%  85.59%   0.57%]
 [  1.56%  11.47%  96.59%]]
[2024-08-05 11:43:31,793] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:43:31,793] {result_logger:77} INFO - actual:
[2024-08-05 11:43:31,793] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:43:31,793] {result_logger:79} INFO - predicted:
[2024-08-05 11:43:31,794] {result_logger:80} INFO - 
[[95.32%  0.14%  4.54%]
 [15.55% 79.02%  5.43%]
 [ 4.27%  2.67% 93.06%]]
[2024-08-05 11:43:31,794] {run_experiment:113} INFO - [epoch  38] execution time: 107.00s	 avg f1-score: 0.9480

[2024-08-05 11:43:32,010] {result_logger:56} INFO - final F1-scores on train:
	Wake                : [0.597033643096606, 0.7437492823908278, 0.8166613251621342, 0.8829847343254902, 0.9241534074864494, 0.951151066754139, 0.9590712533402336, 0.9629000452014446, 0.9668486787804278, 0.9695552321840447, 0.9715078095840738, 0.9740008393196575, 0.9760324501971389, 0.9771135536920866, 0.9782066080642456, 0.9789390114008443, 0.9798411548075074, 0.9803336939192402, 0.9813029542268529, 0.9817641683027104, 0.9826306639942085, 0.9833658696299725, 0.9840065391982589, 0.9848025663056671, 0.9851848569445059, 0.985846653623242, 0.9867065502956833, 0.9872269643678812, 0.9879628946138137, 0.9884758336879547, 0.9889332477314264, 0.989568344438951, 0.9898834904662841, 0.9907408318007926, 0.9911011333207108, 0.9914616487155595, 0.9919096118531193, 0.9923603702811522]
	REM                 : [0.14891514307533354, 0.3506256863241985, 0.44943025419428256, 0.5953752663562466, 0.7132218878369176, 0.7764190545720021, 0.7999262995462816, 0.8172536530535781, 0.8299974067001438, 0.8422001803426511, 0.8489828974322328, 0.8568838851254651, 0.8677235929067079, 0.8768147608642873, 0.8795661267571381, 0.8890851982724775, 0.8950745237390189, 0.9011659637806996, 0.9070548712206047, 0.9099523702650808, 0.9173957732708266, 0.9231350997050445, 0.9288840539378147, 0.9332757613471844, 0.9362449415896772, 0.9419707935858417, 0.9474144359587544, 0.9498093373183552, 0.9542598577892697, 0.9593267882187938, 0.9626214477351462, 0.9635785744060026, 0.9659711159280249, 0.9689333612740989, 0.9701277243043352, 0.9731065485422855, 0.9754389659620396, 0.9766644693473961]
	Non REM             : [0.561185724678065, 0.7907170287721328, 0.840451055662188, 0.8738371365772593, 0.9072844908812998, 0.9314723548704608, 0.9383450155627512, 0.9413999595669481, 0.9461396095959772, 0.9493045989469341, 0.9511535190117995, 0.9537770049013765, 0.9569713913354214, 0.9592208010299755, 0.9603889693991137, 0.9617633891096311, 0.9631797173802082, 0.9640381812525995, 0.9657326968640141, 0.966615416870501, 0.9683858954068887, 0.9698351725101271, 0.9709890524067604, 0.9724712399104234, 0.9736942139825557, 0.9747144391291613, 0.9764359300643227, 0.9776639665534361, 0.9790043704619458, 0.9804353048909997, 0.9812123237132634, 0.9823149614521154, 0.9828499027105299, 0.9843525956036919, 0.9848797968200953, 0.9858200439731708, 0.9866005273520388, 0.9874047354855316]
	avg                 : [0.43571150361666816, 0.6283639991623864, 0.702180878339535, 0.7840657124196654, 0.8482199287348889, 0.886347492065534, 0.8991141894830887, 0.9071845526073236, 0.9143285650255163, 0.9203533371578766, 0.9238814086760353, 0.9282205764488332, 0.933575811479756, 0.9377163718621165, 0.9393872347401658, 0.9432625329276508, 0.9460317986422448, 0.9485126129841798, 0.9513635074371573, 0.9527773184794307, 0.9561374442239746, 0.9587787139483813, 0.9612932151809446, 0.9635165225210915, 0.9650413375055796, 0.9675106287794151, 0.9701856387729202, 0.9715667560798908, 0.9737423742883431, 0.9760793089325827, 0.9775890063932787, 0.9784872934323564, 0.9795681697016129, 0.9813422628928611, 0.9820362181483805, 0.9834627470770053, 0.9846497017223993, 0.9854765250380266]
[2024-08-05 11:43:32,011] {result_logger:56} INFO - final F1-scores on valid:
	Wake                : [0.7394770454979227, 0.7886650137933443, 0.8284946074136733, 0.6943528220548302, 0.7158477244537735, 0.9313876359777128, 0.8976079023994694, 0.9459024635495223, 0.8861315226490558, 0.966436924565131, 0.9702897664751192, 0.9744559741201011, 0.9765739643924258, 0.9586953425437972, 0.976173259730869, 0.9735952682720743, 0.9789270687237027, 0.9770747363594681, 0.9756892713792438, 0.9682184822849785, 0.9781686932753969, 0.9809432894922925, 0.9801184804964227, 0.9795846594805607, 0.9768919494533579, 0.9798468217273144, 0.9775378352066555, 0.9770540080985853, 0.9795097866337505, 0.9788375664083874, 0.9812653399961153, 0.9808298273100146, 0.9795091354370387, 0.9793563413084904, 0.9785911114251395, 0.9810018487542917, 0.9788056658816914, 0.9801064525826245]
	REM                 : [0.3927659574468085, 0.5289604332781707, 0.7379503207764434, 0.39388322520852637, 0.3067408781694496, 0.603045198417456, 0.47995439863195893, 0.8100686498855835, 0.4856180856180856, 0.8173344235486508, 0.8318791946308725, 0.8286470393648693, 0.8170295742606435, 0.7565257212639291, 0.8490402905066574, 0.8612807537951491, 0.8745380960760161, 0.8561643835616439, 0.8773418168964298, 0.846815834767642, 0.8714985994397759, 0.8874004344677769, 0.8909386869234943, 0.8937648564637046, 0.8826734471485652, 0.9071777527245396, 0.8830652448942706, 0.9023707298861303, 0.8967813540510544, 0.9022782903408021, 0.9036869826937548, 0.9059434506635892, 0.9029808239984812, 0.9002442231824158, 0.8959580838323353, 0.9034822104466314, 0.8949430863967157, 0.8992913092129804]
	Non REM             : [0.38746261700392276, 0.7511629680469764, 0.6522482972336099, 0.4797156154945578, 0.7973475565806544, 0.9022509378907879, 0.9088168018299022, 0.8895175064047823, 0.9238046535412938, 0.9301472461405207, 0.9436911628836118, 0.9552958543486284, 0.9474411148107041, 0.9550825090648972, 0.9562978222483816, 0.9588173178458289, 0.9571009201470262, 0.9544628383357077, 0.9577054921206443, 0.9542335748850423, 0.9553293472352623, 0.9638068402642829, 0.9616100284007442, 0.9624651776550509, 0.9627143202125091, 0.96438263229308, 0.959254947613504, 0.9603974936361857, 0.9641259965000972, 0.964448319287029, 0.9661833409987655, 0.9662578174237649, 0.9647880492773305, 0.9635733501369331, 0.9623281038156111, 0.9646196061290402, 0.9616332105661114, 0.9645197958739448]
	avg                 : [0.5065685399828846, 0.6895961383728304, 0.7395644084745756, 0.5226505542526382, 0.6066453864012925, 0.8122279240953189, 0.7621263676204436, 0.8818295399466294, 0.7651847539361452, 0.9046395314181007, 0.9152867079965344, 0.9194662892778663, 0.9136815511545912, 0.8901011909575413, 0.9271704574953027, 0.9312311133043508, 0.9368553616489149, 0.9292339860856066, 0.9369121934654393, 0.9230892973125542, 0.9349988799834783, 0.9440501880747841, 0.9442223986068871, 0.9452715645331055, 0.9407599056048107, 0.9504690689149781, 0.9399526759048101, 0.9466074105403005, 0.9468057123949674, 0.9485213920120729, 0.9503785545628786, 0.9510103651324563, 0.9490926695709502, 0.9477246382092798, 0.9456257663576952, 0.9497012217766544, 0.9451273209481729, 0.9479725192231832]
[2024-08-05 11:43:32,108] {logger:50} INFO - 
[2024-08-05 11:43:32,108] {logger:51} INFO - ================================================================================
[2024-08-05 11:43:32,108] {logger:52} INFO - finished training
[2024-08-05 11:43:32,108] {logger:53} INFO - ================================================================================
[2024-08-05 11:43:32,108] {logger:54} INFO - 
[2024-08-05 11:43:32,108] {logger:50} INFO - 
[2024-08-05 11:43:32,108] {logger:51} INFO - ================================================================================
[2024-08-05 11:43:32,108] {logger:52} INFO - best model on epoch: 32 	f1-score: 0.9510
[2024-08-05 11:43:32,108] {logger:53} INFO - ================================================================================
[2024-08-05 11:43:32,108] {logger:54} INFO - 
