[2024-08-05 10:35:16,116] {logger:43} INFO - run_experiment.py, args: Namespace(experiment='exp002_B_weighted')
================================================================================
[2024-08-05 10:35:16,116] {logger:44} INFO - config:
[2024-08-05 10:35:16,116] {logger:45} INFO - parameter name      | parameter value
[2024-08-05 10:35:16,116] {logger:46} INFO - experiment          : exp002_B_weighted
[2024-08-05 10:35:16,116] {logger:46} INFO - RUN_NAME            : exp002_B_weighted_2024-08-05_10-35-16
[2024-08-05 10:35:16,116] {logger:46} INFO - DEVICE              : cuda
[2024-08-05 10:35:16,116] {logger:46} INFO - EXPERIMENT_DIR      : /home/s202283/code/grieger_validation/results/exp002_B_weighted
[2024-08-05 10:35:16,116] {logger:46} INFO - MODELS_DIR          : /home/s202283/code/grieger_validation/results/exp002_B_weighted/models
[2024-08-05 10:35:16,116] {logger:46} INFO - VISUALS_DIR         : /home/s202283/code/grieger_validation/results/exp002_B_weighted/visuals/exp002_B_weighted_2024-08-05_10-35-16
[2024-08-05 10:35:16,116] {logger:46} INFO - DATA_DIR            : /scratch/s202283/data/mice-data-tuebingen/data
[2024-08-05 10:35:16,116] {logger:46} INFO - SAMPLE_DURATION     : 10
[2024-08-05 10:35:16,116] {logger:46} INFO - SAMPLING_RATE       : 64
[2024-08-05 10:35:16,116] {logger:46} INFO - SCORING_MAP         : {'Wake': [1, 17], 'REM': [3, 19], 'Non REM': [2, 18], 'Pre REM': [4, 20], 'Artifact': [8, 24]}
[2024-08-05 10:35:16,116] {logger:46} INFO - STAGE_MAP           : {'Wake': 'Wake', 'REM': 'REM', 'Non REM': 'Non REM', 'Pre REM': 'Non REM', 'Artifact': None}
[2024-08-05 10:35:16,116] {logger:46} INFO - DATA_SPLIT          : {'train': ['M19', 'M20', 'M21', 'M22', 'M23', 'M24', 'M25', 'M26', 'M27', 'M28', 'M29', 'M31', 'M32', 'M33'], 'valid': ['M34', 'M35'], 'test': ['M36', 'M37']}
[2024-08-05 10:35:16,116] {logger:46} INFO - DATA_FILE           : /home/s202283/code/grieger_validation/cache/dataset/data_tuebingen_main_stages.h5
[2024-08-05 10:35:16,116] {logger:46} INFO - STAGES              : ['Wake', 'REM', 'Non REM']
[2024-08-05 10:35:16,116] {logger:46} INFO - BALANCED_TRAINING   : False
[2024-08-05 10:35:16,116] {logger:46} INFO - BALANCING_WEIGHTS   : [0.3, 0.18, 0.24, 0.14, 0.14]
[2024-08-05 10:35:16,116] {logger:46} INFO - CHANNELS            : ['EEG_PR']
[2024-08-05 10:35:16,116] {logger:46} INFO - SAMPLES_LEFT        : 1
[2024-08-05 10:35:16,117] {logger:46} INFO - SAMPLES_RIGHT       : 1
[2024-08-05 10:35:16,117] {logger:46} INFO - LOG_INTERVAL        : 10
[2024-08-05 10:35:16,117] {logger:46} INFO - EXTRA_SAFE_MODELS   : False
[2024-08-05 10:35:16,117] {logger:46} INFO - BATCH_SIZE          : 256
[2024-08-05 10:35:16,117] {logger:46} INFO - DATA_FRACTION       : 1.0
[2024-08-05 10:35:16,117] {logger:46} INFO - DATA_FRACTION_STRAT : None
[2024-08-05 10:35:16,117] {logger:46} INFO - EPOCHS              : 50
[2024-08-05 10:35:16,117] {logger:46} INFO - WARMUP_EPOCHS       : 12
[2024-08-05 10:35:16,117] {logger:46} INFO - S_OPTIM_MODE        : exp
[2024-08-05 10:35:16,117] {logger:46} INFO - S_OPTIM_PARAS       : [0.06]
[2024-08-05 10:35:16,117] {logger:46} INFO - LEARNING_RATE       : 0.000256
[2024-08-05 10:35:16,117] {logger:46} INFO - OPTIMIZER           : <class 'torch.optim.adam.Adam'>
[2024-08-05 10:35:16,117] {logger:46} INFO - OPTIM_PARAS         : {}
[2024-08-05 10:35:16,117] {logger:46} INFO - L1_WEIGHT_DECAY     : 0
[2024-08-05 10:35:16,117] {logger:46} INFO - L2_WEIGHT_DECAY     : 0.0001
[2024-08-05 10:35:16,117] {logger:46} INFO - BATCH_SIZE_EVAL     : 512
[2024-08-05 10:35:16,117] {logger:46} INFO - FILTERS             : 96
[2024-08-05 10:35:16,117] {logger:46} INFO - CLASSIFIER_DROPOUT  : [0.2, 0.2]
[2024-08-05 10:35:16,117] {logger:46} INFO - FEATURE_EXTR_DROPOUT: [0.0, 0.2, 0.0, 0.2, 0.0, 0.2, 0.0, 0.2]
[2024-08-05 10:35:16,117] {logger:46} INFO - MODEL_NAME          : model_8conv_2fc
[2024-08-05 10:35:16,117] {logger:46} INFO - GAIN                : 0.0
[2024-08-05 10:35:16,117] {logger:46} INFO - FLIP                : 0.0
[2024-08-05 10:35:16,117] {logger:46} INFO - FLIP_ALL            : 0.0
[2024-08-05 10:35:16,117] {logger:46} INFO - WINDOW_WARP_SIZE    : 0.0
[2024-08-05 10:35:16,117] {logger:46} INFO - FLIP_HORI           : 0.0
[2024-08-05 10:35:16,117] {logger:46} INFO - TIME_SHIFT          : 0.0
[2024-08-05 10:35:16,117] {logger:50} INFO - 
[2024-08-05 10:35:16,117] {logger:51} INFO - ================================================================================
[2024-08-05 10:35:16,117] {logger:52} INFO - start training with model: model_8conv_2fc
[2024-08-05 10:35:16,117] {logger:53} INFO - ================================================================================
[2024-08-05 10:35:16,117] {logger:54} INFO - 
[2024-08-05 10:35:37,918] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:35:37,942] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:35:40,784] {dataloader:120} INFO - data distribution in database for dataset valid:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 20704
[2024-08-05 10:35:40,786] {dataloader:147} INFO - data distribution after processing:
	Wake                : 28382
	REM                 : 2544
	Non REM             : 20704
[2024-08-05 10:35:41,600] {run_experiment:48} INFO - classifier:
Model(
  (feature_extractor): Sequential(
    (0): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): Conv1d(1, 96, kernel_size=(5,), stride=(1,))
    (2): ReLU(inplace=True)
    (3): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): Dropout(p=0.0, inplace=False)
    (5): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (6): ReLU(inplace=True)
    (7): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): Dropout(p=0.2, inplace=False)
    (9): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (10): ReLU(inplace=True)
    (11): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (12): Dropout(p=0.0, inplace=False)
    (13): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (14): ReLU(inplace=True)
    (15): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (16): Dropout(p=0.2, inplace=False)
    (17): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (18): ReLU(inplace=True)
    (19): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (20): Dropout(p=0.0, inplace=False)
    (21): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (22): ReLU(inplace=True)
    (23): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (24): Dropout(p=0.2, inplace=False)
    (25): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (26): ReLU(inplace=True)
    (27): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (28): Dropout(p=0.0, inplace=False)
    (29): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (30): ReLU(inplace=True)
    (31): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (32): Dropout(p=0.2, inplace=False)
  )
  (classifier): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=10848, out_features=80, bias=True)
    (2): ReLU(inplace=True)
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=80, out_features=3, bias=True)
  )
)
[2024-08-05 10:36:04,634] {train_model:82} INFO - Train Epoch: 1 [36352/366120 (10%)]	lr:2.56e-05	Loss: 70.811737
[2024-08-05 10:36:10,455] {train_model:82} INFO - Train Epoch: 1 [72960/366120 (20%)]	lr:2.56e-05	Loss: 49.000740
[2024-08-05 10:36:16,297] {train_model:82} INFO - Train Epoch: 1 [109568/366120 (30%)]	lr:2.56e-05	Loss: 55.331871
[2024-08-05 10:36:22,159] {train_model:82} INFO - Train Epoch: 1 [146176/366120 (40%)]	lr:2.56e-05	Loss: 39.998951
[2024-08-05 10:36:28,033] {train_model:82} INFO - Train Epoch: 1 [182784/366120 (50%)]	lr:2.56e-05	Loss: 47.653046
[2024-08-05 10:36:33,910] {train_model:82} INFO - Train Epoch: 1 [219392/366120 (60%)]	lr:2.56e-05	Loss: 38.607651
[2024-08-05 10:36:39,784] {train_model:82} INFO - Train Epoch: 1 [256000/366120 (70%)]	lr:2.56e-05	Loss: 34.901619
[2024-08-05 10:36:45,671] {train_model:82} INFO - Train Epoch: 1 [292608/366120 (80%)]	lr:2.56e-05	Loss: 32.290554
[2024-08-05 10:36:51,568] {train_model:82} INFO - Train Epoch: 1 [329216/366120 (90%)]	lr:2.56e-05	Loss: 25.575203
[2024-08-05 10:36:57,504] {train_model:82} INFO - Train Epoch: 1 [365824/366120 (100%)]	lr:2.56e-05	Loss: 28.198393
[2024-08-05 10:37:03,453] {run_experiment:79} INFO - 
[2024-08-05 10:37:03,453] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 10:37:03,910] {result_logger:103} INFO - precision on Wake: 0.685
[2024-08-05 10:37:04,240] {result_logger:104} INFO - recall on Wake: 0.540
[2024-08-05 10:37:04,571] {result_logger:107} INFO - F1-score on Wake: 0.604
[2024-08-05 10:37:04,571] {result_logger:108} INFO - 
[2024-08-05 10:37:04,994] {result_logger:103} INFO - precision on REM: 0.102
[2024-08-05 10:37:05,288] {result_logger:104} INFO - recall on REM: 0.516
[2024-08-05 10:37:05,585] {result_logger:107} INFO - F1-score on REM: 0.171
[2024-08-05 10:37:05,585] {result_logger:108} INFO - 
[2024-08-05 10:37:06,023] {result_logger:103} INFO - precision on Non REM: 0.706
[2024-08-05 10:37:06,354] {result_logger:104} INFO - recall on Non REM: 0.547
[2024-08-05 10:37:06,684] {result_logger:107} INFO - F1-score on Non REM: 0.616
[2024-08-05 10:37:06,684] {result_logger:108} INFO - 
[2024-08-05 10:37:06,757] {result_logger:111} INFO - average precision on sleep stages: 0.498
[2024-08-05 10:37:06,828] {result_logger:113} INFO - average recall on sleep stages: 0.534
[2024-08-05 10:37:06,900] {result_logger:115} INFO - average F1-score on sleep stages: 0.464
[2024-08-05 10:37:06,901] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 10:37:06,959] {result_logger:103} INFO - precision on Wake: 0.654
[2024-08-05 10:37:07,000] {result_logger:104} INFO - recall on Wake: 0.696
[2024-08-05 10:37:07,042] {result_logger:107} INFO - F1-score on Wake: 0.674
[2024-08-05 10:37:07,042] {result_logger:108} INFO - 
[2024-08-05 10:37:07,102] {result_logger:103} INFO - precision on REM: 0.169
[2024-08-05 10:37:07,145] {result_logger:104} INFO - recall on REM: 0.846
[2024-08-05 10:37:07,187] {result_logger:107} INFO - F1-score on REM: 0.282
[2024-08-05 10:37:07,187] {result_logger:108} INFO - 
[2024-08-05 10:37:07,247] {result_logger:103} INFO - precision on Non REM: 0.981
[2024-08-05 10:37:07,288] {result_logger:104} INFO - recall on Non REM: 0.413
[2024-08-05 10:37:07,329] {result_logger:107} INFO - F1-score on Non REM: 0.581
[2024-08-05 10:37:07,329] {result_logger:108} INFO - 
[2024-08-05 10:37:07,336] {result_logger:111} INFO - average precision on sleep stages: 0.602
[2024-08-05 10:37:07,343] {result_logger:113} INFO - average recall on sleep stages: 0.652
[2024-08-05 10:37:07,350] {result_logger:115} INFO - average F1-score on sleep stages: 0.512
[2024-08-05 10:37:07,350] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 10:37:07,400] {result_logger:134} INFO - 
[[110050  63199  30498]
 [  6761   9609   2236]
 [ 43957  21215  78595]]
[2024-08-05 10:37:07,450] {result_logger:141} INFO - 
[[ 54.01%  31.02%  14.97%]
 [ 36.34%  51.64%  12.02%]
 [ 30.58%  14.76%  54.67%]]
[2024-08-05 10:37:07,500] {result_logger:145} INFO - 
[[ 68.45%  67.22%  27.39%]
 [  4.21%  10.22%   2.01%]
 [ 27.34%  22.56%  70.60%]]
[2024-08-05 10:37:07,500] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 10:37:07,505] {result_logger:134} INFO - 
[[19757  8473   152]
 [  381  2153    11]
 [10081  2081  8541]]
[2024-08-05 10:37:07,676] {result_logger:141} INFO - 
[[ 69.61%  29.85%   0.54%]
 [ 14.97%  84.60%   0.43%]
 [ 48.69%  10.05%  41.25%]]
[2024-08-05 10:37:07,739] {result_logger:145} INFO - 
[[ 65.38%  66.68%   1.75%]
 [  1.26%  16.94%   0.13%]
 [ 33.36%  16.38%  98.13%]]
[2024-08-05 10:37:07,901] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 10:37:07,901] {result_logger:77} INFO - actual:
[2024-08-05 10:37:07,901] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 10:37:07,901] {result_logger:79} INFO - predicted:
[2024-08-05 10:37:07,901] {result_logger:80} INFO - 
[[78.73% 15.67%  5.61%]
 [38.56% 58.61%  2.83%]
 [17.57%  6.03% 76.40%]]
[2024-08-05 10:37:07,999] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_B_weighted/model_8conv_2fc-best.pth
[2024-08-05 10:37:07,999] {run_experiment:113} INFO - [epoch   1] execution time: 86.40s	 avg f1-score: 0.5125

[2024-08-05 10:37:07,999] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:37:08,018] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:37:36,997] {train_model:82} INFO - Train Epoch: 2 [36352/366120 (10%)]	lr:4.65e-05	Loss: 45.977242
[2024-08-05 10:37:42,855] {train_model:82} INFO - Train Epoch: 2 [72960/366120 (20%)]	lr:4.65e-05	Loss: 20.103622
[2024-08-05 10:37:48,724] {train_model:82} INFO - Train Epoch: 2 [109568/366120 (30%)]	lr:4.65e-05	Loss: 19.422310
[2024-08-05 10:37:54,614] {train_model:82} INFO - Train Epoch: 2 [146176/366120 (40%)]	lr:4.65e-05	Loss: 14.774593
[2024-08-05 10:38:00,519] {train_model:82} INFO - Train Epoch: 2 [182784/366120 (50%)]	lr:4.65e-05	Loss: 13.181046
[2024-08-05 10:38:06,437] {train_model:82} INFO - Train Epoch: 2 [219392/366120 (60%)]	lr:4.65e-05	Loss: 5.977207
[2024-08-05 10:38:12,360] {train_model:82} INFO - Train Epoch: 2 [256000/366120 (70%)]	lr:4.65e-05	Loss: 12.709715
[2024-08-05 10:38:18,291] {train_model:82} INFO - Train Epoch: 2 [292608/366120 (80%)]	lr:4.65e-05	Loss: 8.194538
[2024-08-05 10:38:24,231] {train_model:82} INFO - Train Epoch: 2 [329216/366120 (90%)]	lr:4.65e-05	Loss: 10.589533
[2024-08-05 10:38:30,193] {train_model:82} INFO - Train Epoch: 2 [365824/366120 (100%)]	lr:4.65e-05	Loss: 5.772577
[2024-08-05 10:38:34,182] {run_experiment:79} INFO - 
[2024-08-05 10:38:34,183] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 10:38:34,633] {result_logger:103} INFO - precision on Wake: 0.873
[2024-08-05 10:38:34,959] {result_logger:104} INFO - recall on Wake: 0.728
[2024-08-05 10:38:35,285] {result_logger:107} INFO - F1-score on Wake: 0.794
[2024-08-05 10:38:35,285] {result_logger:108} INFO - 
[2024-08-05 10:38:35,695] {result_logger:103} INFO - precision on REM: 0.263
[2024-08-05 10:38:35,983] {result_logger:104} INFO - recall on REM: 0.783
[2024-08-05 10:38:36,279] {result_logger:107} INFO - F1-score on REM: 0.394
[2024-08-05 10:38:36,279] {result_logger:108} INFO - 
[2024-08-05 10:38:36,724] {result_logger:103} INFO - precision on Non REM: 0.839
[2024-08-05 10:38:37,043] {result_logger:104} INFO - recall on Non REM: 0.823
[2024-08-05 10:38:37,363] {result_logger:107} INFO - F1-score on Non REM: 0.831
[2024-08-05 10:38:37,363] {result_logger:108} INFO - 
[2024-08-05 10:38:37,433] {result_logger:111} INFO - average precision on sleep stages: 0.659
[2024-08-05 10:38:37,503] {result_logger:113} INFO - average recall on sleep stages: 0.778
[2024-08-05 10:38:37,573] {result_logger:115} INFO - average F1-score on sleep stages: 0.673
[2024-08-05 10:38:37,574] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 10:38:37,631] {result_logger:103} INFO - precision on Wake: 0.717
[2024-08-05 10:38:37,671] {result_logger:104} INFO - recall on Wake: 0.706
[2024-08-05 10:38:37,711] {result_logger:107} INFO - F1-score on Wake: 0.711
[2024-08-05 10:38:37,711] {result_logger:108} INFO - 
[2024-08-05 10:38:37,767] {result_logger:103} INFO - precision on REM: 0.260
[2024-08-05 10:38:37,806] {result_logger:104} INFO - recall on REM: 0.839
[2024-08-05 10:38:37,845] {result_logger:107} INFO - F1-score on REM: 0.397
[2024-08-05 10:38:37,845] {result_logger:108} INFO - 
[2024-08-05 10:38:37,902] {result_logger:103} INFO - precision on Non REM: 0.808
[2024-08-05 10:38:37,941] {result_logger:104} INFO - recall on Non REM: 0.604
[2024-08-05 10:38:37,981] {result_logger:107} INFO - F1-score on Non REM: 0.691
[2024-08-05 10:38:37,981] {result_logger:108} INFO - 
[2024-08-05 10:38:37,988] {result_logger:111} INFO - average precision on sleep stages: 0.595
[2024-08-05 10:38:37,995] {result_logger:113} INFO - average recall on sleep stages: 0.716
[2024-08-05 10:38:38,002] {result_logger:115} INFO - average F1-score on sleep stages: 0.600
[2024-08-05 10:38:38,002] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 10:38:38,050] {result_logger:134} INFO - 
[[148374  33676  21697]
 [  3059  14567    980]
 [ 18455   7056 118256]]
[2024-08-05 10:38:38,097] {result_logger:141} INFO - 
[[ 72.82%  16.53%  10.65%]
 [ 16.44%  78.29%   5.27%]
 [ 12.84%   4.91%  82.26%]]
[2024-08-05 10:38:38,145] {result_logger:145} INFO - 
[[ 87.34%  60.90%  15.40%]
 [  1.80%  26.34%   0.70%]
 [ 10.86%  12.76%  83.91%]]
[2024-08-05 10:38:38,145] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 10:38:38,150] {result_logger:134} INFO - 
[[20035  5393  2954]
 [  391  2134    20]
 [ 7524   674 12505]]
[2024-08-05 10:38:38,205] {result_logger:141} INFO - 
[[ 70.59%  19.00%  10.41%]
 [ 15.36%  83.85%   0.79%]
 [ 36.34%   3.26%  60.40%]]
[2024-08-05 10:38:38,255] {result_logger:145} INFO - 
[[ 71.68%  65.76%  19.08%]
 [  1.40%  26.02%   0.13%]
 [ 26.92%   8.22%  80.79%]]
[2024-08-05 10:38:38,398] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 10:38:38,398] {result_logger:77} INFO - actual:
[2024-08-05 10:38:38,398] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 10:38:38,398] {result_logger:79} INFO - predicted:
[2024-08-05 10:38:38,398] {result_logger:80} INFO - 
[[80.81%  6.62% 12.58%]
 [24.85% 67.57%  7.57%]
 [21.49%  5.23% 73.27%]]
[2024-08-05 10:38:38,451] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_B_weighted/model_8conv_2fc-best.pth
[2024-08-05 10:38:38,451] {run_experiment:113} INFO - [epoch   2] execution time: 90.45s	 avg f1-score: 0.5999

[2024-08-05 10:38:38,451] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:38:38,470] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:39:01,303] {train_model:82} INFO - Train Epoch: 3 [36352/366120 (10%)]	lr:6.75e-05	Loss: 14.350695
[2024-08-05 10:39:07,186] {train_model:82} INFO - Train Epoch: 3 [72960/366120 (20%)]	lr:6.75e-05	Loss: 5.979042
[2024-08-05 10:39:13,082] {train_model:82} INFO - Train Epoch: 3 [109568/366120 (30%)]	lr:6.75e-05	Loss: 3.235782
[2024-08-05 10:39:18,986] {train_model:82} INFO - Train Epoch: 3 [146176/366120 (40%)]	lr:6.75e-05	Loss: 22.781445
[2024-08-05 10:39:24,895] {train_model:82} INFO - Train Epoch: 3 [182784/366120 (50%)]	lr:6.75e-05	Loss: 3.762776
[2024-08-05 10:39:30,801] {train_model:82} INFO - Train Epoch: 3 [219392/366120 (60%)]	lr:6.75e-05	Loss: 8.076104
[2024-08-05 10:39:36,731] {train_model:82} INFO - Train Epoch: 3 [256000/366120 (70%)]	lr:6.75e-05	Loss: 2.410032
[2024-08-05 10:39:42,662] {train_model:82} INFO - Train Epoch: 3 [292608/366120 (80%)]	lr:6.75e-05	Loss: 2.524064
[2024-08-05 10:39:48,601] {train_model:82} INFO - Train Epoch: 3 [329216/366120 (90%)]	lr:6.75e-05	Loss: 2.289942
[2024-08-05 10:39:54,572] {train_model:82} INFO - Train Epoch: 3 [365824/366120 (100%)]	lr:6.75e-05	Loss: 6.754023
[2024-08-05 10:39:58,285] {run_experiment:79} INFO - 
[2024-08-05 10:39:58,285] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 10:39:58,734] {result_logger:103} INFO - precision on Wake: 0.904
[2024-08-05 10:39:59,058] {result_logger:104} INFO - recall on Wake: 0.794
[2024-08-05 10:39:59,383] {result_logger:107} INFO - F1-score on Wake: 0.846
[2024-08-05 10:39:59,383] {result_logger:108} INFO - 
[2024-08-05 10:39:59,801] {result_logger:103} INFO - precision on REM: 0.359
[2024-08-05 10:40:00,095] {result_logger:104} INFO - recall on REM: 0.805
[2024-08-05 10:40:00,388] {result_logger:107} INFO - F1-score on REM: 0.496
[2024-08-05 10:40:00,389] {result_logger:108} INFO - 
[2024-08-05 10:40:00,835] {result_logger:103} INFO - precision on Non REM: 0.849
[2024-08-05 10:40:01,154] {result_logger:104} INFO - recall on Non REM: 0.858
[2024-08-05 10:40:01,473] {result_logger:107} INFO - F1-score on Non REM: 0.854
[2024-08-05 10:40:01,473] {result_logger:108} INFO - 
[2024-08-05 10:40:01,542] {result_logger:111} INFO - average precision on sleep stages: 0.704
[2024-08-05 10:40:01,612] {result_logger:113} INFO - average recall on sleep stages: 0.819
[2024-08-05 10:40:01,680] {result_logger:115} INFO - average F1-score on sleep stages: 0.732
[2024-08-05 10:40:01,681] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 10:40:01,740] {result_logger:103} INFO - precision on Wake: 0.762
[2024-08-05 10:40:01,780] {result_logger:104} INFO - recall on Wake: 0.873
[2024-08-05 10:40:01,819] {result_logger:107} INFO - F1-score on Wake: 0.814
[2024-08-05 10:40:01,820] {result_logger:108} INFO - 
[2024-08-05 10:40:01,876] {result_logger:103} INFO - precision on REM: 0.389
[2024-08-05 10:40:01,915] {result_logger:104} INFO - recall on REM: 0.811
[2024-08-05 10:40:01,954] {result_logger:107} INFO - F1-score on REM: 0.526
[2024-08-05 10:40:01,954] {result_logger:108} INFO - 
[2024-08-05 10:40:02,012] {result_logger:103} INFO - precision on Non REM: 0.918
[2024-08-05 10:40:02,052] {result_logger:104} INFO - recall on Non REM: 0.611
[2024-08-05 10:40:02,093] {result_logger:107} INFO - F1-score on Non REM: 0.734
[2024-08-05 10:40:02,093] {result_logger:108} INFO - 
[2024-08-05 10:40:02,100] {result_logger:111} INFO - average precision on sleep stages: 0.690
[2024-08-05 10:40:02,107] {result_logger:113} INFO - average recall on sleep stages: 0.765
[2024-08-05 10:40:02,114] {result_logger:115} INFO - average F1-score on sleep stages: 0.691
[2024-08-05 10:40:02,114] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 10:40:02,161] {result_logger:134} INFO - 
[[161857  21096  20794]
 [  2476  14987   1143]
 [ 14678   5703 123386]]
[2024-08-05 10:40:02,208] {result_logger:141} INFO - 
[[ 79.44%  10.35%  10.21%]
 [ 13.31%  80.55%   6.14%]
 [ 10.21%   3.97%  85.82%]]
[2024-08-05 10:40:02,255] {result_logger:145} INFO - 
[[ 90.42%  50.49%  14.31%]
 [  1.38%  35.87%   0.79%]
 [  8.20%  13.65%  84.90%]]
[2024-08-05 10:40:02,255] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 10:40:02,260] {result_logger:134} INFO - 
[[24791  2498  1093]
 [  444  2065    36]
 [ 7304   740 12659]]
[2024-08-05 10:40:02,313] {result_logger:141} INFO - 
[[ 87.35%   8.80%   3.85%]
 [ 17.45%  81.14%   1.41%]
 [ 35.28%   3.57%  61.15%]]
[2024-08-05 10:40:02,362] {result_logger:145} INFO - 
[[ 76.19%  47.11%   7.93%]
 [  1.36%  38.94%   0.26%]
 [ 22.45%  13.95%  91.81%]]
[2024-08-05 10:40:02,540] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 10:40:02,541] {result_logger:77} INFO - actual:
[2024-08-05 10:40:02,541] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 10:40:02,541] {result_logger:79} INFO - predicted:
[2024-08-05 10:40:02,541] {result_logger:80} INFO - 
[[85.18%  5.30%  9.52%]
 [38.75% 56.29%  4.96%]
 [20.06%  4.32% 75.62%]]
[2024-08-05 10:40:02,593] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_B_weighted/model_8conv_2fc-best.pth
[2024-08-05 10:40:02,593] {run_experiment:113} INFO - [epoch   3] execution time: 84.14s	 avg f1-score: 0.6914

[2024-08-05 10:40:02,593] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:40:02,613] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:40:25,602] {train_model:82} INFO - Train Epoch: 4 [36352/366120 (10%)]	lr:8.84e-05	Loss: 4.714812
[2024-08-05 10:40:31,462] {train_model:82} INFO - Train Epoch: 4 [72960/366120 (20%)]	lr:8.84e-05	Loss: 59.299400
[2024-08-05 10:40:37,333] {train_model:82} INFO - Train Epoch: 4 [109568/366120 (30%)]	lr:8.84e-05	Loss: 4.299822
[2024-08-05 10:40:43,215] {train_model:82} INFO - Train Epoch: 4 [146176/366120 (40%)]	lr:8.84e-05	Loss: 0.402805
[2024-08-05 10:40:49,112] {train_model:82} INFO - Train Epoch: 4 [182784/366120 (50%)]	lr:8.84e-05	Loss: 10.115897
[2024-08-05 10:40:55,022] {train_model:82} INFO - Train Epoch: 4 [219392/366120 (60%)]	lr:8.84e-05	Loss: 1.347288
[2024-08-05 10:41:00,929] {train_model:82} INFO - Train Epoch: 4 [256000/366120 (70%)]	lr:8.84e-05	Loss: 11.506913
[2024-08-05 10:41:06,849] {train_model:82} INFO - Train Epoch: 4 [292608/366120 (80%)]	lr:8.84e-05	Loss: 0.683323
[2024-08-05 10:41:12,772] {train_model:82} INFO - Train Epoch: 4 [329216/366120 (90%)]	lr:8.84e-05	Loss: 0.273997
[2024-08-05 10:41:18,729] {train_model:82} INFO - Train Epoch: 4 [365824/366120 (100%)]	lr:8.84e-05	Loss: 0.991414
[2024-08-05 10:41:22,259] {run_experiment:79} INFO - 
[2024-08-05 10:41:22,259] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 10:41:22,708] {result_logger:103} INFO - precision on Wake: 0.926
[2024-08-05 10:41:23,036] {result_logger:104} INFO - recall on Wake: 0.864
[2024-08-05 10:41:23,361] {result_logger:107} INFO - F1-score on Wake: 0.894
[2024-08-05 10:41:23,361] {result_logger:108} INFO - 
[2024-08-05 10:41:23,773] {result_logger:103} INFO - precision on REM: 0.461
[2024-08-05 10:41:24,061] {result_logger:104} INFO - recall on REM: 0.826
[2024-08-05 10:41:24,352] {result_logger:107} INFO - F1-score on REM: 0.592
[2024-08-05 10:41:24,352] {result_logger:108} INFO - 
[2024-08-05 10:41:24,800] {result_logger:103} INFO - precision on Non REM: 0.887
[2024-08-05 10:41:25,123] {result_logger:104} INFO - recall on Non REM: 0.880
[2024-08-05 10:41:25,448] {result_logger:107} INFO - F1-score on Non REM: 0.884
[2024-08-05 10:41:25,448] {result_logger:108} INFO - 
[2024-08-05 10:41:25,516] {result_logger:111} INFO - average precision on sleep stages: 0.758
[2024-08-05 10:41:25,584] {result_logger:113} INFO - average recall on sleep stages: 0.857
[2024-08-05 10:41:25,652] {result_logger:115} INFO - average F1-score on sleep stages: 0.790
[2024-08-05 10:41:25,653] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 10:41:25,711] {result_logger:103} INFO - precision on Wake: 0.672
[2024-08-05 10:41:25,751] {result_logger:104} INFO - recall on Wake: 0.753
[2024-08-05 10:41:25,791] {result_logger:107} INFO - F1-score on Wake: 0.710
[2024-08-05 10:41:25,791] {result_logger:108} INFO - 
[2024-08-05 10:41:25,849] {result_logger:103} INFO - precision on REM: 0.218
[2024-08-05 10:41:25,888] {result_logger:104} INFO - recall on REM: 0.952
[2024-08-05 10:41:25,929] {result_logger:107} INFO - F1-score on REM: 0.355
[2024-08-05 10:41:25,929] {result_logger:108} INFO - 
[2024-08-05 10:41:25,987] {result_logger:103} INFO - precision on Non REM: 0.976
[2024-08-05 10:41:26,027] {result_logger:104} INFO - recall on Non REM: 0.411
[2024-08-05 10:41:26,066] {result_logger:107} INFO - F1-score on Non REM: 0.579
[2024-08-05 10:41:26,066] {result_logger:108} INFO - 
[2024-08-05 10:41:26,073] {result_logger:111} INFO - average precision on sleep stages: 0.622
[2024-08-05 10:41:26,080] {result_logger:113} INFO - average recall on sleep stages: 0.706
[2024-08-05 10:41:26,086] {result_logger:115} INFO - average F1-score on sleep stages: 0.548
[2024-08-05 10:41:26,086] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 10:41:26,132] {result_logger:134} INFO - 
[[176036  12614  15097]
 [  2227  15366   1013]
 [ 11882   5355 126530]]
[2024-08-05 10:41:26,179] {result_logger:141} INFO - 
[[ 86.40%   6.19%   7.41%]
 [ 11.97%  82.59%   5.44%]
 [  8.26%   3.72%  88.01%]]
[2024-08-05 10:41:26,225] {result_logger:145} INFO - 
[[ 92.58%  37.84%  10.58%]
 [  1.17%  46.10%   0.71%]
 [  6.25%  16.06%  88.71%]]
[2024-08-05 10:41:26,225] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 10:41:26,230] {result_logger:134} INFO - 
[[21373  6807   202]
 [  115  2424     6]
 [10308  1877  8518]]
[2024-08-05 10:41:26,235] {result_logger:141} INFO - 
[[ 75.30%  23.98%   0.71%]
 [  4.52%  95.25%   0.24%]
 [ 49.79%   9.07%  41.14%]]
[2024-08-05 10:41:26,239] {result_logger:145} INFO - 
[[ 67.22%  61.28%   2.31%]
 [  0.36%  21.82%   0.07%]
 [ 32.42%  16.90%  97.62%]]
[2024-08-05 10:41:26,293] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 10:41:26,293] {result_logger:77} INFO - actual:
[2024-08-05 10:41:26,293] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 10:41:26,293] {result_logger:79} INFO - predicted:
[2024-08-05 10:41:26,293] {result_logger:80} INFO - 
[[87.65%  6.08%  6.27%]
 [21.60% 77.49%  0.91%]
 [17.50%  6.52% 75.98%]]
[2024-08-05 10:41:26,293] {run_experiment:113} INFO - [epoch   4] execution time: 83.70s	 avg f1-score: 0.5481

[2024-08-05 10:41:26,293] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:41:26,312] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:41:49,708] {train_model:82} INFO - Train Epoch: 5 [36352/366120 (10%)]	lr:1.09e-04	Loss: 0.514910
[2024-08-05 10:41:55,560] {train_model:82} INFO - Train Epoch: 5 [72960/366120 (20%)]	lr:1.09e-04	Loss: 2.216312
[2024-08-05 10:42:01,435] {train_model:82} INFO - Train Epoch: 5 [109568/366120 (30%)]	lr:1.09e-04	Loss: 0.200093
[2024-08-05 10:42:07,321] {train_model:82} INFO - Train Epoch: 5 [146176/366120 (40%)]	lr:1.09e-04	Loss: 0.191677
[2024-08-05 10:42:13,219] {train_model:82} INFO - Train Epoch: 5 [182784/366120 (50%)]	lr:1.09e-04	Loss: 1.005967
[2024-08-05 10:42:19,122] {train_model:82} INFO - Train Epoch: 5 [219392/366120 (60%)]	lr:1.09e-04	Loss: 0.134924
[2024-08-05 10:42:25,037] {train_model:82} INFO - Train Epoch: 5 [256000/366120 (70%)]	lr:1.09e-04	Loss: 0.275891
[2024-08-05 10:42:30,960] {train_model:82} INFO - Train Epoch: 5 [292608/366120 (80%)]	lr:1.09e-04	Loss: 10.386573
[2024-08-05 10:42:36,892] {train_model:82} INFO - Train Epoch: 5 [329216/366120 (90%)]	lr:1.09e-04	Loss: 0.168975
[2024-08-05 10:42:42,854] {train_model:82} INFO - Train Epoch: 5 [365824/366120 (100%)]	lr:1.09e-04	Loss: 27.818363
[2024-08-05 10:42:47,385] {run_experiment:79} INFO - 
[2024-08-05 10:42:47,385] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 10:42:47,832] {result_logger:103} INFO - precision on Wake: 0.956
[2024-08-05 10:42:48,153] {result_logger:104} INFO - recall on Wake: 0.916
[2024-08-05 10:42:48,480] {result_logger:107} INFO - F1-score on Wake: 0.936
[2024-08-05 10:42:48,480] {result_logger:108} INFO - 
[2024-08-05 10:42:48,898] {result_logger:103} INFO - precision on REM: 0.601
[2024-08-05 10:42:49,185] {result_logger:104} INFO - recall on REM: 0.897
[2024-08-05 10:42:49,470] {result_logger:107} INFO - F1-score on REM: 0.720
[2024-08-05 10:42:49,470] {result_logger:108} INFO - 
[2024-08-05 10:42:49,910] {result_logger:103} INFO - precision on Non REM: 0.921
[2024-08-05 10:42:50,225] {result_logger:104} INFO - recall on Non REM: 0.917
[2024-08-05 10:42:50,540] {result_logger:107} INFO - F1-score on Non REM: 0.919
[2024-08-05 10:42:50,540] {result_logger:108} INFO - 
[2024-08-05 10:42:50,604] {result_logger:111} INFO - average precision on sleep stages: 0.826
[2024-08-05 10:42:50,669] {result_logger:113} INFO - average recall on sleep stages: 0.910
[2024-08-05 10:42:50,734] {result_logger:115} INFO - average F1-score on sleep stages: 0.858
[2024-08-05 10:42:50,735] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 10:42:50,793] {result_logger:103} INFO - precision on Wake: 0.846
[2024-08-05 10:42:50,832] {result_logger:104} INFO - recall on Wake: 0.923
[2024-08-05 10:42:50,871] {result_logger:107} INFO - F1-score on Wake: 0.883
[2024-08-05 10:42:50,871] {result_logger:108} INFO - 
[2024-08-05 10:42:50,927] {result_logger:103} INFO - precision on REM: 0.391
[2024-08-05 10:42:50,966] {result_logger:104} INFO - recall on REM: 0.982
[2024-08-05 10:42:51,004] {result_logger:107} INFO - F1-score on REM: 0.560
[2024-08-05 10:42:51,004] {result_logger:108} INFO - 
[2024-08-05 10:42:51,061] {result_logger:103} INFO - precision on Non REM: 0.987
[2024-08-05 10:42:51,101] {result_logger:104} INFO - recall on Non REM: 0.679
[2024-08-05 10:42:51,141] {result_logger:107} INFO - F1-score on Non REM: 0.805
[2024-08-05 10:42:51,142] {result_logger:108} INFO - 
[2024-08-05 10:42:51,148] {result_logger:111} INFO - average precision on sleep stages: 0.741
[2024-08-05 10:42:51,155] {result_logger:113} INFO - average recall on sleep stages: 0.862
[2024-08-05 10:42:51,161] {result_logger:115} INFO - average F1-score on sleep stages: 0.749
[2024-08-05 10:42:51,162] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 10:42:51,206] {result_logger:134} INFO - 
[[186692   6393  10662]
 [  1201  16696    709]
 [  7304   4695 131768]]
[2024-08-05 10:42:51,250] {result_logger:141} INFO - 
[[ 91.63%   3.14%   5.23%]
 [  6.45%  89.73%   3.81%]
 [  5.08%   3.27%  91.65%]]
[2024-08-05 10:42:51,294] {result_logger:145} INFO - 
[[ 95.64%  23.01%   7.45%]
 [  0.62%  60.09%   0.50%]
 [  3.74%  16.90%  92.06%]]
[2024-08-05 10:42:51,295] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 10:42:51,299] {result_logger:134} INFO - 
[[26203  1998   181]
 [   36  2500     9]
 [ 4749  1889 14065]]
[2024-08-05 10:42:51,354] {result_logger:141} INFO - 
[[ 92.32%   7.04%   0.64%]
 [  1.41%  98.23%   0.35%]
 [ 22.94%   9.12%  67.94%]]
[2024-08-05 10:42:51,406] {result_logger:145} INFO - 
[[ 84.56%  31.28%   1.27%]
 [  0.12%  39.14%   0.06%]
 [ 15.33%  29.58%  98.67%]]
[2024-08-05 10:42:51,551] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 10:42:51,552] {result_logger:77} INFO - actual:
[2024-08-05 10:42:51,552] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 10:42:51,552] {result_logger:79} INFO - predicted:
[2024-08-05 10:42:51,552] {result_logger:80} INFO - 
[[90.74%  3.25%  6.01%]
 [25.79% 70.52%  3.70%]
 [ 8.57%  6.15% 85.28%]]
[2024-08-05 10:42:51,604] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_B_weighted/model_8conv_2fc-best.pth
[2024-08-05 10:42:51,604] {run_experiment:113} INFO - [epoch   5] execution time: 85.31s	 avg f1-score: 0.7491

[2024-08-05 10:42:51,604] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:42:51,624] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:43:20,801] {train_model:82} INFO - Train Epoch: 6 [36352/366120 (10%)]	lr:1.30e-04	Loss: 0.246861
[2024-08-05 10:43:26,738] {train_model:82} INFO - Train Epoch: 6 [72960/366120 (20%)]	lr:1.30e-04	Loss: 0.196822
[2024-08-05 10:43:32,687] {train_model:82} INFO - Train Epoch: 6 [109568/366120 (30%)]	lr:1.30e-04	Loss: 5.076766
[2024-08-05 10:43:38,645] {train_model:82} INFO - Train Epoch: 6 [146176/366120 (40%)]	lr:1.30e-04	Loss: 0.267560
[2024-08-05 10:43:44,621] {train_model:82} INFO - Train Epoch: 6 [182784/366120 (50%)]	lr:1.30e-04	Loss: 0.246489
[2024-08-05 10:43:50,612] {train_model:82} INFO - Train Epoch: 6 [219392/366120 (60%)]	lr:1.30e-04	Loss: 0.133642
[2024-08-05 10:43:56,625] {train_model:82} INFO - Train Epoch: 6 [256000/366120 (70%)]	lr:1.30e-04	Loss: 0.224706
[2024-08-05 10:44:02,668] {train_model:82} INFO - Train Epoch: 6 [292608/366120 (80%)]	lr:1.30e-04	Loss: 41.905708
[2024-08-05 10:44:08,704] {train_model:82} INFO - Train Epoch: 6 [329216/366120 (90%)]	lr:1.30e-04	Loss: 11.857275
[2024-08-05 10:44:43,071] {train_model:82} INFO - Train Epoch: 6 [365824/366120 (100%)]	lr:1.30e-04	Loss: 6.145014
[2024-08-05 10:44:49,574] {run_experiment:79} INFO - 
[2024-08-05 10:44:49,574] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 10:44:50,032] {result_logger:103} INFO - precision on Wake: 0.964
[2024-08-05 10:44:50,354] {result_logger:104} INFO - recall on Wake: 0.935
[2024-08-05 10:44:50,685] {result_logger:107} INFO - F1-score on Wake: 0.950
[2024-08-05 10:44:50,685] {result_logger:108} INFO - 
[2024-08-05 10:44:51,082] {result_logger:103} INFO - precision on REM: 0.656
[2024-08-05 10:44:51,377] {result_logger:104} INFO - recall on REM: 0.917
[2024-08-05 10:44:51,665] {result_logger:107} INFO - F1-score on REM: 0.765
[2024-08-05 10:44:51,665] {result_logger:108} INFO - 
[2024-08-05 10:44:52,107] {result_logger:103} INFO - precision on Non REM: 0.934
[2024-08-05 10:44:52,429] {result_logger:104} INFO - recall on Non REM: 0.926
[2024-08-05 10:44:52,750] {result_logger:107} INFO - F1-score on Non REM: 0.930
[2024-08-05 10:44:52,750] {result_logger:108} INFO - 
[2024-08-05 10:44:52,815] {result_logger:111} INFO - average precision on sleep stages: 0.851
[2024-08-05 10:44:52,880] {result_logger:113} INFO - average recall on sleep stages: 0.926
[2024-08-05 10:44:52,946] {result_logger:115} INFO - average F1-score on sleep stages: 0.881
[2024-08-05 10:44:52,947] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 10:44:53,006] {result_logger:103} INFO - precision on Wake: 0.935
[2024-08-05 10:44:53,047] {result_logger:104} INFO - recall on Wake: 0.842
[2024-08-05 10:44:53,088] {result_logger:107} INFO - F1-score on Wake: 0.886
[2024-08-05 10:44:53,089] {result_logger:108} INFO - 
[2024-08-05 10:44:53,147] {result_logger:103} INFO - precision on REM: 0.282
[2024-08-05 10:44:53,187] {result_logger:104} INFO - recall on REM: 0.991
[2024-08-05 10:44:53,228] {result_logger:107} INFO - F1-score on REM: 0.440
[2024-08-05 10:44:53,228] {result_logger:108} INFO - 
[2024-08-05 10:44:53,285] {result_logger:103} INFO - precision on Non REM: 0.979
[2024-08-05 10:44:53,326] {result_logger:104} INFO - recall on Non REM: 0.811
[2024-08-05 10:44:53,366] {result_logger:107} INFO - F1-score on Non REM: 0.887
[2024-08-05 10:44:53,366] {result_logger:108} INFO - 
[2024-08-05 10:44:53,373] {result_logger:111} INFO - average precision on sleep stages: 0.732
[2024-08-05 10:44:53,380] {result_logger:113} INFO - average recall on sleep stages: 0.881
[2024-08-05 10:44:53,386] {result_logger:115} INFO - average F1-score on sleep stages: 0.738
[2024-08-05 10:44:53,386] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 10:44:53,431] {result_logger:134} INFO - 
[[190541   4369   8837]
 [   939  17064    603]
 [  6098   4584 133085]]
[2024-08-05 10:44:53,476] {result_logger:141} INFO - 
[[ 93.52%   2.14%   4.34%]
 [  5.05%  91.71%   3.24%]
 [  4.24%   3.19%  92.57%]]
[2024-08-05 10:44:53,521] {result_logger:145} INFO - 
[[ 96.44%  16.79%   6.20%]
 [  0.48%  65.59%   0.42%]
 [  3.09%  17.62%  93.38%]]
[2024-08-05 10:44:53,521] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 10:44:53,526] {result_logger:134} INFO - 
[[23897  4130   355]
 [   16  2522     7]
 [ 1637  2278 16788]]
[2024-08-05 10:44:53,530] {result_logger:141} INFO - 
[[ 84.20%  14.55%   1.25%]
 [  0.63%  99.10%   0.28%]
 [  7.91%  11.00%  81.09%]]
[2024-08-05 10:44:53,535] {result_logger:145} INFO - 
[[ 93.53%  46.25%   2.07%]
 [  0.06%  28.24%   0.04%]
 [  6.41%  25.51%  97.89%]]
[2024-08-05 10:44:53,588] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 10:44:53,588] {result_logger:77} INFO - actual:
[2024-08-05 10:44:53,588] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 10:44:53,588] {result_logger:79} INFO - predicted:
[2024-08-05 10:44:53,589] {result_logger:80} INFO - 
[[89.22%  5.51%  5.26%]
 [22.86% 70.93%  6.22%]
 [ 4.16%  6.92% 88.92%]]
[2024-08-05 10:44:53,589] {run_experiment:113} INFO - [epoch   6] execution time: 121.98s	 avg f1-score: 0.7376

[2024-08-05 10:44:53,589] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:44:53,608] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:45:16,852] {train_model:82} INFO - Train Epoch: 7 [36352/366120 (10%)]	lr:1.51e-04	Loss: 0.555780
[2024-08-05 10:45:22,865] {train_model:82} INFO - Train Epoch: 7 [72960/366120 (20%)]	lr:1.51e-04	Loss: 1.225430
[2024-08-05 10:45:28,852] {train_model:82} INFO - Train Epoch: 7 [109568/366120 (30%)]	lr:1.51e-04	Loss: 0.150504
[2024-08-05 10:45:34,845] {train_model:82} INFO - Train Epoch: 7 [146176/366120 (40%)]	lr:1.51e-04	Loss: 0.147836
[2024-08-05 10:45:40,865] {train_model:82} INFO - Train Epoch: 7 [182784/366120 (50%)]	lr:1.51e-04	Loss: 0.146711
[2024-08-05 10:45:46,898] {train_model:82} INFO - Train Epoch: 7 [219392/366120 (60%)]	lr:1.51e-04	Loss: 0.119639
[2024-08-05 10:45:52,938] {train_model:82} INFO - Train Epoch: 7 [256000/366120 (70%)]	lr:1.51e-04	Loss: 0.414227
[2024-08-05 10:45:58,980] {train_model:82} INFO - Train Epoch: 7 [292608/366120 (80%)]	lr:1.51e-04	Loss: 0.227175
[2024-08-05 10:46:05,033] {train_model:82} INFO - Train Epoch: 7 [329216/366120 (90%)]	lr:1.51e-04	Loss: 5.383333
[2024-08-05 10:46:35,985] {train_model:82} INFO - Train Epoch: 7 [365824/366120 (100%)]	lr:1.51e-04	Loss: 0.162245
[2024-08-05 10:46:44,202] {run_experiment:79} INFO - 
[2024-08-05 10:46:44,202] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 10:46:44,660] {result_logger:103} INFO - precision on Wake: 0.970
[2024-08-05 10:46:44,988] {result_logger:104} INFO - recall on Wake: 0.941
[2024-08-05 10:46:45,316] {result_logger:107} INFO - F1-score on Wake: 0.955
[2024-08-05 10:46:45,316] {result_logger:108} INFO - 
[2024-08-05 10:46:45,712] {result_logger:103} INFO - precision on REM: 0.677
[2024-08-05 10:46:45,992] {result_logger:104} INFO - recall on REM: 0.933
[2024-08-05 10:46:46,273] {result_logger:107} INFO - F1-score on REM: 0.785
[2024-08-05 10:46:46,273] {result_logger:108} INFO - 
[2024-08-05 10:46:46,718] {result_logger:103} INFO - precision on Non REM: 0.938
[2024-08-05 10:46:47,033] {result_logger:104} INFO - recall on Non REM: 0.931
[2024-08-05 10:46:47,352] {result_logger:107} INFO - F1-score on Non REM: 0.935
[2024-08-05 10:46:47,352] {result_logger:108} INFO - 
[2024-08-05 10:46:47,415] {result_logger:111} INFO - average precision on sleep stages: 0.862
[2024-08-05 10:46:47,478] {result_logger:113} INFO - average recall on sleep stages: 0.935
[2024-08-05 10:46:47,542] {result_logger:115} INFO - average F1-score on sleep stages: 0.892
[2024-08-05 10:46:47,543] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 10:46:47,600] {result_logger:103} INFO - precision on Wake: 0.946
[2024-08-05 10:46:47,640] {result_logger:104} INFO - recall on Wake: 0.854
[2024-08-05 10:46:47,679] {result_logger:107} INFO - F1-score on Wake: 0.897
[2024-08-05 10:46:47,679] {result_logger:108} INFO - 
[2024-08-05 10:46:47,736] {result_logger:103} INFO - precision on REM: 0.329
[2024-08-05 10:46:47,775] {result_logger:104} INFO - recall on REM: 0.990
[2024-08-05 10:46:47,813] {result_logger:107} INFO - F1-score on REM: 0.494
[2024-08-05 10:46:47,813] {result_logger:108} INFO - 
[2024-08-05 10:46:47,870] {result_logger:103} INFO - precision on Non REM: 0.976
[2024-08-05 10:46:47,910] {result_logger:104} INFO - recall on Non REM: 0.865
[2024-08-05 10:46:47,949] {result_logger:107} INFO - F1-score on Non REM: 0.917
[2024-08-05 10:46:47,949] {result_logger:108} INFO - 
[2024-08-05 10:46:47,956] {result_logger:111} INFO - average precision on sleep stages: 0.750
[2024-08-05 10:46:47,963] {result_logger:113} INFO - average recall on sleep stages: 0.903
[2024-08-05 10:46:47,969] {result_logger:115} INFO - average F1-score on sleep stages: 0.769
[2024-08-05 10:46:47,970] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 10:46:48,013] {result_logger:134} INFO - 
[[191796   3618   8333]
 [   707  17353    546]
 [  5229   4650 133888]]
[2024-08-05 10:46:48,056] {result_logger:141} INFO - 
[[ 94.13%   1.78%   4.09%]
 [  3.80%  93.27%   2.93%]
 [  3.64%   3.23%  93.13%]]
[2024-08-05 10:46:48,099] {result_logger:145} INFO - 
[[ 97.00%  14.12%   5.84%]
 [  0.36%  67.73%   0.38%]
 [  2.64%  18.15%  93.78%]]
[2024-08-05 10:46:48,099] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 10:46:48,104] {result_logger:134} INFO - 
[[24231  3721   430]
 [    9  2519    17]
 [ 1378  1420 17905]]
[2024-08-05 10:46:48,289] {result_logger:141} INFO - 
[[ 85.37%  13.11%   1.52%]
 [  0.35%  98.98%   0.67%]
 [  6.66%   6.86%  86.49%]]
[2024-08-05 10:46:48,418] {result_logger:145} INFO - 
[[ 94.59%  48.58%   2.34%]
 [  0.04%  32.89%   0.09%]
 [  5.38%  18.54%  97.56%]]
[2024-08-05 10:46:48,683] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 10:46:48,683] {result_logger:77} INFO - actual:
[2024-08-05 10:46:48,683] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 10:46:48,683] {result_logger:79} INFO - predicted:
[2024-08-05 10:46:48,683] {result_logger:80} INFO - 
[[89.32%  5.25%  5.43%]
 [24.96% 69.79%  5.25%]
 [ 4.49%  5.28% 90.23%]]
[2024-08-05 10:46:48,799] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_B_weighted/model_8conv_2fc-best.pth
[2024-08-05 10:46:48,799] {run_experiment:113} INFO - [epoch   7] execution time: 115.21s	 avg f1-score: 0.7693

[2024-08-05 10:46:48,799] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:46:48,819] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:47:11,695] {train_model:82} INFO - Train Epoch: 8 [36352/366120 (10%)]	lr:1.72e-04	Loss: 0.354770
[2024-08-05 10:47:17,532] {train_model:82} INFO - Train Epoch: 8 [72960/366120 (20%)]	lr:1.72e-04	Loss: 0.228395
[2024-08-05 10:47:23,389] {train_model:82} INFO - Train Epoch: 8 [109568/366120 (30%)]	lr:1.72e-04	Loss: 5.336758
[2024-08-05 10:47:29,260] {train_model:82} INFO - Train Epoch: 8 [146176/366120 (40%)]	lr:1.72e-04	Loss: 0.157576
[2024-08-05 10:47:35,146] {train_model:82} INFO - Train Epoch: 8 [182784/366120 (50%)]	lr:1.72e-04	Loss: 0.144028
[2024-08-05 10:47:41,044] {train_model:82} INFO - Train Epoch: 8 [219392/366120 (60%)]	lr:1.72e-04	Loss: 4.507958
[2024-08-05 10:47:46,948] {train_model:82} INFO - Train Epoch: 8 [256000/366120 (70%)]	lr:1.72e-04	Loss: 0.313069
[2024-08-05 10:47:52,861] {train_model:82} INFO - Train Epoch: 8 [292608/366120 (80%)]	lr:1.72e-04	Loss: 2.696293
[2024-08-05 10:47:58,784] {train_model:82} INFO - Train Epoch: 8 [329216/366120 (90%)]	lr:1.72e-04	Loss: 0.164907
[2024-08-05 10:48:04,731] {train_model:82} INFO - Train Epoch: 8 [365824/366120 (100%)]	lr:1.72e-04	Loss: 0.185222
[2024-08-05 10:48:09,226] {run_experiment:79} INFO - 
[2024-08-05 10:48:09,226] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 10:48:09,686] {result_logger:103} INFO - precision on Wake: 0.971
[2024-08-05 10:48:10,018] {result_logger:104} INFO - recall on Wake: 0.943
[2024-08-05 10:48:10,350] {result_logger:107} INFO - F1-score on Wake: 0.957
[2024-08-05 10:48:10,351] {result_logger:108} INFO - 
[2024-08-05 10:48:10,769] {result_logger:103} INFO - precision on REM: 0.678
[2024-08-05 10:48:11,061] {result_logger:104} INFO - recall on REM: 0.937
[2024-08-05 10:48:11,354] {result_logger:107} INFO - F1-score on REM: 0.787
[2024-08-05 10:48:11,354] {result_logger:108} INFO - 
[2024-08-05 10:48:11,811] {result_logger:103} INFO - precision on Non REM: 0.940
[2024-08-05 10:48:12,132] {result_logger:104} INFO - recall on Non REM: 0.932
[2024-08-05 10:48:12,456] {result_logger:107} INFO - F1-score on Non REM: 0.936
[2024-08-05 10:48:12,457] {result_logger:108} INFO - 
[2024-08-05 10:48:12,527] {result_logger:111} INFO - average precision on sleep stages: 0.863
[2024-08-05 10:48:12,597] {result_logger:113} INFO - average recall on sleep stages: 0.937
[2024-08-05 10:48:12,666] {result_logger:115} INFO - average F1-score on sleep stages: 0.893
[2024-08-05 10:48:12,667] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 10:48:12,725] {result_logger:103} INFO - precision on Wake: 0.925
[2024-08-05 10:48:12,765] {result_logger:104} INFO - recall on Wake: 0.804
[2024-08-05 10:48:12,804] {result_logger:107} INFO - F1-score on Wake: 0.860
[2024-08-05 10:48:12,804] {result_logger:108} INFO - 
[2024-08-05 10:48:12,862] {result_logger:103} INFO - precision on REM: 0.271
[2024-08-05 10:48:12,902] {result_logger:104} INFO - recall on REM: 0.987
[2024-08-05 10:48:12,942] {result_logger:107} INFO - F1-score on REM: 0.426
[2024-08-05 10:48:12,942] {result_logger:108} INFO - 
[2024-08-05 10:48:12,999] {result_logger:103} INFO - precision on Non REM: 0.985
[2024-08-05 10:48:13,038] {result_logger:104} INFO - recall on Non REM: 0.842
[2024-08-05 10:48:13,077] {result_logger:107} INFO - F1-score on Non REM: 0.908
[2024-08-05 10:48:13,077] {result_logger:108} INFO - 
[2024-08-05 10:48:13,084] {result_logger:111} INFO - average precision on sleep stages: 0.727
[2024-08-05 10:48:13,090] {result_logger:113} INFO - average recall on sleep stages: 0.878
[2024-08-05 10:48:13,097] {result_logger:115} INFO - average F1-score on sleep stages: 0.731
[2024-08-05 10:48:13,097] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 10:48:13,145] {result_logger:134} INFO - 
[[192219   3463   8065]
 [   656  17435    515]
 [  4995   4807 133965]]
[2024-08-05 10:48:13,192] {result_logger:141} INFO - 
[[ 94.34%   1.70%   3.96%]
 [  3.53%  93.71%   2.77%]
 [  3.47%   3.34%  93.18%]]
[2024-08-05 10:48:13,239] {result_logger:145} INFO - 
[[ 97.14%  13.47%   5.66%]
 [  0.33%  67.83%   0.36%]
 [  2.52%  18.70%  93.98%]]
[2024-08-05 10:48:13,240] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 10:48:13,244] {result_logger:134} INFO - 
[[22819  5311   252]
 [   14  2512    19]
 [ 1843  1434 17426]]
[2024-08-05 10:48:13,249] {result_logger:141} INFO - 
[[ 80.40%  18.71%   0.89%]
 [  0.55%  98.70%   0.75%]
 [  8.90%   6.93%  84.17%]]
[2024-08-05 10:48:13,254] {result_logger:145} INFO - 
[[ 92.47%  57.37%   1.42%]
 [  0.06%  27.14%   0.11%]
 [  7.47%  15.49%  98.47%]]
[2024-08-05 10:48:13,306] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 10:48:13,306] {result_logger:77} INFO - actual:
[2024-08-05 10:48:13,306] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 10:48:13,306] {result_logger:79} INFO - predicted:
[2024-08-05 10:48:13,306] {result_logger:80} INFO - 
[[87.04%  6.50%  6.45%]
 [24.05% 72.53%  3.42%]
 [ 5.49%  5.30% 89.21%]]
[2024-08-05 10:48:13,306] {run_experiment:113} INFO - [epoch   8] execution time: 84.51s	 avg f1-score: 0.7311

[2024-08-05 10:48:13,306] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:48:13,326] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:48:40,250] {train_model:82} INFO - Train Epoch: 9 [36352/366120 (10%)]	lr:1.93e-04	Loss: 4.406113
[2024-08-05 10:48:46,207] {train_model:82} INFO - Train Epoch: 9 [72960/366120 (20%)]	lr:1.93e-04	Loss: 0.594422
[2024-08-05 10:48:52,182] {train_model:82} INFO - Train Epoch: 9 [109568/366120 (30%)]	lr:1.93e-04	Loss: 0.339458
[2024-08-05 10:48:58,177] {train_model:82} INFO - Train Epoch: 9 [146176/366120 (40%)]	lr:1.93e-04	Loss: 0.516449
[2024-08-05 10:49:04,180] {train_model:82} INFO - Train Epoch: 9 [182784/366120 (50%)]	lr:1.93e-04	Loss: 0.252617
[2024-08-05 10:49:10,193] {train_model:82} INFO - Train Epoch: 9 [219392/366120 (60%)]	lr:1.93e-04	Loss: 5.966132
[2024-08-05 10:49:16,210] {train_model:82} INFO - Train Epoch: 9 [256000/366120 (70%)]	lr:1.93e-04	Loss: 5.207840
[2024-08-05 10:49:22,239] {train_model:82} INFO - Train Epoch: 9 [292608/366120 (80%)]	lr:1.93e-04	Loss: 0.121593
[2024-08-05 10:49:28,256] {train_model:82} INFO - Train Epoch: 9 [329216/366120 (90%)]	lr:1.93e-04	Loss: 0.632538
[2024-08-05 10:50:11,773] {train_model:82} INFO - Train Epoch: 9 [365824/366120 (100%)]	lr:1.93e-04	Loss: 0.082639
[2024-08-05 10:50:19,552] {run_experiment:79} INFO - 
[2024-08-05 10:50:19,552] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 10:50:20,001] {result_logger:103} INFO - precision on Wake: 0.972
[2024-08-05 10:50:20,325] {result_logger:104} INFO - recall on Wake: 0.952
[2024-08-05 10:50:20,646] {result_logger:107} INFO - F1-score on Wake: 0.962
[2024-08-05 10:50:20,646] {result_logger:108} INFO - 
[2024-08-05 10:50:21,058] {result_logger:103} INFO - precision on REM: 0.707
[2024-08-05 10:50:21,340] {result_logger:104} INFO - recall on REM: 0.942
[2024-08-05 10:50:21,623] {result_logger:107} INFO - F1-score on REM: 0.808
[2024-08-05 10:50:21,623] {result_logger:108} INFO - 
[2024-08-05 10:50:22,074] {result_logger:103} INFO - precision on Non REM: 0.946
[2024-08-05 10:50:22,399] {result_logger:104} INFO - recall on Non REM: 0.933
[2024-08-05 10:50:22,730] {result_logger:107} INFO - F1-score on Non REM: 0.939
[2024-08-05 10:50:22,731] {result_logger:108} INFO - 
[2024-08-05 10:50:22,800] {result_logger:111} INFO - average precision on sleep stages: 0.875
[2024-08-05 10:50:22,870] {result_logger:113} INFO - average recall on sleep stages: 0.942
[2024-08-05 10:50:22,940] {result_logger:115} INFO - average F1-score on sleep stages: 0.903
[2024-08-05 10:50:22,941] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 10:50:23,000] {result_logger:103} INFO - precision on Wake: 0.954
[2024-08-05 10:50:23,041] {result_logger:104} INFO - recall on Wake: 0.957
[2024-08-05 10:50:23,082] {result_logger:107} INFO - F1-score on Wake: 0.955
[2024-08-05 10:50:23,083] {result_logger:108} INFO - 
[2024-08-05 10:50:23,141] {result_logger:103} INFO - precision on REM: 0.517
[2024-08-05 10:50:23,181] {result_logger:104} INFO - recall on REM: 0.992
[2024-08-05 10:50:23,222] {result_logger:107} INFO - F1-score on REM: 0.680
[2024-08-05 10:50:23,222] {result_logger:108} INFO - 
[2024-08-05 10:50:23,282] {result_logger:103} INFO - precision on Non REM: 0.983
[2024-08-05 10:50:23,323] {result_logger:104} INFO - recall on Non REM: 0.867
[2024-08-05 10:50:23,365] {result_logger:107} INFO - F1-score on Non REM: 0.921
[2024-08-05 10:50:23,365] {result_logger:108} INFO - 
[2024-08-05 10:50:23,371] {result_logger:111} INFO - average precision on sleep stages: 0.818
[2024-08-05 10:50:23,378] {result_logger:113} INFO - average recall on sleep stages: 0.939
[2024-08-05 10:50:23,384] {result_logger:115} INFO - average F1-score on sleep stages: 0.852
[2024-08-05 10:50:23,384] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 10:50:23,432] {result_logger:134} INFO - 
[[193934   2639   7174]
 [   609  17521    476]
 [  5030   4628 134109]]
[2024-08-05 10:50:23,480] {result_logger:141} INFO - 
[[ 95.18%   1.30%   3.52%]
 [  3.27%  94.17%   2.56%]
 [  3.50%   3.22%  93.28%]]
[2024-08-05 10:50:23,528] {result_logger:145} INFO - 
[[ 97.17%  10.65%   5.06%]
 [  0.31%  70.68%   0.34%]
 [  2.52%  18.67%  94.60%]]
[2024-08-05 10:50:23,528] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 10:50:23,533] {result_logger:134} INFO - 
[[27165   911   306]
 [    8  2524    13]
 [ 1316  1443 17944]]
[2024-08-05 10:50:23,726] {result_logger:141} INFO - 
[[ 95.71%   3.21%   1.08%]
 [  0.31%  99.17%   0.51%]
 [  6.36%   6.97%  86.67%]]
[2024-08-05 10:50:23,846] {result_logger:145} INFO - 
[[ 95.35%  18.68%   1.68%]
 [  0.03%  51.74%   0.07%]
 [  4.62%  29.58%  98.25%]]
[2024-08-05 10:50:24,192] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 10:50:24,192] {result_logger:77} INFO - actual:
[2024-08-05 10:50:24,192] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 10:50:24,192] {result_logger:79} INFO - predicted:
[2024-08-05 10:50:24,192] {result_logger:80} INFO - 
[[92.90%  1.89%  5.21%]
 [23.86% 69.35%  6.79%]
 [ 4.70%  5.23% 90.06%]]
[2024-08-05 10:50:24,321] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_B_weighted/model_8conv_2fc-best.pth
[2024-08-05 10:50:24,321] {run_experiment:113} INFO - [epoch   9] execution time: 131.01s	 avg f1-score: 0.8521

[2024-08-05 10:50:24,321] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:50:24,341] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:50:47,551] {train_model:82} INFO - Train Epoch: 10 [36352/366120 (10%)]	lr:2.14e-04	Loss: 0.135555
[2024-08-05 10:50:53,460] {train_model:82} INFO - Train Epoch: 10 [72960/366120 (20%)]	lr:2.14e-04	Loss: 1.601888
[2024-08-05 10:50:59,390] {train_model:82} INFO - Train Epoch: 10 [109568/366120 (30%)]	lr:2.14e-04	Loss: 0.148875
[2024-08-05 10:51:05,377] {train_model:82} INFO - Train Epoch: 10 [146176/366120 (40%)]	lr:2.14e-04	Loss: 1.453680
[2024-08-05 10:51:11,384] {train_model:82} INFO - Train Epoch: 10 [182784/366120 (50%)]	lr:2.14e-04	Loss: 0.409797
[2024-08-05 10:51:17,404] {train_model:82} INFO - Train Epoch: 10 [219392/366120 (60%)]	lr:2.14e-04	Loss: 0.049053
[2024-08-05 10:51:23,442] {train_model:82} INFO - Train Epoch: 10 [256000/366120 (70%)]	lr:2.14e-04	Loss: 0.136502
[2024-08-05 10:51:29,481] {train_model:82} INFO - Train Epoch: 10 [292608/366120 (80%)]	lr:2.14e-04	Loss: 0.776217
[2024-08-05 10:51:35,536] {train_model:82} INFO - Train Epoch: 10 [329216/366120 (90%)]	lr:2.14e-04	Loss: 0.079065
[2024-08-05 10:52:05,912] {train_model:82} INFO - Train Epoch: 10 [365824/366120 (100%)]	lr:2.14e-04	Loss: 0.069376
[2024-08-05 10:52:14,041] {run_experiment:79} INFO - 
[2024-08-05 10:52:14,041] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 10:52:14,497] {result_logger:103} INFO - precision on Wake: 0.972
[2024-08-05 10:52:14,833] {result_logger:104} INFO - recall on Wake: 0.955
[2024-08-05 10:52:15,171] {result_logger:107} INFO - F1-score on Wake: 0.964
[2024-08-05 10:52:15,171] {result_logger:108} INFO - 
[2024-08-05 10:52:15,589] {result_logger:103} INFO - precision on REM: 0.715
[2024-08-05 10:52:15,883] {result_logger:104} INFO - recall on REM: 0.944
[2024-08-05 10:52:16,176] {result_logger:107} INFO - F1-score on REM: 0.814
[2024-08-05 10:52:16,176] {result_logger:108} INFO - 
[2024-08-05 10:52:16,639] {result_logger:103} INFO - precision on Non REM: 0.950
[2024-08-05 10:52:16,970] {result_logger:104} INFO - recall on Non REM: 0.934
[2024-08-05 10:52:17,303] {result_logger:107} INFO - F1-score on Non REM: 0.942
[2024-08-05 10:52:17,303] {result_logger:108} INFO - 
[2024-08-05 10:52:17,373] {result_logger:111} INFO - average precision on sleep stages: 0.879
[2024-08-05 10:52:17,444] {result_logger:113} INFO - average recall on sleep stages: 0.944
[2024-08-05 10:52:17,516] {result_logger:115} INFO - average F1-score on sleep stages: 0.906
[2024-08-05 10:52:17,517] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 10:52:17,576] {result_logger:103} INFO - precision on Wake: 0.956
[2024-08-05 10:52:17,617] {result_logger:104} INFO - recall on Wake: 0.971
[2024-08-05 10:52:17,658] {result_logger:107} INFO - F1-score on Wake: 0.964
[2024-08-05 10:52:17,658] {result_logger:108} INFO - 
[2024-08-05 10:52:17,716] {result_logger:103} INFO - precision on REM: 0.660
[2024-08-05 10:52:17,756] {result_logger:104} INFO - recall on REM: 0.979
[2024-08-05 10:52:17,797] {result_logger:107} INFO - F1-score on REM: 0.788
[2024-08-05 10:52:17,797] {result_logger:108} INFO - 
[2024-08-05 10:52:17,857] {result_logger:103} INFO - precision on Non REM: 0.974
[2024-08-05 10:52:17,899] {result_logger:104} INFO - recall on Non REM: 0.896
[2024-08-05 10:52:17,941] {result_logger:107} INFO - F1-score on Non REM: 0.933
[2024-08-05 10:52:17,941] {result_logger:108} INFO - 
[2024-08-05 10:52:17,947] {result_logger:111} INFO - average precision on sleep stages: 0.863
[2024-08-05 10:52:17,953] {result_logger:113} INFO - average recall on sleep stages: 0.949
[2024-08-05 10:52:17,960] {result_logger:115} INFO - average F1-score on sleep stages: 0.895
[2024-08-05 10:52:17,960] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 10:52:18,008] {result_logger:134} INFO - 
[[194657   2524   6566]
 [   564  17558    484]
 [  5072   4470 134225]]
[2024-08-05 10:52:18,057] {result_logger:141} INFO - 
[[ 95.54%   1.24%   3.22%]
 [  3.03%  94.37%   2.60%]
 [  3.53%   3.11%  93.36%]]
[2024-08-05 10:52:18,105] {result_logger:145} INFO - 
[[ 97.19%  10.28%   4.65%]
 [  0.28%  71.51%   0.34%]
 [  2.53%  18.21%  95.01%]]
[2024-08-05 10:52:18,105] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 10:52:18,110] {result_logger:134} INFO - 
[[27555   354   473]
 [   29  2492    24]
 [ 1227   931 18545]]
[2024-08-05 10:52:18,310] {result_logger:141} INFO - 
[[ 97.09%   1.25%   1.67%]
 [  1.14%  97.92%   0.94%]
 [  5.93%   4.50%  89.58%]]
[2024-08-05 10:52:18,453] {result_logger:145} INFO - 
[[ 95.64%   9.37%   2.48%]
 [  0.10%  65.98%   0.13%]
 [  4.26%  24.65%  97.39%]]
[2024-08-05 10:52:18,728] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 10:52:18,728] {result_logger:77} INFO - actual:
[2024-08-05 10:52:18,728] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 10:52:18,728] {result_logger:79} INFO - predicted:
[2024-08-05 10:52:18,728] {result_logger:80} INFO - 
[[94.25%  0.76%  4.99%]
 [19.80% 74.32%  5.88%]
 [ 4.77%  3.95% 91.28%]]
[2024-08-05 10:52:18,872] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_B_weighted/model_8conv_2fc-best.pth
[2024-08-05 10:52:18,873] {run_experiment:113} INFO - [epoch  10] execution time: 114.55s	 avg f1-score: 0.8950

[2024-08-05 10:52:18,873] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:52:18,892] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:52:41,831] {train_model:82} INFO - Train Epoch: 11 [36352/366120 (10%)]	lr:2.35e-04	Loss: 0.339041
[2024-08-05 10:52:47,664] {train_model:82} INFO - Train Epoch: 11 [72960/366120 (20%)]	lr:2.35e-04	Loss: 0.146092
[2024-08-05 10:52:53,518] {train_model:82} INFO - Train Epoch: 11 [109568/366120 (30%)]	lr:2.35e-04	Loss: 0.654515
[2024-08-05 10:52:59,385] {train_model:82} INFO - Train Epoch: 11 [146176/366120 (40%)]	lr:2.35e-04	Loss: 0.510392
[2024-08-05 10:53:05,275] {train_model:82} INFO - Train Epoch: 11 [182784/366120 (50%)]	lr:2.35e-04	Loss: 0.139169
[2024-08-05 10:53:11,154] {train_model:82} INFO - Train Epoch: 11 [219392/366120 (60%)]	lr:2.35e-04	Loss: 0.835392
[2024-08-05 10:53:17,049] {train_model:82} INFO - Train Epoch: 11 [256000/366120 (70%)]	lr:2.35e-04	Loss: 3.554528
[2024-08-05 10:53:22,951] {train_model:82} INFO - Train Epoch: 11 [292608/366120 (80%)]	lr:2.35e-04	Loss: 0.177945
[2024-08-05 10:53:28,866] {train_model:82} INFO - Train Epoch: 11 [329216/366120 (90%)]	lr:2.35e-04	Loss: 0.165503
[2024-08-05 10:53:39,265] {train_model:82} INFO - Train Epoch: 11 [365824/366120 (100%)]	lr:2.35e-04	Loss: 0.378885
[2024-08-05 10:53:42,763] {run_experiment:79} INFO - 
[2024-08-05 10:53:42,763] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 10:53:43,224] {result_logger:103} INFO - precision on Wake: 0.974
[2024-08-05 10:53:43,561] {result_logger:104} INFO - recall on Wake: 0.959
[2024-08-05 10:53:43,900] {result_logger:107} INFO - F1-score on Wake: 0.966
[2024-08-05 10:53:43,900] {result_logger:108} INFO - 
[2024-08-05 10:53:44,327] {result_logger:103} INFO - precision on REM: 0.721
[2024-08-05 10:53:44,625] {result_logger:104} INFO - recall on REM: 0.948
[2024-08-05 10:53:44,926] {result_logger:107} INFO - F1-score on REM: 0.819
[2024-08-05 10:53:44,926] {result_logger:108} INFO - 
[2024-08-05 10:53:45,386] {result_logger:103} INFO - precision on Non REM: 0.953
[2024-08-05 10:53:45,721] {result_logger:104} INFO - recall on Non REM: 0.935
[2024-08-05 10:53:46,056] {result_logger:107} INFO - F1-score on Non REM: 0.944
[2024-08-05 10:53:46,057] {result_logger:108} INFO - 
[2024-08-05 10:53:46,123] {result_logger:111} INFO - average precision on sleep stages: 0.883
[2024-08-05 10:53:46,189] {result_logger:113} INFO - average recall on sleep stages: 0.947
[2024-08-05 10:53:46,255] {result_logger:115} INFO - average F1-score on sleep stages: 0.910
[2024-08-05 10:53:46,255] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 10:53:46,313] {result_logger:103} INFO - precision on Wake: 0.952
[2024-08-05 10:53:46,352] {result_logger:104} INFO - recall on Wake: 0.981
[2024-08-05 10:53:46,392] {result_logger:107} INFO - F1-score on Wake: 0.966
[2024-08-05 10:53:46,392] {result_logger:108} INFO - 
[2024-08-05 10:53:46,449] {result_logger:103} INFO - precision on REM: 0.690
[2024-08-05 10:53:46,488] {result_logger:104} INFO - recall on REM: 0.984
[2024-08-05 10:53:46,527] {result_logger:107} INFO - F1-score on REM: 0.811
[2024-08-05 10:53:46,527] {result_logger:108} INFO - 
[2024-08-05 10:53:46,585] {result_logger:103} INFO - precision on Non REM: 0.982
[2024-08-05 10:53:46,624] {result_logger:104} INFO - recall on Non REM: 0.891
[2024-08-05 10:53:46,664] {result_logger:107} INFO - F1-score on Non REM: 0.934
[2024-08-05 10:53:46,664] {result_logger:108} INFO - 
[2024-08-05 10:53:46,670] {result_logger:111} INFO - average precision on sleep stages: 0.875
[2024-08-05 10:53:46,677] {result_logger:113} INFO - average recall on sleep stages: 0.952
[2024-08-05 10:53:46,683] {result_logger:115} INFO - average F1-score on sleep stages: 0.904
[2024-08-05 10:53:46,683] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 10:53:46,728] {result_logger:134} INFO - 
[[195388   2251   6108]
 [   486  17647    473]
 [  4802   4583 134382]]
[2024-08-05 10:53:46,772] {result_logger:141} INFO - 
[[ 95.90%   1.10%   3.00%]
 [  2.61%  94.85%   2.54%]
 [  3.34%   3.19%  93.47%]]
[2024-08-05 10:53:46,817] {result_logger:145} INFO - 
[[ 97.36%   9.19%   4.33%]
 [  0.24%  72.08%   0.34%]
 [  2.39%  18.72%  95.33%]]
[2024-08-05 10:53:46,817] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 10:53:46,821] {result_logger:134} INFO - 
[[27832   239   311]
 [   17  2504    24]
 [ 1374   885 18444]]
[2024-08-05 10:53:47,025] {result_logger:141} INFO - 
[[ 98.06%   0.84%   1.10%]
 [  0.67%  98.39%   0.94%]
 [  6.64%   4.27%  89.09%]]
[2024-08-05 10:53:47,148] {result_logger:145} INFO - 
[[ 95.24%   6.59%   1.66%]
 [  0.06%  69.02%   0.13%]
 [  4.70%  24.39%  98.22%]]
[2024-08-05 10:53:47,436] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 10:53:47,436] {result_logger:77} INFO - actual:
[2024-08-05 10:53:47,436] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 10:53:47,436] {result_logger:79} INFO - predicted:
[2024-08-05 10:53:47,436] {result_logger:80} INFO - 
[[94.26%  0.47%  5.27%]
 [18.91% 77.37%  3.72%]
 [ 5.27%  3.64% 91.09%]]
[2024-08-05 10:53:47,551] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_B_weighted/model_8conv_2fc-best.pth
[2024-08-05 10:53:47,551] {run_experiment:113} INFO - [epoch  11] execution time: 88.68s	 avg f1-score: 0.9040

[2024-08-05 10:53:47,551] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:53:47,570] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:54:10,886] {train_model:82} INFO - Train Epoch: 12 [36352/366120 (10%)]	lr:2.56e-04	Loss: 0.347812
[2024-08-05 10:54:16,849] {train_model:82} INFO - Train Epoch: 12 [72960/366120 (20%)]	lr:2.56e-04	Loss: 0.089830
[2024-08-05 10:54:22,822] {train_model:82} INFO - Train Epoch: 12 [109568/366120 (30%)]	lr:2.56e-04	Loss: 0.144220
[2024-08-05 10:54:28,817] {train_model:82} INFO - Train Epoch: 12 [146176/366120 (40%)]	lr:2.56e-04	Loss: 1.069134
[2024-08-05 10:54:34,817] {train_model:82} INFO - Train Epoch: 12 [182784/366120 (50%)]	lr:2.56e-04	Loss: 0.060203
[2024-08-05 10:54:40,835] {train_model:82} INFO - Train Epoch: 12 [219392/366120 (60%)]	lr:2.56e-04	Loss: 0.059611
[2024-08-05 10:54:46,860] {train_model:82} INFO - Train Epoch: 12 [256000/366120 (70%)]	lr:2.56e-04	Loss: 0.566528
[2024-08-05 10:54:52,892] {train_model:82} INFO - Train Epoch: 12 [292608/366120 (80%)]	lr:2.56e-04	Loss: 0.134443
[2024-08-05 10:54:58,934] {train_model:82} INFO - Train Epoch: 12 [329216/366120 (90%)]	lr:2.56e-04	Loss: 0.076413
[2024-08-05 10:55:31,389] {train_model:82} INFO - Train Epoch: 12 [365824/366120 (100%)]	lr:2.56e-04	Loss: 0.124835
[2024-08-05 10:55:39,530] {run_experiment:79} INFO - 
[2024-08-05 10:55:39,530] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 10:55:39,981] {result_logger:103} INFO - precision on Wake: 0.975
[2024-08-05 10:55:40,302] {result_logger:104} INFO - recall on Wake: 0.962
[2024-08-05 10:55:40,630] {result_logger:107} INFO - F1-score on Wake: 0.968
[2024-08-05 10:55:40,630] {result_logger:108} INFO - 
[2024-08-05 10:55:41,041] {result_logger:103} INFO - precision on REM: 0.740
[2024-08-05 10:55:41,321] {result_logger:104} INFO - recall on REM: 0.953
[2024-08-05 10:55:41,608] {result_logger:107} INFO - F1-score on REM: 0.833
[2024-08-05 10:55:41,608] {result_logger:108} INFO - 
[2024-08-05 10:55:42,057] {result_logger:103} INFO - precision on Non REM: 0.955
[2024-08-05 10:55:42,378] {result_logger:104} INFO - recall on Non REM: 0.939
[2024-08-05 10:55:42,697] {result_logger:107} INFO - F1-score on Non REM: 0.947
[2024-08-05 10:55:42,697] {result_logger:108} INFO - 
[2024-08-05 10:55:42,766] {result_logger:111} INFO - average precision on sleep stages: 0.890
[2024-08-05 10:55:42,836] {result_logger:113} INFO - average recall on sleep stages: 0.951
[2024-08-05 10:55:42,906] {result_logger:115} INFO - average F1-score on sleep stages: 0.916
[2024-08-05 10:55:42,906] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 10:55:42,964] {result_logger:103} INFO - precision on Wake: 0.971
[2024-08-05 10:55:43,003] {result_logger:104} INFO - recall on Wake: 0.903
[2024-08-05 10:55:43,042] {result_logger:107} INFO - F1-score on Wake: 0.936
[2024-08-05 10:55:43,042] {result_logger:108} INFO - 
[2024-08-05 10:55:43,099] {result_logger:103} INFO - precision on REM: 0.457
[2024-08-05 10:55:43,139] {result_logger:104} INFO - recall on REM: 0.987
[2024-08-05 10:55:43,178] {result_logger:107} INFO - F1-score on REM: 0.625
[2024-08-05 10:55:43,178] {result_logger:108} INFO - 
[2024-08-05 10:55:43,235] {result_logger:103} INFO - precision on Non REM: 0.956
[2024-08-05 10:55:43,303] {result_logger:104} INFO - recall on Non REM: 0.912
[2024-08-05 10:55:43,342] {result_logger:107} INFO - F1-score on Non REM: 0.934
[2024-08-05 10:55:43,342] {result_logger:108} INFO - 
[2024-08-05 10:55:43,349] {result_logger:111} INFO - average precision on sleep stages: 0.795
[2024-08-05 10:55:43,355] {result_logger:113} INFO - average recall on sleep stages: 0.934
[2024-08-05 10:55:43,362] {result_logger:115} INFO - average F1-score on sleep stages: 0.831
[2024-08-05 10:55:43,362] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 10:55:43,409] {result_logger:134} INFO - 
[[195924   1945   5878]
 [   414  17738    454]
 [  4541   4287 134939]]
[2024-08-05 10:55:43,457] {result_logger:141} INFO - 
[[ 96.16%   0.95%   2.88%]
 [  2.23%  95.33%   2.44%]
 [  3.16%   2.98%  93.86%]]
[2024-08-05 10:55:43,505] {result_logger:145} INFO - 
[[ 97.53%   8.11%   4.16%]
 [  0.21%  74.00%   0.32%]
 [  2.26%  17.88%  95.52%]]
[2024-08-05 10:55:43,505] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 10:55:43,510] {result_logger:134} INFO - 
[[25616  1921   845]
 [    9  2512    24]
 [  751  1066 18886]]
[2024-08-05 10:55:43,514] {result_logger:141} INFO - 
[[ 90.25%   6.77%   2.98%]
 [  0.35%  98.70%   0.94%]
 [  3.63%   5.15%  91.22%]]
[2024-08-05 10:55:43,519] {result_logger:145} INFO - 
[[ 97.12%  34.93%   4.28%]
 [  0.03%  45.68%   0.12%]
 [  2.85%  19.39%  95.60%]]
[2024-08-05 10:55:43,570] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 10:55:43,570] {result_logger:77} INFO - actual:
[2024-08-05 10:55:43,570] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 10:55:43,570] {result_logger:79} INFO - predicted:
[2024-08-05 10:55:43,570] {result_logger:80} INFO - 
[[91.50%  3.34%  5.16%]
 [24.33% 70.12%  5.55%]
 [ 4.58%  3.86% 91.57%]]
[2024-08-05 10:55:43,570] {run_experiment:113} INFO - [epoch  12] execution time: 116.02s	 avg f1-score: 0.8313

[2024-08-05 10:55:43,570] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:55:43,590] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:56:07,242] {train_model:82} INFO - Train Epoch: 13 [36352/366120 (10%)]	lr:2.41e-04	Loss: 0.141602
[2024-08-05 10:56:13,139] {train_model:82} INFO - Train Epoch: 13 [72960/366120 (20%)]	lr:2.41e-04	Loss: 0.220274
[2024-08-05 10:56:19,055] {train_model:82} INFO - Train Epoch: 13 [109568/366120 (30%)]	lr:2.41e-04	Loss: 0.103426
[2024-08-05 10:56:24,994] {train_model:82} INFO - Train Epoch: 13 [146176/366120 (40%)]	lr:2.41e-04	Loss: 1.071527
[2024-08-05 10:56:30,945] {train_model:82} INFO - Train Epoch: 13 [182784/366120 (50%)]	lr:2.41e-04	Loss: 0.062281
[2024-08-05 10:56:36,922] {train_model:82} INFO - Train Epoch: 13 [219392/366120 (60%)]	lr:2.41e-04	Loss: 0.191946
[2024-08-05 10:56:42,910] {train_model:82} INFO - Train Epoch: 13 [256000/366120 (70%)]	lr:2.41e-04	Loss: 0.873211
[2024-08-05 10:56:48,906] {train_model:82} INFO - Train Epoch: 13 [292608/366120 (80%)]	lr:2.41e-04	Loss: 2.568209
[2024-08-05 10:56:54,908] {train_model:82} INFO - Train Epoch: 13 [329216/366120 (90%)]	lr:2.41e-04	Loss: 0.086348
[2024-08-05 10:57:29,398] {train_model:82} INFO - Train Epoch: 13 [365824/366120 (100%)]	lr:2.41e-04	Loss: 0.139619
[2024-08-05 10:57:35,459] {run_experiment:79} INFO - 
[2024-08-05 10:57:35,460] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 10:57:35,907] {result_logger:103} INFO - precision on Wake: 0.977
[2024-08-05 10:57:36,228] {result_logger:104} INFO - recall on Wake: 0.964
[2024-08-05 10:57:36,551] {result_logger:107} INFO - F1-score on Wake: 0.971
[2024-08-05 10:57:36,551] {result_logger:108} INFO - 
[2024-08-05 10:57:36,950] {result_logger:103} INFO - precision on REM: 0.750
[2024-08-05 10:57:37,235] {result_logger:104} INFO - recall on REM: 0.961
[2024-08-05 10:57:37,522] {result_logger:107} INFO - F1-score on REM: 0.842
[2024-08-05 10:57:37,522] {result_logger:108} INFO - 
[2024-08-05 10:57:37,967] {result_logger:103} INFO - precision on Non REM: 0.958
[2024-08-05 10:57:38,284] {result_logger:104} INFO - recall on Non REM: 0.941
[2024-08-05 10:57:38,605] {result_logger:107} INFO - F1-score on Non REM: 0.950
[2024-08-05 10:57:38,605] {result_logger:108} INFO - 
[2024-08-05 10:57:38,671] {result_logger:111} INFO - average precision on sleep stages: 0.895
[2024-08-05 10:57:38,737] {result_logger:113} INFO - average recall on sleep stages: 0.955
[2024-08-05 10:57:38,803] {result_logger:115} INFO - average F1-score on sleep stages: 0.921
[2024-08-05 10:57:38,804] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 10:57:38,862] {result_logger:103} INFO - precision on Wake: 0.965
[2024-08-05 10:57:38,901] {result_logger:104} INFO - recall on Wake: 0.981
[2024-08-05 10:57:38,940] {result_logger:107} INFO - F1-score on Wake: 0.973
[2024-08-05 10:57:38,940] {result_logger:108} INFO - 
[2024-08-05 10:57:38,997] {result_logger:103} INFO - precision on REM: 0.710
[2024-08-05 10:57:39,036] {result_logger:104} INFO - recall on REM: 0.980
[2024-08-05 10:57:39,075] {result_logger:107} INFO - F1-score on REM: 0.823
[2024-08-05 10:57:39,075] {result_logger:108} INFO - 
[2024-08-05 10:57:39,132] {result_logger:103} INFO - precision on Non REM: 0.975
[2024-08-05 10:57:39,172] {result_logger:104} INFO - recall on Non REM: 0.909
[2024-08-05 10:57:39,211] {result_logger:107} INFO - F1-score on Non REM: 0.941
[2024-08-05 10:57:39,211] {result_logger:108} INFO - 
[2024-08-05 10:57:39,217] {result_logger:111} INFO - average precision on sleep stages: 0.884
[2024-08-05 10:57:39,223] {result_logger:113} INFO - average recall on sleep stages: 0.956
[2024-08-05 10:57:39,229] {result_logger:115} INFO - average F1-score on sleep stages: 0.912
[2024-08-05 10:57:39,230] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 10:57:39,275] {result_logger:134} INFO - 
[[196462   1819   5466]
 [   338  17872    396]
 [  4283   4142 135342]]
[2024-08-05 10:57:39,320] {result_logger:141} INFO - 
[[ 96.42%   0.89%   2.68%]
 [  1.82%  96.06%   2.13%]
 [  2.98%   2.88%  94.14%]]
[2024-08-05 10:57:39,364] {result_logger:145} INFO - 
[[ 97.70%   7.63%   3.87%]
 [  0.17%  74.99%   0.28%]
 [  2.13%  17.38%  95.85%]]
[2024-08-05 10:57:39,364] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 10:57:39,369] {result_logger:134} INFO - 
[[27829    95   458]
 [   32  2494    19]
 [  968   924 18811]]
[2024-08-05 10:57:39,521] {result_logger:141} INFO - 
[[ 98.05%   0.33%   1.61%]
 [  1.26%  98.00%   0.75%]
 [  4.68%   4.46%  90.86%]]
[2024-08-05 10:57:39,606] {result_logger:145} INFO - 
[[ 96.53%   2.70%   2.37%]
 [  0.11%  70.99%   0.10%]
 [  3.36%  26.30%  97.53%]]
[2024-08-05 10:57:39,800] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 10:57:39,800] {result_logger:77} INFO - actual:
[2024-08-05 10:57:39,800] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 10:57:39,800] {result_logger:79} INFO - predicted:
[2024-08-05 10:57:39,800] {result_logger:80} INFO - 
[[94.79%  0.24%  4.97%]
 [17.05% 77.26%  5.69%]
 [ 4.68%  3.79% 91.53%]]
[2024-08-05 10:57:39,884] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_B_weighted/model_8conv_2fc-best.pth
[2024-08-05 10:57:39,884] {run_experiment:113} INFO - [epoch  13] execution time: 116.31s	 avg f1-score: 0.9123

[2024-08-05 10:57:39,884] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:57:39,903] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:58:03,265] {train_model:82} INFO - Train Epoch: 14 [36352/366120 (10%)]	lr:2.27e-04	Loss: 0.059887
[2024-08-05 10:58:09,113] {train_model:82} INFO - Train Epoch: 14 [72960/366120 (20%)]	lr:2.27e-04	Loss: 0.128435
[2024-08-05 10:58:14,977] {train_model:82} INFO - Train Epoch: 14 [109568/366120 (30%)]	lr:2.27e-04	Loss: 0.106655
[2024-08-05 10:58:20,859] {train_model:82} INFO - Train Epoch: 14 [146176/366120 (40%)]	lr:2.27e-04	Loss: 0.093590
[2024-08-05 10:58:26,748] {train_model:82} INFO - Train Epoch: 14 [182784/366120 (50%)]	lr:2.27e-04	Loss: 0.101517
[2024-08-05 10:58:32,650] {train_model:82} INFO - Train Epoch: 14 [219392/366120 (60%)]	lr:2.27e-04	Loss: 0.068211
[2024-08-05 10:58:38,555] {train_model:82} INFO - Train Epoch: 14 [256000/366120 (70%)]	lr:2.27e-04	Loss: 0.077038
[2024-08-05 10:58:44,467] {train_model:82} INFO - Train Epoch: 14 [292608/366120 (80%)]	lr:2.27e-04	Loss: 0.131635
[2024-08-05 10:58:50,387] {train_model:82} INFO - Train Epoch: 14 [329216/366120 (90%)]	lr:2.27e-04	Loss: 0.118256
[2024-08-05 10:59:24,125] {train_model:82} INFO - Train Epoch: 14 [365824/366120 (100%)]	lr:2.27e-04	Loss: 0.496229
[2024-08-05 10:59:30,253] {run_experiment:79} INFO - 
[2024-08-05 10:59:30,253] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 10:59:30,705] {result_logger:103} INFO - precision on Wake: 0.978
[2024-08-05 10:59:31,030] {result_logger:104} INFO - recall on Wake: 0.968
[2024-08-05 10:59:31,358] {result_logger:107} INFO - F1-score on Wake: 0.973
[2024-08-05 10:59:31,358] {result_logger:108} INFO - 
[2024-08-05 10:59:31,771] {result_logger:103} INFO - precision on REM: 0.773
[2024-08-05 10:59:32,053] {result_logger:104} INFO - recall on REM: 0.963
[2024-08-05 10:59:32,336] {result_logger:107} INFO - F1-score on REM: 0.857
[2024-08-05 10:59:32,336] {result_logger:108} INFO - 
[2024-08-05 10:59:32,785] {result_logger:103} INFO - precision on Non REM: 0.961
[2024-08-05 10:59:33,102] {result_logger:104} INFO - recall on Non REM: 0.945
[2024-08-05 10:59:33,429] {result_logger:107} INFO - F1-score on Non REM: 0.953
[2024-08-05 10:59:33,429] {result_logger:108} INFO - 
[2024-08-05 10:59:33,497] {result_logger:111} INFO - average precision on sleep stages: 0.904
[2024-08-05 10:59:33,566] {result_logger:113} INFO - average recall on sleep stages: 0.958
[2024-08-05 10:59:33,634] {result_logger:115} INFO - average F1-score on sleep stages: 0.928
[2024-08-05 10:59:33,635] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 10:59:33,692] {result_logger:103} INFO - precision on Wake: 0.953
[2024-08-05 10:59:33,731] {result_logger:104} INFO - recall on Wake: 0.989
[2024-08-05 10:59:33,772] {result_logger:107} INFO - F1-score on Wake: 0.971
[2024-08-05 10:59:33,772] {result_logger:108} INFO - 
[2024-08-05 10:59:33,829] {result_logger:103} INFO - precision on REM: 0.717
[2024-08-05 10:59:33,868] {result_logger:104} INFO - recall on REM: 0.985
[2024-08-05 10:59:33,907] {result_logger:107} INFO - F1-score on REM: 0.830
[2024-08-05 10:59:33,907] {result_logger:108} INFO - 
[2024-08-05 10:59:33,964] {result_logger:103} INFO - precision on Non REM: 0.987
[2024-08-05 10:59:34,003] {result_logger:104} INFO - recall on Non REM: 0.890
[2024-08-05 10:59:34,042] {result_logger:107} INFO - F1-score on Non REM: 0.936
[2024-08-05 10:59:34,042] {result_logger:108} INFO - 
[2024-08-05 10:59:34,048] {result_logger:111} INFO - average precision on sleep stages: 0.885
[2024-08-05 10:59:34,054] {result_logger:113} INFO - average recall on sleep stages: 0.955
[2024-08-05 10:59:34,060] {result_logger:115} INFO - average F1-score on sleep stages: 0.912
[2024-08-05 10:59:34,061] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 10:59:34,107] {result_logger:134} INFO - 
[[197165   1447   5135]
 [   292  17909    405]
 [  4090   3812 135865]]
[2024-08-05 10:59:34,154] {result_logger:141} INFO - 
[[ 96.77%   0.71%   2.52%]
 [  1.57%  96.25%   2.18%]
 [  2.84%   2.65%  94.50%]]
[2024-08-05 10:59:34,202] {result_logger:145} INFO - 
[[ 97.83%   6.25%   3.63%]
 [  0.14%  77.30%   0.29%]
 [  2.03%  16.45%  96.08%]]
[2024-08-05 10:59:34,202] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 10:59:34,206] {result_logger:134} INFO - 
[[28071    84   227]
 [   16  2507    22]
 [ 1378   905 18420]]
[2024-08-05 10:59:34,211] {result_logger:141} INFO - 
[[ 98.90%   0.30%   0.80%]
 [  0.63%  98.51%   0.86%]
 [  6.66%   4.37%  88.97%]]
[2024-08-05 10:59:34,215] {result_logger:145} INFO - 
[[ 95.27%   2.40%   1.22%]
 [  0.05%  71.71%   0.12%]
 [  4.68%  25.89%  98.67%]]
[2024-08-05 10:59:34,268] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 10:59:34,268] {result_logger:77} INFO - actual:
[2024-08-05 10:59:34,268] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 10:59:34,268] {result_logger:79} INFO - predicted:
[2024-08-05 10:59:34,269] {result_logger:80} INFO - 
[[94.90%  0.16%  4.93%]
 [17.33% 78.18%  4.49%]
 [ 4.80%  3.83% 91.37%]]
[2024-08-05 10:59:34,269] {run_experiment:113} INFO - [epoch  14] execution time: 114.38s	 avg f1-score: 0.9121

[2024-08-05 10:59:34,269] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:59:34,288] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 10:59:57,437] {train_model:82} INFO - Train Epoch: 15 [36352/366120 (10%)]	lr:2.14e-04	Loss: 0.172530
[2024-08-05 11:00:03,378] {train_model:82} INFO - Train Epoch: 15 [72960/366120 (20%)]	lr:2.14e-04	Loss: 0.160052
[2024-08-05 11:00:09,359] {train_model:82} INFO - Train Epoch: 15 [109568/366120 (30%)]	lr:2.14e-04	Loss: 0.186664
[2024-08-05 11:00:15,357] {train_model:82} INFO - Train Epoch: 15 [146176/366120 (40%)]	lr:2.14e-04	Loss: 0.091350
[2024-08-05 11:00:21,368] {train_model:82} INFO - Train Epoch: 15 [182784/366120 (50%)]	lr:2.14e-04	Loss: 0.435435
[2024-08-05 11:00:27,387] {train_model:82} INFO - Train Epoch: 15 [219392/366120 (60%)]	lr:2.14e-04	Loss: 0.186158
[2024-08-05 11:00:33,424] {train_model:82} INFO - Train Epoch: 15 [256000/366120 (70%)]	lr:2.14e-04	Loss: 0.036039
[2024-08-05 11:00:39,465] {train_model:82} INFO - Train Epoch: 15 [292608/366120 (80%)]	lr:2.14e-04	Loss: 0.090241
[2024-08-05 11:00:45,504] {train_model:82} INFO - Train Epoch: 15 [329216/366120 (90%)]	lr:2.14e-04	Loss: 0.049240
[2024-08-05 11:01:45,786] {train_model:82} INFO - Train Epoch: 15 [365824/366120 (100%)]	lr:2.14e-04	Loss: 0.065410
[2024-08-05 11:01:53,900] {run_experiment:79} INFO - 
[2024-08-05 11:01:53,900] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:01:54,353] {result_logger:103} INFO - precision on Wake: 0.980
[2024-08-05 11:01:54,677] {result_logger:104} INFO - recall on Wake: 0.969
[2024-08-05 11:01:54,999] {result_logger:107} INFO - F1-score on Wake: 0.975
[2024-08-05 11:01:54,999] {result_logger:108} INFO - 
[2024-08-05 11:01:55,402] {result_logger:103} INFO - precision on REM: 0.780
[2024-08-05 11:01:55,684] {result_logger:104} INFO - recall on REM: 0.965
[2024-08-05 11:01:55,972] {result_logger:107} INFO - F1-score on REM: 0.863
[2024-08-05 11:01:55,972] {result_logger:108} INFO - 
[2024-08-05 11:01:56,427] {result_logger:103} INFO - precision on Non REM: 0.962
[2024-08-05 11:01:56,753] {result_logger:104} INFO - recall on Non REM: 0.948
[2024-08-05 11:01:57,073] {result_logger:107} INFO - F1-score on Non REM: 0.955
[2024-08-05 11:01:57,073] {result_logger:108} INFO - 
[2024-08-05 11:01:57,140] {result_logger:111} INFO - average precision on sleep stages: 0.907
[2024-08-05 11:01:57,207] {result_logger:113} INFO - average recall on sleep stages: 0.961
[2024-08-05 11:01:57,275] {result_logger:115} INFO - average F1-score on sleep stages: 0.931
[2024-08-05 11:01:57,275] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:01:57,333] {result_logger:103} INFO - precision on Wake: 0.979
[2024-08-05 11:01:57,372] {result_logger:104} INFO - recall on Wake: 0.943
[2024-08-05 11:01:57,411] {result_logger:107} INFO - F1-score on Wake: 0.960
[2024-08-05 11:01:57,411] {result_logger:108} INFO - 
[2024-08-05 11:01:57,469] {result_logger:103} INFO - precision on REM: 0.653
[2024-08-05 11:01:57,508] {result_logger:104} INFO - recall on REM: 0.978
[2024-08-05 11:01:57,547] {result_logger:107} INFO - F1-score on REM: 0.783
[2024-08-05 11:01:57,547] {result_logger:108} INFO - 
[2024-08-05 11:01:57,604] {result_logger:103} INFO - precision on Non REM: 0.956
[2024-08-05 11:01:57,644] {result_logger:104} INFO - recall on Non REM: 0.946
[2024-08-05 11:01:57,683] {result_logger:107} INFO - F1-score on Non REM: 0.951
[2024-08-05 11:01:57,683] {result_logger:108} INFO - 
[2024-08-05 11:01:57,689] {result_logger:111} INFO - average precision on sleep stages: 0.863
[2024-08-05 11:01:57,695] {result_logger:113} INFO - average recall on sleep stages: 0.955
[2024-08-05 11:01:57,701] {result_logger:115} INFO - average F1-score on sleep stages: 0.898
[2024-08-05 11:01:57,701] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:01:57,748] {result_logger:134} INFO - 
[[197429   1330   4988]
 [   234  17963    409]
 [  3778   3747 136242]]
[2024-08-05 11:01:57,793] {result_logger:141} INFO - 
[[ 96.90%   0.65%   2.45%]
 [  1.26%  96.54%   2.20%]
 [  2.63%   2.61%  94.77%]]
[2024-08-05 11:01:57,839] {result_logger:145} INFO - 
[[ 98.01%   5.77%   3.52%]
 [  0.12%  77.96%   0.29%]
 [  1.88%  16.26%  96.19%]]
[2024-08-05 11:01:57,839] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:01:57,844] {result_logger:134} INFO - 
[[26754   774   854]
 [    4  2488    53]
 [  571   546 19586]]
[2024-08-05 11:01:57,848] {result_logger:141} INFO - 
[[ 94.26%   2.73%   3.01%]
 [  0.16%  97.76%   2.08%]
 [  2.76%   2.64%  94.60%]]
[2024-08-05 11:01:57,852] {result_logger:145} INFO - 
[[ 97.90%  20.33%   4.17%]
 [  0.01%  65.34%   0.26%]
 [  2.09%  14.34%  95.57%]]
[2024-08-05 11:01:57,904] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:01:57,904] {result_logger:77} INFO - actual:
[2024-08-05 11:01:57,904] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:01:57,904] {result_logger:79} INFO - predicted:
[2024-08-05 11:01:57,904] {result_logger:80} INFO - 
[[93.63%  1.34%  5.03%]
 [20.35% 73.92%  5.72%]
 [ 4.71%  3.05% 92.23%]]
[2024-08-05 11:01:57,904] {run_experiment:113} INFO - [epoch  15] execution time: 143.64s	 avg f1-score: 0.8982

[2024-08-05 11:01:57,904] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:01:57,923] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:02:21,257] {train_model:82} INFO - Train Epoch: 16 [36352/366120 (10%)]	lr:2.01e-04	Loss: 0.070775
[2024-08-05 11:02:27,183] {train_model:82} INFO - Train Epoch: 16 [72960/366120 (20%)]	lr:2.01e-04	Loss: 0.102928
[2024-08-05 11:02:33,121] {train_model:82} INFO - Train Epoch: 16 [109568/366120 (30%)]	lr:2.01e-04	Loss: 0.073193
[2024-08-05 11:02:39,092] {train_model:82} INFO - Train Epoch: 16 [146176/366120 (40%)]	lr:2.01e-04	Loss: 0.100667
[2024-08-05 11:02:45,111] {train_model:82} INFO - Train Epoch: 16 [182784/366120 (50%)]	lr:2.01e-04	Loss: 0.101559
[2024-08-05 11:02:51,145] {train_model:82} INFO - Train Epoch: 16 [219392/366120 (60%)]	lr:2.01e-04	Loss: 0.145750
[2024-08-05 11:02:57,190] {train_model:82} INFO - Train Epoch: 16 [256000/366120 (70%)]	lr:2.01e-04	Loss: 0.078485
[2024-08-05 11:03:03,251] {train_model:82} INFO - Train Epoch: 16 [292608/366120 (80%)]	lr:2.01e-04	Loss: 0.036046
[2024-08-05 11:03:09,303] {train_model:82} INFO - Train Epoch: 16 [329216/366120 (90%)]	lr:2.01e-04	Loss: 0.065386
[2024-08-05 11:03:51,771] {train_model:82} INFO - Train Epoch: 16 [365824/366120 (100%)]	lr:2.01e-04	Loss: 0.066670
[2024-08-05 11:03:59,600] {run_experiment:79} INFO - 
[2024-08-05 11:03:59,600] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:04:00,050] {result_logger:103} INFO - precision on Wake: 0.981
[2024-08-05 11:04:00,381] {result_logger:104} INFO - recall on Wake: 0.970
[2024-08-05 11:04:00,706] {result_logger:107} INFO - F1-score on Wake: 0.976
[2024-08-05 11:04:00,706] {result_logger:108} INFO - 
[2024-08-05 11:04:01,115] {result_logger:103} INFO - precision on REM: 0.787
[2024-08-05 11:04:01,402] {result_logger:104} INFO - recall on REM: 0.971
[2024-08-05 11:04:01,685] {result_logger:107} INFO - F1-score on REM: 0.869
[2024-08-05 11:04:01,685] {result_logger:108} INFO - 
[2024-08-05 11:04:02,136] {result_logger:103} INFO - precision on Non REM: 0.963
[2024-08-05 11:04:02,464] {result_logger:104} INFO - recall on Non REM: 0.948
[2024-08-05 11:04:02,782] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2024-08-05 11:04:02,782] {result_logger:108} INFO - 
[2024-08-05 11:04:02,851] {result_logger:111} INFO - average precision on sleep stages: 0.910
[2024-08-05 11:04:02,919] {result_logger:113} INFO - average recall on sleep stages: 0.963
[2024-08-05 11:04:02,988] {result_logger:115} INFO - average F1-score on sleep stages: 0.934
[2024-08-05 11:04:02,988] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:04:03,045] {result_logger:103} INFO - precision on Wake: 0.976
[2024-08-05 11:04:03,084] {result_logger:104} INFO - recall on Wake: 0.982
[2024-08-05 11:04:03,122] {result_logger:107} INFO - F1-score on Wake: 0.979
[2024-08-05 11:04:03,122] {result_logger:108} INFO - 
[2024-08-05 11:04:03,177] {result_logger:103} INFO - precision on REM: 0.787
[2024-08-05 11:04:03,215] {result_logger:104} INFO - recall on REM: 0.977
[2024-08-05 11:04:03,254] {result_logger:107} INFO - F1-score on REM: 0.872
[2024-08-05 11:04:03,254] {result_logger:108} INFO - 
[2024-08-05 11:04:03,312] {result_logger:103} INFO - precision on Non REM: 0.976
[2024-08-05 11:04:03,351] {result_logger:104} INFO - recall on Non REM: 0.940
[2024-08-05 11:04:03,391] {result_logger:107} INFO - F1-score on Non REM: 0.957
[2024-08-05 11:04:03,391] {result_logger:108} INFO - 
[2024-08-05 11:04:03,397] {result_logger:111} INFO - average precision on sleep stages: 0.913
[2024-08-05 11:04:03,403] {result_logger:113} INFO - average recall on sleep stages: 0.966
[2024-08-05 11:04:03,409] {result_logger:115} INFO - average F1-score on sleep stages: 0.936
[2024-08-05 11:04:03,410] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:04:03,457] {result_logger:134} INFO - 
[[197733   1172   4842]
 [   174  18063    369]
 [  3681   3724 136362]]
[2024-08-05 11:04:03,504] {result_logger:141} INFO - 
[[ 97.05%   0.58%   2.38%]
 [  0.94%  97.08%   1.98%]
 [  2.56%   2.59%  94.85%]]
[2024-08-05 11:04:03,551] {result_logger:145} INFO - 
[[ 98.09%   5.10%   3.42%]
 [  0.09%  78.68%   0.26%]
 [  1.83%  16.22%  96.32%]]
[2024-08-05 11:04:03,551] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:04:03,555] {result_logger:134} INFO - 
[[27860    77   445]
 [   19  2486    40]
 [  652   597 19454]]
[2024-08-05 11:04:03,742] {result_logger:141} INFO - 
[[ 98.16%   0.27%   1.57%]
 [  0.75%  97.68%   1.57%]
 [  3.15%   2.88%  93.97%]]
[2024-08-05 11:04:03,855] {result_logger:145} INFO - 
[[ 97.65%   2.44%   2.23%]
 [  0.07%  78.67%   0.20%]
 [  2.29%  18.89%  97.57%]]
[2024-08-05 11:04:04,135] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:04:04,135] {result_logger:77} INFO - actual:
[2024-08-05 11:04:04,135] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:04:04,135] {result_logger:79} INFO - predicted:
[2024-08-05 11:04:04,135] {result_logger:80} INFO - 
[[95.56%  0.11%  4.33%]
 [15.98% 79.15%  4.87%]
 [ 3.82%  3.14% 93.04%]]
[2024-08-05 11:04:04,252] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_B_weighted/model_8conv_2fc-best.pth
[2024-08-05 11:04:04,252] {run_experiment:113} INFO - [epoch  16] execution time: 126.35s	 avg f1-score: 0.9360

[2024-08-05 11:04:04,252] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:04:04,271] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:04:27,884] {train_model:82} INFO - Train Epoch: 17 [36352/366120 (10%)]	lr:1.90e-04	Loss: 0.047470
[2024-08-05 11:04:33,838] {train_model:82} INFO - Train Epoch: 17 [72960/366120 (20%)]	lr:1.90e-04	Loss: 0.134958
[2024-08-05 11:04:39,783] {train_model:82} INFO - Train Epoch: 17 [109568/366120 (30%)]	lr:1.90e-04	Loss: 0.088363
[2024-08-05 11:04:45,772] {train_model:82} INFO - Train Epoch: 17 [146176/366120 (40%)]	lr:1.90e-04	Loss: 0.394914
[2024-08-05 11:04:51,780] {train_model:82} INFO - Train Epoch: 17 [182784/366120 (50%)]	lr:1.90e-04	Loss: 0.073701
[2024-08-05 11:04:57,807] {train_model:82} INFO - Train Epoch: 17 [219392/366120 (60%)]	lr:1.90e-04	Loss: 0.037242
[2024-08-05 11:05:03,846] {train_model:82} INFO - Train Epoch: 17 [256000/366120 (70%)]	lr:1.90e-04	Loss: 0.058727
[2024-08-05 11:05:09,892] {train_model:82} INFO - Train Epoch: 17 [292608/366120 (80%)]	lr:1.90e-04	Loss: 0.116927
[2024-08-05 11:05:15,946] {train_model:82} INFO - Train Epoch: 17 [329216/366120 (90%)]	lr:1.90e-04	Loss: 0.141342
[2024-08-05 11:06:05,069] {train_model:82} INFO - Train Epoch: 17 [365824/366120 (100%)]	lr:1.90e-04	Loss: 0.073489
[2024-08-05 11:06:12,821] {run_experiment:79} INFO - 
[2024-08-05 11:06:12,821] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:06:13,272] {result_logger:103} INFO - precision on Wake: 0.983
[2024-08-05 11:06:13,601] {result_logger:104} INFO - recall on Wake: 0.972
[2024-08-05 11:06:13,936] {result_logger:107} INFO - F1-score on Wake: 0.977
[2024-08-05 11:06:13,936] {result_logger:108} INFO - 
[2024-08-05 11:06:14,356] {result_logger:103} INFO - precision on REM: 0.801
[2024-08-05 11:06:14,654] {result_logger:104} INFO - recall on REM: 0.973
[2024-08-05 11:06:14,952] {result_logger:107} INFO - F1-score on REM: 0.878
[2024-08-05 11:06:14,952] {result_logger:108} INFO - 
[2024-08-05 11:06:15,412] {result_logger:103} INFO - precision on Non REM: 0.965
[2024-08-05 11:06:15,742] {result_logger:104} INFO - recall on Non REM: 0.952
[2024-08-05 11:06:16,076] {result_logger:107} INFO - F1-score on Non REM: 0.959
[2024-08-05 11:06:16,076] {result_logger:108} INFO - 
[2024-08-05 11:06:16,143] {result_logger:111} INFO - average precision on sleep stages: 0.916
[2024-08-05 11:06:16,210] {result_logger:113} INFO - average recall on sleep stages: 0.966
[2024-08-05 11:06:16,277] {result_logger:115} INFO - average F1-score on sleep stages: 0.938
[2024-08-05 11:06:16,278] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:06:16,336] {result_logger:103} INFO - precision on Wake: 0.971
[2024-08-05 11:06:16,377] {result_logger:104} INFO - recall on Wake: 0.980
[2024-08-05 11:06:16,417] {result_logger:107} INFO - F1-score on Wake: 0.976
[2024-08-05 11:06:16,417] {result_logger:108} INFO - 
[2024-08-05 11:06:16,475] {result_logger:103} INFO - precision on REM: 0.752
[2024-08-05 11:06:16,515] {result_logger:104} INFO - recall on REM: 0.984
[2024-08-05 11:06:16,555] {result_logger:107} INFO - F1-score on REM: 0.852
[2024-08-05 11:06:16,555] {result_logger:108} INFO - 
[2024-08-05 11:06:16,613] {result_logger:103} INFO - precision on Non REM: 0.979
[2024-08-05 11:06:16,654] {result_logger:104} INFO - recall on Non REM: 0.929
[2024-08-05 11:06:16,695] {result_logger:107} INFO - F1-score on Non REM: 0.953
[2024-08-05 11:06:16,695] {result_logger:108} INFO - 
[2024-08-05 11:06:16,701] {result_logger:111} INFO - average precision on sleep stages: 0.901
[2024-08-05 11:06:16,707] {result_logger:113} INFO - average recall on sleep stages: 0.965
[2024-08-05 11:06:16,714] {result_logger:115} INFO - average F1-score on sleep stages: 0.927
[2024-08-05 11:06:16,714] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:06:16,760] {result_logger:134} INFO - 
[[198129   1041   4577]
 [   155  18098    353]
 [  3371   3469 136927]]
[2024-08-05 11:06:16,806] {result_logger:141} INFO - 
[[ 97.24%   0.51%   2.25%]
 [  0.83%  97.27%   1.90%]
 [  2.34%   2.41%  95.24%]]
[2024-08-05 11:06:16,852] {result_logger:145} INFO - 
[[ 98.25%   4.60%   3.23%]
 [  0.08%  80.05%   0.25%]
 [  1.67%  15.34%  96.52%]]
[2024-08-05 11:06:16,852] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:06:16,856] {result_logger:134} INFO - 
[[27827   165   390]
 [    9  2505    31]
 [  811   663 19229]]
[2024-08-05 11:06:16,861] {result_logger:141} INFO - 
[[ 98.04%   0.58%   1.37%]
 [  0.35%  98.43%   1.22%]
 [  3.92%   3.20%  92.88%]]
[2024-08-05 11:06:16,865] {result_logger:145} INFO - 
[[ 97.14%   4.95%   1.98%]
 [  0.03%  75.16%   0.16%]
 [  2.83%  19.89%  97.86%]]
[2024-08-05 11:06:16,917] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:06:16,917] {result_logger:77} INFO - actual:
[2024-08-05 11:06:16,917] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:06:16,917] {result_logger:79} INFO - predicted:
[2024-08-05 11:06:16,917] {result_logger:80} INFO - 
[[94.74%  0.32%  4.94%]
 [16.89% 76.96%  6.15%]
 [ 4.81%  3.44% 91.75%]]
[2024-08-05 11:06:16,917] {run_experiment:113} INFO - [epoch  17] execution time: 132.67s	 avg f1-score: 0.9271

[2024-08-05 11:06:16,917] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:06:16,936] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:06:40,186] {train_model:82} INFO - Train Epoch: 18 [36352/366120 (10%)]	lr:1.79e-04	Loss: 0.042316
[2024-08-05 11:06:46,036] {train_model:82} INFO - Train Epoch: 18 [72960/366120 (20%)]	lr:1.79e-04	Loss: 0.108830
[2024-08-05 11:06:51,885] {train_model:82} INFO - Train Epoch: 18 [109568/366120 (30%)]	lr:1.79e-04	Loss: 0.065607
[2024-08-05 11:06:57,752] {train_model:82} INFO - Train Epoch: 18 [146176/366120 (40%)]	lr:1.79e-04	Loss: 0.053901
[2024-08-05 11:07:03,634] {train_model:82} INFO - Train Epoch: 18 [182784/366120 (50%)]	lr:1.79e-04	Loss: 0.053589
[2024-08-05 11:07:09,520] {train_model:82} INFO - Train Epoch: 18 [219392/366120 (60%)]	lr:1.79e-04	Loss: 0.060708
[2024-08-05 11:07:15,413] {train_model:82} INFO - Train Epoch: 18 [256000/366120 (70%)]	lr:1.79e-04	Loss: 0.105484
[2024-08-05 11:07:21,331] {train_model:82} INFO - Train Epoch: 18 [292608/366120 (80%)]	lr:1.79e-04	Loss: 0.088273
[2024-08-05 11:07:27,265] {train_model:82} INFO - Train Epoch: 18 [329216/366120 (90%)]	lr:1.79e-04	Loss: 0.212765
[2024-08-05 11:07:59,816] {train_model:82} INFO - Train Epoch: 18 [365824/366120 (100%)]	lr:1.79e-04	Loss: 0.248045
[2024-08-05 11:08:07,821] {run_experiment:79} INFO - 
[2024-08-05 11:08:07,821] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:08:08,278] {result_logger:103} INFO - precision on Wake: 0.983
[2024-08-05 11:08:08,606] {result_logger:104} INFO - recall on Wake: 0.974
[2024-08-05 11:08:08,932] {result_logger:107} INFO - F1-score on Wake: 0.979
[2024-08-05 11:08:08,932] {result_logger:108} INFO - 
[2024-08-05 11:08:09,344] {result_logger:103} INFO - precision on REM: 0.813
[2024-08-05 11:08:09,631] {result_logger:104} INFO - recall on REM: 0.973
[2024-08-05 11:08:09,918] {result_logger:107} INFO - F1-score on REM: 0.886
[2024-08-05 11:08:09,918] {result_logger:108} INFO - 
[2024-08-05 11:08:10,375] {result_logger:103} INFO - precision on Non REM: 0.966
[2024-08-05 11:08:10,706] {result_logger:104} INFO - recall on Non REM: 0.954
[2024-08-05 11:08:11,031] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2024-08-05 11:08:11,031] {result_logger:108} INFO - 
[2024-08-05 11:08:11,097] {result_logger:111} INFO - average precision on sleep stages: 0.921
[2024-08-05 11:08:11,163] {result_logger:113} INFO - average recall on sleep stages: 0.967
[2024-08-05 11:08:11,228] {result_logger:115} INFO - average F1-score on sleep stages: 0.942
[2024-08-05 11:08:11,229] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:08:11,289] {result_logger:103} INFO - precision on Wake: 0.967
[2024-08-05 11:08:11,330] {result_logger:104} INFO - recall on Wake: 0.983
[2024-08-05 11:08:11,371] {result_logger:107} INFO - F1-score on Wake: 0.975
[2024-08-05 11:08:11,371] {result_logger:108} INFO - 
[2024-08-05 11:08:11,429] {result_logger:103} INFO - precision on REM: 0.722
[2024-08-05 11:08:11,470] {result_logger:104} INFO - recall on REM: 0.979
[2024-08-05 11:08:11,510] {result_logger:107} INFO - F1-score on REM: 0.831
[2024-08-05 11:08:11,510] {result_logger:108} INFO - 
[2024-08-05 11:08:11,569] {result_logger:103} INFO - precision on Non REM: 0.978
[2024-08-05 11:08:11,611] {result_logger:104} INFO - recall on Non REM: 0.913
[2024-08-05 11:08:11,652] {result_logger:107} INFO - F1-score on Non REM: 0.944
[2024-08-05 11:08:11,652] {result_logger:108} INFO - 
[2024-08-05 11:08:11,658] {result_logger:111} INFO - average precision on sleep stages: 0.889
[2024-08-05 11:08:11,665] {result_logger:113} INFO - average recall on sleep stages: 0.958
[2024-08-05 11:08:11,671] {result_logger:115} INFO - average F1-score on sleep stages: 0.917
[2024-08-05 11:08:11,671] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:08:11,716] {result_logger:134} INFO - 
[[198452    891   4404]
 [   127  18109    370]
 [  3291   3272 137204]]
[2024-08-05 11:08:11,761] {result_logger:141} INFO - 
[[ 97.40%   0.44%   2.16%]
 [  0.68%  97.33%   1.99%]
 [  2.29%   2.28%  95.43%]]
[2024-08-05 11:08:11,806] {result_logger:145} INFO - 
[[ 98.31%   4.00%   3.10%]
 [  0.06%  81.31%   0.26%]
 [  1.63%  14.69%  96.64%]]
[2024-08-05 11:08:11,807] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:08:11,811] {result_logger:134} INFO - 
[[27906    78   398]
 [   25  2491    29]
 [  926   879 18898]]
[2024-08-05 11:08:11,816] {result_logger:141} INFO - 
[[ 98.32%   0.27%   1.40%]
 [  0.98%  97.88%   1.14%]
 [  4.47%   4.25%  91.28%]]
[2024-08-05 11:08:11,820] {result_logger:145} INFO - 
[[ 96.70%   2.26%   2.06%]
 [  0.09%  72.24%   0.15%]
 [  3.21%  25.49%  97.79%]]
[2024-08-05 11:08:11,873] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:08:11,873] {result_logger:77} INFO - actual:
[2024-08-05 11:08:11,873] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:08:11,873] {result_logger:79} INFO - predicted:
[2024-08-05 11:08:11,873] {result_logger:80} INFO - 
[[94.90%  0.15%  4.95%]
 [15.95% 77.52%  6.53%]
 [ 4.77%  3.78% 91.45%]]
[2024-08-05 11:08:11,873] {run_experiment:113} INFO - [epoch  18] execution time: 114.96s	 avg f1-score: 0.9169

[2024-08-05 11:08:11,873] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:08:11,892] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:08:34,690] {train_model:82} INFO - Train Epoch: 19 [36352/366120 (10%)]	lr:1.68e-04	Loss: 0.062277
[2024-08-05 11:08:40,531] {train_model:82} INFO - Train Epoch: 19 [72960/366120 (20%)]	lr:1.68e-04	Loss: 0.068994
[2024-08-05 11:08:46,386] {train_model:82} INFO - Train Epoch: 19 [109568/366120 (30%)]	lr:1.68e-04	Loss: 0.067200
[2024-08-05 11:08:52,263] {train_model:82} INFO - Train Epoch: 19 [146176/366120 (40%)]	lr:1.68e-04	Loss: 0.161073
[2024-08-05 11:08:58,149] {train_model:82} INFO - Train Epoch: 19 [182784/366120 (50%)]	lr:1.68e-04	Loss: 0.045714
[2024-08-05 11:09:04,054] {train_model:82} INFO - Train Epoch: 19 [219392/366120 (60%)]	lr:1.68e-04	Loss: 0.117272
[2024-08-05 11:09:09,970] {train_model:82} INFO - Train Epoch: 19 [256000/366120 (70%)]	lr:1.68e-04	Loss: 0.060100
[2024-08-05 11:09:15,902] {train_model:82} INFO - Train Epoch: 19 [292608/366120 (80%)]	lr:1.68e-04	Loss: 0.052216
[2024-08-05 11:09:21,837] {train_model:82} INFO - Train Epoch: 19 [329216/366120 (90%)]	lr:1.68e-04	Loss: 0.073634
[2024-08-05 11:09:54,297] {train_model:82} INFO - Train Epoch: 19 [365824/366120 (100%)]	lr:1.68e-04	Loss: 0.039979
[2024-08-05 11:10:02,175] {run_experiment:79} INFO - 
[2024-08-05 11:10:02,175] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:10:02,632] {result_logger:103} INFO - precision on Wake: 0.983
[2024-08-05 11:10:02,960] {result_logger:104} INFO - recall on Wake: 0.975
[2024-08-05 11:10:03,283] {result_logger:107} INFO - F1-score on Wake: 0.979
[2024-08-05 11:10:03,283] {result_logger:108} INFO - 
[2024-08-05 11:10:03,695] {result_logger:103} INFO - precision on REM: 0.820
[2024-08-05 11:10:03,978] {result_logger:104} INFO - recall on REM: 0.975
[2024-08-05 11:10:04,254] {result_logger:107} INFO - F1-score on REM: 0.891
[2024-08-05 11:10:04,254] {result_logger:108} INFO - 
[2024-08-05 11:10:04,710] {result_logger:103} INFO - precision on Non REM: 0.967
[2024-08-05 11:10:05,033] {result_logger:104} INFO - recall on Non REM: 0.955
[2024-08-05 11:10:05,361] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2024-08-05 11:10:05,361] {result_logger:108} INFO - 
[2024-08-05 11:10:05,427] {result_logger:111} INFO - average precision on sleep stages: 0.924
[2024-08-05 11:10:05,494] {result_logger:113} INFO - average recall on sleep stages: 0.968
[2024-08-05 11:10:05,560] {result_logger:115} INFO - average F1-score on sleep stages: 0.944
[2024-08-05 11:10:05,561] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:10:05,617] {result_logger:103} INFO - precision on Wake: 0.973
[2024-08-05 11:10:05,655] {result_logger:104} INFO - recall on Wake: 0.980
[2024-08-05 11:10:05,695] {result_logger:107} INFO - F1-score on Wake: 0.977
[2024-08-05 11:10:05,695] {result_logger:108} INFO - 
[2024-08-05 11:10:05,752] {result_logger:103} INFO - precision on REM: 0.792
[2024-08-05 11:10:05,791] {result_logger:104} INFO - recall on REM: 0.972
[2024-08-05 11:10:05,830] {result_logger:107} INFO - F1-score on REM: 0.873
[2024-08-05 11:10:05,830] {result_logger:108} INFO - 
[2024-08-05 11:10:05,887] {result_logger:103} INFO - precision on Non REM: 0.975
[2024-08-05 11:10:05,927] {result_logger:104} INFO - recall on Non REM: 0.937
[2024-08-05 11:10:05,967] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2024-08-05 11:10:05,967] {result_logger:108} INFO - 
[2024-08-05 11:10:05,973] {result_logger:111} INFO - average precision on sleep stages: 0.913
[2024-08-05 11:10:05,979] {result_logger:113} INFO - average recall on sleep stages: 0.963
[2024-08-05 11:10:05,985] {result_logger:115} INFO - average F1-score on sleep stages: 0.935
[2024-08-05 11:10:05,986] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:10:06,031] {result_logger:134} INFO - 
[[198571    797   4379]
 [   129  18150    327]
 [  3235   3179 137353]]
[2024-08-05 11:10:06,076] {result_logger:141} INFO - 
[[ 97.46%   0.39%   2.15%]
 [  0.69%  97.55%   1.76%]
 [  2.25%   2.21%  95.54%]]
[2024-08-05 11:10:06,120] {result_logger:145} INFO - 
[[ 98.33%   3.60%   3.08%]
 [  0.06%  82.03%   0.23%]
 [  1.60%  14.37%  96.69%]]
[2024-08-05 11:10:06,121] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:10:06,125] {result_logger:134} INFO - 
[[27824   116   442]
 [   11  2475    59]
 [  770   533 19400]]
[2024-08-05 11:10:06,130] {result_logger:141} INFO - 
[[ 98.03%   0.41%   1.56%]
 [  0.43%  97.25%   2.32%]
 [  3.72%   2.57%  93.71%]]
[2024-08-05 11:10:06,134] {result_logger:145} INFO - 
[[ 97.27%   3.71%   2.22%]
 [  0.04%  79.23%   0.30%]
 [  2.69%  17.06%  97.48%]]
[2024-08-05 11:10:06,186] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:10:06,186] {result_logger:77} INFO - actual:
[2024-08-05 11:10:06,186] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:10:06,186] {result_logger:79} INFO - predicted:
[2024-08-05 11:10:06,186] {result_logger:80} INFO - 
[[95.25%  0.15%  4.60%]
 [15.91% 78.10%  5.99%]
 [ 4.33%  3.22% 92.45%]]
[2024-08-05 11:10:06,186] {run_experiment:113} INFO - [epoch  19] execution time: 114.31s	 avg f1-score: 0.9351

[2024-08-05 11:10:06,186] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:10:06,206] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:10:29,231] {train_model:82} INFO - Train Epoch: 20 [36352/366120 (10%)]	lr:1.58e-04	Loss: 0.066470
[2024-08-05 11:10:35,223] {train_model:82} INFO - Train Epoch: 20 [72960/366120 (20%)]	lr:1.58e-04	Loss: 0.105333
[2024-08-05 11:10:41,194] {train_model:82} INFO - Train Epoch: 20 [109568/366120 (30%)]	lr:1.58e-04	Loss: 0.083097
[2024-08-05 11:10:47,177] {train_model:82} INFO - Train Epoch: 20 [146176/366120 (40%)]	lr:1.58e-04	Loss: 0.225807
[2024-08-05 11:10:53,166] {train_model:82} INFO - Train Epoch: 20 [182784/366120 (50%)]	lr:1.58e-04	Loss: 0.071056
[2024-08-05 11:10:59,177] {train_model:82} INFO - Train Epoch: 20 [219392/366120 (60%)]	lr:1.58e-04	Loss: 0.076973
[2024-08-05 11:11:05,197] {train_model:82} INFO - Train Epoch: 20 [256000/366120 (70%)]	lr:1.58e-04	Loss: 0.163435
[2024-08-05 11:11:11,230] {train_model:82} INFO - Train Epoch: 20 [292608/366120 (80%)]	lr:1.58e-04	Loss: 0.119706
[2024-08-05 11:11:17,276] {train_model:82} INFO - Train Epoch: 20 [329216/366120 (90%)]	lr:1.58e-04	Loss: 0.021007
[2024-08-05 11:11:48,988] {train_model:82} INFO - Train Epoch: 20 [365824/366120 (100%)]	lr:1.58e-04	Loss: 0.070115
[2024-08-05 11:11:56,743] {run_experiment:79} INFO - 
[2024-08-05 11:11:56,743] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:11:57,192] {result_logger:103} INFO - precision on Wake: 0.985
[2024-08-05 11:11:57,518] {result_logger:104} INFO - recall on Wake: 0.976
[2024-08-05 11:11:57,843] {result_logger:107} INFO - F1-score on Wake: 0.980
[2024-08-05 11:11:57,843] {result_logger:108} INFO - 
[2024-08-05 11:11:58,250] {result_logger:103} INFO - precision on REM: 0.830
[2024-08-05 11:11:58,529] {result_logger:104} INFO - recall on REM: 0.979
[2024-08-05 11:11:58,809] {result_logger:107} INFO - F1-score on REM: 0.898
[2024-08-05 11:11:58,809] {result_logger:108} INFO - 
[2024-08-05 11:11:59,258] {result_logger:103} INFO - precision on Non REM: 0.968
[2024-08-05 11:11:59,584] {result_logger:104} INFO - recall on Non REM: 0.958
[2024-08-05 11:11:59,910] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2024-08-05 11:11:59,910] {result_logger:108} INFO - 
[2024-08-05 11:11:59,980] {result_logger:111} INFO - average precision on sleep stages: 0.927
[2024-08-05 11:12:00,050] {result_logger:113} INFO - average recall on sleep stages: 0.971
[2024-08-05 11:12:00,121] {result_logger:115} INFO - average F1-score on sleep stages: 0.947
[2024-08-05 11:12:00,121] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:12:00,180] {result_logger:103} INFO - precision on Wake: 0.973
[2024-08-05 11:12:00,220] {result_logger:104} INFO - recall on Wake: 0.981
[2024-08-05 11:12:00,260] {result_logger:107} INFO - F1-score on Wake: 0.977
[2024-08-05 11:12:00,260] {result_logger:108} INFO - 
[2024-08-05 11:12:00,317] {result_logger:103} INFO - precision on REM: 0.803
[2024-08-05 11:12:00,356] {result_logger:104} INFO - recall on REM: 0.974
[2024-08-05 11:12:00,396] {result_logger:107} INFO - F1-score on REM: 0.881
[2024-08-05 11:12:00,396] {result_logger:108} INFO - 
[2024-08-05 11:12:00,454] {result_logger:103} INFO - precision on Non REM: 0.977
[2024-08-05 11:12:00,494] {result_logger:104} INFO - recall on Non REM: 0.939
[2024-08-05 11:12:00,535] {result_logger:107} INFO - F1-score on Non REM: 0.958
[2024-08-05 11:12:00,535] {result_logger:108} INFO - 
[2024-08-05 11:12:00,541] {result_logger:111} INFO - average precision on sleep stages: 0.918
[2024-08-05 11:12:00,547] {result_logger:113} INFO - average recall on sleep stages: 0.965
[2024-08-05 11:12:00,554] {result_logger:115} INFO - average F1-score on sleep stages: 0.938
[2024-08-05 11:12:00,554] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:12:00,602] {result_logger:134} INFO - 
[[198779    742   4226]
 [   113  18207    286]
 [  3005   2998 137764]]
[2024-08-05 11:12:00,651] {result_logger:141} INFO - 
[[ 97.56%   0.36%   2.07%]
 [  0.61%  97.86%   1.54%]
 [  2.09%   2.09%  95.82%]]
[2024-08-05 11:12:00,699] {result_logger:145} INFO - 
[[ 98.46%   3.38%   2.97%]
 [  0.06%  82.96%   0.20%]
 [  1.49%  13.66%  96.83%]]
[2024-08-05 11:12:00,699] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:12:00,704] {result_logger:134} INFO - 
[[27852   119   411]
 [   13  2480    52]
 [  770   488 19445]]
[2024-08-05 11:12:00,923] {result_logger:141} INFO - 
[[ 98.13%   0.42%   1.45%]
 [  0.51%  97.45%   2.04%]
 [  3.72%   2.36%  93.92%]]
[2024-08-05 11:12:01,051] {result_logger:145} INFO - 
[[ 97.27%   3.85%   2.06%]
 [  0.05%  80.34%   0.26%]
 [  2.69%  15.81%  97.67%]]
[2024-08-05 11:12:01,326] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:12:01,326] {result_logger:77} INFO - actual:
[2024-08-05 11:12:01,327] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:12:01,327] {result_logger:79} INFO - predicted:
[2024-08-05 11:12:01,327] {result_logger:80} INFO - 
[[94.95%  0.22%  4.83%]
 [16.29% 78.39%  5.31%]
 [ 4.74%  3.03% 92.23%]]
[2024-08-05 11:12:01,434] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_B_weighted/model_8conv_2fc-best.pth
[2024-08-05 11:12:01,434] {run_experiment:113} INFO - [epoch  20] execution time: 115.25s	 avg f1-score: 0.9384

[2024-08-05 11:12:01,434] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:12:01,453] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:12:24,372] {train_model:82} INFO - Train Epoch: 21 [36352/366120 (10%)]	lr:1.49e-04	Loss: 0.057737
[2024-08-05 11:12:30,338] {train_model:82} INFO - Train Epoch: 21 [72960/366120 (20%)]	lr:1.49e-04	Loss: 0.071939
[2024-08-05 11:12:36,318] {train_model:82} INFO - Train Epoch: 21 [109568/366120 (30%)]	lr:1.49e-04	Loss: 0.085863
[2024-08-05 11:12:42,320] {train_model:82} INFO - Train Epoch: 21 [146176/366120 (40%)]	lr:1.49e-04	Loss: 0.197818
[2024-08-05 11:12:48,332] {train_model:82} INFO - Train Epoch: 21 [182784/366120 (50%)]	lr:1.49e-04	Loss: 0.069223
[2024-08-05 11:12:54,359] {train_model:82} INFO - Train Epoch: 21 [219392/366120 (60%)]	lr:1.49e-04	Loss: 0.079696
[2024-08-05 11:13:00,389] {train_model:82} INFO - Train Epoch: 21 [256000/366120 (70%)]	lr:1.49e-04	Loss: 0.087535
[2024-08-05 11:13:06,424] {train_model:82} INFO - Train Epoch: 21 [292608/366120 (80%)]	lr:1.49e-04	Loss: 0.051559
[2024-08-05 11:13:12,468] {train_model:82} INFO - Train Epoch: 21 [329216/366120 (90%)]	lr:1.49e-04	Loss: 0.046829
[2024-08-05 11:13:44,654] {train_model:82} INFO - Train Epoch: 21 [365824/366120 (100%)]	lr:1.49e-04	Loss: 0.111918
[2024-08-05 11:13:52,206] {run_experiment:79} INFO - 
[2024-08-05 11:13:52,207] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:13:52,653] {result_logger:103} INFO - precision on Wake: 0.985
[2024-08-05 11:13:52,973] {result_logger:104} INFO - recall on Wake: 0.977
[2024-08-05 11:13:53,294] {result_logger:107} INFO - F1-score on Wake: 0.981
[2024-08-05 11:13:53,300] {result_logger:108} INFO - 
[2024-08-05 11:13:53,706] {result_logger:103} INFO - precision on REM: 0.837
[2024-08-05 11:13:53,995] {result_logger:104} INFO - recall on REM: 0.980
[2024-08-05 11:13:54,282] {result_logger:107} INFO - F1-score on REM: 0.903
[2024-08-05 11:13:54,282] {result_logger:108} INFO - 
[2024-08-05 11:13:54,736] {result_logger:103} INFO - precision on Non REM: 0.969
[2024-08-05 11:13:55,066] {result_logger:104} INFO - recall on Non REM: 0.959
[2024-08-05 11:13:55,395] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2024-08-05 11:13:55,395] {result_logger:108} INFO - 
[2024-08-05 11:13:55,466] {result_logger:111} INFO - average precision on sleep stages: 0.930
[2024-08-05 11:13:55,536] {result_logger:113} INFO - average recall on sleep stages: 0.972
[2024-08-05 11:13:55,608] {result_logger:115} INFO - average F1-score on sleep stages: 0.949
[2024-08-05 11:13:55,609] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:13:55,667] {result_logger:103} INFO - precision on Wake: 0.977
[2024-08-05 11:13:55,706] {result_logger:104} INFO - recall on Wake: 0.962
[2024-08-05 11:13:55,745] {result_logger:107} INFO - F1-score on Wake: 0.970
[2024-08-05 11:13:55,745] {result_logger:108} INFO - 
[2024-08-05 11:13:55,802] {result_logger:103} INFO - precision on REM: 0.719
[2024-08-05 11:13:55,841] {result_logger:104} INFO - recall on REM: 0.969
[2024-08-05 11:13:55,881] {result_logger:107} INFO - F1-score on REM: 0.825
[2024-08-05 11:13:55,881] {result_logger:108} INFO - 
[2024-08-05 11:13:55,938] {result_logger:103} INFO - precision on Non REM: 0.970
[2024-08-05 11:13:55,976] {result_logger:104} INFO - recall on Non REM: 0.949
[2024-08-05 11:13:56,016] {result_logger:107} INFO - F1-score on Non REM: 0.959
[2024-08-05 11:13:56,016] {result_logger:108} INFO - 
[2024-08-05 11:13:56,022] {result_logger:111} INFO - average precision on sleep stages: 0.889
[2024-08-05 11:13:56,028] {result_logger:113} INFO - average recall on sleep stages: 0.960
[2024-08-05 11:13:56,035] {result_logger:115} INFO - average F1-score on sleep stages: 0.918
[2024-08-05 11:13:56,035] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:13:56,083] {result_logger:134} INFO - 
[[198995    648   4104]
 [    93  18234    279]
 [  2967   2899 137901]]
[2024-08-05 11:13:56,132] {result_logger:141} INFO - 
[[ 97.67%   0.32%   2.01%]
 [  0.50%  98.00%   1.50%]
 [  2.06%   2.02%  95.92%]]
[2024-08-05 11:13:56,181] {result_logger:145} INFO - 
[[ 98.49%   2.98%   2.88%]
 [  0.05%  83.72%   0.20%]
 [  1.47%  13.31%  96.92%]]
[2024-08-05 11:13:56,181] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:13:56,185] {result_logger:134} INFO - 
[[27302   535   545]
 [    9  2465    71]
 [  622   428 19653]]
[2024-08-05 11:13:56,190] {result_logger:141} INFO - 
[[ 96.19%   1.88%   1.92%]
 [  0.35%  96.86%   2.79%]
 [  3.00%   2.07%  94.93%]]
[2024-08-05 11:13:56,194] {result_logger:145} INFO - 
[[ 97.74%  15.61%   2.69%]
 [  0.03%  71.91%   0.35%]
 [  2.23%  12.49%  96.96%]]
[2024-08-05 11:13:56,246] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:13:56,247] {result_logger:77} INFO - actual:
[2024-08-05 11:13:56,247] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:13:56,247] {result_logger:79} INFO - predicted:
[2024-08-05 11:13:56,247] {result_logger:80} INFO - 
[[94.18%  1.02%  4.80%]
 [20.48% 74.39%  5.13%]
 [ 4.56%  2.93% 92.52%]]
[2024-08-05 11:13:56,247] {run_experiment:113} INFO - [epoch  21] execution time: 114.81s	 avg f1-score: 0.9181

[2024-08-05 11:13:56,247] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:13:56,266] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:14:18,971] {train_model:82} INFO - Train Epoch: 22 [36352/366120 (10%)]	lr:1.40e-04	Loss: 0.054535
[2024-08-05 11:14:24,914] {train_model:82} INFO - Train Epoch: 22 [72960/366120 (20%)]	lr:1.40e-04	Loss: 0.042819
[2024-08-05 11:14:30,870] {train_model:82} INFO - Train Epoch: 22 [109568/366120 (30%)]	lr:1.40e-04	Loss: 0.061838
[2024-08-05 11:14:36,845] {train_model:82} INFO - Train Epoch: 22 [146176/366120 (40%)]	lr:1.40e-04	Loss: 0.042221
[2024-08-05 11:14:42,840] {train_model:82} INFO - Train Epoch: 22 [182784/366120 (50%)]	lr:1.40e-04	Loss: 0.120680
[2024-08-05 11:14:48,845] {train_model:82} INFO - Train Epoch: 22 [219392/366120 (60%)]	lr:1.40e-04	Loss: 0.123768
[2024-08-05 11:14:54,857] {train_model:82} INFO - Train Epoch: 22 [256000/366120 (70%)]	lr:1.40e-04	Loss: 0.101649
[2024-08-05 11:15:00,876] {train_model:82} INFO - Train Epoch: 22 [292608/366120 (80%)]	lr:1.40e-04	Loss: 0.153216
[2024-08-05 11:15:06,903] {train_model:82} INFO - Train Epoch: 22 [329216/366120 (90%)]	lr:1.40e-04	Loss: 0.066641
[2024-08-05 11:15:37,606] {train_model:82} INFO - Train Epoch: 22 [365824/366120 (100%)]	lr:1.40e-04	Loss: 0.063646
[2024-08-05 11:15:43,430] {run_experiment:79} INFO - 
[2024-08-05 11:15:43,431] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:15:43,877] {result_logger:103} INFO - precision on Wake: 0.985
[2024-08-05 11:15:44,196] {result_logger:104} INFO - recall on Wake: 0.978
[2024-08-05 11:15:44,514] {result_logger:107} INFO - F1-score on Wake: 0.981
[2024-08-05 11:15:44,514] {result_logger:108} INFO - 
[2024-08-05 11:15:44,918] {result_logger:103} INFO - precision on REM: 0.844
[2024-08-05 11:15:45,201] {result_logger:104} INFO - recall on REM: 0.981
[2024-08-05 11:15:45,491] {result_logger:107} INFO - F1-score on REM: 0.907
[2024-08-05 11:15:45,491] {result_logger:108} INFO - 
[2024-08-05 11:15:45,942] {result_logger:103} INFO - precision on Non REM: 0.970
[2024-08-05 11:15:46,262] {result_logger:104} INFO - recall on Non REM: 0.961
[2024-08-05 11:15:46,589] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2024-08-05 11:15:46,589] {result_logger:108} INFO - 
[2024-08-05 11:15:46,658] {result_logger:111} INFO - average precision on sleep stages: 0.933
[2024-08-05 11:15:46,727] {result_logger:113} INFO - average recall on sleep stages: 0.973
[2024-08-05 11:15:46,796] {result_logger:115} INFO - average F1-score on sleep stages: 0.951
[2024-08-05 11:15:46,797] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:15:46,852] {result_logger:103} INFO - precision on Wake: 0.976
[2024-08-05 11:15:46,890] {result_logger:104} INFO - recall on Wake: 0.975
[2024-08-05 11:15:46,928] {result_logger:107} INFO - F1-score on Wake: 0.976
[2024-08-05 11:15:46,928] {result_logger:108} INFO - 
[2024-08-05 11:15:46,984] {result_logger:103} INFO - precision on REM: 0.767
[2024-08-05 11:15:47,021] {result_logger:104} INFO - recall on REM: 0.978
[2024-08-05 11:15:47,059] {result_logger:107} INFO - F1-score on REM: 0.860
[2024-08-05 11:15:47,059] {result_logger:108} INFO - 
[2024-08-05 11:15:47,115] {result_logger:103} INFO - precision on Non REM: 0.971
[2024-08-05 11:15:47,154] {result_logger:104} INFO - recall on Non REM: 0.939
[2024-08-05 11:15:47,192] {result_logger:107} INFO - F1-score on Non REM: 0.955
[2024-08-05 11:15:47,192] {result_logger:108} INFO - 
[2024-08-05 11:15:47,198] {result_logger:111} INFO - average precision on sleep stages: 0.905
[2024-08-05 11:15:47,204] {result_logger:113} INFO - average recall on sleep stages: 0.964
[2024-08-05 11:15:47,210] {result_logger:115} INFO - average F1-score on sleep stages: 0.930
[2024-08-05 11:15:47,210] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:15:47,258] {result_logger:134} INFO - 
[[199166    629   3952]
 [    95  18250    261]
 [  2916   2753 138098]]
[2024-08-05 11:15:47,305] {result_logger:141} INFO - 
[[ 97.75%   0.31%   1.94%]
 [  0.51%  98.09%   1.40%]
 [  2.03%   1.91%  96.06%]]
[2024-08-05 11:15:47,352] {result_logger:145} INFO - 
[[ 98.51%   2.91%   2.78%]
 [  0.05%  84.37%   0.18%]
 [  1.44%  12.73%  97.04%]]
[2024-08-05 11:15:47,352] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:15:47,356] {result_logger:134} INFO - 
[[27677   177   528]
 [    5  2490    50]
 [  678   578 19447]]
[2024-08-05 11:15:47,361] {result_logger:141} INFO - 
[[ 97.52%   0.62%   1.86%]
 [  0.20%  97.84%   1.96%]
 [  3.27%   2.79%  93.93%]]
[2024-08-05 11:15:47,365] {result_logger:145} INFO - 
[[ 97.59%   5.45%   2.64%]
 [  0.02%  76.73%   0.25%]
 [  2.39%  17.81%  97.11%]]
[2024-08-05 11:15:47,417] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:15:47,417] {result_logger:77} INFO - actual:
[2024-08-05 11:15:47,417] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:15:47,417] {result_logger:79} INFO - predicted:
[2024-08-05 11:15:47,417] {result_logger:80} INFO - 
[[95.06%  0.29%  4.65%]
 [16.12% 77.60%  6.29%]
 [ 4.38%  3.23% 92.39%]]
[2024-08-05 11:15:47,417] {run_experiment:113} INFO - [epoch  22] execution time: 111.17s	 avg f1-score: 0.9302

[2024-08-05 11:15:47,417] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:15:47,436] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:16:09,366] {train_model:82} INFO - Train Epoch: 23 [36352/366120 (10%)]	lr:1.32e-04	Loss: 0.065115
[2024-08-05 11:16:15,271] {train_model:82} INFO - Train Epoch: 23 [72960/366120 (20%)]	lr:1.32e-04	Loss: 0.027994
[2024-08-05 11:16:21,200] {train_model:82} INFO - Train Epoch: 23 [109568/366120 (30%)]	lr:1.32e-04	Loss: 0.070952
[2024-08-05 11:16:27,147] {train_model:82} INFO - Train Epoch: 23 [146176/366120 (40%)]	lr:1.32e-04	Loss: 0.056326
[2024-08-05 11:16:33,105] {train_model:82} INFO - Train Epoch: 23 [182784/366120 (50%)]	lr:1.32e-04	Loss: 0.052343
[2024-08-05 11:16:39,077] {train_model:82} INFO - Train Epoch: 23 [219392/366120 (60%)]	lr:1.32e-04	Loss: 0.240630
[2024-08-05 11:16:45,055] {train_model:82} INFO - Train Epoch: 23 [256000/366120 (70%)]	lr:1.32e-04	Loss: 0.117091
[2024-08-05 11:16:51,047] {train_model:82} INFO - Train Epoch: 23 [292608/366120 (80%)]	lr:1.32e-04	Loss: 0.052791
[2024-08-05 11:17:19,057] {train_model:82} INFO - Train Epoch: 23 [329216/366120 (90%)]	lr:1.32e-04	Loss: 0.072012
[2024-08-05 11:17:27,210] {train_model:82} INFO - Train Epoch: 23 [365824/366120 (100%)]	lr:1.32e-04	Loss: 0.066628
[2024-08-05 11:17:32,841] {run_experiment:79} INFO - 
[2024-08-05 11:17:32,842] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:17:33,295] {result_logger:103} INFO - precision on Wake: 0.985
[2024-08-05 11:17:33,624] {result_logger:104} INFO - recall on Wake: 0.978
[2024-08-05 11:17:33,954] {result_logger:107} INFO - F1-score on Wake: 0.982
[2024-08-05 11:17:33,955] {result_logger:108} INFO - 
[2024-08-05 11:17:34,362] {result_logger:103} INFO - precision on REM: 0.853
[2024-08-05 11:17:34,647] {result_logger:104} INFO - recall on REM: 0.981
[2024-08-05 11:17:34,935] {result_logger:107} INFO - F1-score on REM: 0.913
[2024-08-05 11:17:34,935] {result_logger:108} INFO - 
[2024-08-05 11:17:35,390] {result_logger:103} INFO - precision on Non REM: 0.971
[2024-08-05 11:17:35,712] {result_logger:104} INFO - recall on Non REM: 0.962
[2024-08-05 11:17:36,034] {result_logger:107} INFO - F1-score on Non REM: 0.967
[2024-08-05 11:17:36,034] {result_logger:108} INFO - 
[2024-08-05 11:17:36,102] {result_logger:111} INFO - average precision on sleep stages: 0.936
[2024-08-05 11:17:36,170] {result_logger:113} INFO - average recall on sleep stages: 0.974
[2024-08-05 11:17:36,238] {result_logger:115} INFO - average F1-score on sleep stages: 0.954
[2024-08-05 11:17:36,239] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:17:36,295] {result_logger:103} INFO - precision on Wake: 0.971
[2024-08-05 11:17:36,335] {result_logger:104} INFO - recall on Wake: 0.984
[2024-08-05 11:17:36,374] {result_logger:107} INFO - F1-score on Wake: 0.977
[2024-08-05 11:17:36,374] {result_logger:108} INFO - 
[2024-08-05 11:17:36,430] {result_logger:103} INFO - precision on REM: 0.814
[2024-08-05 11:17:36,469] {result_logger:104} INFO - recall on REM: 0.969
[2024-08-05 11:17:36,508] {result_logger:107} INFO - F1-score on REM: 0.885
[2024-08-05 11:17:36,508] {result_logger:108} INFO - 
[2024-08-05 11:17:36,565] {result_logger:103} INFO - precision on Non REM: 0.977
[2024-08-05 11:17:36,604] {result_logger:104} INFO - recall on Non REM: 0.936
[2024-08-05 11:17:36,644] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2024-08-05 11:17:36,644] {result_logger:108} INFO - 
[2024-08-05 11:17:36,650] {result_logger:111} INFO - average precision on sleep stages: 0.921
[2024-08-05 11:17:36,657] {result_logger:113} INFO - average recall on sleep stages: 0.963
[2024-08-05 11:17:36,663] {result_logger:115} INFO - average F1-score on sleep stages: 0.939
[2024-08-05 11:17:36,663] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:17:36,710] {result_logger:134} INFO - 
[[199282    596   3869]
 [    86  18260    260]
 [  2850   2555 138362]]
[2024-08-05 11:17:36,756] {result_logger:141} INFO - 
[[ 97.81%   0.29%   1.90%]
 [  0.46%  98.14%   1.40%]
 [  1.98%   1.78%  96.24%]]
[2024-08-05 11:17:36,802] {result_logger:145} INFO - 
[[ 98.55%   2.78%   2.72%]
 [  0.04%  85.28%   0.18%]
 [  1.41%  11.93%  97.10%]]
[2024-08-05 11:17:36,802] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:17:36,806] {result_logger:134} INFO - 
[[27931    59   392]
 [   19  2467    59]
 [  824   505 19374]]
[2024-08-05 11:17:36,922] {result_logger:141} INFO - 
[[ 98.41%   0.21%   1.38%]
 [  0.75%  96.94%   2.32%]
 [  3.98%   2.44%  93.58%]]
[2024-08-05 11:17:37,000] {result_logger:145} INFO - 
[[ 97.07%   1.95%   1.98%]
 [  0.07%  81.39%   0.30%]
 [  2.86%  16.66%  97.73%]]
[2024-08-05 11:17:37,212] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:17:37,213] {result_logger:77} INFO - actual:
[2024-08-05 11:17:37,213] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:17:37,213] {result_logger:79} INFO - predicted:
[2024-08-05 11:17:37,213] {result_logger:80} INFO - 
[[95.11%  0.10%  4.79%]
 [15.97% 79.08%  4.95%]
 [ 4.66%  3.05% 92.29%]]
[2024-08-05 11:17:37,297] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_B_weighted/model_8conv_2fc-best.pth
[2024-08-05 11:17:37,297] {run_experiment:113} INFO - [epoch  23] execution time: 109.88s	 avg f1-score: 0.9394

[2024-08-05 11:17:37,297] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:17:37,316] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:17:59,686] {train_model:82} INFO - Train Epoch: 24 [36352/366120 (10%)]	lr:1.25e-04	Loss: 0.061465
[2024-08-05 11:18:05,606] {train_model:82} INFO - Train Epoch: 24 [72960/366120 (20%)]	lr:1.25e-04	Loss: 0.050277
[2024-08-05 11:18:11,542] {train_model:82} INFO - Train Epoch: 24 [109568/366120 (30%)]	lr:1.25e-04	Loss: 0.050630
[2024-08-05 11:18:17,500] {train_model:82} INFO - Train Epoch: 24 [146176/366120 (40%)]	lr:1.25e-04	Loss: 0.036298
[2024-08-05 11:18:23,470] {train_model:82} INFO - Train Epoch: 24 [182784/366120 (50%)]	lr:1.25e-04	Loss: 0.135792
[2024-08-05 11:18:29,449] {train_model:82} INFO - Train Epoch: 24 [219392/366120 (60%)]	lr:1.25e-04	Loss: 0.064932
[2024-08-05 11:18:35,438] {train_model:82} INFO - Train Epoch: 24 [256000/366120 (70%)]	lr:1.25e-04	Loss: 0.061084
[2024-08-05 11:18:41,437] {train_model:82} INFO - Train Epoch: 24 [292608/366120 (80%)]	lr:1.25e-04	Loss: 0.098668
[2024-08-05 11:19:11,693] {train_model:82} INFO - Train Epoch: 24 [329216/366120 (90%)]	lr:1.25e-04	Loss: 0.053795
[2024-08-05 11:19:17,903] {train_model:82} INFO - Train Epoch: 24 [365824/366120 (100%)]	lr:1.25e-04	Loss: 0.134032
[2024-08-05 11:19:23,756] {run_experiment:79} INFO - 
[2024-08-05 11:19:23,756] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:19:24,209] {result_logger:103} INFO - precision on Wake: 0.986
[2024-08-05 11:19:24,532] {result_logger:104} INFO - recall on Wake: 0.979
[2024-08-05 11:19:24,858] {result_logger:107} INFO - F1-score on Wake: 0.982
[2024-08-05 11:19:24,858] {result_logger:108} INFO - 
[2024-08-05 11:19:25,259] {result_logger:103} INFO - precision on REM: 0.862
[2024-08-05 11:19:25,537] {result_logger:104} INFO - recall on REM: 0.984
[2024-08-05 11:19:25,814] {result_logger:107} INFO - F1-score on REM: 0.919
[2024-08-05 11:19:25,814] {result_logger:108} INFO - 
[2024-08-05 11:19:26,251] {result_logger:103} INFO - precision on Non REM: 0.972
[2024-08-05 11:19:26,567] {result_logger:104} INFO - recall on Non REM: 0.964
[2024-08-05 11:19:26,882] {result_logger:107} INFO - F1-score on Non REM: 0.968
[2024-08-05 11:19:26,883] {result_logger:108} INFO - 
[2024-08-05 11:19:26,948] {result_logger:111} INFO - average precision on sleep stages: 0.940
[2024-08-05 11:19:27,014] {result_logger:113} INFO - average recall on sleep stages: 0.976
[2024-08-05 11:19:27,079] {result_logger:115} INFO - average F1-score on sleep stages: 0.956
[2024-08-05 11:19:27,080] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:19:27,136] {result_logger:103} INFO - precision on Wake: 0.979
[2024-08-05 11:19:27,174] {result_logger:104} INFO - recall on Wake: 0.973
[2024-08-05 11:19:27,214] {result_logger:107} INFO - F1-score on Wake: 0.976
[2024-08-05 11:19:27,214] {result_logger:108} INFO - 
[2024-08-05 11:19:27,270] {result_logger:103} INFO - precision on REM: 0.791
[2024-08-05 11:19:27,309] {result_logger:104} INFO - recall on REM: 0.973
[2024-08-05 11:19:27,347] {result_logger:107} INFO - F1-score on REM: 0.873
[2024-08-05 11:19:27,347] {result_logger:108} INFO - 
[2024-08-05 11:19:27,405] {result_logger:103} INFO - precision on Non REM: 0.967
[2024-08-05 11:19:27,444] {result_logger:104} INFO - recall on Non REM: 0.948
[2024-08-05 11:19:27,484] {result_logger:107} INFO - F1-score on Non REM: 0.957
[2024-08-05 11:19:27,484] {result_logger:108} INFO - 
[2024-08-05 11:19:27,490] {result_logger:111} INFO - average precision on sleep stages: 0.913
[2024-08-05 11:19:27,496] {result_logger:113} INFO - average recall on sleep stages: 0.965
[2024-08-05 11:19:27,502] {result_logger:115} INFO - average F1-score on sleep stages: 0.936
[2024-08-05 11:19:27,503] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:19:27,548] {result_logger:134} INFO - 
[[199409    519   3819]
 [    66  18317    223]
 [  2766   2417 138584]]
[2024-08-05 11:19:27,593] {result_logger:141} INFO - 
[[ 97.87%   0.25%   1.87%]
 [  0.35%  98.45%   1.20%]
 [  1.92%   1.68%  96.39%]]
[2024-08-05 11:19:27,637] {result_logger:145} INFO - 
[[ 98.60%   2.44%   2.68%]
 [  0.03%  86.19%   0.16%]
 [  1.37%  11.37%  97.17%]]
[2024-08-05 11:19:27,637] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:19:27,642] {result_logger:134} INFO - 
[[27628   151   603]
 [    9  2477    59]
 [  584   502 19617]]
[2024-08-05 11:19:27,646] {result_logger:141} INFO - 
[[ 97.34%   0.53%   2.12%]
 [  0.35%  97.33%   2.32%]
 [  2.82%   2.42%  94.75%]]
[2024-08-05 11:19:27,651] {result_logger:145} INFO - 
[[ 97.90%   4.82%   2.97%]
 [  0.03%  79.14%   0.29%]
 [  2.07%  16.04%  96.74%]]
[2024-08-05 11:19:27,702] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:19:27,702] {result_logger:77} INFO - actual:
[2024-08-05 11:19:27,703] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:19:27,703] {result_logger:79} INFO - predicted:
[2024-08-05 11:19:27,703] {result_logger:80} INFO - 
[[95.26%  0.24%  4.50%]
 [15.30% 78.21%  6.49%]
 [ 4.23%  3.03% 92.74%]]
[2024-08-05 11:19:27,703] {run_experiment:113} INFO - [epoch  24] execution time: 110.41s	 avg f1-score: 0.9355

[2024-08-05 11:19:27,703] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:19:27,722] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:19:49,562] {train_model:82} INFO - Train Epoch: 25 [36352/366120 (10%)]	lr:1.17e-04	Loss: 0.044450
[2024-08-05 11:19:55,501] {train_model:82} INFO - Train Epoch: 25 [72960/366120 (20%)]	lr:1.17e-04	Loss: 0.045277
[2024-08-05 11:20:01,456] {train_model:82} INFO - Train Epoch: 25 [109568/366120 (30%)]	lr:1.17e-04	Loss: 0.043798
[2024-08-05 11:20:07,442] {train_model:82} INFO - Train Epoch: 25 [146176/366120 (40%)]	lr:1.17e-04	Loss: 0.146479
[2024-08-05 11:20:13,443] {train_model:82} INFO - Train Epoch: 25 [182784/366120 (50%)]	lr:1.17e-04	Loss: 0.058886
[2024-08-05 11:20:19,494] {train_model:82} INFO - Train Epoch: 25 [219392/366120 (60%)]	lr:1.17e-04	Loss: 0.069298
[2024-08-05 11:20:25,556] {train_model:82} INFO - Train Epoch: 25 [256000/366120 (70%)]	lr:1.17e-04	Loss: 0.030470
[2024-08-05 11:20:31,681] {train_model:82} INFO - Train Epoch: 25 [292608/366120 (80%)]	lr:1.17e-04	Loss: 0.028976
[2024-08-05 11:21:10,085] {train_model:82} INFO - Train Epoch: 25 [329216/366120 (90%)]	lr:1.17e-04	Loss: 0.038852
[2024-08-05 11:21:16,005] {train_model:82} INFO - Train Epoch: 25 [365824/366120 (100%)]	lr:1.17e-04	Loss: 0.050919
[2024-08-05 11:21:22,740] {run_experiment:79} INFO - 
[2024-08-05 11:21:22,741] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:21:23,194] {result_logger:103} INFO - precision on Wake: 0.986
[2024-08-05 11:21:23,529] {result_logger:104} INFO - recall on Wake: 0.980
[2024-08-05 11:21:23,855] {result_logger:107} INFO - F1-score on Wake: 0.983
[2024-08-05 11:21:23,856] {result_logger:108} INFO - 
[2024-08-05 11:21:24,259] {result_logger:103} INFO - precision on REM: 0.868
[2024-08-05 11:21:24,546] {result_logger:104} INFO - recall on REM: 0.985
[2024-08-05 11:21:24,839] {result_logger:107} INFO - F1-score on REM: 0.923
[2024-08-05 11:21:24,839] {result_logger:108} INFO - 
[2024-08-05 11:21:25,293] {result_logger:103} INFO - precision on Non REM: 0.973
[2024-08-05 11:21:25,620] {result_logger:104} INFO - recall on Non REM: 0.965
[2024-08-05 11:21:25,946] {result_logger:107} INFO - F1-score on Non REM: 0.969
[2024-08-05 11:21:25,946] {result_logger:108} INFO - 
[2024-08-05 11:21:26,016] {result_logger:111} INFO - average precision on sleep stages: 0.942
[2024-08-05 11:21:26,085] {result_logger:113} INFO - average recall on sleep stages: 0.977
[2024-08-05 11:21:26,154] {result_logger:115} INFO - average F1-score on sleep stages: 0.958
[2024-08-05 11:21:26,155] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:21:26,212] {result_logger:103} INFO - precision on Wake: 0.973
[2024-08-05 11:21:26,251] {result_logger:104} INFO - recall on Wake: 0.982
[2024-08-05 11:21:26,291] {result_logger:107} INFO - F1-score on Wake: 0.977
[2024-08-05 11:21:26,291] {result_logger:108} INFO - 
[2024-08-05 11:21:26,347] {result_logger:103} INFO - precision on REM: 0.800
[2024-08-05 11:21:26,386] {result_logger:104} INFO - recall on REM: 0.968
[2024-08-05 11:21:26,425] {result_logger:107} INFO - F1-score on REM: 0.876
[2024-08-05 11:21:26,425] {result_logger:108} INFO - 
[2024-08-05 11:21:26,482] {result_logger:103} INFO - precision on Non REM: 0.977
[2024-08-05 11:21:26,522] {result_logger:104} INFO - recall on Non REM: 0.938
[2024-08-05 11:21:26,561] {result_logger:107} INFO - F1-score on Non REM: 0.957
[2024-08-05 11:21:26,561] {result_logger:108} INFO - 
[2024-08-05 11:21:26,567] {result_logger:111} INFO - average precision on sleep stages: 0.917
[2024-08-05 11:21:26,573] {result_logger:113} INFO - average recall on sleep stages: 0.963
[2024-08-05 11:21:26,579] {result_logger:115} INFO - average F1-score on sleep stages: 0.937
[2024-08-05 11:21:26,580] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:21:26,627] {result_logger:134} INFO - 
[[199578    494   3675]
 [    72  18333    201]
 [  2694   2296 138777]]
[2024-08-05 11:21:26,674] {result_logger:141} INFO - 
[[ 97.95%   0.24%   1.80%]
 [  0.39%  98.53%   1.08%]
 [  1.87%   1.60%  96.53%]]
[2024-08-05 11:21:26,720] {result_logger:145} INFO - 
[[ 98.63%   2.34%   2.58%]
 [  0.04%  86.79%   0.14%]
 [  1.33%  10.87%  97.28%]]
[2024-08-05 11:21:26,720] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:21:26,725] {result_logger:134} INFO - 
[[27881    93   408]
 [   30  2464    51]
 [  756   522 19425]]
[2024-08-05 11:21:26,729] {result_logger:141} INFO - 
[[ 98.23%   0.33%   1.44%]
 [  1.18%  96.82%   2.00%]
 [  3.65%   2.52%  93.83%]]
[2024-08-05 11:21:26,733] {result_logger:145} INFO - 
[[ 97.26%   3.02%   2.05%]
 [  0.10%  80.03%   0.26%]
 [  2.64%  16.95%  97.69%]]
[2024-08-05 11:21:26,788] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:21:26,788] {result_logger:77} INFO - actual:
[2024-08-05 11:21:26,788] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:21:26,788] {result_logger:79} INFO - predicted:
[2024-08-05 11:21:26,788] {result_logger:80} INFO - 
[[94.85%  0.20%  4.95%]
 [17.08% 78.50%  4.42%]
 [ 4.78%  3.04% 92.17%]]
[2024-08-05 11:21:26,788] {run_experiment:113} INFO - [epoch  25] execution time: 119.09s	 avg f1-score: 0.9370

[2024-08-05 11:21:26,788] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:21:26,807] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:21:52,673] {train_model:82} INFO - Train Epoch: 26 [36352/366120 (10%)]	lr:1.11e-04	Loss: 0.054456
[2024-08-05 11:21:58,498] {train_model:82} INFO - Train Epoch: 26 [72960/366120 (20%)]	lr:1.11e-04	Loss: 0.044611
[2024-08-05 11:22:04,337] {train_model:82} INFO - Train Epoch: 26 [109568/366120 (30%)]	lr:1.11e-04	Loss: 0.024424
[2024-08-05 11:22:10,195] {train_model:82} INFO - Train Epoch: 26 [146176/366120 (40%)]	lr:1.11e-04	Loss: 0.049535
[2024-08-05 11:22:16,070] {train_model:82} INFO - Train Epoch: 26 [182784/366120 (50%)]	lr:1.11e-04	Loss: 0.070440
[2024-08-05 11:22:21,949] {train_model:82} INFO - Train Epoch: 26 [219392/366120 (60%)]	lr:1.11e-04	Loss: 0.049400
[2024-08-05 11:22:27,837] {train_model:82} INFO - Train Epoch: 26 [256000/366120 (70%)]	lr:1.11e-04	Loss: 0.043379
[2024-08-05 11:22:33,733] {train_model:82} INFO - Train Epoch: 26 [292608/366120 (80%)]	lr:1.11e-04	Loss: 0.039816
[2024-08-05 11:23:09,739] {train_model:82} INFO - Train Epoch: 26 [329216/366120 (90%)]	lr:1.11e-04	Loss: 0.067465
[2024-08-05 11:23:15,675] {train_model:82} INFO - Train Epoch: 26 [365824/366120 (100%)]	lr:1.11e-04	Loss: 0.046556
[2024-08-05 11:23:22,234] {run_experiment:79} INFO - 
[2024-08-05 11:23:22,234] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:23:22,696] {result_logger:103} INFO - precision on Wake: 0.987
[2024-08-05 11:23:23,027] {result_logger:104} INFO - recall on Wake: 0.981
[2024-08-05 11:23:23,362] {result_logger:107} INFO - F1-score on Wake: 0.984
[2024-08-05 11:23:23,362] {result_logger:108} INFO - 
[2024-08-05 11:23:23,771] {result_logger:103} INFO - precision on REM: 0.876
[2024-08-05 11:23:24,051] {result_logger:104} INFO - recall on REM: 0.987
[2024-08-05 11:23:24,333] {result_logger:107} INFO - F1-score on REM: 0.928
[2024-08-05 11:23:24,333] {result_logger:108} INFO - 
[2024-08-05 11:23:24,791] {result_logger:103} INFO - precision on Non REM: 0.974
[2024-08-05 11:23:25,119] {result_logger:104} INFO - recall on Non REM: 0.967
[2024-08-05 11:23:25,436] {result_logger:107} INFO - F1-score on Non REM: 0.971
[2024-08-05 11:23:25,436] {result_logger:108} INFO - 
[2024-08-05 11:23:25,504] {result_logger:111} INFO - average precision on sleep stages: 0.946
[2024-08-05 11:23:25,571] {result_logger:113} INFO - average recall on sleep stages: 0.978
[2024-08-05 11:23:25,638] {result_logger:115} INFO - average F1-score on sleep stages: 0.961
[2024-08-05 11:23:25,639] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:23:25,696] {result_logger:103} INFO - precision on Wake: 0.976
[2024-08-05 11:23:25,736] {result_logger:104} INFO - recall on Wake: 0.984
[2024-08-05 11:23:25,775] {result_logger:107} INFO - F1-score on Wake: 0.980
[2024-08-05 11:23:25,775] {result_logger:108} INFO - 
[2024-08-05 11:23:25,833] {result_logger:103} INFO - precision on REM: 0.863
[2024-08-05 11:23:25,871] {result_logger:104} INFO - recall on REM: 0.958
[2024-08-05 11:23:25,910] {result_logger:107} INFO - F1-score on REM: 0.908
[2024-08-05 11:23:25,910] {result_logger:108} INFO - 
[2024-08-05 11:23:25,967] {result_logger:103} INFO - precision on Non REM: 0.976
[2024-08-05 11:23:26,007] {result_logger:104} INFO - recall on Non REM: 0.952
[2024-08-05 11:23:26,046] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2024-08-05 11:23:26,046] {result_logger:108} INFO - 
[2024-08-05 11:23:26,052] {result_logger:111} INFO - average precision on sleep stages: 0.938
[2024-08-05 11:23:26,058] {result_logger:113} INFO - average recall on sleep stages: 0.965
[2024-08-05 11:23:26,064] {result_logger:115} INFO - average F1-score on sleep stages: 0.951
[2024-08-05 11:23:26,065] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:23:26,110] {result_logger:134} INFO - 
[[199781    464   3502]
 [    57  18361    188]
 [  2615   2125 139027]]
[2024-08-05 11:23:26,157] {result_logger:141} INFO - 
[[ 98.05%   0.23%   1.72%]
 [  0.31%  98.68%   1.01%]
 [  1.82%   1.48%  96.70%]]
[2024-08-05 11:23:26,204] {result_logger:145} INFO - 
[[ 98.68%   2.21%   2.45%]
 [  0.03%  87.64%   0.13%]
 [  1.29%  10.14%  97.41%]]
[2024-08-05 11:23:26,204] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:23:26,209] {result_logger:134} INFO - 
[[27932    59   391]
 [    9  2437    99]
 [  665   328 19710]]
[2024-08-05 11:23:26,384] {result_logger:141} INFO - 
[[ 98.41%   0.21%   1.38%]
 [  0.35%  95.76%   3.89%]
 [  3.21%   1.58%  95.20%]]
[2024-08-05 11:23:26,479] {result_logger:145} INFO - 
[[ 97.64%   2.09%   1.94%]
 [  0.03%  86.30%   0.49%]
 [  2.32%  11.61%  97.57%]]
[2024-08-05 11:23:26,719] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:23:26,720] {result_logger:77} INFO - actual:
[2024-08-05 11:23:26,720] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:23:26,720] {result_logger:79} INFO - predicted:
[2024-08-05 11:23:26,720] {result_logger:80} INFO - 
[[95.43%  0.06%  4.51%]
 [15.55% 79.89%  4.57%]
 [ 4.29%  2.73% 92.98%]]
[2024-08-05 11:23:26,800] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_B_weighted/model_8conv_2fc-best.pth
[2024-08-05 11:23:26,800] {run_experiment:113} INFO - [epoch  26] execution time: 120.01s	 avg f1-score: 0.9506

[2024-08-05 11:23:26,800] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:23:26,819] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:23:48,491] {train_model:82} INFO - Train Epoch: 27 [36352/366120 (10%)]	lr:1.04e-04	Loss: 0.051100
[2024-08-05 11:23:54,363] {train_model:82} INFO - Train Epoch: 27 [72960/366120 (20%)]	lr:1.04e-04	Loss: 0.052266
[2024-08-05 11:24:00,209] {train_model:82} INFO - Train Epoch: 27 [109568/366120 (30%)]	lr:1.04e-04	Loss: 0.063098
[2024-08-05 11:24:06,064] {train_model:82} INFO - Train Epoch: 27 [146176/366120 (40%)]	lr:1.04e-04	Loss: 0.018880
[2024-08-05 11:24:11,957] {train_model:82} INFO - Train Epoch: 27 [182784/366120 (50%)]	lr:1.04e-04	Loss: 0.087282
[2024-08-05 11:24:17,847] {train_model:82} INFO - Train Epoch: 27 [219392/366120 (60%)]	lr:1.04e-04	Loss: 0.067992
[2024-08-05 11:24:23,729] {train_model:82} INFO - Train Epoch: 27 [256000/366120 (70%)]	lr:1.04e-04	Loss: 0.034690
[2024-08-05 11:24:29,649] {train_model:82} INFO - Train Epoch: 27 [292608/366120 (80%)]	lr:1.04e-04	Loss: 0.055082
[2024-08-05 11:25:04,594] {train_model:82} INFO - Train Epoch: 27 [329216/366120 (90%)]	lr:1.04e-04	Loss: 0.054761
[2024-08-05 11:25:10,508] {train_model:82} INFO - Train Epoch: 27 [365824/366120 (100%)]	lr:1.04e-04	Loss: 0.034920
[2024-08-05 11:25:16,172] {run_experiment:79} INFO - 
[2024-08-05 11:25:16,172] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:25:16,626] {result_logger:103} INFO - precision on Wake: 0.987
[2024-08-05 11:25:16,954] {result_logger:104} INFO - recall on Wake: 0.982
[2024-08-05 11:25:17,283] {result_logger:107} INFO - F1-score on Wake: 0.985
[2024-08-05 11:25:17,283] {result_logger:108} INFO - 
[2024-08-05 11:25:17,682] {result_logger:103} INFO - precision on REM: 0.883
[2024-08-05 11:25:17,969] {result_logger:104} INFO - recall on REM: 0.988
[2024-08-05 11:25:18,258] {result_logger:107} INFO - F1-score on REM: 0.933
[2024-08-05 11:25:18,258] {result_logger:108} INFO - 
[2024-08-05 11:25:18,709] {result_logger:103} INFO - precision on Non REM: 0.975
[2024-08-05 11:25:19,031] {result_logger:104} INFO - recall on Non REM: 0.968
[2024-08-05 11:25:19,352] {result_logger:107} INFO - F1-score on Non REM: 0.972
[2024-08-05 11:25:19,352] {result_logger:108} INFO - 
[2024-08-05 11:25:19,420] {result_logger:111} INFO - average precision on sleep stages: 0.949
[2024-08-05 11:25:19,488] {result_logger:113} INFO - average recall on sleep stages: 0.979
[2024-08-05 11:25:19,556] {result_logger:115} INFO - average F1-score on sleep stages: 0.963
[2024-08-05 11:25:19,557] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:25:19,614] {result_logger:103} INFO - precision on Wake: 0.981
[2024-08-05 11:25:19,654] {result_logger:104} INFO - recall on Wake: 0.980
[2024-08-05 11:25:19,693] {result_logger:107} INFO - F1-score on Wake: 0.981
[2024-08-05 11:25:19,694] {result_logger:108} INFO - 
[2024-08-05 11:25:19,750] {result_logger:103} INFO - precision on REM: 0.832
[2024-08-05 11:25:19,789] {result_logger:104} INFO - recall on REM: 0.963
[2024-08-05 11:25:19,827] {result_logger:107} INFO - F1-score on REM: 0.893
[2024-08-05 11:25:19,827] {result_logger:108} INFO - 
[2024-08-05 11:25:19,884] {result_logger:103} INFO - precision on Non REM: 0.973
[2024-08-05 11:25:19,923] {result_logger:104} INFO - recall on Non REM: 0.955
[2024-08-05 11:25:19,962] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2024-08-05 11:25:19,962] {result_logger:108} INFO - 
[2024-08-05 11:25:19,969] {result_logger:111} INFO - average precision on sleep stages: 0.929
[2024-08-05 11:25:19,975] {result_logger:113} INFO - average recall on sleep stages: 0.966
[2024-08-05 11:25:19,981] {result_logger:115} INFO - average F1-score on sleep stages: 0.946
[2024-08-05 11:25:19,981] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:25:20,028] {result_logger:134} INFO - 
[[200008    399   3340]
 [    56  18383    167]
 [  2498   2039 139230]]
[2024-08-05 11:25:20,074] {result_logger:141} INFO - 
[[ 98.16%   0.20%   1.64%]
 [  0.30%  98.80%   0.90%]
 [  1.74%   1.42%  96.84%]]
[2024-08-05 11:25:20,120] {result_logger:145} INFO - 
[[ 98.74%   1.92%   2.34%]
 [  0.03%  88.29%   0.12%]
 [  1.23%   9.79%  97.54%]]
[2024-08-05 11:25:20,120] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:25:20,125] {result_logger:134} INFO - 
[[27828    75   479]
 [   14  2452    79]
 [  514   420 19769]]
[2024-08-05 11:25:20,129] {result_logger:141} INFO - 
[[ 98.05%   0.26%   1.69%]
 [  0.55%  96.35%   3.10%]
 [  2.48%   2.03%  95.49%]]
[2024-08-05 11:25:20,133] {result_logger:145} INFO - 
[[ 98.14%   2.54%   2.36%]
 [  0.05%  83.20%   0.39%]
 [  1.81%  14.25%  97.25%]]
[2024-08-05 11:25:20,186] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:25:20,186] {result_logger:77} INFO - actual:
[2024-08-05 11:25:20,186] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:25:20,186] {result_logger:79} INFO - predicted:
[2024-08-05 11:25:20,186] {result_logger:80} INFO - 
[[95.33%  0.11%  4.56%]
 [14.96% 79.50%  5.53%]
 [ 4.35%  2.82% 92.83%]]
[2024-08-05 11:25:20,186] {run_experiment:113} INFO - [epoch  27] execution time: 113.39s	 avg f1-score: 0.9458

[2024-08-05 11:25:20,187] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:25:20,206] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:25:42,660] {train_model:82} INFO - Train Epoch: 28 [36352/366120 (10%)]	lr:9.80e-05	Loss: 0.057012
[2024-08-05 11:25:48,576] {train_model:82} INFO - Train Epoch: 28 [72960/366120 (20%)]	lr:9.80e-05	Loss: 0.046852
[2024-08-05 11:25:54,562] {train_model:82} INFO - Train Epoch: 28 [109568/366120 (30%)]	lr:9.80e-05	Loss: 0.031773
[2024-08-05 11:26:00,571] {train_model:82} INFO - Train Epoch: 28 [146176/366120 (40%)]	lr:9.80e-05	Loss: 0.040755
[2024-08-05 11:26:06,579] {train_model:82} INFO - Train Epoch: 28 [182784/366120 (50%)]	lr:9.80e-05	Loss: 0.038309
[2024-08-05 11:26:12,574] {train_model:82} INFO - Train Epoch: 28 [219392/366120 (60%)]	lr:9.80e-05	Loss: 0.029431
[2024-08-05 11:26:18,590] {train_model:82} INFO - Train Epoch: 28 [256000/366120 (70%)]	lr:9.80e-05	Loss: 0.034113
[2024-08-05 11:26:24,619] {train_model:82} INFO - Train Epoch: 28 [292608/366120 (80%)]	lr:9.80e-05	Loss: 0.053037
[2024-08-05 11:26:56,431] {train_model:82} INFO - Train Epoch: 28 [329216/366120 (90%)]	lr:9.80e-05	Loss: 0.060648
[2024-08-05 11:27:02,382] {train_model:82} INFO - Train Epoch: 28 [365824/366120 (100%)]	lr:9.80e-05	Loss: 0.026287
[2024-08-05 11:27:08,737] {run_experiment:79} INFO - 
[2024-08-05 11:27:08,737] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:27:09,193] {result_logger:103} INFO - precision on Wake: 0.988
[2024-08-05 11:27:09,519] {result_logger:104} INFO - recall on Wake: 0.982
[2024-08-05 11:27:09,847] {result_logger:107} INFO - F1-score on Wake: 0.985
[2024-08-05 11:27:09,847] {result_logger:108} INFO - 
[2024-08-05 11:27:10,254] {result_logger:103} INFO - precision on REM: 0.888
[2024-08-05 11:27:10,543] {result_logger:104} INFO - recall on REM: 0.989
[2024-08-05 11:27:10,821] {result_logger:107} INFO - F1-score on REM: 0.936
[2024-08-05 11:27:10,821] {result_logger:108} INFO - 
[2024-08-05 11:27:11,277] {result_logger:103} INFO - precision on Non REM: 0.976
[2024-08-05 11:27:11,602] {result_logger:104} INFO - recall on Non REM: 0.970
[2024-08-05 11:27:11,928] {result_logger:107} INFO - F1-score on Non REM: 0.973
[2024-08-05 11:27:11,928] {result_logger:108} INFO - 
[2024-08-05 11:27:11,992] {result_logger:111} INFO - average precision on sleep stages: 0.950
[2024-08-05 11:27:12,057] {result_logger:113} INFO - average recall on sleep stages: 0.980
[2024-08-05 11:27:12,122] {result_logger:115} INFO - average F1-score on sleep stages: 0.964
[2024-08-05 11:27:12,123] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:27:12,179] {result_logger:103} INFO - precision on Wake: 0.979
[2024-08-05 11:27:12,218] {result_logger:104} INFO - recall on Wake: 0.977
[2024-08-05 11:27:12,257] {result_logger:107} INFO - F1-score on Wake: 0.978
[2024-08-05 11:27:12,257] {result_logger:108} INFO - 
[2024-08-05 11:27:12,312] {result_logger:103} INFO - precision on REM: 0.825
[2024-08-05 11:27:12,351] {result_logger:104} INFO - recall on REM: 0.964
[2024-08-05 11:27:12,389] {result_logger:107} INFO - F1-score on REM: 0.889
[2024-08-05 11:27:12,389] {result_logger:108} INFO - 
[2024-08-05 11:27:12,446] {result_logger:103} INFO - precision on Non REM: 0.971
[2024-08-05 11:27:12,485] {result_logger:104} INFO - recall on Non REM: 0.953
[2024-08-05 11:27:12,525] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2024-08-05 11:27:12,525] {result_logger:108} INFO - 
[2024-08-05 11:27:12,532] {result_logger:111} INFO - average precision on sleep stages: 0.925
[2024-08-05 11:27:12,538] {result_logger:113} INFO - average recall on sleep stages: 0.965
[2024-08-05 11:27:12,544] {result_logger:115} INFO - average F1-score on sleep stages: 0.943
[2024-08-05 11:27:12,544] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:27:12,589] {result_logger:134} INFO - 
[[200047    383   3317]
 [    40  18404    162]
 [  2372   1948 139447]]
[2024-08-05 11:27:12,632] {result_logger:141} INFO - 
[[ 98.18%   0.19%   1.63%]
 [  0.21%  98.91%   0.87%]
 [  1.65%   1.35%  97.00%]]
[2024-08-05 11:27:12,676] {result_logger:145} INFO - 
[[ 98.81%   1.85%   2.32%]
 [  0.02%  88.76%   0.11%]
 [  1.17%   9.39%  97.57%]]
[2024-08-05 11:27:12,677] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:27:12,681] {result_logger:134} INFO - 
[[27719   156   507]
 [    5  2453    87]
 [  599   366 19738]]
[2024-08-05 11:27:12,686] {result_logger:141} INFO - 
[[ 97.66%   0.55%   1.79%]
 [  0.20%  96.39%   3.42%]
 [  2.89%   1.77%  95.34%]]
[2024-08-05 11:27:12,690] {result_logger:145} INFO - 
[[ 97.87%   5.24%   2.49%]
 [  0.02%  82.45%   0.43%]
 [  2.11%  12.30%  97.08%]]
[2024-08-05 11:27:12,745] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:27:12,745] {result_logger:77} INFO - actual:
[2024-08-05 11:27:12,745] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:27:12,746] {result_logger:79} INFO - predicted:
[2024-08-05 11:27:12,746] {result_logger:80} INFO - 
[[95.03%  0.30%  4.67%]
 [16.00% 78.29%  5.71%]
 [ 4.58%  2.76% 92.66%]]
[2024-08-05 11:27:12,746] {run_experiment:113} INFO - [epoch  28] execution time: 112.56s	 avg f1-score: 0.9428

[2024-08-05 11:27:12,746] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:27:12,765] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:27:38,364] {train_model:82} INFO - Train Epoch: 29 [36352/366120 (10%)]	lr:9.23e-05	Loss: 0.071824
[2024-08-05 11:27:44,300] {train_model:82} INFO - Train Epoch: 29 [72960/366120 (20%)]	lr:9.23e-05	Loss: 0.030210
[2024-08-05 11:27:50,404] {train_model:82} INFO - Train Epoch: 29 [109568/366120 (30%)]	lr:9.23e-05	Loss: 0.042669
[2024-08-05 11:27:56,420] {train_model:82} INFO - Train Epoch: 29 [146176/366120 (40%)]	lr:9.23e-05	Loss: 0.041726
[2024-08-05 11:28:02,388] {train_model:82} INFO - Train Epoch: 29 [182784/366120 (50%)]	lr:9.23e-05	Loss: 0.055482
[2024-08-05 11:28:08,353] {train_model:82} INFO - Train Epoch: 29 [219392/366120 (60%)]	lr:9.23e-05	Loss: 0.051897
[2024-08-05 11:28:14,369] {train_model:82} INFO - Train Epoch: 29 [256000/366120 (70%)]	lr:9.23e-05	Loss: 0.069525
[2024-08-05 11:28:20,381] {train_model:82} INFO - Train Epoch: 29 [292608/366120 (80%)]	lr:9.23e-05	Loss: 0.016874
[2024-08-05 11:28:55,233] {train_model:82} INFO - Train Epoch: 29 [329216/366120 (90%)]	lr:9.23e-05	Loss: 0.029239
[2024-08-05 11:29:01,239] {train_model:82} INFO - Train Epoch: 29 [365824/366120 (100%)]	lr:9.23e-05	Loss: 0.043455
[2024-08-05 11:29:07,280] {run_experiment:79} INFO - 
[2024-08-05 11:29:07,280] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:29:07,738] {result_logger:103} INFO - precision on Wake: 0.989
[2024-08-05 11:29:08,060] {result_logger:104} INFO - recall on Wake: 0.983
[2024-08-05 11:29:08,384] {result_logger:107} INFO - F1-score on Wake: 0.986
[2024-08-05 11:29:08,384] {result_logger:108} INFO - 
[2024-08-05 11:29:08,794] {result_logger:103} INFO - precision on REM: 0.896
[2024-08-05 11:29:09,087] {result_logger:104} INFO - recall on REM: 0.989
[2024-08-05 11:29:09,380] {result_logger:107} INFO - F1-score on REM: 0.940
[2024-08-05 11:29:09,380] {result_logger:108} INFO - 
[2024-08-05 11:29:09,834] {result_logger:103} INFO - precision on Non REM: 0.977
[2024-08-05 11:29:10,163] {result_logger:104} INFO - recall on Non REM: 0.972
[2024-08-05 11:29:10,489] {result_logger:107} INFO - F1-score on Non REM: 0.974
[2024-08-05 11:29:10,490] {result_logger:108} INFO - 
[2024-08-05 11:29:10,560] {result_logger:111} INFO - average precision on sleep stages: 0.954
[2024-08-05 11:29:10,631] {result_logger:113} INFO - average recall on sleep stages: 0.981
[2024-08-05 11:29:10,703] {result_logger:115} INFO - average F1-score on sleep stages: 0.967
[2024-08-05 11:29:10,704] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:29:10,763] {result_logger:103} INFO - precision on Wake: 0.980
[2024-08-05 11:29:10,802] {result_logger:104} INFO - recall on Wake: 0.968
[2024-08-05 11:29:10,840] {result_logger:107} INFO - F1-score on Wake: 0.974
[2024-08-05 11:29:10,840] {result_logger:108} INFO - 
[2024-08-05 11:29:10,896] {result_logger:103} INFO - precision on REM: 0.809
[2024-08-05 11:29:10,935] {result_logger:104} INFO - recall on REM: 0.958
[2024-08-05 11:29:10,974] {result_logger:107} INFO - F1-score on REM: 0.877
[2024-08-05 11:29:10,975] {result_logger:108} INFO - 
[2024-08-05 11:29:11,031] {result_logger:103} INFO - precision on Non REM: 0.962
[2024-08-05 11:29:11,072] {result_logger:104} INFO - recall on Non REM: 0.955
[2024-08-05 11:29:11,112] {result_logger:107} INFO - F1-score on Non REM: 0.959
[2024-08-05 11:29:11,112] {result_logger:108} INFO - 
[2024-08-05 11:29:11,118] {result_logger:111} INFO - average precision on sleep stages: 0.917
[2024-08-05 11:29:11,124] {result_logger:113} INFO - average recall on sleep stages: 0.960
[2024-08-05 11:29:11,131] {result_logger:115} INFO - average F1-score on sleep stages: 0.936
[2024-08-05 11:29:11,131] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:29:11,179] {result_logger:134} INFO - 
[[200201    362   3184]
 [    47  18410    149]
 [  2273   1774 139720]]
[2024-08-05 11:29:11,226] {result_logger:141} INFO - 
[[ 98.26%   0.18%   1.56%]
 [  0.25%  98.95%   0.80%]
 [  1.58%   1.23%  97.19%]]
[2024-08-05 11:29:11,273] {result_logger:145} INFO - 
[[ 98.85%   1.76%   2.23%]
 [  0.02%  89.60%   0.10%]
 [  1.12%   8.63%  97.67%]]
[2024-08-05 11:29:11,273] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:29:11,277] {result_logger:134} INFO - 
[[27484   208   690]
 [   10  2437    98]
 [  554   369 19780]]
[2024-08-05 11:29:11,282] {result_logger:141} INFO - 
[[ 96.84%   0.73%   2.43%]
 [  0.39%  95.76%   3.85%]
 [  2.68%   1.78%  95.54%]]
[2024-08-05 11:29:11,286] {result_logger:145} INFO - 
[[ 97.99%   6.90%   3.35%]
 [  0.04%  80.86%   0.48%]
 [  1.98%  12.24%  96.17%]]
[2024-08-05 11:29:11,339] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:29:11,339] {result_logger:77} INFO - actual:
[2024-08-05 11:29:11,340] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:29:11,340] {result_logger:79} INFO - predicted:
[2024-08-05 11:29:11,340] {result_logger:80} INFO - 
[[94.81%  0.42%  4.77%]
 [17.15% 77.27%  5.57%]
 [ 4.57%  2.75% 92.68%]]
[2024-08-05 11:29:11,340] {run_experiment:113} INFO - [epoch  29] execution time: 118.59s	 avg f1-score: 0.9365

[2024-08-05 11:29:11,340] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:29:11,359] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:29:36,417] {train_model:82} INFO - Train Epoch: 30 [36352/366120 (10%)]	lr:8.69e-05	Loss: 0.055904
[2024-08-05 11:29:42,356] {train_model:82} INFO - Train Epoch: 30 [72960/366120 (20%)]	lr:8.69e-05	Loss: 0.071113
[2024-08-05 11:29:48,352] {train_model:82} INFO - Train Epoch: 30 [109568/366120 (30%)]	lr:8.69e-05	Loss: 0.154066
[2024-08-05 11:29:54,292] {train_model:82} INFO - Train Epoch: 30 [146176/366120 (40%)]	lr:8.69e-05	Loss: 0.054327
[2024-08-05 11:30:00,274] {train_model:82} INFO - Train Epoch: 30 [182784/366120 (50%)]	lr:8.69e-05	Loss: 0.048216
[2024-08-05 11:30:06,305] {train_model:82} INFO - Train Epoch: 30 [219392/366120 (60%)]	lr:8.69e-05	Loss: 0.060188
[2024-08-05 11:30:12,323] {train_model:82} INFO - Train Epoch: 30 [256000/366120 (70%)]	lr:8.69e-05	Loss: 0.040693
[2024-08-05 11:30:36,072] {train_model:82} INFO - Train Epoch: 30 [292608/366120 (80%)]	lr:8.69e-05	Loss: 0.082350
[2024-08-05 11:30:52,936] {train_model:82} INFO - Train Epoch: 30 [329216/366120 (90%)]	lr:8.69e-05	Loss: 0.037207
[2024-08-05 11:30:58,860] {train_model:82} INFO - Train Epoch: 30 [365824/366120 (100%)]	lr:8.69e-05	Loss: 0.040394
[2024-08-05 11:31:04,764] {run_experiment:79} INFO - 
[2024-08-05 11:31:04,764] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:31:05,206] {result_logger:103} INFO - precision on Wake: 0.989
[2024-08-05 11:31:05,528] {result_logger:104} INFO - recall on Wake: 0.983
[2024-08-05 11:31:05,852] {result_logger:107} INFO - F1-score on Wake: 0.986
[2024-08-05 11:31:05,852] {result_logger:108} INFO - 
[2024-08-05 11:31:06,256] {result_logger:103} INFO - precision on REM: 0.902
[2024-08-05 11:31:06,537] {result_logger:104} INFO - recall on REM: 0.991
[2024-08-05 11:31:06,822] {result_logger:107} INFO - F1-score on REM: 0.944
[2024-08-05 11:31:06,822] {result_logger:108} INFO - 
[2024-08-05 11:31:07,272] {result_logger:103} INFO - precision on Non REM: 0.978
[2024-08-05 11:31:07,596] {result_logger:104} INFO - recall on Non REM: 0.973
[2024-08-05 11:31:07,921] {result_logger:107} INFO - F1-score on Non REM: 0.975
[2024-08-05 11:31:07,921] {result_logger:108} INFO - 
[2024-08-05 11:31:07,987] {result_logger:111} INFO - average precision on sleep stages: 0.956
[2024-08-05 11:31:08,054] {result_logger:113} INFO - average recall on sleep stages: 0.982
[2024-08-05 11:31:08,121] {result_logger:115} INFO - average F1-score on sleep stages: 0.969
[2024-08-05 11:31:08,122] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:31:08,177] {result_logger:103} INFO - precision on Wake: 0.985
[2024-08-05 11:31:08,215] {result_logger:104} INFO - recall on Wake: 0.975
[2024-08-05 11:31:08,253] {result_logger:107} INFO - F1-score on Wake: 0.980
[2024-08-05 11:31:08,253] {result_logger:108} INFO - 
[2024-08-05 11:31:08,309] {result_logger:103} INFO - precision on REM: 0.841
[2024-08-05 11:31:08,348] {result_logger:104} INFO - recall on REM: 0.953
[2024-08-05 11:31:08,387] {result_logger:107} INFO - F1-score on REM: 0.894
[2024-08-05 11:31:08,388] {result_logger:108} INFO - 
[2024-08-05 11:31:08,445] {result_logger:103} INFO - precision on Non REM: 0.966
[2024-08-05 11:31:08,484] {result_logger:104} INFO - recall on Non REM: 0.963
[2024-08-05 11:31:08,524] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2024-08-05 11:31:08,524] {result_logger:108} INFO - 
[2024-08-05 11:31:08,530] {result_logger:111} INFO - average precision on sleep stages: 0.931
[2024-08-05 11:31:08,536] {result_logger:113} INFO - average recall on sleep stages: 0.964
[2024-08-05 11:31:08,542] {result_logger:115} INFO - average F1-score on sleep stages: 0.946
[2024-08-05 11:31:08,542] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:31:08,587] {result_logger:134} INFO - 
[[200308    347   3092]
 [    44  18433    129]
 [  2165   1660 139942]]
[2024-08-05 11:31:08,632] {result_logger:141} INFO - 
[[ 98.31%   0.17%   1.52%]
 [  0.24%  99.07%   0.69%]
 [  1.51%   1.15%  97.34%]]
[2024-08-05 11:31:08,677] {result_logger:145} INFO - 
[[ 98.91%   1.70%   2.16%]
 [  0.02%  90.18%   0.09%]
 [  1.07%   8.12%  97.75%]]
[2024-08-05 11:31:08,677] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:31:08,682] {result_logger:134} INFO - 
[[27676   112   594]
 [    6  2426   113]
 [  413   347 19943]]
[2024-08-05 11:31:08,686] {result_logger:141} INFO - 
[[ 97.51%   0.39%   2.09%]
 [  0.24%  95.32%   4.44%]
 [  1.99%   1.68%  96.33%]]
[2024-08-05 11:31:08,690] {result_logger:145} INFO - 
[[ 98.51%   3.88%   2.88%]
 [  0.02%  84.09%   0.55%]
 [  1.47%  12.03%  96.58%]]
[2024-08-05 11:31:08,743] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:31:08,744] {result_logger:77} INFO - actual:
[2024-08-05 11:31:08,744] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:31:08,744] {result_logger:79} INFO - predicted:
[2024-08-05 11:31:08,744] {result_logger:80} INFO - 
[[95.44%  0.15%  4.42%]
 [14.70% 78.86%  6.45%]
 [ 4.15%  2.76% 93.09%]]
[2024-08-05 11:31:08,744] {run_experiment:113} INFO - [epoch  30] execution time: 117.40s	 avg f1-score: 0.9461

[2024-08-05 11:31:08,744] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:31:08,763] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:31:29,450] {train_model:82} INFO - Train Epoch: 31 [36352/366120 (10%)]	lr:8.19e-05	Loss: 0.096377
[2024-08-05 11:31:35,305] {train_model:82} INFO - Train Epoch: 31 [72960/366120 (20%)]	lr:8.19e-05	Loss: 0.043968
[2024-08-05 11:31:41,176] {train_model:82} INFO - Train Epoch: 31 [109568/366120 (30%)]	lr:8.19e-05	Loss: 0.070311
[2024-08-05 11:31:47,047] {train_model:82} INFO - Train Epoch: 31 [146176/366120 (40%)]	lr:8.19e-05	Loss: 0.065735
[2024-08-05 11:31:52,973] {train_model:82} INFO - Train Epoch: 31 [182784/366120 (50%)]	lr:8.19e-05	Loss: 0.035571
[2024-08-05 11:31:58,884] {train_model:82} INFO - Train Epoch: 31 [219392/366120 (60%)]	lr:8.19e-05	Loss: 0.049287
[2024-08-05 11:32:04,802] {train_model:82} INFO - Train Epoch: 31 [256000/366120 (70%)]	lr:8.19e-05	Loss: 0.045998
[2024-08-05 11:32:34,174] {train_model:82} INFO - Train Epoch: 31 [292608/366120 (80%)]	lr:8.19e-05	Loss: 0.071331
[2024-08-05 11:32:46,354] {train_model:82} INFO - Train Epoch: 31 [329216/366120 (90%)]	lr:8.19e-05	Loss: 0.057633
[2024-08-05 11:32:52,361] {train_model:82} INFO - Train Epoch: 31 [365824/366120 (100%)]	lr:8.19e-05	Loss: 0.024064
[2024-08-05 11:32:57,674] {run_experiment:79} INFO - 
[2024-08-05 11:32:57,674] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:32:58,127] {result_logger:103} INFO - precision on Wake: 0.990
[2024-08-05 11:32:58,456] {result_logger:104} INFO - recall on Wake: 0.984
[2024-08-05 11:32:58,785] {result_logger:107} INFO - F1-score on Wake: 0.987
[2024-08-05 11:32:58,785] {result_logger:108} INFO - 
[2024-08-05 11:32:59,184] {result_logger:103} INFO - precision on REM: 0.908
[2024-08-05 11:32:59,466] {result_logger:104} INFO - recall on REM: 0.991
[2024-08-05 11:32:59,748] {result_logger:107} INFO - F1-score on REM: 0.948
[2024-08-05 11:32:59,748] {result_logger:108} INFO - 
[2024-08-05 11:33:00,191] {result_logger:103} INFO - precision on Non REM: 0.979
[2024-08-05 11:33:00,510] {result_logger:104} INFO - recall on Non REM: 0.975
[2024-08-05 11:33:00,830] {result_logger:107} INFO - F1-score on Non REM: 0.977
[2024-08-05 11:33:00,830] {result_logger:108} INFO - 
[2024-08-05 11:33:00,899] {result_logger:111} INFO - average precision on sleep stages: 0.959
[2024-08-05 11:33:00,967] {result_logger:113} INFO - average recall on sleep stages: 0.983
[2024-08-05 11:33:01,036] {result_logger:115} INFO - average F1-score on sleep stages: 0.970
[2024-08-05 11:33:01,036] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:33:01,092] {result_logger:103} INFO - precision on Wake: 0.979
[2024-08-05 11:33:01,130] {result_logger:104} INFO - recall on Wake: 0.981
[2024-08-05 11:33:01,168] {result_logger:107} INFO - F1-score on Wake: 0.980
[2024-08-05 11:33:01,168] {result_logger:108} INFO - 
[2024-08-05 11:33:01,223] {result_logger:103} INFO - precision on REM: 0.870
[2024-08-05 11:33:01,261] {result_logger:104} INFO - recall on REM: 0.949
[2024-08-05 11:33:01,299] {result_logger:107} INFO - F1-score on REM: 0.908
[2024-08-05 11:33:01,299] {result_logger:108} INFO - 
[2024-08-05 11:33:01,355] {result_logger:103} INFO - precision on Non REM: 0.972
[2024-08-05 11:33:01,394] {result_logger:104} INFO - recall on Non REM: 0.958
[2024-08-05 11:33:01,432] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2024-08-05 11:33:01,433] {result_logger:108} INFO - 
[2024-08-05 11:33:01,439] {result_logger:111} INFO - average precision on sleep stages: 0.940
[2024-08-05 11:33:01,445] {result_logger:113} INFO - average recall on sleep stages: 0.963
[2024-08-05 11:33:01,451] {result_logger:115} INFO - average F1-score on sleep stages: 0.951
[2024-08-05 11:33:01,451] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:33:01,498] {result_logger:134} INFO - 
[[200505    302   2940]
 [    40  18439    127]
 [  2054   1561 140152]]
[2024-08-05 11:33:01,544] {result_logger:141} INFO - 
[[ 98.41%   0.15%   1.44%]
 [  0.21%  99.10%   0.68%]
 [  1.43%   1.09%  97.49%]]
[2024-08-05 11:33:01,591] {result_logger:145} INFO - 
[[ 98.97%   1.49%   2.05%]
 [  0.02%  90.82%   0.09%]
 [  1.01%   7.69%  97.86%]]
[2024-08-05 11:33:01,591] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:33:01,595] {result_logger:134} INFO - 
[[27855    61   466]
 [   17  2416   112]
 [  571   299 19833]]
[2024-08-05 11:33:01,723] {result_logger:141} INFO - 
[[ 98.14%   0.21%   1.64%]
 [  0.67%  94.93%   4.40%]
 [  2.76%   1.44%  95.80%]]
[2024-08-05 11:33:01,801] {result_logger:145} INFO - 
[[ 97.93%   2.20%   2.28%]
 [  0.06%  87.03%   0.55%]
 [  2.01%  10.77%  97.17%]]
[2024-08-05 11:33:02,008] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:33:02,008] {result_logger:77} INFO - actual:
[2024-08-05 11:33:02,008] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:33:02,008] {result_logger:79} INFO - predicted:
[2024-08-05 11:33:02,008] {result_logger:80} INFO - 
[[95.28%  0.08%  4.63%]
 [15.09% 79.43%  5.48%]
 [ 4.52%  2.68% 92.80%]]
[2024-08-05 11:33:02,084] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp002_B_weighted/model_8conv_2fc-best.pth
[2024-08-05 11:33:02,084] {run_experiment:113} INFO - [epoch  31] execution time: 113.34s	 avg f1-score: 0.9511

[2024-08-05 11:33:02,085] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:33:02,104] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:33:23,518] {train_model:82} INFO - Train Epoch: 32 [36352/366120 (10%)]	lr:7.71e-05	Loss: 0.049535
[2024-08-05 11:33:29,491] {train_model:82} INFO - Train Epoch: 32 [72960/366120 (20%)]	lr:7.71e-05	Loss: 0.019097
[2024-08-05 11:33:35,470] {train_model:82} INFO - Train Epoch: 32 [109568/366120 (30%)]	lr:7.71e-05	Loss: 0.023921
[2024-08-05 11:33:41,432] {train_model:82} INFO - Train Epoch: 32 [146176/366120 (40%)]	lr:7.71e-05	Loss: 0.027145
[2024-08-05 11:33:47,442] {train_model:82} INFO - Train Epoch: 32 [182784/366120 (50%)]	lr:7.71e-05	Loss: 0.050001
[2024-08-05 11:33:53,441] {train_model:82} INFO - Train Epoch: 32 [219392/366120 (60%)]	lr:7.71e-05	Loss: 0.046472
[2024-08-05 11:33:59,432] {train_model:82} INFO - Train Epoch: 32 [256000/366120 (70%)]	lr:7.71e-05	Loss: 0.032271
[2024-08-05 11:34:31,622] {train_model:82} INFO - Train Epoch: 32 [292608/366120 (80%)]	lr:7.71e-05	Loss: 0.027697
[2024-08-05 11:34:39,287] {train_model:82} INFO - Train Epoch: 32 [329216/366120 (90%)]	lr:7.71e-05	Loss: 0.061339
[2024-08-05 11:34:45,328] {train_model:82} INFO - Train Epoch: 32 [365824/366120 (100%)]	lr:7.71e-05	Loss: 0.033059
[2024-08-05 11:34:51,382] {run_experiment:79} INFO - 
[2024-08-05 11:34:51,382] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:34:51,837] {result_logger:103} INFO - precision on Wake: 0.990
[2024-08-05 11:34:52,162] {result_logger:104} INFO - recall on Wake: 0.985
[2024-08-05 11:34:52,491] {result_logger:107} INFO - F1-score on Wake: 0.987
[2024-08-05 11:34:52,491] {result_logger:108} INFO - 
[2024-08-05 11:34:52,904] {result_logger:103} INFO - precision on REM: 0.916
[2024-08-05 11:34:53,191] {result_logger:104} INFO - recall on REM: 0.992
[2024-08-05 11:34:53,475] {result_logger:107} INFO - F1-score on REM: 0.952
[2024-08-05 11:34:53,475] {result_logger:108} INFO - 
[2024-08-05 11:34:53,927] {result_logger:103} INFO - precision on Non REM: 0.980
[2024-08-05 11:34:54,251] {result_logger:104} INFO - recall on Non REM: 0.977
[2024-08-05 11:34:54,578] {result_logger:107} INFO - F1-score on Non REM: 0.978
[2024-08-05 11:34:54,578] {result_logger:108} INFO - 
[2024-08-05 11:34:54,643] {result_logger:111} INFO - average precision on sleep stages: 0.962
[2024-08-05 11:34:54,710] {result_logger:113} INFO - average recall on sleep stages: 0.984
[2024-08-05 11:34:54,775] {result_logger:115} INFO - average F1-score on sleep stages: 0.973
[2024-08-05 11:34:54,776] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:34:54,834] {result_logger:103} INFO - precision on Wake: 0.978
[2024-08-05 11:34:54,873] {result_logger:104} INFO - recall on Wake: 0.982
[2024-08-05 11:34:54,912] {result_logger:107} INFO - F1-score on Wake: 0.980
[2024-08-05 11:34:54,912] {result_logger:108} INFO - 
[2024-08-05 11:34:54,969] {result_logger:103} INFO - precision on REM: 0.844
[2024-08-05 11:34:55,009] {result_logger:104} INFO - recall on REM: 0.962
[2024-08-05 11:34:55,049] {result_logger:107} INFO - F1-score on REM: 0.899
[2024-08-05 11:34:55,050] {result_logger:108} INFO - 
[2024-08-05 11:34:55,108] {result_logger:103} INFO - precision on Non REM: 0.974
[2024-08-05 11:34:55,149] {result_logger:104} INFO - recall on Non REM: 0.952
[2024-08-05 11:34:55,190] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2024-08-05 11:34:55,190] {result_logger:108} INFO - 
[2024-08-05 11:34:55,196] {result_logger:111} INFO - average precision on sleep stages: 0.932
[2024-08-05 11:34:55,203] {result_logger:113} INFO - average recall on sleep stages: 0.965
[2024-08-05 11:34:55,209] {result_logger:115} INFO - average F1-score on sleep stages: 0.947
[2024-08-05 11:34:55,209] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:34:55,254] {result_logger:134} INFO - 
[[200625    303   2819]
 [    37  18453    116]
 [  1935   1391 140441]]
[2024-08-05 11:34:55,298] {result_logger:141} INFO - 
[[ 98.47%   0.15%   1.38%]
 [  0.20%  99.18%   0.62%]
 [  1.35%   0.97%  97.69%]]
[2024-08-05 11:34:55,343] {result_logger:145} INFO - 
[[ 99.03%   1.50%   1.97%]
 [  0.02%  91.59%   0.08%]
 [  0.96%   6.90%  97.95%]]
[2024-08-05 11:34:55,343] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:34:55,347] {result_logger:134} INFO - 
[[27874    73   435]
 [   13  2449    83]
 [  618   381 19704]]
[2024-08-05 11:34:55,352] {result_logger:141} INFO - 
[[ 98.21%   0.26%   1.53%]
 [  0.51%  96.23%   3.26%]
 [  2.99%   1.84%  95.17%]]
[2024-08-05 11:34:55,356] {result_logger:145} INFO - 
[[ 97.79%   2.51%   2.15%]
 [  0.05%  84.36%   0.41%]
 [  2.17%  13.12%  97.44%]]
[2024-08-05 11:34:55,419] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:34:55,419] {result_logger:77} INFO - actual:
[2024-08-05 11:34:55,419] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:34:55,419] {result_logger:79} INFO - predicted:
[2024-08-05 11:34:55,419] {result_logger:80} INFO - 
[[95.11%  0.09%  4.80%]
 [14.88% 79.95%  5.17%]
 [ 4.76%  2.75% 92.49%]]
[2024-08-05 11:34:55,419] {run_experiment:113} INFO - [epoch  32] execution time: 113.33s	 avg f1-score: 0.9473

[2024-08-05 11:34:55,419] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:34:55,438] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:35:19,287] {train_model:82} INFO - Train Epoch: 33 [36352/366120 (10%)]	lr:7.26e-05	Loss: 0.028744
[2024-08-05 11:35:25,262] {train_model:82} INFO - Train Epoch: 33 [72960/366120 (20%)]	lr:7.26e-05	Loss: 0.080648
[2024-08-05 11:35:31,212] {train_model:82} INFO - Train Epoch: 33 [109568/366120 (30%)]	lr:7.26e-05	Loss: 0.069990
[2024-08-05 11:35:37,182] {train_model:82} INFO - Train Epoch: 33 [146176/366120 (40%)]	lr:7.26e-05	Loss: 0.029674
[2024-08-05 11:35:43,271] {train_model:82} INFO - Train Epoch: 33 [182784/366120 (50%)]	lr:7.26e-05	Loss: 0.012448
[2024-08-05 11:35:49,257] {train_model:82} INFO - Train Epoch: 33 [219392/366120 (60%)]	lr:7.26e-05	Loss: 0.024382
[2024-08-05 11:35:55,381] {train_model:82} INFO - Train Epoch: 33 [256000/366120 (70%)]	lr:7.26e-05	Loss: 0.030476
[2024-08-05 11:36:32,109] {train_model:82} INFO - Train Epoch: 33 [292608/366120 (80%)]	lr:7.26e-05	Loss: 0.048362
[2024-08-05 11:36:38,133] {train_model:82} INFO - Train Epoch: 33 [329216/366120 (90%)]	lr:7.26e-05	Loss: 0.037181
[2024-08-05 11:36:44,142] {train_model:82} INFO - Train Epoch: 33 [365824/366120 (100%)]	lr:7.26e-05	Loss: 0.031793
[2024-08-05 11:36:50,462] {run_experiment:79} INFO - 
[2024-08-05 11:36:50,462] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:36:50,909] {result_logger:103} INFO - precision on Wake: 0.990
[2024-08-05 11:36:51,236] {result_logger:104} INFO - recall on Wake: 0.985
[2024-08-05 11:36:51,566] {result_logger:107} INFO - F1-score on Wake: 0.988
[2024-08-05 11:36:51,566] {result_logger:108} INFO - 
[2024-08-05 11:36:51,971] {result_logger:103} INFO - precision on REM: 0.921
[2024-08-05 11:36:52,250] {result_logger:104} INFO - recall on REM: 0.993
[2024-08-05 11:36:52,535] {result_logger:107} INFO - F1-score on REM: 0.956
[2024-08-05 11:36:52,535] {result_logger:108} INFO - 
[2024-08-05 11:36:52,989] {result_logger:103} INFO - precision on Non REM: 0.980
[2024-08-05 11:36:53,316] {result_logger:104} INFO - recall on Non REM: 0.977
[2024-08-05 11:36:53,632] {result_logger:107} INFO - F1-score on Non REM: 0.979
[2024-08-05 11:36:53,632] {result_logger:108} INFO - 
[2024-08-05 11:36:53,703] {result_logger:111} INFO - average precision on sleep stages: 0.964
[2024-08-05 11:36:53,773] {result_logger:113} INFO - average recall on sleep stages: 0.985
[2024-08-05 11:36:53,843] {result_logger:115} INFO - average F1-score on sleep stages: 0.974
[2024-08-05 11:36:53,844] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:36:53,900] {result_logger:103} INFO - precision on Wake: 0.983
[2024-08-05 11:36:53,939] {result_logger:104} INFO - recall on Wake: 0.977
[2024-08-05 11:36:53,979] {result_logger:107} INFO - F1-score on Wake: 0.980
[2024-08-05 11:36:53,979] {result_logger:108} INFO - 
[2024-08-05 11:36:54,036] {result_logger:103} INFO - precision on REM: 0.859
[2024-08-05 11:36:54,076] {result_logger:104} INFO - recall on REM: 0.949
[2024-08-05 11:36:54,115] {result_logger:107} INFO - F1-score on REM: 0.901
[2024-08-05 11:36:54,115] {result_logger:108} INFO - 
[2024-08-05 11:36:54,174] {result_logger:103} INFO - precision on Non REM: 0.966
[2024-08-05 11:36:54,214] {result_logger:104} INFO - recall on Non REM: 0.962
[2024-08-05 11:36:54,255] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2024-08-05 11:36:54,255] {result_logger:108} INFO - 
[2024-08-05 11:36:54,261] {result_logger:111} INFO - average precision on sleep stages: 0.936
[2024-08-05 11:36:54,267] {result_logger:113} INFO - average recall on sleep stages: 0.962
[2024-08-05 11:36:54,273] {result_logger:115} INFO - average F1-score on sleep stages: 0.948
[2024-08-05 11:36:54,273] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:36:54,321] {result_logger:134} INFO - 
[[200743    272   2732]
 [    40  18469     97]
 [  1929   1308 140530]]
[2024-08-05 11:36:54,369] {result_logger:141} INFO - 
[[ 98.53%   0.13%   1.34%]
 [  0.21%  99.26%   0.52%]
 [  1.34%   0.91%  97.75%]]
[2024-08-05 11:36:54,416] {result_logger:145} INFO - 
[[ 99.03%   1.36%   1.91%]
 [  0.02%  92.12%   0.07%]
 [  0.95%   6.52%  98.03%]]
[2024-08-05 11:36:54,417] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:36:54,421] {result_logger:134} INFO - 
[[27730    80   572]
 [   13  2414   118]
 [  480   317 19906]]
[2024-08-05 11:36:54,425] {result_logger:141} INFO - 
[[ 97.70%   0.28%   2.02%]
 [  0.51%  94.85%   4.64%]
 [  2.32%   1.53%  96.15%]]
[2024-08-05 11:36:54,430] {result_logger:145} INFO - 
[[ 98.25%   2.85%   2.78%]
 [  0.05%  85.88%   0.57%]
 [  1.70%  11.28%  96.65%]]
[2024-08-05 11:36:54,482] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:36:54,482] {result_logger:77} INFO - actual:
[2024-08-05 11:36:54,482] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:36:54,482] {result_logger:79} INFO - predicted:
[2024-08-05 11:36:54,482] {result_logger:80} INFO - 
[[95.61%  0.13%  4.26%]
 [15.23% 78.62%  6.15%]
 [ 3.94%  2.74% 93.32%]]
[2024-08-05 11:36:54,482] {run_experiment:113} INFO - [epoch  33] execution time: 119.06s	 avg f1-score: 0.9484

[2024-08-05 11:36:54,482] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:36:54,501] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:37:20,228] {train_model:82} INFO - Train Epoch: 34 [36352/366120 (10%)]	lr:6.84e-05	Loss: 0.032404
[2024-08-05 11:37:26,038] {train_model:82} INFO - Train Epoch: 34 [72960/366120 (20%)]	lr:6.84e-05	Loss: 0.032430
[2024-08-05 11:37:31,897] {train_model:82} INFO - Train Epoch: 34 [109568/366120 (30%)]	lr:6.84e-05	Loss: 0.042746
[2024-08-05 11:37:37,755] {train_model:82} INFO - Train Epoch: 34 [146176/366120 (40%)]	lr:6.84e-05	Loss: 0.031600
[2024-08-05 11:37:43,608] {train_model:82} INFO - Train Epoch: 34 [182784/366120 (50%)]	lr:6.84e-05	Loss: 0.018362
[2024-08-05 11:37:49,505] {train_model:82} INFO - Train Epoch: 34 [219392/366120 (60%)]	lr:6.84e-05	Loss: 0.035176
[2024-08-05 11:37:55,389] {train_model:82} INFO - Train Epoch: 34 [256000/366120 (70%)]	lr:6.84e-05	Loss: 0.025350
[2024-08-05 11:38:21,319] {train_model:82} INFO - Train Epoch: 34 [292608/366120 (80%)]	lr:6.84e-05	Loss: 0.045988
[2024-08-05 11:38:27,322] {train_model:82} INFO - Train Epoch: 34 [329216/366120 (90%)]	lr:6.84e-05	Loss: 0.047620
[2024-08-05 11:38:33,233] {train_model:82} INFO - Train Epoch: 34 [365824/366120 (100%)]	lr:6.84e-05	Loss: 0.033829
[2024-08-05 11:38:36,741] {run_experiment:79} INFO - 
[2024-08-05 11:38:36,741] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:38:37,189] {result_logger:103} INFO - precision on Wake: 0.991
[2024-08-05 11:38:37,512] {result_logger:104} INFO - recall on Wake: 0.986
[2024-08-05 11:38:37,837] {result_logger:107} INFO - F1-score on Wake: 0.988
[2024-08-05 11:38:37,837] {result_logger:108} INFO - 
[2024-08-05 11:38:38,238] {result_logger:103} INFO - precision on REM: 0.927
[2024-08-05 11:38:38,523] {result_logger:104} INFO - recall on REM: 0.993
[2024-08-05 11:38:38,808] {result_logger:107} INFO - F1-score on REM: 0.959
[2024-08-05 11:38:38,808] {result_logger:108} INFO - 
[2024-08-05 11:38:39,259] {result_logger:103} INFO - precision on Non REM: 0.981
[2024-08-05 11:38:39,587] {result_logger:104} INFO - recall on Non REM: 0.979
[2024-08-05 11:38:39,911] {result_logger:107} INFO - F1-score on Non REM: 0.980
[2024-08-05 11:38:39,911] {result_logger:108} INFO - 
[2024-08-05 11:38:39,979] {result_logger:111} INFO - average precision on sleep stages: 0.966
[2024-08-05 11:38:40,046] {result_logger:113} INFO - average recall on sleep stages: 0.986
[2024-08-05 11:38:40,113] {result_logger:115} INFO - average F1-score on sleep stages: 0.976
[2024-08-05 11:38:40,114] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:38:40,171] {result_logger:103} INFO - precision on Wake: 0.983
[2024-08-05 11:38:40,210] {result_logger:104} INFO - recall on Wake: 0.976
[2024-08-05 11:38:40,249] {result_logger:107} INFO - F1-score on Wake: 0.980
[2024-08-05 11:38:40,249] {result_logger:108} INFO - 
[2024-08-05 11:38:40,305] {result_logger:103} INFO - precision on REM: 0.860
[2024-08-05 11:38:40,344] {result_logger:104} INFO - recall on REM: 0.953
[2024-08-05 11:38:40,383] {result_logger:107} INFO - F1-score on REM: 0.904
[2024-08-05 11:38:40,383] {result_logger:108} INFO - 
[2024-08-05 11:38:40,440] {result_logger:103} INFO - precision on Non REM: 0.967
[2024-08-05 11:38:40,479] {result_logger:104} INFO - recall on Non REM: 0.964
[2024-08-05 11:38:40,517] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2024-08-05 11:38:40,518] {result_logger:108} INFO - 
[2024-08-05 11:38:40,524] {result_logger:111} INFO - average precision on sleep stages: 0.937
[2024-08-05 11:38:40,530] {result_logger:113} INFO - average recall on sleep stages: 0.964
[2024-08-05 11:38:40,536] {result_logger:115} INFO - average F1-score on sleep stages: 0.950
[2024-08-05 11:38:40,536] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:38:40,582] {result_logger:134} INFO - 
[[200874    237   2636]
 [    29  18468    109]
 [  1788   1217 140762]]
[2024-08-05 11:38:40,629] {result_logger:141} INFO - 
[[ 98.59%   0.12%   1.29%]
 [  0.16%  99.26%   0.59%]
 [  1.24%   0.85%  97.91%]]
[2024-08-05 11:38:40,675] {result_logger:145} INFO - 
[[ 99.10%   1.19%   1.84%]
 [  0.01%  92.70%   0.08%]
 [  0.88%   6.11%  98.09%]]
[2024-08-05 11:38:40,675] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:38:40,679] {result_logger:134} INFO - 
[[27711   105   566]
 [    9  2426   110]
 [  465   290 19948]]
[2024-08-05 11:38:40,684] {result_logger:141} INFO - 
[[ 97.64%   0.37%   1.99%]
 [  0.35%  95.32%   4.32%]
 [  2.25%   1.40%  96.35%]]
[2024-08-05 11:38:40,688] {result_logger:145} INFO - 
[[ 98.32%   3.72%   2.74%]
 [  0.03%  86.00%   0.53%]
 [  1.65%  10.28%  96.72%]]
[2024-08-05 11:38:40,740] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:38:40,740] {result_logger:77} INFO - actual:
[2024-08-05 11:38:40,740] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:38:40,740] {result_logger:79} INFO - predicted:
[2024-08-05 11:38:40,740] {result_logger:80} INFO - 
[[95.20%  0.19%  4.61%]
 [15.88% 78.13%  5.99%]
 [ 4.38%  2.73% 92.89%]]
[2024-08-05 11:38:40,740] {run_experiment:113} INFO - [epoch  34] execution time: 106.26s	 avg f1-score: 0.9498

[2024-08-05 11:38:40,740] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:38:40,760] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:38:59,899] {train_model:82} INFO - Train Epoch: 35 [36352/366120 (10%)]	lr:6.44e-05	Loss: 0.014253
[2024-08-05 11:39:05,771] {train_model:82} INFO - Train Epoch: 35 [72960/366120 (20%)]	lr:6.44e-05	Loss: 0.017386
[2024-08-05 11:39:11,613] {train_model:82} INFO - Train Epoch: 35 [109568/366120 (30%)]	lr:6.44e-05	Loss: 0.016496
[2024-08-05 11:39:17,469] {train_model:82} INFO - Train Epoch: 35 [146176/366120 (40%)]	lr:6.44e-05	Loss: 0.041449
[2024-08-05 11:39:23,368] {train_model:82} INFO - Train Epoch: 35 [182784/366120 (50%)]	lr:6.44e-05	Loss: 0.037093
[2024-08-05 11:39:29,242] {train_model:82} INFO - Train Epoch: 35 [219392/366120 (60%)]	lr:6.44e-05	Loss: 0.040686
[2024-08-05 11:39:35,123] {train_model:82} INFO - Train Epoch: 35 [256000/366120 (70%)]	lr:6.44e-05	Loss: 0.042177
[2024-08-05 11:39:41,035] {train_model:82} INFO - Train Epoch: 35 [292608/366120 (80%)]	lr:6.44e-05	Loss: 0.051647
[2024-08-05 11:39:46,932] {train_model:82} INFO - Train Epoch: 35 [329216/366120 (90%)]	lr:6.44e-05	Loss: 0.055283
[2024-08-05 11:39:52,858] {train_model:82} INFO - Train Epoch: 35 [365824/366120 (100%)]	lr:6.44e-05	Loss: 0.045817
[2024-08-05 11:39:56,405] {run_experiment:79} INFO - 
[2024-08-05 11:39:56,406] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:39:56,866] {result_logger:103} INFO - precision on Wake: 0.992
[2024-08-05 11:39:57,205] {result_logger:104} INFO - recall on Wake: 0.986
[2024-08-05 11:39:57,544] {result_logger:107} INFO - F1-score on Wake: 0.989
[2024-08-05 11:39:57,544] {result_logger:108} INFO - 
[2024-08-05 11:39:57,962] {result_logger:103} INFO - precision on REM: 0.930
[2024-08-05 11:39:58,251] {result_logger:104} INFO - recall on REM: 0.993
[2024-08-05 11:39:58,537] {result_logger:107} INFO - F1-score on REM: 0.961
[2024-08-05 11:39:58,537] {result_logger:108} INFO - 
[2024-08-05 11:39:58,991] {result_logger:103} INFO - precision on Non REM: 0.982
[2024-08-05 11:39:59,327] {result_logger:104} INFO - recall on Non REM: 0.980
[2024-08-05 11:39:59,664] {result_logger:107} INFO - F1-score on Non REM: 0.981
[2024-08-05 11:39:59,664] {result_logger:108} INFO - 
[2024-08-05 11:39:59,732] {result_logger:111} INFO - average precision on sleep stages: 0.968
[2024-08-05 11:39:59,800] {result_logger:113} INFO - average recall on sleep stages: 0.987
[2024-08-05 11:39:59,868] {result_logger:115} INFO - average F1-score on sleep stages: 0.977
[2024-08-05 11:39:59,869] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:39:59,928] {result_logger:103} INFO - precision on Wake: 0.980
[2024-08-05 11:39:59,968] {result_logger:104} INFO - recall on Wake: 0.977
[2024-08-05 11:40:00,009] {result_logger:107} INFO - F1-score on Wake: 0.978
[2024-08-05 11:40:00,009] {result_logger:108} INFO - 
[2024-08-05 11:40:00,067] {result_logger:103} INFO - precision on REM: 0.838
[2024-08-05 11:40:00,107] {result_logger:104} INFO - recall on REM: 0.960
[2024-08-05 11:40:00,146] {result_logger:107} INFO - F1-score on REM: 0.895
[2024-08-05 11:40:00,147] {result_logger:108} INFO - 
[2024-08-05 11:40:00,204] {result_logger:103} INFO - precision on Non REM: 0.968
[2024-08-05 11:40:00,244] {result_logger:104} INFO - recall on Non REM: 0.956
[2024-08-05 11:40:00,284] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2024-08-05 11:40:00,284] {result_logger:108} INFO - 
[2024-08-05 11:40:00,290] {result_logger:111} INFO - average precision on sleep stages: 0.929
[2024-08-05 11:40:00,296] {result_logger:113} INFO - average recall on sleep stages: 0.964
[2024-08-05 11:40:00,302] {result_logger:115} INFO - average F1-score on sleep stages: 0.945
[2024-08-05 11:40:00,302] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:40:00,350] {result_logger:134} INFO - 
[[200991    222   2534]
 [    29  18479     98]
 [  1689   1162 140916]]
[2024-08-05 11:40:00,398] {result_logger:141} INFO - 
[[ 98.65%   0.11%   1.24%]
 [  0.16%  99.32%   0.53%]
 [  1.17%   0.81%  98.02%]]
[2024-08-05 11:40:00,445] {result_logger:145} INFO - 
[[ 99.15%   1.12%   1.77%]
 [  0.01%  93.03%   0.07%]
 [  0.83%   5.85%  98.17%]]
[2024-08-05 11:40:00,445] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:40:00,449] {result_logger:134} INFO - 
[[27720   101   561]
 [   11  2444    90]
 [  546   371 19786]]
[2024-08-05 11:40:00,454] {result_logger:141} INFO - 
[[ 97.67%   0.36%   1.98%]
 [  0.43%  96.03%   3.54%]
 [  2.64%   1.79%  95.57%]]
[2024-08-05 11:40:00,458] {result_logger:145} INFO - 
[[ 98.03%   3.46%   2.75%]
 [  0.04%  83.81%   0.44%]
 [  1.93%  12.72%  96.81%]]
[2024-08-05 11:40:00,510] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:40:00,511] {result_logger:77} INFO - actual:
[2024-08-05 11:40:00,511] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:40:00,511] {result_logger:79} INFO - predicted:
[2024-08-05 11:40:00,511] {result_logger:80} INFO - 
[[95.10%  0.23%  4.67%]
 [16.02% 78.70%  5.28%]
 [ 4.50%  2.72% 92.79%]]
[2024-08-05 11:40:00,511] {run_experiment:113} INFO - [epoch  35] execution time: 79.77s	 avg f1-score: 0.9451

[2024-08-05 11:40:00,511] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:40:00,530] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:40:25,410] {train_model:82} INFO - Train Epoch: 36 [36352/366120 (10%)]	lr:6.07e-05	Loss: 0.062729
[2024-08-05 11:40:31,263] {train_model:82} INFO - Train Epoch: 36 [72960/366120 (20%)]	lr:6.07e-05	Loss: 0.034792
[2024-08-05 11:40:37,135] {train_model:82} INFO - Train Epoch: 36 [109568/366120 (30%)]	lr:6.07e-05	Loss: 0.051064
[2024-08-05 11:40:42,995] {train_model:82} INFO - Train Epoch: 36 [146176/366120 (40%)]	lr:6.07e-05	Loss: 0.047068
[2024-08-05 11:40:48,867] {train_model:82} INFO - Train Epoch: 36 [182784/366120 (50%)]	lr:6.07e-05	Loss: 0.055157
[2024-08-05 11:40:54,771] {train_model:82} INFO - Train Epoch: 36 [219392/366120 (60%)]	lr:6.07e-05	Loss: 0.025788
[2024-08-05 11:41:00,662] {train_model:82} INFO - Train Epoch: 36 [256000/366120 (70%)]	lr:6.07e-05	Loss: 0.009822
[2024-08-05 11:41:06,567] {train_model:82} INFO - Train Epoch: 36 [292608/366120 (80%)]	lr:6.07e-05	Loss: 0.066565
[2024-08-05 11:41:12,488] {train_model:82} INFO - Train Epoch: 36 [329216/366120 (90%)]	lr:6.07e-05	Loss: 0.019520
[2024-08-05 11:41:18,417] {train_model:82} INFO - Train Epoch: 36 [365824/366120 (100%)]	lr:6.07e-05	Loss: 0.117482
[2024-08-05 11:41:22,332] {run_experiment:79} INFO - 
[2024-08-05 11:41:22,333] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:41:22,779] {result_logger:103} INFO - precision on Wake: 0.992
[2024-08-05 11:41:23,101] {result_logger:104} INFO - recall on Wake: 0.987
[2024-08-05 11:41:23,424] {result_logger:107} INFO - F1-score on Wake: 0.989
[2024-08-05 11:41:23,424] {result_logger:108} INFO - 
[2024-08-05 11:41:23,824] {result_logger:103} INFO - precision on REM: 0.935
[2024-08-05 11:41:24,108] {result_logger:104} INFO - recall on REM: 0.994
[2024-08-05 11:41:24,391] {result_logger:107} INFO - F1-score on REM: 0.963
[2024-08-05 11:41:24,391] {result_logger:108} INFO - 
[2024-08-05 11:41:24,839] {result_logger:103} INFO - precision on Non REM: 0.983
[2024-08-05 11:41:25,161] {result_logger:104} INFO - recall on Non REM: 0.981
[2024-08-05 11:41:25,481] {result_logger:107} INFO - F1-score on Non REM: 0.982
[2024-08-05 11:41:25,481] {result_logger:108} INFO - 
[2024-08-05 11:41:25,549] {result_logger:111} INFO - average precision on sleep stages: 0.970
[2024-08-05 11:41:25,616] {result_logger:113} INFO - average recall on sleep stages: 0.988
[2024-08-05 11:41:25,685] {result_logger:115} INFO - average F1-score on sleep stages: 0.978
[2024-08-05 11:41:25,685] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:41:25,743] {result_logger:103} INFO - precision on Wake: 0.980
[2024-08-05 11:41:25,782] {result_logger:104} INFO - recall on Wake: 0.978
[2024-08-05 11:41:25,822] {result_logger:107} INFO - F1-score on Wake: 0.979
[2024-08-05 11:41:25,822] {result_logger:108} INFO - 
[2024-08-05 11:41:25,878] {result_logger:103} INFO - precision on REM: 0.861
[2024-08-05 11:41:25,917] {result_logger:104} INFO - recall on REM: 0.945
[2024-08-05 11:41:25,956] {result_logger:107} INFO - F1-score on REM: 0.901
[2024-08-05 11:41:25,956] {result_logger:108} INFO - 
[2024-08-05 11:41:26,013] {result_logger:103} INFO - precision on Non REM: 0.968
[2024-08-05 11:41:26,053] {result_logger:104} INFO - recall on Non REM: 0.960
[2024-08-05 11:41:26,093] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2024-08-05 11:41:26,093] {result_logger:108} INFO - 
[2024-08-05 11:41:26,099] {result_logger:111} INFO - average precision on sleep stages: 0.936
[2024-08-05 11:41:26,106] {result_logger:113} INFO - average recall on sleep stages: 0.961
[2024-08-05 11:41:26,112] {result_logger:115} INFO - average F1-score on sleep stages: 0.948
[2024-08-05 11:41:26,112] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:41:26,159] {result_logger:134} INFO - 
[[201120    227   2400]
 [    34  18499     73]
 [  1640   1068 141059]]
[2024-08-05 11:41:26,205] {result_logger:141} INFO - 
[[ 98.71%   0.11%   1.18%]
 [  0.18%  99.42%   0.39%]
 [  1.14%   0.74%  98.12%]]
[2024-08-05 11:41:26,252] {result_logger:145} INFO - 
[[ 99.17%   1.15%   1.67%]
 [  0.02%  93.46%   0.05%]
 [  0.81%   5.40%  98.28%]]
[2024-08-05 11:41:26,252] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:41:26,256] {result_logger:134} INFO - 
[[27754    97   531]
 [   21  2404   120]
 [  539   292 19872]]
[2024-08-05 11:41:26,260] {result_logger:141} INFO - 
[[ 97.79%   0.34%   1.87%]
 [  0.83%  94.46%   4.72%]
 [  2.60%   1.41%  95.99%]]
[2024-08-05 11:41:26,265] {result_logger:145} INFO - 
[[ 98.02%   3.47%   2.59%]
 [  0.07%  86.07%   0.58%]
 [  1.90%  10.45%  96.83%]]
[2024-08-05 11:41:26,318] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:41:26,318] {result_logger:77} INFO - actual:
[2024-08-05 11:41:26,318] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:41:26,318] {result_logger:79} INFO - predicted:
[2024-08-05 11:41:26,318] {result_logger:80} INFO - 
[[95.35%  0.19%  4.46%]
 [15.90% 79.02%  5.08%]
 [ 4.25%  2.60% 93.15%]]
[2024-08-05 11:41:26,318] {run_experiment:113} INFO - [epoch  36] execution time: 85.81s	 avg f1-score: 0.9479

[2024-08-05 11:41:26,318] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:41:26,337] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	REM                 : 18606
	Non REM             : 143767
[2024-08-05 11:41:51,732] {train_model:82} INFO - Train Epoch: 37 [36352/366120 (10%)]	lr:5.71e-05	Loss: 0.021442
[2024-08-05 11:41:57,666] {train_model:82} INFO - Train Epoch: 37 [72960/366120 (20%)]	lr:5.71e-05	Loss: 0.021697
[2024-08-05 11:42:03,619] {train_model:82} INFO - Train Epoch: 37 [109568/366120 (30%)]	lr:5.71e-05	Loss: 0.049052
[2024-08-05 11:42:09,571] {train_model:82} INFO - Train Epoch: 37 [146176/366120 (40%)]	lr:5.71e-05	Loss: 0.020123
[2024-08-05 11:42:15,526] {train_model:82} INFO - Train Epoch: 37 [182784/366120 (50%)]	lr:5.71e-05	Loss: 0.025701
[2024-08-05 11:42:21,499] {train_model:82} INFO - Train Epoch: 37 [219392/366120 (60%)]	lr:5.71e-05	Loss: 0.057166
[2024-08-05 11:42:27,475] {train_model:82} INFO - Train Epoch: 37 [256000/366120 (70%)]	lr:5.71e-05	Loss: 0.042252
[2024-08-05 11:42:33,448] {train_model:82} INFO - Train Epoch: 37 [292608/366120 (80%)]	lr:5.71e-05	Loss: 0.031180
[2024-08-05 11:42:39,432] {train_model:82} INFO - Train Epoch: 37 [329216/366120 (90%)]	lr:5.71e-05	Loss: 0.024749
[2024-08-05 11:42:45,433] {train_model:82} INFO - Train Epoch: 37 [365824/366120 (100%)]	lr:5.71e-05	Loss: 0.054703
[2024-08-05 11:42:49,184] {run_experiment:79} INFO - 
[2024-08-05 11:42:49,184] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-08-05 11:42:49,632] {result_logger:103} INFO - precision on Wake: 0.992
[2024-08-05 11:42:49,953] {result_logger:104} INFO - recall on Wake: 0.987
[2024-08-05 11:42:50,277] {result_logger:107} INFO - F1-score on Wake: 0.990
[2024-08-05 11:42:50,277] {result_logger:108} INFO - 
[2024-08-05 11:42:50,679] {result_logger:103} INFO - precision on REM: 0.936
[2024-08-05 11:42:50,964] {result_logger:104} INFO - recall on REM: 0.993
[2024-08-05 11:42:51,249] {result_logger:107} INFO - F1-score on REM: 0.964
[2024-08-05 11:42:51,249] {result_logger:108} INFO - 
[2024-08-05 11:42:51,702] {result_logger:103} INFO - precision on Non REM: 0.983
[2024-08-05 11:42:52,026] {result_logger:104} INFO - recall on Non REM: 0.982
[2024-08-05 11:42:52,343] {result_logger:107} INFO - F1-score on Non REM: 0.983
[2024-08-05 11:42:52,343] {result_logger:108} INFO - 
[2024-08-05 11:42:52,409] {result_logger:111} INFO - average precision on sleep stages: 0.971
[2024-08-05 11:42:52,477] {result_logger:113} INFO - average recall on sleep stages: 0.988
[2024-08-05 11:42:52,544] {result_logger:115} INFO - average F1-score on sleep stages: 0.979
[2024-08-05 11:42:52,545] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-08-05 11:42:52,601] {result_logger:103} INFO - precision on Wake: 0.980
[2024-08-05 11:42:52,639] {result_logger:104} INFO - recall on Wake: 0.977
[2024-08-05 11:42:52,677] {result_logger:107} INFO - F1-score on Wake: 0.979
[2024-08-05 11:42:52,677] {result_logger:108} INFO - 
[2024-08-05 11:42:52,733] {result_logger:103} INFO - precision on REM: 0.832
[2024-08-05 11:42:52,772] {result_logger:104} INFO - recall on REM: 0.961
[2024-08-05 11:42:52,811] {result_logger:107} INFO - F1-score on REM: 0.892
[2024-08-05 11:42:52,811] {result_logger:108} INFO - 
[2024-08-05 11:42:52,868] {result_logger:103} INFO - precision on Non REM: 0.969
[2024-08-05 11:42:52,908] {result_logger:104} INFO - recall on Non REM: 0.955
[2024-08-05 11:42:52,948] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2024-08-05 11:42:52,948] {result_logger:108} INFO - 
[2024-08-05 11:42:52,954] {result_logger:111} INFO - average precision on sleep stages: 0.927
[2024-08-05 11:42:52,960] {result_logger:113} INFO - average recall on sleep stages: 0.964
[2024-08-05 11:42:52,966] {result_logger:115} INFO - average F1-score on sleep stages: 0.944
[2024-08-05 11:42:52,966] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-08-05 11:42:53,012] {result_logger:134} INFO - 
[[201181    236   2330]
 [    37  18482     87]
 [  1533   1026 141208]]
[2024-08-05 11:42:53,058] {result_logger:141} INFO - 
[[ 98.74%   0.12%   1.14%]
 [  0.20%  99.33%   0.47%]
 [  1.07%   0.71%  98.22%]]
[2024-08-05 11:42:53,103] {result_logger:145} INFO - 
[[ 99.23%   1.20%   1.62%]
 [  0.02%  93.61%   0.06%]
 [  0.76%   5.20%  98.32%]]
[2024-08-05 11:42:53,103] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-08-05 11:42:53,108] {result_logger:134} INFO - 
[[27732   103   547]
 [   19  2445    81]
 [  540   392 19771]]
[2024-08-05 11:42:53,112] {result_logger:141} INFO - 
[[ 97.71%   0.36%   1.93%]
 [  0.75%  96.07%   3.18%]
 [  2.61%   1.89%  95.50%]]
[2024-08-05 11:42:53,116] {result_logger:145} INFO - 
[[ 98.02%   3.50%   2.68%]
 [  0.07%  83.16%   0.40%]
 [  1.91%  13.33%  96.92%]]
[2024-08-05 11:42:53,169] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-08-05 11:42:53,169] {result_logger:77} INFO - actual:
[2024-08-05 11:42:53,170] {result_logger:78} INFO - 
[[95.61%  0.00%  4.39%]
 [15.36% 80.35%  4.28%]
 [ 4.13%  2.41% 93.46%]]
[2024-08-05 11:42:53,170] {result_logger:79} INFO - predicted:
[2024-08-05 11:42:53,170] {result_logger:80} INFO - 
[[95.27%  0.17%  4.56%]
 [15.58% 78.27%  6.16%]
 [ 4.31%  2.90% 92.79%]]
[2024-08-05 11:42:53,170] {run_experiment:113} INFO - [epoch  37] execution time: 86.85s	 avg f1-score: 0.9441

[2024-08-05 11:42:53,290] {result_logger:56} INFO - final F1-scores on train:
	Wake                : [0.6038160295186755, 0.7942189570034928, 0.8457406507506048, 0.8938287652452958, 0.9359308574637043, 0.9495595838784028, 0.9554472338528291, 0.9572254162547899, 0.9616879896856095, 0.9635531135531135, 0.9662556283890877, 0.9684202201539199, 0.970590124249685, 0.9729480327860763, 0.9745056615694444, 0.9756522382720466, 0.9774446105347285, 0.9785191449076345, 0.978949029042452, 0.9800662650008382, 0.9807492323842661, 0.9812969915550694, 0.9817693643540699, 0.9823393794890489, 0.9829225469168241, 0.9836582964057113, 0.9845117878265065, 0.9849534472656731, 0.9855612551320803, 0.9860977098635371, 0.9868683338829469, 0.9874638237552419, 0.9877650636349544, 0.988460724636968, 0.9889926584919401, 0.9894205012532561, 0.9898252881932997]
	REM                 : [0.17063100977545748, 0.39420878154387395, 0.4963240164260167, 0.591671319381606, 0.7198103039448157, 0.7648073863254375, 0.7847242634589731, 0.7869377806865112, 0.8075309950684425, 0.8136614300940729, 0.8191333812983034, 0.833239383690342, 0.8422441622092885, 0.8574232776368076, 0.8626518753301637, 0.8691447130999638, 0.8782452564662494, 0.8860022505993443, 0.89119120102131, 0.8979360343254507, 0.9029638249931909, 0.907102738704707, 0.9126121398405678, 0.9190897915150907, 0.9229026655591633, 0.9283547375872181, 0.9325081796738276, 0.9356142446811215, 0.9404372701266858, 0.9441684167392307, 0.9478256399712142, 0.9523391737413878, 0.9555814254300866, 0.9586794019933556, 0.9607216200057188, 0.9634895833333335, 0.9638591916558019]
	Non REM             : [0.6161993916015931, 0.8307411310151037, 0.853616520806669, 0.8835677898934036, 0.9185447498483824, 0.9297151160353764, 0.9345348196025604, 0.9357973120232475, 0.9393820527727773, 0.9417910343037167, 0.943925824465283, 0.9468141089959936, 0.949865073989985, 0.9528635349894099, 0.9547241473549961, 0.9557860797644915, 0.9587919782651317, 0.960324765087753, 0.961095211772197, 0.9632397926185923, 0.9641707248008222, 0.9654569732730234, 0.9666943805937301, 0.9677890171896659, 0.9690454577194331, 0.9705742729087837, 0.9719236031608633, 0.9727966849556843, 0.9742695767380238, 0.9754434879587356, 0.9767166342609048, 0.9781955332360532, 0.9788733865968251, 0.9799842658924929, 0.9809164157805893, 0.9819665226819446, 0.9826856697472443]
	avg                 : [0.46354881029857536, 0.6730562898541569, 0.7318937293277635, 0.7896892915067685, 0.8580953037523008, 0.8813606954130723, 0.8915687723047875, 0.8933201696548494, 0.9028670125089432, 0.9063351926503009, 0.9097716113842247, 0.9161579042800853, 0.9208997868163195, 0.9277449484707646, 0.9306272280848681, 0.9335276770455007, 0.9381606150887033, 0.9416153868649105, 0.943745147278653, 0.9470806973149605, 0.9492945940594265, 0.9512855678442665, 0.9536919615961227, 0.9564060627312685, 0.9582902233984735, 0.9608624356339043, 0.9629811902203992, 0.9644547923008263, 0.9667560339989301, 0.9685698715205011, 0.9704702027050219, 0.9726661769108942, 0.9740732918872886, 0.9757081308409389, 0.9768768980927494, 0.9782922024228448, 0.9787900498654487]
[2024-08-05 11:42:53,290] {result_logger:56} INFO - final F1-scores on valid:
	Wake                : [0.6742888346615244, 0.7113186110913868, 0.8138737052904581, 0.7103260327694506, 0.8827017011958902, 0.8861900170585181, 0.8974444444444444, 0.860153040069358, 0.9553199345888063, 0.9635794590247058, 0.966305008245812, 0.9356075824537053, 0.972854870566849, 0.9705256970975158, 0.9604566423148032, 0.979038181083408, 0.9758894597485488, 0.9750694456576809, 0.9765034130591188, 0.9769717803462126, 0.9696173310840808, 0.9755384018892532, 0.9773602071523549, 0.9762026747698884, 0.9774404459324441, 0.9802765494490069, 0.9809298882583102, 0.977656291332334, 0.9740917951444267, 0.9800803867060928, 0.9803783545974483, 0.9799778508270782, 0.9797721049377264, 0.9797585164495202, 0.9784853244850775, 0.9790461408212219, 0.9786670901487482]
	REM                 : [0.2823236296879098, 0.39717104038712076, 0.5262487257900101, 0.3550867941111843, 0.5597850425436632, 0.43956427015250543, 0.4936795688388045, 0.4256905609218776, 0.6800484979118954, 0.7883581145207212, 0.8112749068524219, 0.624564893088016, 0.8233740508418621, 0.829995033934779, 0.7832520069258619, 0.8715162138475021, 0.8523307247363048, 0.8313031870515601, 0.8731698712294937, 0.8806818181818182, 0.8253808806294994, 0.8601036269430052, 0.8848637015781923, 0.8729515418502203, 0.8762446657183499, 0.9078040603464332, 0.8929351784413693, 0.888768115942029, 0.8767763986328477, 0.8935543278084714, 0.9080999812065401, 0.8990455212922172, 0.9014189693801344, 0.9042117033171824, 0.8950741622413477, 0.9007118771075309, 0.8915223336371922]
	Non REM             : [0.5808821029006699, 0.6912276822729534, 0.7340465628714739, 0.5788847735227157, 0.8046799015962012, 0.8870102765963067, 0.9169120471130456, 0.9076041666666667, 0.9210080583072422, 0.9331991445464838, 0.9342991743072793, 0.9336101636264768, 0.9407616713760596, 0.9356903383114905, 0.9508690164093602, 0.9573347768318489, 0.9530394270562287, 0.9442390326771261, 0.9555708797162842, 0.9576223190761124, 0.9593380845455431, 0.9549695541151052, 0.9560797473351756, 0.957347128007418, 0.9572030453100746, 0.9637434906975039, 0.9636363636363636, 0.9620080419154381, 0.9585423178503064, 0.9645249437767514, 0.9647808532373401, 0.9629321930360415, 0.9639942855759219, 0.9653737266194012, 0.9618862421001457, 0.9640518119633241, 0.9620456425478079]
	avg                 : [0.5124981890833681, 0.5999057779171536, 0.6913896646506474, 0.5480992001344501, 0.7490555484452516, 0.7375881879357767, 0.7693453534654315, 0.7311492558859675, 0.8521254969359813, 0.8950455726973036, 0.9039596964685043, 0.8312608797227327, 0.9123301975949237, 0.9120703564479284, 0.8981925552166751, 0.935963057254253, 0.9270865371803607, 0.916870555128789, 0.9350813880016323, 0.9384253058680477, 0.9181120987530411, 0.9302038609824544, 0.9394345520219076, 0.9355004482091754, 0.9369627189869562, 0.950608033497648, 0.9458338101120143, 0.9428108163966004, 0.936470170542527, 0.9460532194304386, 0.9510863963471095, 0.9473185217184458, 0.9483951199645942, 0.9497813154620346, 0.9451485762755235, 0.9479366099640257, 0.9440783554445827]
[2024-08-05 11:42:53,430] {logger:50} INFO - 
[2024-08-05 11:42:53,430] {logger:51} INFO - ================================================================================
[2024-08-05 11:42:53,430] {logger:52} INFO - finished training
[2024-08-05 11:42:53,430] {logger:53} INFO - ================================================================================
[2024-08-05 11:42:53,430] {logger:54} INFO - 
[2024-08-05 11:42:53,430] {logger:50} INFO - 
[2024-08-05 11:42:53,430] {logger:51} INFO - ================================================================================
[2024-08-05 11:42:53,430] {logger:52} INFO - best model on epoch: 31 	f1-score: 0.9511
[2024-08-05 11:42:53,430] {logger:53} INFO - ================================================================================
[2024-08-05 11:42:53,430] {logger:54} INFO - 
