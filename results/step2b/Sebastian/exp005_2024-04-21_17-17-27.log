[2024-04-21 17:17:27,209] {logger:43} INFO - run_experiment.py, args: Namespace(experiment='exp005')
================================================================================
[2024-04-21 17:17:27,209] {logger:44} INFO - config:
[2024-04-21 17:17:27,209] {logger:45} INFO - parameter name      | parameter value
[2024-04-21 17:17:27,209] {logger:46} INFO - experiment          : exp005
[2024-04-21 17:17:27,209] {logger:46} INFO - RUN_NAME            : exp005_2024-04-21_17-17-27
[2024-04-21 17:17:27,209] {logger:46} INFO - DEVICE              : cuda
[2024-04-21 17:17:27,210] {logger:46} INFO - EXPERIMENT_DIR      : /home/s202283/code/grieger_validation/results/exp005
[2024-04-21 17:17:27,210] {logger:46} INFO - MODELS_DIR          : /home/s202283/code/grieger_validation/results/exp005/models
[2024-04-21 17:17:27,210] {logger:46} INFO - VISUALS_DIR         : /home/s202283/code/grieger_validation/results/exp005/visuals/exp005_2024-04-21_17-17-27
[2024-04-21 17:17:27,210] {logger:46} INFO - DATA_DIR            : /scratch/s202283/data/mice-data-tuebingen/data
[2024-04-21 17:17:27,210] {logger:46} INFO - SAMPLE_DURATION     : 10
[2024-04-21 17:17:27,210] {logger:46} INFO - SAMPLING_RATE       : 64
[2024-04-21 17:17:27,210] {logger:46} INFO - SCORING_MAP         : {'Wake': [1, 17], 'REM': [3, 19], 'Non REM': [2, 18], 'Pre REM': [4, 20], 'Artifact': [8, 24]}
[2024-04-21 17:17:27,210] {logger:46} INFO - STAGE_MAP           : {'Wake': 'Wake', 'REM': 'REM', 'Non REM': 'Non REM', 'Pre REM': 'Non REM', 'Artifact': None}
[2024-04-21 17:17:27,210] {logger:46} INFO - DATA_SPLIT          : {'train': ['M19', 'M20', 'M21', 'M22', 'M23', 'M24', 'M25', 'M26', 'M27', 'M28', 'M29', 'M31', 'M32', 'M33'], 'valid': ['M34', 'M35'], 'test': ['M36', 'M37']}
[2024-04-21 17:17:27,210] {logger:46} INFO - DATA_FILE           : /home/s202283/code/grieger_validation/cache/dataset/data_tuebingen_main_stages.h5
[2024-04-21 17:17:27,210] {logger:46} INFO - STAGES              : ['Wake', 'Non REM', 'REM']
[2024-04-21 17:17:27,210] {logger:46} INFO - BALANCED_TRAINING   : False
[2024-04-21 17:17:27,210] {logger:46} INFO - BALANCING_WEIGHTS   : [0.3, 0.18, 0.24, 0.14, 0.14]
[2024-04-21 17:17:27,210] {logger:46} INFO - CHANNELS            : ['EEG_PR']
[2024-04-21 17:17:27,210] {logger:46} INFO - SAMPLES_LEFT        : 1
[2024-04-21 17:17:27,210] {logger:46} INFO - SAMPLES_RIGHT       : 1
[2024-04-21 17:17:27,210] {logger:46} INFO - LOG_INTERVAL        : 10
[2024-04-21 17:17:27,210] {logger:46} INFO - EXTRA_SAFE_MODELS   : False
[2024-04-21 17:17:27,210] {logger:46} INFO - BATCH_SIZE          : 256
[2024-04-21 17:17:27,210] {logger:46} INFO - DATA_FRACTION       : 1.0
[2024-04-21 17:17:27,210] {logger:46} INFO - DATA_FRACTION_STRAT : None
[2024-04-21 17:17:27,210] {logger:46} INFO - EPOCHS              : 50
[2024-04-21 17:17:27,210] {logger:46} INFO - WARMUP_EPOCHS       : 12
[2024-04-21 17:17:27,211] {logger:46} INFO - S_OPTIM_MODE        : exp
[2024-04-21 17:17:27,211] {logger:46} INFO - S_OPTIM_PARAS       : [0.06]
[2024-04-21 17:17:27,211] {logger:46} INFO - LEARNING_RATE       : 0.000256
[2024-04-21 17:17:27,211] {logger:46} INFO - OPTIMIZER           : <class 'torch.optim.adam.Adam'>
[2024-04-21 17:17:27,211] {logger:46} INFO - OPTIM_PARAS         : {}
[2024-04-21 17:17:27,211] {logger:46} INFO - L1_WEIGHT_DECAY     : 0
[2024-04-21 17:17:27,211] {logger:46} INFO - L2_WEIGHT_DECAY     : 0.0001
[2024-04-21 17:17:27,211] {logger:46} INFO - BATCH_SIZE_EVAL     : 512
[2024-04-21 17:17:27,211] {logger:46} INFO - FILTERS             : 96
[2024-04-21 17:17:27,211] {logger:46} INFO - CLASSIFIER_DROPOUT  : [0.2, 0.2]
[2024-04-21 17:17:27,211] {logger:46} INFO - FEATURE_EXTR_DROPOUT: [0.0, 0.2, 0.0, 0.2, 0.0, 0.2, 0.0, 0.2]
[2024-04-21 17:17:27,211] {logger:46} INFO - MODEL_NAME          : model_8conv_2fc
[2024-04-21 17:17:27,211] {logger:46} INFO - GAIN                : 0.0
[2024-04-21 17:17:27,211] {logger:46} INFO - FLIP                : 0.0
[2024-04-21 17:17:27,211] {logger:46} INFO - FLIP_ALL            : 0.0
[2024-04-21 17:17:27,211] {logger:46} INFO - WINDOW_WARP_SIZE    : 0.0
[2024-04-21 17:17:27,211] {logger:46} INFO - FLIP_HORI           : 0.0
[2024-04-21 17:17:27,211] {logger:46} INFO - TIME_SHIFT          : 0.0
[2024-04-21 17:17:27,211] {logger:50} INFO - 
[2024-04-21 17:17:27,211] {logger:51} INFO - ================================================================================
[2024-04-21 17:17:27,211] {logger:52} INFO - start training with model: model_8conv_2fc
[2024-04-21 17:17:27,211] {logger:53} INFO - ================================================================================
[2024-04-21 17:17:27,211] {logger:54} INFO - 
[2024-04-21 17:17:36,624] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 17:17:36,655] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 17:17:38,015] {dataloader:120} INFO - data distribution in database for dataset valid:
	Wake                : 28382
	Non REM             : 20704
	REM                 : 2544
[2024-04-21 17:17:38,020] {dataloader:147} INFO - data distribution after processing:
	Wake                : 28382
	Non REM             : 20704
	REM                 : 2544
[2024-04-21 17:17:39,003] {run_experiment:47} INFO - classifier:
Model(
  (feature_extractor): Sequential(
    (0): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1): Conv1d(1, 96, kernel_size=(5,), stride=(1,))
    (2): ReLU(inplace=True)
    (3): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): Dropout(p=0.0, inplace=False)
    (5): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (6): ReLU(inplace=True)
    (7): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): Dropout(p=0.2, inplace=False)
    (9): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (10): ReLU(inplace=True)
    (11): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (12): Dropout(p=0.0, inplace=False)
    (13): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (14): ReLU(inplace=True)
    (15): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (16): Dropout(p=0.2, inplace=False)
    (17): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (18): ReLU(inplace=True)
    (19): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (20): Dropout(p=0.0, inplace=False)
    (21): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (22): ReLU(inplace=True)
    (23): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (24): Dropout(p=0.2, inplace=False)
    (25): Conv1d(96, 96, kernel_size=(5,), stride=(1,))
    (26): ReLU(inplace=True)
    (27): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (28): Dropout(p=0.0, inplace=False)
    (29): Conv1d(96, 96, kernel_size=(5,), stride=(2,))
    (30): ReLU(inplace=True)
    (31): BatchNorm1d(96, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (32): Dropout(p=0.2, inplace=False)
  )
  (classifier): Sequential(
    (0): Dropout(p=0.2, inplace=False)
    (1): Linear(in_features=10848, out_features=80, bias=True)
    (2): ReLU(inplace=True)
    (3): Dropout(p=0.2, inplace=False)
    (4): Linear(in_features=80, out_features=3, bias=True)
  )
)
[2024-04-21 17:17:56,811] {train_model:82} INFO - Train Epoch: 1 [36352/366120 (10%)]	lr:2.56e-05	Loss: 102.468636
[2024-04-21 17:18:10,174] {train_model:82} INFO - Train Epoch: 1 [72960/366120 (20%)]	lr:2.56e-05	Loss: 46.014729
[2024-04-21 17:18:23,605] {train_model:82} INFO - Train Epoch: 1 [109568/366120 (30%)]	lr:2.56e-05	Loss: 48.262436
[2024-04-21 17:18:37,088] {train_model:82} INFO - Train Epoch: 1 [146176/366120 (40%)]	lr:2.56e-05	Loss: 53.866737
[2024-04-21 17:18:50,603] {train_model:82} INFO - Train Epoch: 1 [182784/366120 (50%)]	lr:2.56e-05	Loss: 38.298653
[2024-04-21 17:19:04,179] {train_model:82} INFO - Train Epoch: 1 [219392/366120 (60%)]	lr:2.56e-05	Loss: 41.566860
[2024-04-21 17:19:17,783] {train_model:82} INFO - Train Epoch: 1 [256000/366120 (70%)]	lr:2.56e-05	Loss: 40.616707
[2024-04-21 17:19:31,432] {train_model:82} INFO - Train Epoch: 1 [292608/366120 (80%)]	lr:2.56e-05	Loss: 31.712177
[2024-04-21 17:19:45,057] {train_model:82} INFO - Train Epoch: 1 [329216/366120 (90%)]	lr:2.56e-05	Loss: 22.753105
[2024-04-21 17:19:58,647] {train_model:82} INFO - Train Epoch: 1 [365824/366120 (100%)]	lr:2.56e-05	Loss: 26.238396
[2024-04-21 17:20:04,093] {run_experiment:78} INFO - 
[2024-04-21 17:20:04,093] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 17:20:04,743] {result_logger:103} INFO - precision on Wake: 0.730
[2024-04-21 17:20:05,155] {result_logger:104} INFO - recall on Wake: 0.394
[2024-04-21 17:20:05,567] {result_logger:107} INFO - F1-score on Wake: 0.511
[2024-04-21 17:20:05,567] {result_logger:108} INFO - 
[2024-04-21 17:20:06,218] {result_logger:103} INFO - precision on Non REM: 0.581
[2024-04-21 17:20:06,636] {result_logger:104} INFO - recall on Non REM: 0.724
[2024-04-21 17:20:07,055] {result_logger:107} INFO - F1-score on Non REM: 0.645
[2024-04-21 17:20:07,056] {result_logger:108} INFO - 
[2024-04-21 17:20:07,670] {result_logger:103} INFO - precision on REM: 0.089
[2024-04-21 17:20:08,049] {result_logger:104} INFO - recall on REM: 0.370
[2024-04-21 17:20:08,429] {result_logger:107} INFO - F1-score on REM: 0.144
[2024-04-21 17:20:08,429] {result_logger:108} INFO - 
[2024-04-21 17:20:08,523] {result_logger:111} INFO - average precision on sleep stages: 0.467
[2024-04-21 17:20:08,617] {result_logger:113} INFO - average recall on sleep stages: 0.496
[2024-04-21 17:20:08,710] {result_logger:115} INFO - average F1-score on sleep stages: 0.433
[2024-04-21 17:20:08,712] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 17:20:08,793] {result_logger:103} INFO - precision on Wake: 0.660
[2024-04-21 17:20:08,845] {result_logger:104} INFO - recall on Wake: 0.882
[2024-04-21 17:20:08,898] {result_logger:107} INFO - F1-score on Wake: 0.755
[2024-04-21 17:20:08,898] {result_logger:108} INFO - 
[2024-04-21 17:20:08,982] {result_logger:103} INFO - precision on Non REM: 0.976
[2024-04-21 17:20:09,032] {result_logger:104} INFO - recall on Non REM: 0.305
[2024-04-21 17:20:09,084] {result_logger:107} INFO - F1-score on Non REM: 0.465
[2024-04-21 17:20:09,084] {result_logger:108} INFO - 
[2024-04-21 17:20:09,166] {result_logger:103} INFO - precision on REM: 0.234
[2024-04-21 17:20:09,217] {result_logger:104} INFO - recall on REM: 0.665
[2024-04-21 17:20:09,268] {result_logger:107} INFO - F1-score on REM: 0.346
[2024-04-21 17:20:09,268] {result_logger:108} INFO - 
[2024-04-21 17:20:09,279] {result_logger:111} INFO - average precision on sleep stages: 0.623
[2024-04-21 17:20:09,290] {result_logger:113} INFO - average recall on sleep stages: 0.617
[2024-04-21 17:20:09,301] {result_logger:115} INFO - average F1-score on sleep stages: 0.522
[2024-04-21 17:20:09,301] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 17:20:09,365] {result_logger:134} INFO - 
[[ 80206  69095  54446]
 [ 23922 104133  15712]
 [  5773   5954   6879]]
[2024-04-21 17:20:09,428] {result_logger:141} INFO - 
[[ 39.37%  33.91%  26.72%]
 [ 16.64%  72.43%  10.93%]
 [ 31.03%  32.00%  36.97%]]
[2024-04-21 17:20:09,490] {result_logger:145} INFO - 
[[ 72.98%  38.56%  70.68%]
 [ 21.77%  58.12%  20.40%]
 [  5.25%   3.32%   8.93%]]
[2024-04-21 17:20:09,490] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 17:20:09,498] {result_logger:134} INFO - 
[[25038   154  3190]
 [12026  6315  2362]
 [  848     4  1693]]
[2024-04-21 17:20:09,619] {result_logger:141} INFO - 
[[ 88.22%   0.54%  11.24%]
 [ 58.09%  30.50%  11.41%]
 [ 33.32%   0.16%  66.52%]]
[2024-04-21 17:20:09,711] {result_logger:145} INFO - 
[[ 66.04%   2.38%  44.03%]
 [ 31.72%  97.56%  32.60%]
 [  2.24%   0.06%  23.37%]]
[2024-04-21 17:20:09,969] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 17:20:09,970] {result_logger:77} INFO - actual:
[2024-04-21 17:20:09,970] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 17:20:09,970] {result_logger:79} INFO - predicted:
[2024-04-21 17:20:09,970] {result_logger:80} INFO - 
[[84.37%  4.82% 10.81%]
 [24.22% 64.53% 11.25%]
 [60.17%  6.47% 33.36%]]
[2024-04-21 17:20:10,025] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp005/model_8conv_2fc-best.pth
[2024-04-21 17:20:10,026] {run_experiment:112} INFO - [epoch   1] execution time: 151.02s	 avg f1-score: 0.5220

[2024-04-21 17:20:10,026] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 17:20:10,053] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 17:20:28,271] {train_model:82} INFO - Train Epoch: 2 [36352/366120 (10%)]	lr:4.65e-05	Loss: 29.453583
[2024-04-21 17:20:41,771] {train_model:82} INFO - Train Epoch: 2 [72960/366120 (20%)]	lr:4.65e-05	Loss: 8.083097
[2024-04-21 17:20:55,301] {train_model:82} INFO - Train Epoch: 2 [109568/366120 (30%)]	lr:4.65e-05	Loss: 11.007700
[2024-04-21 17:21:08,863] {train_model:82} INFO - Train Epoch: 2 [146176/366120 (40%)]	lr:4.65e-05	Loss: 11.069194
[2024-04-21 17:21:22,431] {train_model:82} INFO - Train Epoch: 2 [182784/366120 (50%)]	lr:4.65e-05	Loss: 7.839905
[2024-04-21 17:21:36,019] {train_model:82} INFO - Train Epoch: 2 [219392/366120 (60%)]	lr:4.65e-05	Loss: 8.844263
[2024-04-21 17:21:49,625] {train_model:82} INFO - Train Epoch: 2 [256000/366120 (70%)]	lr:4.65e-05	Loss: 8.089372
[2024-04-21 17:22:03,252] {train_model:82} INFO - Train Epoch: 2 [292608/366120 (80%)]	lr:4.65e-05	Loss: 3.049621
[2024-04-21 17:22:16,907] {train_model:82} INFO - Train Epoch: 2 [329216/366120 (90%)]	lr:4.65e-05	Loss: 8.290979
[2024-04-21 17:22:30,519] {train_model:82} INFO - Train Epoch: 2 [365824/366120 (100%)]	lr:4.65e-05	Loss: 2.937214
[2024-04-21 17:22:36,005] {run_experiment:78} INFO - 
[2024-04-21 17:22:36,005] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 17:22:36,667] {result_logger:103} INFO - precision on Wake: 0.839
[2024-04-21 17:22:37,089] {result_logger:104} INFO - recall on Wake: 0.633
[2024-04-21 17:22:37,510] {result_logger:107} INFO - F1-score on Wake: 0.722
[2024-04-21 17:22:37,510] {result_logger:108} INFO - 
[2024-04-21 17:22:38,148] {result_logger:103} INFO - precision on Non REM: 0.784
[2024-04-21 17:22:38,565] {result_logger:104} INFO - recall on Non REM: 0.803
[2024-04-21 17:22:38,982] {result_logger:107} INFO - F1-score on Non REM: 0.793
[2024-04-21 17:22:38,982] {result_logger:108} INFO - 
[2024-04-21 17:22:39,598] {result_logger:103} INFO - precision on REM: 0.212
[2024-04-21 17:22:39,975] {result_logger:104} INFO - recall on REM: 0.742
[2024-04-21 17:22:40,352] {result_logger:107} INFO - F1-score on REM: 0.330
[2024-04-21 17:22:40,352] {result_logger:108} INFO - 
[2024-04-21 17:22:40,451] {result_logger:111} INFO - average precision on sleep stages: 0.611
[2024-04-21 17:22:40,549] {result_logger:113} INFO - average recall on sleep stages: 0.726
[2024-04-21 17:22:40,647] {result_logger:115} INFO - average F1-score on sleep stages: 0.615
[2024-04-21 17:22:40,648] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 17:22:40,732] {result_logger:103} INFO - precision on Wake: 0.738
[2024-04-21 17:22:40,783] {result_logger:104} INFO - recall on Wake: 0.975
[2024-04-21 17:22:40,834] {result_logger:107} INFO - F1-score on Wake: 0.840
[2024-04-21 17:22:40,834] {result_logger:108} INFO - 
[2024-04-21 17:22:40,916] {result_logger:103} INFO - precision on Non REM: 0.969
[2024-04-21 17:22:40,968] {result_logger:104} INFO - recall on Non REM: 0.543
[2024-04-21 17:22:41,019] {result_logger:107} INFO - F1-score on Non REM: 0.696
[2024-04-21 17:22:41,019] {result_logger:108} INFO - 
[2024-04-21 17:22:41,102] {result_logger:103} INFO - precision on REM: 0.668
[2024-04-21 17:22:41,153] {result_logger:104} INFO - recall on REM: 0.663
[2024-04-21 17:22:41,202] {result_logger:107} INFO - F1-score on REM: 0.665
[2024-04-21 17:22:41,202] {result_logger:108} INFO - 
[2024-04-21 17:22:41,213] {result_logger:111} INFO - average precision on sleep stages: 0.792
[2024-04-21 17:22:41,223] {result_logger:113} INFO - average recall on sleep stages: 0.727
[2024-04-21 17:22:41,234] {result_logger:115} INFO - average F1-score on sleep stages: 0.734
[2024-04-21 17:22:41,234] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 17:22:41,301] {result_logger:134} INFO - 
[[128983  30690  44074]
 [ 21167 115384   7216]
 [  3627   1176  13803]]
[2024-04-21 17:22:41,367] {result_logger:141} INFO - 
[[ 63.31%  15.06%  21.63%]
 [ 14.72%  80.26%   5.02%]
 [ 19.49%   6.32%  74.19%]]
[2024-04-21 17:22:41,433] {result_logger:145} INFO - 
[[ 83.88%  20.84%  67.71%]
 [ 13.76%  78.36%  11.09%]
 [  2.36%   0.80%  21.21%]]
[2024-04-21 17:22:41,433] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 17:22:41,440] {result_logger:134} INFO - 
[[27686   340   356]
 [ 8984 11235   484]
 [  839    19  1687]]
[2024-04-21 17:22:41,537] {result_logger:141} INFO - 
[[ 97.55%   1.20%   1.25%]
 [ 43.39%  54.27%   2.34%]
 [ 32.97%   0.75%  66.29%]]
[2024-04-21 17:22:41,631] {result_logger:145} INFO - 
[[ 73.81%   2.93%  14.09%]
 [ 23.95%  96.90%  19.15%]
 [  2.24%   0.16%  66.76%]]
[2024-04-21 17:22:41,891] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 17:22:41,891] {result_logger:77} INFO - actual:
[2024-04-21 17:22:41,891] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 17:22:41,891] {result_logger:79} INFO - predicted:
[2024-04-21 17:22:41,891] {result_logger:80} INFO - 
[[90.52%  7.48%  1.99%]
 [22.30% 75.20%  2.50%]
 [38.35%  2.69% 58.96%]]
[2024-04-21 17:22:41,948] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp005/model_8conv_2fc-best.pth
[2024-04-21 17:22:41,948] {run_experiment:112} INFO - [epoch   2] execution time: 151.92s	 avg f1-score: 0.7338

[2024-04-21 17:22:41,948] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 17:22:41,975] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 17:22:59,960] {train_model:82} INFO - Train Epoch: 3 [36352/366120 (10%)]	lr:6.75e-05	Loss: 2.732372
[2024-04-21 17:23:13,447] {train_model:82} INFO - Train Epoch: 3 [72960/366120 (20%)]	lr:6.75e-05	Loss: 3.100604
[2024-04-21 17:23:26,973] {train_model:82} INFO - Train Epoch: 3 [109568/366120 (30%)]	lr:6.75e-05	Loss: 2.866003
[2024-04-21 17:23:40,525] {train_model:82} INFO - Train Epoch: 3 [146176/366120 (40%)]	lr:6.75e-05	Loss: 3.099722
[2024-04-21 17:23:54,102] {train_model:82} INFO - Train Epoch: 3 [182784/366120 (50%)]	lr:6.75e-05	Loss: 1.914495
[2024-04-21 17:24:07,700] {train_model:82} INFO - Train Epoch: 3 [219392/366120 (60%)]	lr:6.75e-05	Loss: 3.738731
[2024-04-21 17:24:21,318] {train_model:82} INFO - Train Epoch: 3 [256000/366120 (70%)]	lr:6.75e-05	Loss: 0.951608
[2024-04-21 17:24:34,949] {train_model:82} INFO - Train Epoch: 3 [292608/366120 (80%)]	lr:6.75e-05	Loss: 1.574357
[2024-04-21 17:24:48,594] {train_model:82} INFO - Train Epoch: 3 [329216/366120 (90%)]	lr:6.75e-05	Loss: 1.322262
[2024-04-21 17:25:02,215] {train_model:82} INFO - Train Epoch: 3 [365824/366120 (100%)]	lr:6.75e-05	Loss: 0.598511
[2024-04-21 17:25:07,403] {run_experiment:78} INFO - 
[2024-04-21 17:25:07,404] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 17:25:08,058] {result_logger:103} INFO - precision on Wake: 0.863
[2024-04-21 17:25:08,482] {result_logger:104} INFO - recall on Wake: 0.811
[2024-04-21 17:25:08,907] {result_logger:107} INFO - F1-score on Wake: 0.837
[2024-04-21 17:25:08,907] {result_logger:108} INFO - 
[2024-04-21 17:25:09,540] {result_logger:103} INFO - precision on Non REM: 0.879
[2024-04-21 17:25:09,953] {result_logger:104} INFO - recall on Non REM: 0.810
[2024-04-21 17:25:10,367] {result_logger:107} INFO - F1-score on Non REM: 0.843
[2024-04-21 17:25:10,367] {result_logger:108} INFO - 
[2024-04-21 17:25:10,975] {result_logger:103} INFO - precision on REM: 0.340
[2024-04-21 17:25:11,347] {result_logger:104} INFO - recall on REM: 0.772
[2024-04-21 17:25:11,720] {result_logger:107} INFO - F1-score on REM: 0.472
[2024-04-21 17:25:11,720] {result_logger:108} INFO - 
[2024-04-21 17:25:11,815] {result_logger:111} INFO - average precision on sleep stages: 0.694
[2024-04-21 17:25:11,911] {result_logger:113} INFO - average recall on sleep stages: 0.798
[2024-04-21 17:25:12,007] {result_logger:115} INFO - average F1-score on sleep stages: 0.717
[2024-04-21 17:25:12,009] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 17:25:12,093] {result_logger:103} INFO - precision on Wake: 0.636
[2024-04-21 17:25:12,144] {result_logger:104} INFO - recall on Wake: 0.941
[2024-04-21 17:25:12,195] {result_logger:107} INFO - F1-score on Wake: 0.759
[2024-04-21 17:25:12,195] {result_logger:108} INFO - 
[2024-04-21 17:25:12,277] {result_logger:103} INFO - precision on Non REM: 0.993
[2024-04-21 17:25:12,327] {result_logger:104} INFO - recall on Non REM: 0.273
[2024-04-21 17:25:12,378] {result_logger:107} INFO - F1-score on Non REM: 0.428
[2024-04-21 17:25:12,378] {result_logger:108} INFO - 
[2024-04-21 17:25:12,461] {result_logger:103} INFO - precision on REM: 0.505
[2024-04-21 17:25:12,510] {result_logger:104} INFO - recall on REM: 0.780
[2024-04-21 17:25:12,560] {result_logger:107} INFO - F1-score on REM: 0.613
[2024-04-21 17:25:12,560] {result_logger:108} INFO - 
[2024-04-21 17:25:12,570] {result_logger:111} INFO - average precision on sleep stages: 0.711
[2024-04-21 17:25:12,580] {result_logger:113} INFO - average recall on sleep stages: 0.665
[2024-04-21 17:25:12,590] {result_logger:115} INFO - average F1-score on sleep stages: 0.600
[2024-04-21 17:25:12,590] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 17:25:12,656] {result_logger:134} INFO - 
[[165316  15097  23334]
 [ 22794 116408   4565]
 [  3346    900  14360]]
[2024-04-21 17:25:12,721] {result_logger:141} INFO - 
[[ 81.14%   7.41%  11.45%]
 [ 15.85%  80.97%   3.18%]
 [ 17.98%   4.84%  77.18%]]
[2024-04-21 17:25:12,787] {result_logger:145} INFO - 
[[ 86.35%  11.40%  55.22%]
 [ 11.91%  87.92%  10.80%]
 [  1.75%   0.68%  33.98%]]
[2024-04-21 17:25:12,787] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 17:25:12,794] {result_logger:134} INFO - 
[[26699    27  1656]
 [14755  5655   293]
 [  550    10  1985]]
[2024-04-21 17:25:12,801] {result_logger:141} INFO - 
[[ 94.07%   0.10%   5.83%]
 [ 71.27%  27.31%   1.42%]
 [ 21.61%   0.39%  78.00%]]
[2024-04-21 17:25:12,808] {result_logger:145} INFO - 
[[ 63.56%   0.47%  42.09%]
 [ 35.13%  99.35%   7.45%]
 [  1.31%   0.18%  50.46%]]
[2024-04-21 17:25:12,898] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 17:25:12,898] {result_logger:77} INFO - actual:
[2024-04-21 17:25:12,898] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 17:25:12,899] {result_logger:79} INFO - predicted:
[2024-04-21 17:25:12,899] {result_logger:80} INFO - 
[[93.47%  3.68%  2.85%]
 [25.14% 72.66%  2.20%]
 [33.38%  0.23% 66.40%]]
[2024-04-21 17:25:12,899] {run_experiment:112} INFO - [epoch   3] execution time: 150.95s	 avg f1-score: 0.6000

[2024-04-21 17:25:12,899] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 17:25:12,926] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 17:25:30,741] {train_model:82} INFO - Train Epoch: 4 [36352/366120 (10%)]	lr:8.84e-05	Loss: 0.493658
[2024-04-21 17:25:44,239] {train_model:82} INFO - Train Epoch: 4 [72960/366120 (20%)]	lr:8.84e-05	Loss: 3.469710
[2024-04-21 17:25:57,774] {train_model:82} INFO - Train Epoch: 4 [109568/366120 (30%)]	lr:8.84e-05	Loss: 0.624261
[2024-04-21 17:26:11,342] {train_model:82} INFO - Train Epoch: 4 [146176/366120 (40%)]	lr:8.84e-05	Loss: 1.104738
[2024-04-21 17:26:24,959] {train_model:82} INFO - Train Epoch: 4 [182784/366120 (50%)]	lr:8.84e-05	Loss: 1.060034
[2024-04-21 17:26:38,557] {train_model:82} INFO - Train Epoch: 4 [219392/366120 (60%)]	lr:8.84e-05	Loss: 0.349528
[2024-04-21 17:26:52,204] {train_model:82} INFO - Train Epoch: 4 [256000/366120 (70%)]	lr:8.84e-05	Loss: 0.323232
[2024-04-21 17:27:05,848] {train_model:82} INFO - Train Epoch: 4 [292608/366120 (80%)]	lr:8.84e-05	Loss: 0.420996
[2024-04-21 17:27:19,509] {train_model:82} INFO - Train Epoch: 4 [329216/366120 (90%)]	lr:8.84e-05	Loss: 0.444018
[2024-04-21 17:27:33,122] {train_model:82} INFO - Train Epoch: 4 [365824/366120 (100%)]	lr:8.84e-05	Loss: 0.974370
[2024-04-21 17:27:38,482] {run_experiment:78} INFO - 
[2024-04-21 17:27:38,483] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 17:27:39,138] {result_logger:103} INFO - precision on Wake: 0.886
[2024-04-21 17:27:39,560] {result_logger:104} INFO - recall on Wake: 0.871
[2024-04-21 17:27:39,975] {result_logger:107} INFO - F1-score on Wake: 0.878
[2024-04-21 17:27:39,975] {result_logger:108} INFO - 
[2024-04-21 17:27:40,625] {result_logger:103} INFO - precision on Non REM: 0.895
[2024-04-21 17:27:41,037] {result_logger:104} INFO - recall on Non REM: 0.838
[2024-04-21 17:27:41,451] {result_logger:107} INFO - F1-score on Non REM: 0.865
[2024-04-21 17:27:41,451] {result_logger:108} INFO - 
[2024-04-21 17:27:42,039] {result_logger:103} INFO - precision on REM: 0.472
[2024-04-21 17:27:42,409] {result_logger:104} INFO - recall on REM: 0.793
[2024-04-21 17:27:42,778] {result_logger:107} INFO - F1-score on REM: 0.592
[2024-04-21 17:27:42,778] {result_logger:108} INFO - 
[2024-04-21 17:27:42,874] {result_logger:111} INFO - average precision on sleep stages: 0.751
[2024-04-21 17:27:42,970] {result_logger:113} INFO - average recall on sleep stages: 0.834
[2024-04-21 17:27:43,066] {result_logger:115} INFO - average F1-score on sleep stages: 0.778
[2024-04-21 17:27:43,067] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 17:27:43,150] {result_logger:103} INFO - precision on Wake: 0.591
[2024-04-21 17:27:43,202] {result_logger:104} INFO - recall on Wake: 0.967
[2024-04-21 17:27:43,252] {result_logger:107} INFO - F1-score on Wake: 0.733
[2024-04-21 17:27:43,252] {result_logger:108} INFO - 
[2024-04-21 17:27:43,336] {result_logger:103} INFO - precision on Non REM: 0.994
[2024-04-21 17:27:43,386] {result_logger:104} INFO - recall on Non REM: 0.117
[2024-04-21 17:27:43,436] {result_logger:107} INFO - F1-score on Non REM: 0.210
[2024-04-21 17:27:43,436] {result_logger:108} INFO - 
[2024-04-21 17:27:43,517] {result_logger:103} INFO - precision on REM: 0.600
[2024-04-21 17:27:43,566] {result_logger:104} INFO - recall on REM: 0.644
[2024-04-21 17:27:43,615] {result_logger:107} INFO - F1-score on REM: 0.621
[2024-04-21 17:27:43,615] {result_logger:108} INFO - 
[2024-04-21 17:27:43,625] {result_logger:111} INFO - average precision on sleep stages: 0.728
[2024-04-21 17:27:43,634] {result_logger:113} INFO - average recall on sleep stages: 0.576
[2024-04-21 17:27:43,644] {result_logger:115} INFO - average F1-score on sleep stages: 0.521
[2024-04-21 17:27:43,644] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 17:27:43,710] {result_logger:134} INFO - 
[[177417  13292  13038]
 [ 19868 120427   3472]
 [  3031    821  14754]]
[2024-04-21 17:27:43,776] {result_logger:141} INFO - 
[[ 87.08%   6.52%   6.40%]
 [ 13.82%  83.77%   2.42%]
 [ 16.29%   4.41%  79.30%]]
[2024-04-21 17:27:43,841] {result_logger:145} INFO - 
[[ 88.57%   9.88%  41.70%]
 [  9.92%  89.51%  11.11%]
 [  1.51%   0.61%  47.19%]]
[2024-04-21 17:27:43,841] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 17:27:43,848] {result_logger:134} INFO - 
[[27432    11   939]
 [18122  2425   156]
 [  901     4  1640]]
[2024-04-21 17:27:43,855] {result_logger:141} INFO - 
[[ 96.65%   0.04%   3.31%]
 [ 87.53%  11.71%   0.75%]
 [ 35.40%   0.16%  64.44%]]
[2024-04-21 17:27:43,862] {result_logger:145} INFO - 
[[ 59.05%   0.45%  34.33%]
 [ 39.01%  99.39%   5.70%]
 [  1.94%   0.16%  59.96%]]
[2024-04-21 17:27:43,953] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 17:27:43,953] {result_logger:77} INFO - actual:
[2024-04-21 17:27:43,953] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 17:27:43,953] {result_logger:79} INFO - predicted:
[2024-04-21 17:27:43,953] {result_logger:80} INFO - 
[[96.20%  2.11%  1.68%]
 [38.20% 59.75%  2.05%]
 [30.42%  0.00% 69.58%]]
[2024-04-21 17:27:43,954] {run_experiment:112} INFO - [epoch   4] execution time: 151.05s	 avg f1-score: 0.5213

[2024-04-21 17:27:43,954] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 17:27:43,981] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 17:28:02,081] {train_model:82} INFO - Train Epoch: 5 [36352/366120 (10%)]	lr:1.09e-04	Loss: 3.705723
[2024-04-21 17:28:15,579] {train_model:82} INFO - Train Epoch: 5 [72960/366120 (20%)]	lr:1.09e-04	Loss: 0.355737
[2024-04-21 17:28:29,106] {train_model:82} INFO - Train Epoch: 5 [109568/366120 (30%)]	lr:1.09e-04	Loss: 0.948612
[2024-04-21 17:28:42,667] {train_model:82} INFO - Train Epoch: 5 [146176/366120 (40%)]	lr:1.09e-04	Loss: 0.382579
[2024-04-21 17:28:56,280] {train_model:82} INFO - Train Epoch: 5 [182784/366120 (50%)]	lr:1.09e-04	Loss: 0.382332
[2024-04-21 17:29:09,887] {train_model:82} INFO - Train Epoch: 5 [219392/366120 (60%)]	lr:1.09e-04	Loss: 0.252411
[2024-04-21 17:29:23,510] {train_model:82} INFO - Train Epoch: 5 [256000/366120 (70%)]	lr:1.09e-04	Loss: 2.322970
[2024-04-21 17:29:37,166] {train_model:82} INFO - Train Epoch: 5 [292608/366120 (80%)]	lr:1.09e-04	Loss: 0.268147
[2024-04-21 17:29:50,832] {train_model:82} INFO - Train Epoch: 5 [329216/366120 (90%)]	lr:1.09e-04	Loss: 6.134866
[2024-04-21 17:30:04,454] {train_model:82} INFO - Train Epoch: 5 [365824/366120 (100%)]	lr:1.09e-04	Loss: 0.444860
[2024-04-21 17:30:09,925] {run_experiment:78} INFO - 
[2024-04-21 17:30:09,925] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 17:30:10,580] {result_logger:103} INFO - precision on Wake: 0.930
[2024-04-21 17:30:11,004] {result_logger:104} INFO - recall on Wake: 0.907
[2024-04-21 17:30:11,430] {result_logger:107} INFO - F1-score on Wake: 0.919
[2024-04-21 17:30:11,430] {result_logger:108} INFO - 
[2024-04-21 17:30:12,067] {result_logger:103} INFO - precision on Non REM: 0.913
[2024-04-21 17:30:12,482] {result_logger:104} INFO - recall on Non REM: 0.889
[2024-04-21 17:30:12,900] {result_logger:107} INFO - F1-score on Non REM: 0.901
[2024-04-21 17:30:12,900] {result_logger:108} INFO - 
[2024-04-21 17:30:13,501] {result_logger:103} INFO - precision on REM: 0.578
[2024-04-21 17:30:13,868] {result_logger:104} INFO - recall on REM: 0.853
[2024-04-21 17:30:14,234] {result_logger:107} INFO - F1-score on REM: 0.689
[2024-04-21 17:30:14,234] {result_logger:108} INFO - 
[2024-04-21 17:30:14,331] {result_logger:111} INFO - average precision on sleep stages: 0.807
[2024-04-21 17:30:14,427] {result_logger:113} INFO - average recall on sleep stages: 0.883
[2024-04-21 17:30:14,522] {result_logger:115} INFO - average F1-score on sleep stages: 0.836
[2024-04-21 17:30:14,524] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 17:30:14,608] {result_logger:103} INFO - precision on Wake: 0.640
[2024-04-21 17:30:14,659] {result_logger:104} INFO - recall on Wake: 0.984
[2024-04-21 17:30:14,710] {result_logger:107} INFO - F1-score on Wake: 0.775
[2024-04-21 17:30:14,710] {result_logger:108} INFO - 
[2024-04-21 17:30:14,796] {result_logger:103} INFO - precision on Non REM: 0.994
[2024-04-21 17:30:14,846] {result_logger:104} INFO - recall on Non REM: 0.230
[2024-04-21 17:30:14,897] {result_logger:107} INFO - F1-score on Non REM: 0.374
[2024-04-21 17:30:14,897] {result_logger:108} INFO - 
[2024-04-21 17:30:14,978] {result_logger:103} INFO - precision on REM: 0.618
[2024-04-21 17:30:15,027] {result_logger:104} INFO - recall on REM: 0.780
[2024-04-21 17:30:15,076] {result_logger:107} INFO - F1-score on REM: 0.690
[2024-04-21 17:30:15,076] {result_logger:108} INFO - 
[2024-04-21 17:30:15,086] {result_logger:111} INFO - average precision on sleep stages: 0.751
[2024-04-21 17:30:15,096] {result_logger:113} INFO - average recall on sleep stages: 0.664
[2024-04-21 17:30:15,106] {result_logger:115} INFO - average F1-score on sleep stages: 0.613
[2024-04-21 17:30:15,107] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 17:30:15,172] {result_logger:134} INFO - 
[[184831  11286   7630]
 [ 11962 127868   3937]
 [  1889    851  15866]]
[2024-04-21 17:30:15,238] {result_logger:141} INFO - 
[[ 90.72%   5.54%   3.74%]
 [  8.32%  88.94%   2.74%]
 [ 10.15%   4.57%  85.27%]]
[2024-04-21 17:30:15,304] {result_logger:145} INFO - 
[[ 93.03%   8.06%  27.81%]
 [  6.02%  91.33%  14.35%]
 [  0.95%   0.61%  57.84%]]
[2024-04-21 17:30:15,304] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 17:30:15,311] {result_logger:134} INFO - 
[[27916    24   442]
 [15153  4767   783]
 [  554     7  1984]]
[2024-04-21 17:30:15,318] {result_logger:141} INFO - 
[[ 98.36%   0.08%   1.56%]
 [ 73.19%  23.03%   3.78%]
 [ 21.77%   0.28%  77.96%]]
[2024-04-21 17:30:15,326] {result_logger:145} INFO - 
[[ 63.99%   0.50%  13.77%]
 [ 34.74%  99.35%  24.40%]
 [  1.27%   0.15%  61.83%]]
[2024-04-21 17:30:15,419] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 17:30:15,419] {result_logger:77} INFO - actual:
[2024-04-21 17:30:15,419] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 17:30:15,419] {result_logger:79} INFO - predicted:
[2024-04-21 17:30:15,419] {result_logger:80} INFO - 
[[94.94%  3.84%  1.22%]
 [28.41% 64.74%  6.86%]
 [26.36%  0.53% 73.11%]]
[2024-04-21 17:30:15,419] {run_experiment:112} INFO - [epoch   5] execution time: 151.47s	 avg f1-score: 0.6130

[2024-04-21 17:30:15,420] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 17:30:15,447] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 17:30:33,532] {train_model:82} INFO - Train Epoch: 6 [36352/366120 (10%)]	lr:1.30e-04	Loss: 0.192338
[2024-04-21 17:30:47,021] {train_model:82} INFO - Train Epoch: 6 [72960/366120 (20%)]	lr:1.30e-04	Loss: 0.255168
[2024-04-21 17:31:00,533] {train_model:82} INFO - Train Epoch: 6 [109568/366120 (30%)]	lr:1.30e-04	Loss: 0.168817
[2024-04-21 17:31:14,074] {train_model:82} INFO - Train Epoch: 6 [146176/366120 (40%)]	lr:1.30e-04	Loss: 1.398110
[2024-04-21 17:31:27,643] {train_model:82} INFO - Train Epoch: 6 [182784/366120 (50%)]	lr:1.30e-04	Loss: 3.369011
[2024-04-21 17:31:41,189] {train_model:82} INFO - Train Epoch: 6 [219392/366120 (60%)]	lr:1.30e-04	Loss: 0.509441
[2024-04-21 17:31:54,791] {train_model:82} INFO - Train Epoch: 6 [256000/366120 (70%)]	lr:1.30e-04	Loss: 0.226733
[2024-04-21 17:32:08,387] {train_model:82} INFO - Train Epoch: 6 [292608/366120 (80%)]	lr:1.30e-04	Loss: 0.163239
[2024-04-21 17:32:22,002] {train_model:82} INFO - Train Epoch: 6 [329216/366120 (90%)]	lr:1.30e-04	Loss: 0.369473
[2024-04-21 17:32:35,596] {train_model:82} INFO - Train Epoch: 6 [365824/366120 (100%)]	lr:1.30e-04	Loss: 0.191111
[2024-04-21 17:32:41,145] {run_experiment:78} INFO - 
[2024-04-21 17:32:41,145] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 17:32:41,795] {result_logger:103} INFO - precision on Wake: 0.957
[2024-04-21 17:32:42,220] {result_logger:104} INFO - recall on Wake: 0.934
[2024-04-21 17:32:42,643] {result_logger:107} INFO - F1-score on Wake: 0.945
[2024-04-21 17:32:42,644] {result_logger:108} INFO - 
[2024-04-21 17:32:43,285] {result_logger:103} INFO - precision on Non REM: 0.931
[2024-04-21 17:32:43,699] {result_logger:104} INFO - recall on Non REM: 0.919
[2024-04-21 17:32:44,115] {result_logger:107} INFO - F1-score on Non REM: 0.925
[2024-04-21 17:32:44,116] {result_logger:108} INFO - 
[2024-04-21 17:32:44,701] {result_logger:103} INFO - precision on REM: 0.658
[2024-04-21 17:32:45,066] {result_logger:104} INFO - recall on REM: 0.898
[2024-04-21 17:32:45,432] {result_logger:107} INFO - F1-score on REM: 0.760
[2024-04-21 17:32:45,432] {result_logger:108} INFO - 
[2024-04-21 17:32:45,527] {result_logger:111} INFO - average precision on sleep stages: 0.849
[2024-04-21 17:32:45,623] {result_logger:113} INFO - average recall on sleep stages: 0.917
[2024-04-21 17:32:45,719] {result_logger:115} INFO - average F1-score on sleep stages: 0.877
[2024-04-21 17:32:45,720] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 17:32:45,802] {result_logger:103} INFO - precision on Wake: 0.742
[2024-04-21 17:32:45,853] {result_logger:104} INFO - recall on Wake: 0.996
[2024-04-21 17:32:45,904] {result_logger:107} INFO - F1-score on Wake: 0.850
[2024-04-21 17:32:45,904] {result_logger:108} INFO - 
[2024-04-21 17:32:45,985] {result_logger:103} INFO - precision on Non REM: 0.996
[2024-04-21 17:32:46,036] {result_logger:104} INFO - recall on Non REM: 0.522
[2024-04-21 17:32:46,086] {result_logger:107} INFO - F1-score on Non REM: 0.685
[2024-04-21 17:32:46,086] {result_logger:108} INFO - 
[2024-04-21 17:32:46,166] {result_logger:103} INFO - precision on REM: 0.755
[2024-04-21 17:32:46,216] {result_logger:104} INFO - recall on REM: 0.795
[2024-04-21 17:32:46,265] {result_logger:107} INFO - F1-score on REM: 0.774
[2024-04-21 17:32:46,265] {result_logger:108} INFO - 
[2024-04-21 17:32:46,275] {result_logger:111} INFO - average precision on sleep stages: 0.831
[2024-04-21 17:32:46,285] {result_logger:113} INFO - average recall on sleep stages: 0.771
[2024-04-21 17:32:46,295] {result_logger:115} INFO - average F1-score on sleep stages: 0.770
[2024-04-21 17:32:46,295] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 17:32:46,362] {result_logger:134} INFO - 
[[190284   9014   4449]
 [  7430 132113   4224]
 [  1108    785  16713]]
[2024-04-21 17:32:46,427] {result_logger:141} INFO - 
[[ 93.39%   4.42%   2.18%]
 [  5.17%  91.89%   2.94%]
 [  5.96%   4.22%  89.83%]]
[2024-04-21 17:32:46,492] {result_logger:145} INFO - 
[[ 95.71%   6.35%  17.53%]
 [  3.74%  93.10%  16.64%]
 [  0.56%   0.55%  65.84%]]
[2024-04-21 17:32:46,493] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 17:32:46,500] {result_logger:134} INFO - 
[[28263    33    86]
 [ 9326 10806   571]
 [  507    15  2023]]
[2024-04-21 17:32:46,596] {result_logger:141} INFO - 
[[ 99.58%   0.12%   0.30%]
 [ 45.05%  52.20%   2.76%]
 [ 19.92%   0.59%  79.49%]]
[2024-04-21 17:32:46,687] {result_logger:145} INFO - 
[[ 74.19%   0.30%   3.21%]
 [ 24.48%  99.56%  21.31%]
 [  1.33%   0.14%  75.49%]]
[2024-04-21 17:32:46,948] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 17:32:46,948] {result_logger:77} INFO - actual:
[2024-04-21 17:32:46,948] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 17:32:46,948] {result_logger:79} INFO - predicted:
[2024-04-21 17:32:46,948] {result_logger:80} INFO - 
[[94.09%  5.11%  0.80%]
 [14.77% 81.98%  3.25%]
 [24.18%  0.41% 75.41%]]
[2024-04-21 17:32:47,005] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp005/model_8conv_2fc-best.pth
[2024-04-21 17:32:47,005] {run_experiment:112} INFO - [epoch   6] execution time: 151.59s	 avg f1-score: 0.7698

[2024-04-21 17:32:47,005] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 17:32:47,032] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 17:33:04,904] {train_model:82} INFO - Train Epoch: 7 [36352/366120 (10%)]	lr:1.51e-04	Loss: 0.157136
[2024-04-21 17:33:18,393] {train_model:82} INFO - Train Epoch: 7 [72960/366120 (20%)]	lr:1.51e-04	Loss: 0.299113
[2024-04-21 17:33:31,909] {train_model:82} INFO - Train Epoch: 7 [109568/366120 (30%)]	lr:1.51e-04	Loss: 0.309640
[2024-04-21 17:33:45,451] {train_model:82} INFO - Train Epoch: 7 [146176/366120 (40%)]	lr:1.51e-04	Loss: 0.557422
[2024-04-21 17:33:59,089] {train_model:82} INFO - Train Epoch: 7 [182784/366120 (50%)]	lr:1.51e-04	Loss: 0.102685
[2024-04-21 17:34:12,684] {train_model:82} INFO - Train Epoch: 7 [219392/366120 (60%)]	lr:1.51e-04	Loss: 0.483255
[2024-04-21 17:34:26,300] {train_model:82} INFO - Train Epoch: 7 [256000/366120 (70%)]	lr:1.51e-04	Loss: 0.245028
[2024-04-21 17:34:39,952] {train_model:82} INFO - Train Epoch: 7 [292608/366120 (80%)]	lr:1.51e-04	Loss: 0.134525
[2024-04-21 17:34:53,602] {train_model:82} INFO - Train Epoch: 7 [329216/366120 (90%)]	lr:1.51e-04	Loss: 0.835334
[2024-04-21 17:35:07,226] {train_model:82} INFO - Train Epoch: 7 [365824/366120 (100%)]	lr:1.51e-04	Loss: 1.198360
[2024-04-21 17:35:12,735] {run_experiment:78} INFO - 
[2024-04-21 17:35:12,735] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 17:35:13,390] {result_logger:103} INFO - precision on Wake: 0.966
[2024-04-21 17:35:13,815] {result_logger:104} INFO - recall on Wake: 0.942
[2024-04-21 17:35:14,239] {result_logger:107} INFO - F1-score on Wake: 0.954
[2024-04-21 17:35:14,239] {result_logger:108} INFO - 
[2024-04-21 17:35:14,876] {result_logger:103} INFO - precision on Non REM: 0.937
[2024-04-21 17:35:15,290] {result_logger:104} INFO - recall on Non REM: 0.928
[2024-04-21 17:35:15,706] {result_logger:107} INFO - F1-score on Non REM: 0.933
[2024-04-21 17:35:15,706] {result_logger:108} INFO - 
[2024-04-21 17:35:16,316] {result_logger:103} INFO - precision on REM: 0.681
[2024-04-21 17:35:16,682] {result_logger:104} INFO - recall on REM: 0.917
[2024-04-21 17:35:17,050] {result_logger:107} INFO - F1-score on REM: 0.782
[2024-04-21 17:35:17,050] {result_logger:108} INFO - 
[2024-04-21 17:35:17,146] {result_logger:111} INFO - average precision on sleep stages: 0.862
[2024-04-21 17:35:17,240] {result_logger:113} INFO - average recall on sleep stages: 0.929
[2024-04-21 17:35:17,335] {result_logger:115} INFO - average F1-score on sleep stages: 0.890
[2024-04-21 17:35:17,336] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 17:35:17,423] {result_logger:103} INFO - precision on Wake: 0.879
[2024-04-21 17:35:17,475] {result_logger:104} INFO - recall on Wake: 0.901
[2024-04-21 17:35:17,526] {result_logger:107} INFO - F1-score on Wake: 0.890
[2024-04-21 17:35:17,526] {result_logger:108} INFO - 
[2024-04-21 17:35:17,608] {result_logger:103} INFO - precision on Non REM: 0.986
[2024-04-21 17:35:17,659] {result_logger:104} INFO - recall on Non REM: 0.781
[2024-04-21 17:35:17,710] {result_logger:107} INFO - F1-score on Non REM: 0.872
[2024-04-21 17:35:17,710] {result_logger:108} INFO - 
[2024-04-21 17:35:17,794] {result_logger:103} INFO - precision on REM: 0.403
[2024-04-21 17:35:17,844] {result_logger:104} INFO - recall on REM: 0.974
[2024-04-21 17:35:17,895] {result_logger:107} INFO - F1-score on REM: 0.570
[2024-04-21 17:35:17,895] {result_logger:108} INFO - 
[2024-04-21 17:35:17,905] {result_logger:111} INFO - average precision on sleep stages: 0.756
[2024-04-21 17:35:17,916] {result_logger:113} INFO - average recall on sleep stages: 0.885
[2024-04-21 17:35:17,926] {result_logger:115} INFO - average F1-score on sleep stages: 0.777
[2024-04-21 17:35:17,927] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 17:35:17,992] {result_logger:134} INFO - 
[[192028   8196   3523]
 [  5897 133411   4459]
 [   808    728  17070]]
[2024-04-21 17:35:18,057] {result_logger:141} INFO - 
[[ 94.25%   4.02%   1.73%]
 [  4.10%  92.80%   3.10%]
 [  4.34%   3.91%  91.74%]]
[2024-04-21 17:35:18,122] {result_logger:145} INFO - 
[[ 96.63%   5.76%  14.06%]
 [  2.97%  93.73%  17.80%]
 [  0.41%   0.51%  68.14%]]
[2024-04-21 17:35:18,122] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 17:35:18,130] {result_logger:134} INFO - 
[[25568   211  2603]
 [ 3462 16171  1070]
 [   45    21  2479]]
[2024-04-21 17:35:18,225] {result_logger:141} INFO - 
[[ 90.09%   0.74%   9.17%]
 [ 16.72%  78.11%   5.17%]
 [  1.77%   0.83%  97.41%]]
[2024-04-21 17:35:18,316] {result_logger:145} INFO - 
[[ 87.94%   1.29%  42.31%]
 [ 11.91%  98.59%  17.39%]
 [  0.15%   0.13%  40.30%]]
[2024-04-21 17:35:18,577] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 17:35:18,577] {result_logger:77} INFO - actual:
[2024-04-21 17:35:18,577] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 17:35:18,577] {result_logger:79} INFO - predicted:
[2024-04-21 17:35:18,578] {result_logger:80} INFO - 
[[89.89%  6.39%  3.72%]
 [ 7.93% 87.90%  4.18%]
 [26.63%  2.08% 71.29%]]
[2024-04-21 17:35:18,634] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp005/model_8conv_2fc-best.pth
[2024-04-21 17:35:18,634] {run_experiment:112} INFO - [epoch   7] execution time: 151.63s	 avg f1-score: 0.7772

[2024-04-21 17:35:18,634] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 17:35:18,663] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 17:35:36,579] {train_model:82} INFO - Train Epoch: 8 [36352/366120 (10%)]	lr:1.72e-04	Loss: 0.331160
[2024-04-21 17:35:50,149] {train_model:82} INFO - Train Epoch: 8 [72960/366120 (20%)]	lr:1.72e-04	Loss: 0.100555
[2024-04-21 17:36:03,755] {train_model:82} INFO - Train Epoch: 8 [109568/366120 (30%)]	lr:1.72e-04	Loss: 0.296182
[2024-04-21 17:36:17,398] {train_model:82} INFO - Train Epoch: 8 [146176/366120 (40%)]	lr:1.72e-04	Loss: 0.383498
[2024-04-21 17:36:31,081] {train_model:82} INFO - Train Epoch: 8 [182784/366120 (50%)]	lr:1.72e-04	Loss: 2.208379
[2024-04-21 17:36:44,705] {train_model:82} INFO - Train Epoch: 8 [219392/366120 (60%)]	lr:1.72e-04	Loss: 0.876753
[2024-04-21 17:36:58,317] {train_model:82} INFO - Train Epoch: 8 [256000/366120 (70%)]	lr:1.72e-04	Loss: 2.233496
[2024-04-21 17:37:11,976] {train_model:82} INFO - Train Epoch: 8 [292608/366120 (80%)]	lr:1.72e-04	Loss: 0.188178
[2024-04-21 17:37:25,646] {train_model:82} INFO - Train Epoch: 8 [329216/366120 (90%)]	lr:1.72e-04	Loss: 0.132174
[2024-04-21 17:37:39,327] {train_model:82} INFO - Train Epoch: 8 [365824/366120 (100%)]	lr:1.72e-04	Loss: 0.120223
[2024-04-21 17:37:44,999] {run_experiment:78} INFO - 
[2024-04-21 17:37:45,000] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 17:37:45,667] {result_logger:103} INFO - precision on Wake: 0.972
[2024-04-21 17:37:46,088] {result_logger:104} INFO - recall on Wake: 0.949
[2024-04-21 17:37:46,504] {result_logger:107} INFO - F1-score on Wake: 0.960
[2024-04-21 17:37:46,504] {result_logger:108} INFO - 
[2024-04-21 17:37:47,137] {result_logger:103} INFO - precision on Non REM: 0.943
[2024-04-21 17:37:47,549] {result_logger:104} INFO - recall on Non REM: 0.937
[2024-04-21 17:37:47,961] {result_logger:107} INFO - F1-score on Non REM: 0.940
[2024-04-21 17:37:47,961] {result_logger:108} INFO - 
[2024-04-21 17:37:48,559] {result_logger:103} INFO - precision on REM: 0.709
[2024-04-21 17:37:48,924] {result_logger:104} INFO - recall on REM: 0.928
[2024-04-21 17:37:49,290] {result_logger:107} INFO - F1-score on REM: 0.804
[2024-04-21 17:37:49,290] {result_logger:108} INFO - 
[2024-04-21 17:37:49,383] {result_logger:111} INFO - average precision on sleep stages: 0.875
[2024-04-21 17:37:49,478] {result_logger:113} INFO - average recall on sleep stages: 0.938
[2024-04-21 17:37:49,572] {result_logger:115} INFO - average F1-score on sleep stages: 0.901
[2024-04-21 17:37:49,573] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 17:37:49,658] {result_logger:103} INFO - precision on Wake: 0.924
[2024-04-21 17:37:49,708] {result_logger:104} INFO - recall on Wake: 0.958
[2024-04-21 17:37:49,759] {result_logger:107} INFO - F1-score on Wake: 0.941
[2024-04-21 17:37:49,759] {result_logger:108} INFO - 
[2024-04-21 17:37:49,842] {result_logger:103} INFO - precision on Non REM: 0.978
[2024-04-21 17:37:49,893] {result_logger:104} INFO - recall on Non REM: 0.839
[2024-04-21 17:37:49,944] {result_logger:107} INFO - F1-score on Non REM: 0.903
[2024-04-21 17:37:49,944] {result_logger:108} INFO - 
[2024-04-21 17:37:50,027] {result_logger:103} INFO - precision on REM: 0.564
[2024-04-21 17:37:50,077] {result_logger:104} INFO - recall on REM: 0.985
[2024-04-21 17:37:50,126] {result_logger:107} INFO - F1-score on REM: 0.717
[2024-04-21 17:37:50,126] {result_logger:108} INFO - 
[2024-04-21 17:37:50,136] {result_logger:111} INFO - average precision on sleep stages: 0.822
[2024-04-21 17:37:50,146] {result_logger:113} INFO - average recall on sleep stages: 0.927
[2024-04-21 17:37:50,156] {result_logger:115} INFO - average F1-score on sleep stages: 0.854
[2024-04-21 17:37:50,156] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 17:37:50,221] {result_logger:134} INFO - 
[[193403   7405   2939]
 [  4969 134657   4141]
 [   661    683  17262]]
[2024-04-21 17:37:50,285] {result_logger:141} INFO - 
[[ 94.92%   3.63%   1.44%]
 [  3.46%  93.66%   2.88%]
 [  3.55%   3.67%  92.78%]]
[2024-04-21 17:37:50,350] {result_logger:145} INFO - 
[[ 97.17%   5.19%  12.07%]
 [  2.50%  94.33%  17.01%]
 [  0.33%   0.48%  70.91%]]
[2024-04-21 17:37:50,350] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 17:37:50,357] {result_logger:134} INFO - 
[[27196   373   813]
 [ 2209 17366  1128]
 [   19    18  2508]]
[2024-04-21 17:37:50,454] {result_logger:141} INFO - 
[[ 95.82%   1.31%   2.86%]
 [ 10.67%  83.88%   5.45%]
 [  0.75%   0.71%  98.55%]]
[2024-04-21 17:37:50,544] {result_logger:145} INFO - 
[[ 92.43%   2.10%  18.27%]
 [  7.51%  97.80%  25.35%]
 [  0.06%   0.10%  56.37%]]
[2024-04-21 17:37:50,803] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 17:37:50,803] {result_logger:77} INFO - actual:
[2024-04-21 17:37:50,803] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 17:37:50,803] {result_logger:79} INFO - predicted:
[2024-04-21 17:37:50,803] {result_logger:80} INFO - 
[[92.23%  6.18%  1.59%]
 [ 7.02% 88.71%  4.27%]
 [23.35%  4.20% 72.44%]]
[2024-04-21 17:37:50,860] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp005/model_8conv_2fc-best.pth
[2024-04-21 17:37:50,860] {run_experiment:112} INFO - [epoch   8] execution time: 152.23s	 avg f1-score: 0.8537

[2024-04-21 17:37:50,860] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 17:37:50,888] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 17:38:09,029] {train_model:82} INFO - Train Epoch: 9 [36352/366120 (10%)]	lr:1.93e-04	Loss: 0.480927
[2024-04-21 17:38:22,517] {train_model:82} INFO - Train Epoch: 9 [72960/366120 (20%)]	lr:1.93e-04	Loss: 0.303160
[2024-04-21 17:38:36,050] {train_model:82} INFO - Train Epoch: 9 [109568/366120 (30%)]	lr:1.93e-04	Loss: 0.153456
[2024-04-21 17:38:49,608] {train_model:82} INFO - Train Epoch: 9 [146176/366120 (40%)]	lr:1.93e-04	Loss: 0.124755
[2024-04-21 17:39:03,191] {train_model:82} INFO - Train Epoch: 9 [182784/366120 (50%)]	lr:1.93e-04	Loss: 2.342347
[2024-04-21 17:39:16,799] {train_model:82} INFO - Train Epoch: 9 [219392/366120 (60%)]	lr:1.93e-04	Loss: 0.109180
[2024-04-21 17:39:30,404] {train_model:82} INFO - Train Epoch: 9 [256000/366120 (70%)]	lr:1.93e-04	Loss: 0.600884
[2024-04-21 17:39:44,043] {train_model:82} INFO - Train Epoch: 9 [292608/366120 (80%)]	lr:1.93e-04	Loss: 0.130215
[2024-04-21 17:39:57,702] {train_model:82} INFO - Train Epoch: 9 [329216/366120 (90%)]	lr:1.93e-04	Loss: 1.515074
[2024-04-21 17:40:11,354] {train_model:82} INFO - Train Epoch: 9 [365824/366120 (100%)]	lr:1.93e-04	Loss: 0.211071
[2024-04-21 17:40:16,717] {run_experiment:78} INFO - 
[2024-04-21 17:40:16,718] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 17:40:17,390] {result_logger:103} INFO - precision on Wake: 0.974
[2024-04-21 17:40:17,812] {result_logger:104} INFO - recall on Wake: 0.955
[2024-04-21 17:40:18,238] {result_logger:107} INFO - F1-score on Wake: 0.964
[2024-04-21 17:40:18,238] {result_logger:108} INFO - 
[2024-04-21 17:40:18,888] {result_logger:103} INFO - precision on Non REM: 0.948
[2024-04-21 17:40:19,302] {result_logger:104} INFO - recall on Non REM: 0.938
[2024-04-21 17:40:19,716] {result_logger:107} INFO - F1-score on Non REM: 0.943
[2024-04-21 17:40:19,716] {result_logger:108} INFO - 
[2024-04-21 17:40:20,322] {result_logger:103} INFO - precision on REM: 0.723
[2024-04-21 17:40:20,689] {result_logger:104} INFO - recall on REM: 0.942
[2024-04-21 17:40:21,058] {result_logger:107} INFO - F1-score on REM: 0.818
[2024-04-21 17:40:21,058] {result_logger:108} INFO - 
[2024-04-21 17:40:21,153] {result_logger:111} INFO - average precision on sleep stages: 0.882
[2024-04-21 17:40:21,248] {result_logger:113} INFO - average recall on sleep stages: 0.945
[2024-04-21 17:40:21,342] {result_logger:115} INFO - average F1-score on sleep stages: 0.909
[2024-04-21 17:40:21,344] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 17:40:21,429] {result_logger:103} INFO - precision on Wake: 0.884
[2024-04-21 17:40:21,480] {result_logger:104} INFO - recall on Wake: 0.994
[2024-04-21 17:40:21,531] {result_logger:107} INFO - F1-score on Wake: 0.936
[2024-04-21 17:40:21,531] {result_logger:108} INFO - 
[2024-04-21 17:40:21,615] {result_logger:103} INFO - precision on Non REM: 0.994
[2024-04-21 17:40:21,666] {result_logger:104} INFO - recall on Non REM: 0.770
[2024-04-21 17:40:21,717] {result_logger:107} INFO - F1-score on Non REM: 0.868
[2024-04-21 17:40:21,717] {result_logger:108} INFO - 
[2024-04-21 17:40:21,800] {result_logger:103} INFO - precision on REM: 0.669
[2024-04-21 17:40:21,849] {result_logger:104} INFO - recall on REM: 0.974
[2024-04-21 17:40:21,899] {result_logger:107} INFO - F1-score on REM: 0.793
[2024-04-21 17:40:21,899] {result_logger:108} INFO - 
[2024-04-21 17:40:21,909] {result_logger:111} INFO - average precision on sleep stages: 0.849
[2024-04-21 17:40:21,919] {result_logger:113} INFO - average recall on sleep stages: 0.912
[2024-04-21 17:40:21,929] {result_logger:115} INFO - average F1-score on sleep stages: 0.866
[2024-04-21 17:40:21,929] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 17:40:21,994] {result_logger:134} INFO - 
[[194548   6728   2471]
 [  4649 134877   4241]
 [   481    603  17522]]
[2024-04-21 17:40:22,059] {result_logger:141} INFO - 
[[ 95.49%   3.30%   1.21%]
 [  3.23%  93.82%   2.95%]
 [  2.59%   3.24%  94.17%]]
[2024-04-21 17:40:22,124] {result_logger:145} INFO - 
[[ 97.43%   4.73%  10.20%]
 [  2.33%  94.84%  17.50%]
 [  0.24%   0.42%  72.30%]]
[2024-04-21 17:40:22,124] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 17:40:22,131] {result_logger:134} INFO - 
[[28205    75   102]
 [ 3648 15932  1123]
 [   49    18  2478]]
[2024-04-21 17:40:22,226] {result_logger:141} INFO - 
[[ 99.38%   0.26%   0.36%]
 [ 17.62%  76.96%   5.42%]
 [  1.93%   0.71%  97.37%]]
[2024-04-21 17:40:22,318] {result_logger:145} INFO - 
[[ 88.41%   0.47%   2.75%]
 [ 11.44%  99.42%  30.33%]
 [  0.15%   0.11%  66.92%]]
[2024-04-21 17:40:22,666] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 17:40:22,666] {result_logger:77} INFO - actual:
[2024-04-21 17:40:22,666] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 17:40:22,666] {result_logger:79} INFO - predicted:
[2024-04-21 17:40:22,666] {result_logger:80} INFO - 
[[93.45%  6.13%  0.42%]
 [ 8.57% 86.97%  4.46%]
 [19.34%  3.56% 77.10%]]
[2024-04-21 17:40:22,723] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp005/model_8conv_2fc-best.pth
[2024-04-21 17:40:22,724] {run_experiment:112} INFO - [epoch   9] execution time: 151.86s	 avg f1-score: 0.8655

[2024-04-21 17:40:22,724] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 17:40:22,751] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 17:40:40,889] {train_model:82} INFO - Train Epoch: 10 [36352/366120 (10%)]	lr:2.14e-04	Loss: 0.072740
[2024-04-21 17:40:54,384] {train_model:82} INFO - Train Epoch: 10 [72960/366120 (20%)]	lr:2.14e-04	Loss: 0.133078
[2024-04-21 17:41:07,934] {train_model:82} INFO - Train Epoch: 10 [109568/366120 (30%)]	lr:2.14e-04	Loss: 0.076706
[2024-04-21 17:41:21,632] {train_model:82} INFO - Train Epoch: 10 [146176/366120 (40%)]	lr:2.14e-04	Loss: 0.119620
[2024-04-21 17:41:35,245] {train_model:82} INFO - Train Epoch: 10 [182784/366120 (50%)]	lr:2.14e-04	Loss: 0.200127
[2024-04-21 17:41:48,824] {train_model:82} INFO - Train Epoch: 10 [219392/366120 (60%)]	lr:2.14e-04	Loss: 1.499973
[2024-04-21 17:42:02,423] {train_model:82} INFO - Train Epoch: 10 [256000/366120 (70%)]	lr:2.14e-04	Loss: 0.214927
[2024-04-21 17:42:16,025] {train_model:82} INFO - Train Epoch: 10 [292608/366120 (80%)]	lr:2.14e-04	Loss: 0.093170
[2024-04-21 17:42:29,661] {train_model:82} INFO - Train Epoch: 10 [329216/366120 (90%)]	lr:2.14e-04	Loss: 0.229236
[2024-04-21 17:42:43,262] {train_model:82} INFO - Train Epoch: 10 [365824/366120 (100%)]	lr:2.14e-04	Loss: 0.053943
[2024-04-21 17:42:48,977] {run_experiment:78} INFO - 
[2024-04-21 17:42:48,977] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 17:42:49,629] {result_logger:103} INFO - precision on Wake: 0.975
[2024-04-21 17:42:50,053] {result_logger:104} INFO - recall on Wake: 0.960
[2024-04-21 17:42:50,476] {result_logger:107} INFO - F1-score on Wake: 0.967
[2024-04-21 17:42:50,476] {result_logger:108} INFO - 
[2024-04-21 17:42:51,112] {result_logger:103} INFO - precision on Non REM: 0.953
[2024-04-21 17:42:51,528] {result_logger:104} INFO - recall on Non REM: 0.940
[2024-04-21 17:42:51,943] {result_logger:107} INFO - F1-score on Non REM: 0.946
[2024-04-21 17:42:51,943] {result_logger:108} INFO - 
[2024-04-21 17:42:52,526] {result_logger:103} INFO - precision on REM: 0.741
[2024-04-21 17:42:52,892] {result_logger:104} INFO - recall on REM: 0.946
[2024-04-21 17:42:53,260] {result_logger:107} INFO - F1-score on REM: 0.831
[2024-04-21 17:42:53,260] {result_logger:108} INFO - 
[2024-04-21 17:42:53,354] {result_logger:111} INFO - average precision on sleep stages: 0.890
[2024-04-21 17:42:53,448] {result_logger:113} INFO - average recall on sleep stages: 0.949
[2024-04-21 17:42:53,542] {result_logger:115} INFO - average F1-score on sleep stages: 0.915
[2024-04-21 17:42:53,544] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 17:42:53,626] {result_logger:103} INFO - precision on Wake: 0.963
[2024-04-21 17:42:53,677] {result_logger:104} INFO - recall on Wake: 0.970
[2024-04-21 17:42:53,727] {result_logger:107} INFO - F1-score on Wake: 0.967
[2024-04-21 17:42:53,727] {result_logger:108} INFO - 
[2024-04-21 17:42:53,809] {result_logger:103} INFO - precision on Non REM: 0.976
[2024-04-21 17:42:53,860] {result_logger:104} INFO - recall on Non REM: 0.909
[2024-04-21 17:42:53,911] {result_logger:107} INFO - F1-score on Non REM: 0.941
[2024-04-21 17:42:53,911] {result_logger:108} INFO - 
[2024-04-21 17:42:53,992] {result_logger:103} INFO - precision on REM: 0.671
[2024-04-21 17:42:54,041] {result_logger:104} INFO - recall on REM: 0.985
[2024-04-21 17:42:54,092] {result_logger:107} INFO - F1-score on REM: 0.798
[2024-04-21 17:42:54,092] {result_logger:108} INFO - 
[2024-04-21 17:42:54,102] {result_logger:111} INFO - average precision on sleep stages: 0.870
[2024-04-21 17:42:54,113] {result_logger:113} INFO - average recall on sleep stages: 0.955
[2024-04-21 17:42:54,123] {result_logger:115} INFO - average F1-score on sleep stages: 0.902
[2024-04-21 17:42:54,123] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 17:42:54,188] {result_logger:134} INFO - 
[[195566   6084   2097]
 [  4575 135144   4048]
 [   427    580  17599]]
[2024-04-21 17:42:54,253] {result_logger:141} INFO - 
[[ 95.98%   2.99%   1.03%]
 [  3.18%  94.00%   2.82%]
 [  2.29%   3.12%  94.59%]]
[2024-04-21 17:42:54,318] {result_logger:145} INFO - 
[[ 97.51%   4.29%   8.83%]
 [  2.28%  95.30%  17.05%]
 [  0.21%   0.41%  74.12%]]
[2024-04-21 17:42:54,318] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 17:42:54,325] {result_logger:134} INFO - 
[[27542   445   395]
 [ 1046 18822   835]
 [   11    26  2508]]
[2024-04-21 17:42:54,421] {result_logger:141} INFO - 
[[ 97.04%   1.57%   1.39%]
 [  5.05%  90.91%   4.03%]
 [  0.43%   1.02%  98.55%]]
[2024-04-21 17:42:54,514] {result_logger:145} INFO - 
[[ 96.30%   2.31%  10.57%]
 [  3.66%  97.56%  22.34%]
 [  0.04%   0.13%  67.09%]]
[2024-04-21 17:42:54,777] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 17:42:54,777] {result_logger:77} INFO - actual:
[2024-04-21 17:42:54,777] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 17:42:54,777] {result_logger:79} INFO - predicted:
[2024-04-21 17:42:54,778] {result_logger:80} INFO - 
[[94.71%  4.54%  0.75%]
 [ 4.25% 92.36%  3.39%]
 [18.51%  4.71% 76.78%]]
[2024-04-21 17:42:54,835] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp005/model_8conv_2fc-best.pth
[2024-04-21 17:42:54,835] {run_experiment:112} INFO - [epoch  10] execution time: 152.11s	 avg f1-score: 0.9021

[2024-04-21 17:42:54,835] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 17:42:54,862] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 17:43:12,746] {train_model:82} INFO - Train Epoch: 11 [36352/366120 (10%)]	lr:2.35e-04	Loss: 0.095917
[2024-04-21 17:43:26,237] {train_model:82} INFO - Train Epoch: 11 [72960/366120 (20%)]	lr:2.35e-04	Loss: 0.072446
[2024-04-21 17:43:39,762] {train_model:82} INFO - Train Epoch: 11 [109568/366120 (30%)]	lr:2.35e-04	Loss: 0.106544
[2024-04-21 17:43:53,313] {train_model:82} INFO - Train Epoch: 11 [146176/366120 (40%)]	lr:2.35e-04	Loss: 0.355384
[2024-04-21 17:44:06,920] {train_model:82} INFO - Train Epoch: 11 [182784/366120 (50%)]	lr:2.35e-04	Loss: 0.140675
[2024-04-21 17:44:20,489] {train_model:82} INFO - Train Epoch: 11 [219392/366120 (60%)]	lr:2.35e-04	Loss: 0.140194
[2024-04-21 17:44:34,085] {train_model:82} INFO - Train Epoch: 11 [256000/366120 (70%)]	lr:2.35e-04	Loss: 0.082100
[2024-04-21 17:44:47,706] {train_model:82} INFO - Train Epoch: 11 [292608/366120 (80%)]	lr:2.35e-04	Loss: 0.202061
[2024-04-21 17:45:01,363] {train_model:82} INFO - Train Epoch: 11 [329216/366120 (90%)]	lr:2.35e-04	Loss: 0.096502
[2024-04-21 17:45:14,978] {train_model:82} INFO - Train Epoch: 11 [365824/366120 (100%)]	lr:2.35e-04	Loss: 0.202372
[2024-04-21 17:45:20,521] {run_experiment:78} INFO - 
[2024-04-21 17:45:20,522] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 17:45:21,192] {result_logger:103} INFO - precision on Wake: 0.977
[2024-04-21 17:45:21,616] {result_logger:104} INFO - recall on Wake: 0.965
[2024-04-21 17:45:22,042] {result_logger:107} INFO - F1-score on Wake: 0.971
[2024-04-21 17:45:22,042] {result_logger:108} INFO - 
[2024-04-21 17:45:22,695] {result_logger:103} INFO - precision on Non REM: 0.957
[2024-04-21 17:45:23,109] {result_logger:104} INFO - recall on Non REM: 0.943
[2024-04-21 17:45:23,524] {result_logger:107} INFO - F1-score on Non REM: 0.950
[2024-04-21 17:45:23,524] {result_logger:108} INFO - 
[2024-04-21 17:45:24,124] {result_logger:103} INFO - precision on REM: 0.759
[2024-04-21 17:45:24,490] {result_logger:104} INFO - recall on REM: 0.952
[2024-04-21 17:45:24,856] {result_logger:107} INFO - F1-score on REM: 0.845
[2024-04-21 17:45:24,857] {result_logger:108} INFO - 
[2024-04-21 17:45:24,952] {result_logger:111} INFO - average precision on sleep stages: 0.898
[2024-04-21 17:45:25,048] {result_logger:113} INFO - average recall on sleep stages: 0.953
[2024-04-21 17:45:25,143] {result_logger:115} INFO - average F1-score on sleep stages: 0.922
[2024-04-21 17:45:25,145] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 17:45:25,229] {result_logger:103} INFO - precision on Wake: 0.960
[2024-04-21 17:45:25,280] {result_logger:104} INFO - recall on Wake: 0.983
[2024-04-21 17:45:25,330] {result_logger:107} INFO - F1-score on Wake: 0.972
[2024-04-21 17:45:25,330] {result_logger:108} INFO - 
[2024-04-21 17:45:25,415] {result_logger:103} INFO - precision on Non REM: 0.979
[2024-04-21 17:45:25,465] {result_logger:104} INFO - recall on Non REM: 0.913
[2024-04-21 17:45:25,516] {result_logger:107} INFO - F1-score on Non REM: 0.945
[2024-04-21 17:45:25,516] {result_logger:108} INFO - 
[2024-04-21 17:45:25,598] {result_logger:103} INFO - precision on REM: 0.761
[2024-04-21 17:45:25,649] {result_logger:104} INFO - recall on REM: 0.981
[2024-04-21 17:45:25,698] {result_logger:107} INFO - F1-score on REM: 0.857
[2024-04-21 17:45:25,698] {result_logger:108} INFO - 
[2024-04-21 17:45:25,708] {result_logger:111} INFO - average precision on sleep stages: 0.900
[2024-04-21 17:45:25,718] {result_logger:113} INFO - average recall on sleep stages: 0.959
[2024-04-21 17:45:25,728] {result_logger:115} INFO - average F1-score on sleep stages: 0.924
[2024-04-21 17:45:25,728] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 17:45:25,795] {result_logger:134} INFO - 
[[196520   5481   1746]
 [  4365 135516   3886]
 [   338    551  17717]]
[2024-04-21 17:45:25,860] {result_logger:141} INFO - 
[[ 96.45%   2.69%   0.86%]
 [  3.04%  94.26%   2.70%]
 [  1.82%   2.96%  95.22%]]
[2024-04-21 17:45:25,925] {result_logger:145} INFO - 
[[ 97.66%   3.87%   7.48%]
 [  2.17%  95.74%  16.64%]
 [  0.17%   0.39%  75.88%]]
[2024-04-21 17:45:25,925] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 17:45:25,933] {result_logger:134} INFO - 
[[27899   375   108]
 [ 1134 18894   675]
 [   15    34  2496]]
[2024-04-21 17:45:26,029] {result_logger:141} INFO - 
[[ 98.30%   1.32%   0.38%]
 [  5.48%  91.26%   3.26%]
 [  0.59%   1.34%  98.07%]]
[2024-04-21 17:45:26,120] {result_logger:145} INFO - 
[[ 96.04%   1.94%   3.29%]
 [  3.90%  97.88%  20.59%]
 [  0.05%   0.18%  76.12%]]
[2024-04-21 17:45:26,384] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 17:45:26,385] {result_logger:77} INFO - actual:
[2024-04-21 17:45:26,385] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 17:45:26,385] {result_logger:79} INFO - predicted:
[2024-04-21 17:45:26,385] {result_logger:80} INFO - 
[[95.15%  4.70%  0.15%]
 [ 4.61% 92.28%  3.12%]
 [15.83%  3.87% 80.30%]]
[2024-04-21 17:45:26,441] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp005/model_8conv_2fc-best.pth
[2024-04-21 17:45:26,441] {run_experiment:112} INFO - [epoch  11] execution time: 151.61s	 avg f1-score: 0.9244

[2024-04-21 17:45:26,441] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 17:45:26,469] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 17:45:44,374] {train_model:82} INFO - Train Epoch: 12 [36352/366120 (10%)]	lr:2.56e-04	Loss: 0.067905
[2024-04-21 17:45:57,934] {train_model:82} INFO - Train Epoch: 12 [72960/366120 (20%)]	lr:2.56e-04	Loss: 0.096456
[2024-04-21 17:46:11,501] {train_model:82} INFO - Train Epoch: 12 [109568/366120 (30%)]	lr:2.56e-04	Loss: 4.978100
[2024-04-21 17:46:25,069] {train_model:82} INFO - Train Epoch: 12 [146176/366120 (40%)]	lr:2.56e-04	Loss: 2.758623
[2024-04-21 17:46:38,680] {train_model:82} INFO - Train Epoch: 12 [182784/366120 (50%)]	lr:2.56e-04	Loss: 0.456716
[2024-04-21 17:46:52,292] {train_model:82} INFO - Train Epoch: 12 [219392/366120 (60%)]	lr:2.56e-04	Loss: 0.094264
[2024-04-21 17:47:05,943] {train_model:82} INFO - Train Epoch: 12 [256000/366120 (70%)]	lr:2.56e-04	Loss: 0.066805
[2024-04-21 17:47:19,591] {train_model:82} INFO - Train Epoch: 12 [292608/366120 (80%)]	lr:2.56e-04	Loss: 0.110982
[2024-04-21 17:47:33,246] {train_model:82} INFO - Train Epoch: 12 [329216/366120 (90%)]	lr:2.56e-04	Loss: 0.074575
[2024-04-21 17:47:46,851] {train_model:82} INFO - Train Epoch: 12 [365824/366120 (100%)]	lr:2.56e-04	Loss: 0.076834
[2024-04-21 17:47:52,220] {run_experiment:78} INFO - 
[2024-04-21 17:47:52,220] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 17:47:52,889] {result_logger:103} INFO - precision on Wake: 0.978
[2024-04-21 17:47:53,311] {result_logger:104} INFO - recall on Wake: 0.967
[2024-04-21 17:47:53,733] {result_logger:107} INFO - F1-score on Wake: 0.972
[2024-04-21 17:47:53,734] {result_logger:108} INFO - 
[2024-04-21 17:47:54,369] {result_logger:103} INFO - precision on Non REM: 0.960
[2024-04-21 17:47:54,781] {result_logger:104} INFO - recall on Non REM: 0.944
[2024-04-21 17:47:55,193] {result_logger:107} INFO - F1-score on Non REM: 0.952
[2024-04-21 17:47:55,193] {result_logger:108} INFO - 
[2024-04-21 17:47:55,796] {result_logger:103} INFO - precision on REM: 0.762
[2024-04-21 17:47:56,162] {result_logger:104} INFO - recall on REM: 0.957
[2024-04-21 17:47:56,527] {result_logger:107} INFO - F1-score on REM: 0.849
[2024-04-21 17:47:56,528] {result_logger:108} INFO - 
[2024-04-21 17:47:56,622] {result_logger:111} INFO - average precision on sleep stages: 0.900
[2024-04-21 17:47:56,716] {result_logger:113} INFO - average recall on sleep stages: 0.956
[2024-04-21 17:47:56,810] {result_logger:115} INFO - average F1-score on sleep stages: 0.924
[2024-04-21 17:47:56,812] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 17:47:56,896] {result_logger:103} INFO - precision on Wake: 0.963
[2024-04-21 17:47:56,947] {result_logger:104} INFO - recall on Wake: 0.975
[2024-04-21 17:47:56,998] {result_logger:107} INFO - F1-score on Wake: 0.969
[2024-04-21 17:47:56,998] {result_logger:108} INFO - 
[2024-04-21 17:47:57,079] {result_logger:103} INFO - precision on Non REM: 0.973
[2024-04-21 17:47:57,131] {result_logger:104} INFO - recall on Non REM: 0.921
[2024-04-21 17:47:57,182] {result_logger:107} INFO - F1-score on Non REM: 0.946
[2024-04-21 17:47:57,182] {result_logger:108} INFO - 
[2024-04-21 17:47:57,265] {result_logger:103} INFO - precision on REM: 0.746
[2024-04-21 17:47:57,314] {result_logger:104} INFO - recall on REM: 0.969
[2024-04-21 17:47:57,364] {result_logger:107} INFO - F1-score on REM: 0.843
[2024-04-21 17:47:57,364] {result_logger:108} INFO - 
[2024-04-21 17:47:57,374] {result_logger:111} INFO - average precision on sleep stages: 0.894
[2024-04-21 17:47:57,383] {result_logger:113} INFO - average recall on sleep stages: 0.955
[2024-04-21 17:47:57,393] {result_logger:115} INFO - average F1-score on sleep stages: 0.919
[2024-04-21 17:47:57,394] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 17:47:57,459] {result_logger:134} INFO - 
[[196980   5090   1677]
 [  4171 135720   3876]
 [   289    509  17808]]
[2024-04-21 17:47:57,523] {result_logger:141} INFO - 
[[ 96.68%   2.50%   0.82%]
 [  2.90%  94.40%   2.70%]
 [  1.55%   2.74%  95.71%]]
[2024-04-21 17:47:57,587] {result_logger:145} INFO - 
[[ 97.79%   3.60%   7.18%]
 [  2.07%  96.04%  16.59%]
 [  0.14%   0.36%  76.23%]]
[2024-04-21 17:47:57,588] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 17:47:57,595] {result_logger:134} INFO - 
[[27675   477   230]
 [ 1037 19058   608]
 [   33    46  2466]]
[2024-04-21 17:47:57,602] {result_logger:141} INFO - 
[[ 97.51%   1.68%   0.81%]
 [  5.01%  92.05%   2.94%]
 [  1.30%   1.81%  96.90%]]
[2024-04-21 17:47:57,609] {result_logger:145} INFO - 
[[ 96.28%   2.44%   6.96%]
 [  3.61%  97.33%  18.40%]
 [  0.11%   0.23%  74.64%]]
[2024-04-21 17:47:57,702] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 17:47:57,702] {result_logger:77} INFO - actual:
[2024-04-21 17:47:57,702] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 17:47:57,702] {result_logger:79} INFO - predicted:
[2024-04-21 17:47:57,702] {result_logger:80} INFO - 
[[94.40%  5.12%  0.48%]
 [ 5.20% 91.72%  3.08%]
 [17.89%  4.54% 77.57%]]
[2024-04-21 17:47:57,702] {run_experiment:112} INFO - [epoch  12] execution time: 151.26s	 avg f1-score: 0.9194

[2024-04-21 17:47:57,702] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 17:47:57,729] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 17:48:15,594] {train_model:82} INFO - Train Epoch: 13 [36352/366120 (10%)]	lr:2.41e-04	Loss: 0.091886
[2024-04-21 17:48:29,085] {train_model:82} INFO - Train Epoch: 13 [72960/366120 (20%)]	lr:2.41e-04	Loss: 0.060039
[2024-04-21 17:48:42,597] {train_model:82} INFO - Train Epoch: 13 [109568/366120 (30%)]	lr:2.41e-04	Loss: 0.725407
[2024-04-21 17:48:56,154] {train_model:82} INFO - Train Epoch: 13 [146176/366120 (40%)]	lr:2.41e-04	Loss: 0.139916
[2024-04-21 17:49:09,737] {train_model:82} INFO - Train Epoch: 13 [182784/366120 (50%)]	lr:2.41e-04	Loss: 1.116696
[2024-04-21 17:49:23,327] {train_model:82} INFO - Train Epoch: 13 [219392/366120 (60%)]	lr:2.41e-04	Loss: 0.160210
[2024-04-21 17:49:36,956] {train_model:82} INFO - Train Epoch: 13 [256000/366120 (70%)]	lr:2.41e-04	Loss: 0.214282
[2024-04-21 17:49:50,587] {train_model:82} INFO - Train Epoch: 13 [292608/366120 (80%)]	lr:2.41e-04	Loss: 0.185443
[2024-04-21 17:50:04,244] {train_model:82} INFO - Train Epoch: 13 [329216/366120 (90%)]	lr:2.41e-04	Loss: 0.101558
[2024-04-21 17:50:17,841] {train_model:82} INFO - Train Epoch: 13 [365824/366120 (100%)]	lr:2.41e-04	Loss: 0.494766
[2024-04-21 17:50:23,811] {run_experiment:78} INFO - 
[2024-04-21 17:50:23,811] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 17:50:24,480] {result_logger:103} INFO - precision on Wake: 0.979
[2024-04-21 17:50:24,906] {result_logger:104} INFO - recall on Wake: 0.968
[2024-04-21 17:50:25,329] {result_logger:107} INFO - F1-score on Wake: 0.974
[2024-04-21 17:50:25,329] {result_logger:108} INFO - 
[2024-04-21 17:50:25,977] {result_logger:103} INFO - precision on Non REM: 0.960
[2024-04-21 17:50:26,391] {result_logger:104} INFO - recall on Non REM: 0.947
[2024-04-21 17:50:26,806] {result_logger:107} INFO - F1-score on Non REM: 0.954
[2024-04-21 17:50:26,806] {result_logger:108} INFO - 
[2024-04-21 17:50:27,404] {result_logger:103} INFO - precision on REM: 0.776
[2024-04-21 17:50:27,772] {result_logger:104} INFO - recall on REM: 0.961
[2024-04-21 17:50:28,138] {result_logger:107} INFO - F1-score on REM: 0.858
[2024-04-21 17:50:28,139] {result_logger:108} INFO - 
[2024-04-21 17:50:28,232] {result_logger:111} INFO - average precision on sleep stages: 0.905
[2024-04-21 17:50:28,325] {result_logger:113} INFO - average recall on sleep stages: 0.959
[2024-04-21 17:50:28,418] {result_logger:115} INFO - average F1-score on sleep stages: 0.929
[2024-04-21 17:50:28,419] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 17:50:28,504] {result_logger:103} INFO - precision on Wake: 0.952
[2024-04-21 17:50:28,555] {result_logger:104} INFO - recall on Wake: 0.977
[2024-04-21 17:50:28,605] {result_logger:107} INFO - F1-score on Wake: 0.964
[2024-04-21 17:50:28,605] {result_logger:108} INFO - 
[2024-04-21 17:50:28,687] {result_logger:103} INFO - precision on Non REM: 0.981
[2024-04-21 17:50:28,737] {result_logger:104} INFO - recall on Non REM: 0.895
[2024-04-21 17:50:28,788] {result_logger:107} INFO - F1-score on Non REM: 0.936
[2024-04-21 17:50:28,788] {result_logger:108} INFO - 
[2024-04-21 17:50:28,870] {result_logger:103} INFO - precision on REM: 0.697
[2024-04-21 17:50:28,919] {result_logger:104} INFO - recall on REM: 0.983
[2024-04-21 17:50:28,969] {result_logger:107} INFO - F1-score on REM: 0.816
[2024-04-21 17:50:28,969] {result_logger:108} INFO - 
[2024-04-21 17:50:28,979] {result_logger:111} INFO - average precision on sleep stages: 0.877
[2024-04-21 17:50:28,989] {result_logger:113} INFO - average recall on sleep stages: 0.952
[2024-04-21 17:50:28,999] {result_logger:115} INFO - average F1-score on sleep stages: 0.905
[2024-04-21 17:50:28,999] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 17:50:29,064] {result_logger:134} INFO - 
[[197236   5122   1389]
 [  3883 136104   3780]
 [   246    483  17877]]
[2024-04-21 17:50:29,127] {result_logger:141} INFO - 
[[ 96.80%   2.51%   0.68%]
 [  2.70%  94.67%   2.63%]
 [  1.32%   2.60%  96.08%]]
[2024-04-21 17:50:29,192] {result_logger:145} INFO - 
[[ 97.95%   3.61%   6.03%]
 [  1.93%  96.04%  16.40%]
 [  0.12%   0.34%  77.57%]]
[2024-04-21 17:50:29,192] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 17:50:29,199] {result_logger:134} INFO - 
[[27737   322   323]
 [ 1399 18539   765]
 [   11    32  2502]]
[2024-04-21 17:50:29,206] {result_logger:141} INFO - 
[[ 97.73%   1.13%   1.14%]
 [  6.76%  89.55%   3.70%]
 [  0.43%   1.26%  98.31%]]
[2024-04-21 17:50:29,213] {result_logger:145} INFO - 
[[ 95.16%   1.70%   9.00%]
 [  4.80%  98.13%  21.31%]
 [  0.04%   0.17%  69.69%]]
[2024-04-21 17:50:29,305] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 17:50:29,305] {result_logger:77} INFO - actual:
[2024-04-21 17:50:29,305] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 17:50:29,305] {result_logger:79} INFO - predicted:
[2024-04-21 17:50:29,305] {result_logger:80} INFO - 
[[93.87%  5.42%  0.71%]
 [ 5.94% 90.60%  3.46%]
 [18.47%  5.49% 76.04%]]
[2024-04-21 17:50:29,305] {run_experiment:112} INFO - [epoch  13] execution time: 151.60s	 avg f1-score: 0.9054

[2024-04-21 17:50:29,305] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 17:50:29,332] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 17:50:47,471] {train_model:82} INFO - Train Epoch: 14 [36352/366120 (10%)]	lr:2.27e-04	Loss: 0.096066
[2024-04-21 17:51:01,029] {train_model:82} INFO - Train Epoch: 14 [72960/366120 (20%)]	lr:2.27e-04	Loss: 0.061255
[2024-04-21 17:51:14,620] {train_model:82} INFO - Train Epoch: 14 [109568/366120 (30%)]	lr:2.27e-04	Loss: 0.038270
[2024-04-21 17:51:28,229] {train_model:82} INFO - Train Epoch: 14 [146176/366120 (40%)]	lr:2.27e-04	Loss: 0.051524
[2024-04-21 17:51:41,881] {train_model:82} INFO - Train Epoch: 14 [182784/366120 (50%)]	lr:2.27e-04	Loss: 0.156067
[2024-04-21 17:51:55,522] {train_model:82} INFO - Train Epoch: 14 [219392/366120 (60%)]	lr:2.27e-04	Loss: 0.079585
[2024-04-21 17:52:09,174] {train_model:82} INFO - Train Epoch: 14 [256000/366120 (70%)]	lr:2.27e-04	Loss: 0.094929
[2024-04-21 17:52:22,803] {train_model:82} INFO - Train Epoch: 14 [292608/366120 (80%)]	lr:2.27e-04	Loss: 0.192965
[2024-04-21 17:52:36,418] {train_model:82} INFO - Train Epoch: 14 [329216/366120 (90%)]	lr:2.27e-04	Loss: 0.082625
[2024-04-21 17:52:50,029] {train_model:82} INFO - Train Epoch: 14 [365824/366120 (100%)]	lr:2.27e-04	Loss: 0.292398
[2024-04-21 17:52:55,677] {run_experiment:78} INFO - 
[2024-04-21 17:52:55,677] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 17:52:56,347] {result_logger:103} INFO - precision on Wake: 0.980
[2024-04-21 17:52:56,769] {result_logger:104} INFO - recall on Wake: 0.971
[2024-04-21 17:52:57,191] {result_logger:107} INFO - F1-score on Wake: 0.976
[2024-04-21 17:52:57,192] {result_logger:108} INFO - 
[2024-04-21 17:52:57,842] {result_logger:103} INFO - precision on Non REM: 0.964
[2024-04-21 17:52:58,254] {result_logger:104} INFO - recall on Non REM: 0.947
[2024-04-21 17:52:58,666] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2024-04-21 17:52:58,667] {result_logger:108} INFO - 
[2024-04-21 17:52:59,265] {result_logger:103} INFO - precision on REM: 0.784
[2024-04-21 17:52:59,629] {result_logger:104} INFO - recall on REM: 0.965
[2024-04-21 17:52:59,994] {result_logger:107} INFO - F1-score on REM: 0.865
[2024-04-21 17:52:59,994] {result_logger:108} INFO - 
[2024-04-21 17:53:00,088] {result_logger:111} INFO - average precision on sleep stages: 0.909
[2024-04-21 17:53:00,182] {result_logger:113} INFO - average recall on sleep stages: 0.961
[2024-04-21 17:53:00,275] {result_logger:115} INFO - average F1-score on sleep stages: 0.932
[2024-04-21 17:53:00,277] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 17:53:00,361] {result_logger:103} INFO - precision on Wake: 0.966
[2024-04-21 17:53:00,411] {result_logger:104} INFO - recall on Wake: 0.976
[2024-04-21 17:53:00,462] {result_logger:107} INFO - F1-score on Wake: 0.971
[2024-04-21 17:53:00,462] {result_logger:108} INFO - 
[2024-04-21 17:53:00,545] {result_logger:103} INFO - precision on Non REM: 0.978
[2024-04-21 17:53:00,595] {result_logger:104} INFO - recall on Non REM: 0.914
[2024-04-21 17:53:00,646] {result_logger:107} INFO - F1-score on Non REM: 0.945
[2024-04-21 17:53:00,646] {result_logger:108} INFO - 
[2024-04-21 17:53:00,730] {result_logger:103} INFO - precision on REM: 0.693
[2024-04-21 17:53:00,780] {result_logger:104} INFO - recall on REM: 0.982
[2024-04-21 17:53:00,829] {result_logger:107} INFO - F1-score on REM: 0.812
[2024-04-21 17:53:00,830] {result_logger:108} INFO - 
[2024-04-21 17:53:00,840] {result_logger:111} INFO - average precision on sleep stages: 0.879
[2024-04-21 17:53:00,850] {result_logger:113} INFO - average recall on sleep stages: 0.957
[2024-04-21 17:53:00,860] {result_logger:115} INFO - average F1-score on sleep stages: 0.909
[2024-04-21 17:53:00,860] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 17:53:00,925] {result_logger:134} INFO - 
[[197879   4653   1215]
 [  3828 136201   3738]
 [   201    456  17949]]
[2024-04-21 17:53:00,988] {result_logger:141} INFO - 
[[ 97.12%   2.28%   0.60%]
 [  2.66%  94.74%   2.60%]
 [  1.08%   2.45%  96.47%]]
[2024-04-21 17:53:01,053] {result_logger:145} INFO - 
[[ 98.00%   3.29%   5.31%]
 [  1.90%  96.38%  16.32%]
 [  0.10%   0.32%  78.37%]]
[2024-04-21 17:53:01,053] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 17:53:01,060] {result_logger:134} INFO - 
[[27691   380   311]
 [  978 18927   798]
 [    9    37  2499]]
[2024-04-21 17:53:01,067] {result_logger:141} INFO - 
[[ 97.57%   1.34%   1.10%]
 [  4.72%  91.42%   3.85%]
 [  0.35%   1.45%  98.19%]]
[2024-04-21 17:53:01,074] {result_logger:145} INFO - 
[[ 96.56%   1.96%   8.62%]
 [  3.41%  97.84%  22.12%]
 [  0.03%   0.19%  69.26%]]
[2024-04-21 17:53:01,164] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 17:53:01,164] {result_logger:77} INFO - actual:
[2024-04-21 17:53:01,164] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 17:53:01,164] {result_logger:79} INFO - predicted:
[2024-04-21 17:53:01,164] {result_logger:80} INFO - 
[[94.27%  5.15%  0.58%]
 [ 5.13% 91.19%  3.68%]
 [17.99%  6.32% 75.69%]]
[2024-04-21 17:53:01,164] {run_experiment:112} INFO - [epoch  14] execution time: 151.86s	 avg f1-score: 0.9094

[2024-04-21 17:53:01,165] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 17:53:01,191] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 17:53:19,464] {train_model:82} INFO - Train Epoch: 15 [36352/366120 (10%)]	lr:2.14e-04	Loss: 0.059262
[2024-04-21 17:53:32,998] {train_model:82} INFO - Train Epoch: 15 [72960/366120 (20%)]	lr:2.14e-04	Loss: 0.117430
[2024-04-21 17:53:46,560] {train_model:82} INFO - Train Epoch: 15 [109568/366120 (30%)]	lr:2.14e-04	Loss: 0.058099
[2024-04-21 17:54:00,172] {train_model:82} INFO - Train Epoch: 15 [146176/366120 (40%)]	lr:2.14e-04	Loss: 0.122266
[2024-04-21 17:54:13,791] {train_model:82} INFO - Train Epoch: 15 [182784/366120 (50%)]	lr:2.14e-04	Loss: 0.112321
[2024-04-21 17:54:27,405] {train_model:82} INFO - Train Epoch: 15 [219392/366120 (60%)]	lr:2.14e-04	Loss: 0.084520
[2024-04-21 17:54:41,068] {train_model:82} INFO - Train Epoch: 15 [256000/366120 (70%)]	lr:2.14e-04	Loss: 0.337955
[2024-04-21 17:54:54,772] {train_model:82} INFO - Train Epoch: 15 [292608/366120 (80%)]	lr:2.14e-04	Loss: 0.114641
[2024-04-21 17:55:08,487] {train_model:82} INFO - Train Epoch: 15 [329216/366120 (90%)]	lr:2.14e-04	Loss: 0.133242
[2024-04-21 17:55:22,152] {train_model:82} INFO - Train Epoch: 15 [365824/366120 (100%)]	lr:2.14e-04	Loss: 0.089737
[2024-04-21 17:55:27,829] {run_experiment:78} INFO - 
[2024-04-21 17:55:27,829] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 17:55:28,499] {result_logger:103} INFO - precision on Wake: 0.981
[2024-04-21 17:55:28,921] {result_logger:104} INFO - recall on Wake: 0.972
[2024-04-21 17:55:29,342] {result_logger:107} INFO - F1-score on Wake: 0.976
[2024-04-21 17:55:29,343] {result_logger:108} INFO - 
[2024-04-21 17:55:29,981] {result_logger:103} INFO - precision on Non REM: 0.965
[2024-04-21 17:55:30,397] {result_logger:104} INFO - recall on Non REM: 0.950
[2024-04-21 17:55:30,814] {result_logger:107} INFO - F1-score on Non REM: 0.957
[2024-04-21 17:55:30,814] {result_logger:108} INFO - 
[2024-04-21 17:55:31,417] {result_logger:103} INFO - precision on REM: 0.791
[2024-04-21 17:55:31,781] {result_logger:104} INFO - recall on REM: 0.968
[2024-04-21 17:55:32,147] {result_logger:107} INFO - F1-score on REM: 0.871
[2024-04-21 17:55:32,147] {result_logger:108} INFO - 
[2024-04-21 17:55:32,241] {result_logger:111} INFO - average precision on sleep stages: 0.912
[2024-04-21 17:55:32,336] {result_logger:113} INFO - average recall on sleep stages: 0.963
[2024-04-21 17:55:32,431] {result_logger:115} INFO - average F1-score on sleep stages: 0.935
[2024-04-21 17:55:32,432] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 17:55:32,517] {result_logger:103} INFO - precision on Wake: 0.965
[2024-04-21 17:55:32,567] {result_logger:104} INFO - recall on Wake: 0.984
[2024-04-21 17:55:32,618] {result_logger:107} INFO - F1-score on Wake: 0.975
[2024-04-21 17:55:32,618] {result_logger:108} INFO - 
[2024-04-21 17:55:32,699] {result_logger:103} INFO - precision on Non REM: 0.980
[2024-04-21 17:55:32,750] {result_logger:104} INFO - recall on Non REM: 0.921
[2024-04-21 17:55:32,801] {result_logger:107} INFO - F1-score on Non REM: 0.950
[2024-04-21 17:55:32,801] {result_logger:108} INFO - 
[2024-04-21 17:55:32,884] {result_logger:103} INFO - precision on REM: 0.771
[2024-04-21 17:55:32,935] {result_logger:104} INFO - recall on REM: 0.974
[2024-04-21 17:55:32,985] {result_logger:107} INFO - F1-score on REM: 0.860
[2024-04-21 17:55:32,985] {result_logger:108} INFO - 
[2024-04-21 17:55:32,995] {result_logger:111} INFO - average precision on sleep stages: 0.905
[2024-04-21 17:55:33,005] {result_logger:113} INFO - average recall on sleep stages: 0.960
[2024-04-21 17:55:33,016] {result_logger:115} INFO - average F1-score on sleep stages: 0.928
[2024-04-21 17:55:33,016] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 17:55:33,083] {result_logger:134} INFO - 
[[197971   4594   1182]
 [  3650 136554   3563]
 [   170    431  18005]]
[2024-04-21 17:55:33,147] {result_logger:141} INFO - 
[[ 97.17%   2.25%   0.58%]
 [  2.54%  94.98%   2.48%]
 [  0.91%   2.32%  96.77%]]
[2024-04-21 17:55:33,212] {result_logger:145} INFO - 
[[ 98.11%   3.24%   5.20%]
 [  1.81%  96.45%  15.66%]
 [  0.08%   0.30%  79.14%]]
[2024-04-21 17:55:33,212] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 17:55:33,219] {result_logger:134} INFO - 
[[27940   346    96]
 [  993 19068   642]
 [   26    40  2479]]
[2024-04-21 17:55:33,316] {result_logger:141} INFO - 
[[ 98.44%   1.22%   0.34%]
 [  4.80%  92.10%   3.10%]
 [  1.02%   1.57%  97.41%]]
[2024-04-21 17:55:33,407] {result_logger:145} INFO - 
[[ 96.48%   1.78%   2.98%]
 [  3.43%  98.02%  19.96%]
 [  0.09%   0.21%  77.06%]]
[2024-04-21 17:55:33,665] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 17:55:33,665] {result_logger:77} INFO - actual:
[2024-04-21 17:55:33,665] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 17:55:33,666] {result_logger:79} INFO - predicted:
[2024-04-21 17:55:33,666] {result_logger:80} INFO - 
[[95.14%  4.62%  0.23%]
 [ 4.33% 92.46%  3.21%]
 [17.56%  3.98% 78.46%]]
[2024-04-21 17:55:33,722] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp005/model_8conv_2fc-best.pth
[2024-04-21 17:55:33,723] {run_experiment:112} INFO - [epoch  15] execution time: 152.56s	 avg f1-score: 0.9282

[2024-04-21 17:55:33,723] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 17:55:33,751] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 17:55:51,628] {train_model:82} INFO - Train Epoch: 16 [36352/366120 (10%)]	lr:2.01e-04	Loss: 0.294773
[2024-04-21 17:56:05,122] {train_model:82} INFO - Train Epoch: 16 [72960/366120 (20%)]	lr:2.01e-04	Loss: 0.071516
[2024-04-21 17:56:18,647] {train_model:82} INFO - Train Epoch: 16 [109568/366120 (30%)]	lr:2.01e-04	Loss: 0.150280
[2024-04-21 17:56:32,204] {train_model:82} INFO - Train Epoch: 16 [146176/366120 (40%)]	lr:2.01e-04	Loss: 0.047833
[2024-04-21 17:56:45,774] {train_model:82} INFO - Train Epoch: 16 [182784/366120 (50%)]	lr:2.01e-04	Loss: 0.067407
[2024-04-21 17:56:59,368] {train_model:82} INFO - Train Epoch: 16 [219392/366120 (60%)]	lr:2.01e-04	Loss: 0.602377
[2024-04-21 17:57:13,006] {train_model:82} INFO - Train Epoch: 16 [256000/366120 (70%)]	lr:2.01e-04	Loss: 0.290255
[2024-04-21 17:57:26,658] {train_model:82} INFO - Train Epoch: 16 [292608/366120 (80%)]	lr:2.01e-04	Loss: 0.054720
[2024-04-21 17:57:40,348] {train_model:82} INFO - Train Epoch: 16 [329216/366120 (90%)]	lr:2.01e-04	Loss: 7.247111
[2024-04-21 17:57:53,980] {train_model:82} INFO - Train Epoch: 16 [365824/366120 (100%)]	lr:2.01e-04	Loss: 0.051703
[2024-04-21 17:57:59,583] {run_experiment:78} INFO - 
[2024-04-21 17:57:59,583] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 17:58:00,246] {result_logger:103} INFO - precision on Wake: 0.981
[2024-04-21 17:58:00,666] {result_logger:104} INFO - recall on Wake: 0.974
[2024-04-21 17:58:01,088] {result_logger:107} INFO - F1-score on Wake: 0.978
[2024-04-21 17:58:01,088] {result_logger:108} INFO - 
[2024-04-21 17:58:01,728] {result_logger:103} INFO - precision on Non REM: 0.967
[2024-04-21 17:58:02,142] {result_logger:104} INFO - recall on Non REM: 0.950
[2024-04-21 17:58:02,557] {result_logger:107} INFO - F1-score on Non REM: 0.959
[2024-04-21 17:58:02,558] {result_logger:108} INFO - 
[2024-04-21 17:58:03,160] {result_logger:103} INFO - precision on REM: 0.800
[2024-04-21 17:58:03,524] {result_logger:104} INFO - recall on REM: 0.970
[2024-04-21 17:58:03,889] {result_logger:107} INFO - F1-score on REM: 0.877
[2024-04-21 17:58:03,889] {result_logger:108} INFO - 
[2024-04-21 17:58:03,985] {result_logger:111} INFO - average precision on sleep stages: 0.916
[2024-04-21 17:58:04,080] {result_logger:113} INFO - average recall on sleep stages: 0.965
[2024-04-21 17:58:04,176] {result_logger:115} INFO - average F1-score on sleep stages: 0.938
[2024-04-21 17:58:04,178] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 17:58:04,262] {result_logger:103} INFO - precision on Wake: 0.967
[2024-04-21 17:58:04,313] {result_logger:104} INFO - recall on Wake: 0.978
[2024-04-21 17:58:04,364] {result_logger:107} INFO - F1-score on Wake: 0.973
[2024-04-21 17:58:04,364] {result_logger:108} INFO - 
[2024-04-21 17:58:04,446] {result_logger:103} INFO - precision on Non REM: 0.978
[2024-04-21 17:58:04,496] {result_logger:104} INFO - recall on Non REM: 0.921
[2024-04-21 17:58:04,547] {result_logger:107} INFO - F1-score on Non REM: 0.949
[2024-04-21 17:58:04,547] {result_logger:108} INFO - 
[2024-04-21 17:58:04,630] {result_logger:103} INFO - precision on REM: 0.729
[2024-04-21 17:58:04,680] {result_logger:104} INFO - recall on REM: 0.978
[2024-04-21 17:58:04,729] {result_logger:107} INFO - F1-score on REM: 0.835
[2024-04-21 17:58:04,729] {result_logger:108} INFO - 
[2024-04-21 17:58:04,739] {result_logger:111} INFO - average precision on sleep stages: 0.891
[2024-04-21 17:58:04,749] {result_logger:113} INFO - average recall on sleep stages: 0.959
[2024-04-21 17:58:04,759] {result_logger:115} INFO - average F1-score on sleep stages: 0.919
[2024-04-21 17:58:04,759] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 17:58:04,826] {result_logger:134} INFO - 
[[198530   4208   1009]
 [  3631 136630   3506]
 [   166    398  18042]]
[2024-04-21 17:58:04,891] {result_logger:141} INFO - 
[[ 97.44%   2.07%   0.50%]
 [  2.53%  95.04%   2.44%]
 [  0.89%   2.14%  96.97%]]
[2024-04-21 17:58:04,957] {result_logger:145} INFO - 
[[ 98.12%   2.98%   4.47%]
 [  1.79%  96.74%  15.54%]
 [  0.08%   0.28%  79.98%]]
[2024-04-21 17:58:04,957] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 17:58:04,964] {result_logger:134} INFO - 
[[27768   402   212]
 [  917 19073   713]
 [   26    30  2489]]
[2024-04-21 17:58:04,971] {result_logger:141} INFO - 
[[ 97.84%   1.42%   0.75%]
 [  4.43%  92.13%   3.44%]
 [  1.02%   1.18%  97.80%]]
[2024-04-21 17:58:04,978] {result_logger:145} INFO - 
[[ 96.72%   2.06%   6.21%]
 [  3.19%  97.79%  20.88%]
 [  0.09%   0.15%  72.91%]]
[2024-04-21 17:58:05,069] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 17:58:05,069] {result_logger:77} INFO - actual:
[2024-04-21 17:58:05,069] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 17:58:05,069] {result_logger:79} INFO - predicted:
[2024-04-21 17:58:05,069] {result_logger:80} INFO - 
[[94.41%  5.10%  0.49%]
 [ 5.04% 91.62%  3.33%]
 [18.22%  4.95% 76.83%]]
[2024-04-21 17:58:05,069] {run_experiment:112} INFO - [epoch  16] execution time: 151.35s	 avg f1-score: 0.9189

[2024-04-21 17:58:05,069] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 17:58:05,096] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 17:58:22,953] {train_model:82} INFO - Train Epoch: 17 [36352/366120 (10%)]	lr:1.90e-04	Loss: 0.057720
[2024-04-21 17:58:36,442] {train_model:82} INFO - Train Epoch: 17 [72960/366120 (20%)]	lr:1.90e-04	Loss: 0.107813
[2024-04-21 17:58:49,980] {train_model:82} INFO - Train Epoch: 17 [109568/366120 (30%)]	lr:1.90e-04	Loss: 0.080856
[2024-04-21 17:59:03,541] {train_model:82} INFO - Train Epoch: 17 [146176/366120 (40%)]	lr:1.90e-04	Loss: 0.073503
[2024-04-21 17:59:17,140] {train_model:82} INFO - Train Epoch: 17 [182784/366120 (50%)]	lr:1.90e-04	Loss: 0.074865
[2024-04-21 17:59:30,747] {train_model:82} INFO - Train Epoch: 17 [219392/366120 (60%)]	lr:1.90e-04	Loss: 0.082951
[2024-04-21 17:59:44,361] {train_model:82} INFO - Train Epoch: 17 [256000/366120 (70%)]	lr:1.90e-04	Loss: 0.064371
[2024-04-21 17:59:57,981] {train_model:82} INFO - Train Epoch: 17 [292608/366120 (80%)]	lr:1.90e-04	Loss: 0.077360
[2024-04-21 18:00:11,623] {train_model:82} INFO - Train Epoch: 17 [329216/366120 (90%)]	lr:1.90e-04	Loss: 0.072389
[2024-04-21 18:00:25,257] {train_model:82} INFO - Train Epoch: 17 [365824/366120 (100%)]	lr:1.90e-04	Loss: 0.079157
[2024-04-21 18:00:30,581] {run_experiment:78} INFO - 
[2024-04-21 18:00:30,581] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 18:00:31,234] {result_logger:103} INFO - precision on Wake: 0.983
[2024-04-21 18:00:31,654] {result_logger:104} INFO - recall on Wake: 0.974
[2024-04-21 18:00:32,075] {result_logger:107} INFO - F1-score on Wake: 0.978
[2024-04-21 18:00:32,075] {result_logger:108} INFO - 
[2024-04-21 18:00:32,715] {result_logger:103} INFO - precision on Non REM: 0.967
[2024-04-21 18:00:33,129] {result_logger:104} INFO - recall on Non REM: 0.954
[2024-04-21 18:00:33,546] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2024-04-21 18:00:33,546] {result_logger:108} INFO - 
[2024-04-21 18:00:34,134] {result_logger:103} INFO - precision on REM: 0.808
[2024-04-21 18:00:34,500] {result_logger:104} INFO - recall on REM: 0.971
[2024-04-21 18:00:34,867] {result_logger:107} INFO - F1-score on REM: 0.882
[2024-04-21 18:00:34,867] {result_logger:108} INFO - 
[2024-04-21 18:00:34,963] {result_logger:111} INFO - average precision on sleep stages: 0.919
[2024-04-21 18:00:35,058] {result_logger:113} INFO - average recall on sleep stages: 0.966
[2024-04-21 18:00:35,152] {result_logger:115} INFO - average F1-score on sleep stages: 0.940
[2024-04-21 18:00:35,154] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 18:00:35,237] {result_logger:103} INFO - precision on Wake: 0.976
[2024-04-21 18:00:35,287] {result_logger:104} INFO - recall on Wake: 0.976
[2024-04-21 18:00:35,338] {result_logger:107} INFO - F1-score on Wake: 0.976
[2024-04-21 18:00:35,338] {result_logger:108} INFO - 
[2024-04-21 18:00:35,420] {result_logger:103} INFO - precision on Non REM: 0.977
[2024-04-21 18:00:35,471] {result_logger:104} INFO - recall on Non REM: 0.940
[2024-04-21 18:00:35,522] {result_logger:107} INFO - F1-score on Non REM: 0.958
[2024-04-21 18:00:35,522] {result_logger:108} INFO - 
[2024-04-21 18:00:35,602] {result_logger:103} INFO - precision on REM: 0.740
[2024-04-21 18:00:35,652] {result_logger:104} INFO - recall on REM: 0.979
[2024-04-21 18:00:35,702] {result_logger:107} INFO - F1-score on REM: 0.843
[2024-04-21 18:00:35,702] {result_logger:108} INFO - 
[2024-04-21 18:00:35,711] {result_logger:111} INFO - average precision on sleep stages: 0.898
[2024-04-21 18:00:35,722] {result_logger:113} INFO - average recall on sleep stages: 0.965
[2024-04-21 18:00:35,732] {result_logger:115} INFO - average F1-score on sleep stages: 0.926
[2024-04-21 18:00:35,732] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 18:00:35,798] {result_logger:134} INFO - 
[[198452   4346    949]
 [  3337 137095   3335]
 [   141    399  18066]]
[2024-04-21 18:00:35,863] {result_logger:141} INFO - 
[[ 97.40%   2.13%   0.47%]
 [  2.32%  95.36%   2.32%]
 [  0.76%   2.14%  97.10%]]
[2024-04-21 18:00:35,928] {result_logger:145} INFO - 
[[ 98.28%   3.06%   4.25%]
 [  1.65%  96.65%  14.92%]
 [  0.07%   0.28%  80.83%]]
[2024-04-21 18:00:35,928] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 18:00:35,935] {result_logger:134} INFO - 
[[27695   404   283]
 [  658 19453   592]
 [    9    44  2492]]
[2024-04-21 18:00:35,942] {result_logger:141} INFO - 
[[ 97.58%   1.42%   1.00%]
 [  3.18%  93.96%   2.86%]
 [  0.35%   1.73%  97.92%]]
[2024-04-21 18:00:35,949] {result_logger:145} INFO - 
[[ 97.65%   2.03%   8.41%]
 [  2.32%  97.75%  17.58%]
 [  0.03%   0.22%  74.01%]]
[2024-04-21 18:00:36,039] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 18:00:36,040] {result_logger:77} INFO - actual:
[2024-04-21 18:00:36,040] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 18:00:36,040] {result_logger:79} INFO - predicted:
[2024-04-21 18:00:36,040] {result_logger:80} INFO - 
[[94.58%  4.91%  0.50%]
 [ 4.89% 91.85%  3.25%]
 [16.69%  6.77% 76.54%]]
[2024-04-21 18:00:36,040] {run_experiment:112} INFO - [epoch  17] execution time: 150.97s	 avg f1-score: 0.9258

[2024-04-21 18:00:36,040] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:00:36,067] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:00:54,234] {train_model:82} INFO - Train Epoch: 18 [36352/366120 (10%)]	lr:1.79e-04	Loss: 0.086529
[2024-04-21 18:01:07,767] {train_model:82} INFO - Train Epoch: 18 [72960/366120 (20%)]	lr:1.79e-04	Loss: 0.076267
[2024-04-21 18:01:21,299] {train_model:82} INFO - Train Epoch: 18 [109568/366120 (30%)]	lr:1.79e-04	Loss: 0.126468
[2024-04-21 18:01:34,853] {train_model:82} INFO - Train Epoch: 18 [146176/366120 (40%)]	lr:1.79e-04	Loss: 0.081340
[2024-04-21 18:01:48,443] {train_model:82} INFO - Train Epoch: 18 [182784/366120 (50%)]	lr:1.79e-04	Loss: 0.076807
[2024-04-21 18:02:02,108] {train_model:82} INFO - Train Epoch: 18 [219392/366120 (60%)]	lr:1.79e-04	Loss: 0.084797
[2024-04-21 18:02:15,784] {train_model:82} INFO - Train Epoch: 18 [256000/366120 (70%)]	lr:1.79e-04	Loss: 0.315454
[2024-04-21 18:02:29,408] {train_model:82} INFO - Train Epoch: 18 [292608/366120 (80%)]	lr:1.79e-04	Loss: 1.754096
[2024-04-21 18:02:43,054] {train_model:82} INFO - Train Epoch: 18 [329216/366120 (90%)]	lr:1.79e-04	Loss: 0.051566
[2024-04-21 18:02:56,672] {train_model:82} INFO - Train Epoch: 18 [365824/366120 (100%)]	lr:1.79e-04	Loss: 0.092179
[2024-04-21 18:03:02,182] {run_experiment:78} INFO - 
[2024-04-21 18:03:02,182] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 18:03:02,833] {result_logger:103} INFO - precision on Wake: 0.983
[2024-04-21 18:03:03,257] {result_logger:104} INFO - recall on Wake: 0.975
[2024-04-21 18:03:03,682] {result_logger:107} INFO - F1-score on Wake: 0.979
[2024-04-21 18:03:03,682] {result_logger:108} INFO - 
[2024-04-21 18:03:04,322] {result_logger:103} INFO - precision on Non REM: 0.968
[2024-04-21 18:03:04,738] {result_logger:104} INFO - recall on Non REM: 0.954
[2024-04-21 18:03:05,154] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2024-04-21 18:03:05,154] {result_logger:108} INFO - 
[2024-04-21 18:03:05,740] {result_logger:103} INFO - precision on REM: 0.812
[2024-04-21 18:03:06,106] {result_logger:104} INFO - recall on REM: 0.974
[2024-04-21 18:03:06,472] {result_logger:107} INFO - F1-score on REM: 0.886
[2024-04-21 18:03:06,472] {result_logger:108} INFO - 
[2024-04-21 18:03:06,567] {result_logger:111} INFO - average precision on sleep stages: 0.921
[2024-04-21 18:03:06,662] {result_logger:113} INFO - average recall on sleep stages: 0.968
[2024-04-21 18:03:06,758] {result_logger:115} INFO - average F1-score on sleep stages: 0.942
[2024-04-21 18:03:06,760] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 18:03:06,841] {result_logger:103} INFO - precision on Wake: 0.966
[2024-04-21 18:03:06,891] {result_logger:104} INFO - recall on Wake: 0.984
[2024-04-21 18:03:06,941] {result_logger:107} INFO - F1-score on Wake: 0.975
[2024-04-21 18:03:06,941] {result_logger:108} INFO - 
[2024-04-21 18:03:07,023] {result_logger:103} INFO - precision on Non REM: 0.980
[2024-04-21 18:03:07,074] {result_logger:104} INFO - recall on Non REM: 0.920
[2024-04-21 18:03:07,125] {result_logger:107} INFO - F1-score on Non REM: 0.949
[2024-04-21 18:03:07,125] {result_logger:108} INFO - 
[2024-04-21 18:03:07,204] {result_logger:103} INFO - precision on REM: 0.761
[2024-04-21 18:03:07,254] {result_logger:104} INFO - recall on REM: 0.974
[2024-04-21 18:03:07,304] {result_logger:107} INFO - F1-score on REM: 0.854
[2024-04-21 18:03:07,304] {result_logger:108} INFO - 
[2024-04-21 18:03:07,314] {result_logger:111} INFO - average precision on sleep stages: 0.902
[2024-04-21 18:03:07,323] {result_logger:113} INFO - average recall on sleep stages: 0.960
[2024-04-21 18:03:07,333] {result_logger:115} INFO - average F1-score on sleep stages: 0.926
[2024-04-21 18:03:07,334] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 18:03:07,400] {result_logger:134} INFO - 
[[198694   4150    903]
 [  3267 137203   3297]
 [   115    366  18125]]
[2024-04-21 18:03:07,464] {result_logger:141} INFO - 
[[ 97.52%   2.04%   0.44%]
 [  2.27%  95.43%   2.29%]
 [  0.62%   1.97%  97.41%]]
[2024-04-21 18:03:07,531] {result_logger:145} INFO - 
[[ 98.33%   2.93%   4.04%]
 [  1.62%  96.81%  14.77%]
 [  0.06%   0.26%  81.19%]]
[2024-04-21 18:03:07,531] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 18:03:07,538] {result_logger:134} INFO - 
[[27926   360    96]
 [  968 19051   684]
 [   28    37  2480]]
[2024-04-21 18:03:07,545] {result_logger:141} INFO - 
[[ 98.39%   1.27%   0.34%]
 [  4.68%  92.02%   3.30%]
 [  1.10%   1.45%  97.45%]]
[2024-04-21 18:03:07,553] {result_logger:145} INFO - 
[[ 96.56%   1.85%   2.94%]
 [  3.35%  97.96%  20.98%]
 [  0.10%   0.19%  76.07%]]
[2024-04-21 18:03:07,643] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 18:03:07,643] {result_logger:77} INFO - actual:
[2024-04-21 18:03:07,643] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 18:03:07,643] {result_logger:79} INFO - predicted:
[2024-04-21 18:03:07,643] {result_logger:80} INFO - 
[[94.81%  4.99%  0.20%]
 [ 5.00% 91.48%  3.51%]
 [16.23%  6.53% 77.24%]]
[2024-04-21 18:03:07,643] {run_experiment:112} INFO - [epoch  18] execution time: 151.60s	 avg f1-score: 0.9260

[2024-04-21 18:03:07,643] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:03:07,670] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:03:25,513] {train_model:82} INFO - Train Epoch: 19 [36352/366120 (10%)]	lr:1.68e-04	Loss: 0.086683
[2024-04-21 18:03:39,015] {train_model:82} INFO - Train Epoch: 19 [72960/366120 (20%)]	lr:1.68e-04	Loss: 0.063881
[2024-04-21 18:03:52,617] {train_model:82} INFO - Train Epoch: 19 [109568/366120 (30%)]	lr:1.68e-04	Loss: 0.046575
[2024-04-21 18:04:06,253] {train_model:82} INFO - Train Epoch: 19 [146176/366120 (40%)]	lr:1.68e-04	Loss: 0.053264
[2024-04-21 18:04:19,894] {train_model:82} INFO - Train Epoch: 19 [182784/366120 (50%)]	lr:1.68e-04	Loss: 0.134700
[2024-04-21 18:04:33,499] {train_model:82} INFO - Train Epoch: 19 [219392/366120 (60%)]	lr:1.68e-04	Loss: 0.070462
[2024-04-21 18:04:47,117] {train_model:82} INFO - Train Epoch: 19 [256000/366120 (70%)]	lr:1.68e-04	Loss: 0.131112
[2024-04-21 18:05:00,724] {train_model:82} INFO - Train Epoch: 19 [292608/366120 (80%)]	lr:1.68e-04	Loss: 0.058645
[2024-04-21 18:05:14,333] {train_model:82} INFO - Train Epoch: 19 [329216/366120 (90%)]	lr:1.68e-04	Loss: 0.075284
[2024-04-21 18:05:27,930] {train_model:82} INFO - Train Epoch: 19 [365824/366120 (100%)]	lr:1.68e-04	Loss: 0.075857
[2024-04-21 18:05:33,632] {run_experiment:78} INFO - 
[2024-04-21 18:05:33,632] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 18:05:34,280] {result_logger:103} INFO - precision on Wake: 0.984
[2024-04-21 18:05:34,703] {result_logger:104} INFO - recall on Wake: 0.976
[2024-04-21 18:05:35,125] {result_logger:107} INFO - F1-score on Wake: 0.980
[2024-04-21 18:05:35,125] {result_logger:108} INFO - 
[2024-04-21 18:05:35,760] {result_logger:103} INFO - precision on Non REM: 0.968
[2024-04-21 18:05:36,169] {result_logger:104} INFO - recall on Non REM: 0.957
[2024-04-21 18:05:36,580] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2024-04-21 18:05:36,580] {result_logger:108} INFO - 
[2024-04-21 18:05:37,165] {result_logger:103} INFO - precision on REM: 0.828
[2024-04-21 18:05:37,534] {result_logger:104} INFO - recall on REM: 0.975
[2024-04-21 18:05:37,901] {result_logger:107} INFO - F1-score on REM: 0.896
[2024-04-21 18:05:37,901] {result_logger:108} INFO - 
[2024-04-21 18:05:37,994] {result_logger:111} INFO - average precision on sleep stages: 0.927
[2024-04-21 18:05:38,087] {result_logger:113} INFO - average recall on sleep stages: 0.969
[2024-04-21 18:05:38,180] {result_logger:115} INFO - average F1-score on sleep stages: 0.946
[2024-04-21 18:05:38,182] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 18:05:38,263] {result_logger:103} INFO - precision on Wake: 0.976
[2024-04-21 18:05:38,314] {result_logger:104} INFO - recall on Wake: 0.981
[2024-04-21 18:05:38,365] {result_logger:107} INFO - F1-score on Wake: 0.978
[2024-04-21 18:05:38,365] {result_logger:108} INFO - 
[2024-04-21 18:05:38,447] {result_logger:103} INFO - precision on Non REM: 0.974
[2024-04-21 18:05:38,498] {result_logger:104} INFO - recall on Non REM: 0.942
[2024-04-21 18:05:38,549] {result_logger:107} INFO - F1-score on Non REM: 0.958
[2024-04-21 18:05:38,549] {result_logger:108} INFO - 
[2024-04-21 18:05:38,630] {result_logger:103} INFO - precision on REM: 0.801
[2024-04-21 18:05:38,679] {result_logger:104} INFO - recall on REM: 0.969
[2024-04-21 18:05:38,729] {result_logger:107} INFO - F1-score on REM: 0.877
[2024-04-21 18:05:38,729] {result_logger:108} INFO - 
[2024-04-21 18:05:38,738] {result_logger:111} INFO - average precision on sleep stages: 0.917
[2024-04-21 18:05:38,748] {result_logger:113} INFO - average recall on sleep stages: 0.964
[2024-04-21 18:05:38,758] {result_logger:115} INFO - average F1-score on sleep stages: 0.938
[2024-04-21 18:05:38,759] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 18:05:38,822] {result_logger:134} INFO - 
[[198826   4204    717]
 [  3071 137652   3044]
 [   106    357  18143]]
[2024-04-21 18:05:38,886] {result_logger:141} INFO - 
[[ 97.58%   2.06%   0.35%]
 [  2.14%  95.75%   2.12%]
 [  0.57%   1.92%  97.51%]]
[2024-04-21 18:05:38,949] {result_logger:145} INFO - 
[[ 98.43%   2.96%   3.27%]
 [  1.52%  96.79%  13.90%]
 [  0.05%   0.25%  82.83%]]
[2024-04-21 18:05:38,950] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 18:05:38,957] {result_logger:134} INFO - 
[[27841   462    79]
 [  668 19503   532]
 [   24    56  2465]]
[2024-04-21 18:05:39,058] {result_logger:141} INFO - 
[[ 98.09%   1.63%   0.28%]
 [  3.23%  94.20%   2.57%]
 [  0.94%   2.20%  96.86%]]
[2024-04-21 18:05:39,152] {result_logger:145} INFO - 
[[ 97.57%   2.31%   2.57%]
 [  2.34%  97.41%  17.30%]
 [  0.08%   0.28%  80.14%]]
[2024-04-21 18:05:39,412] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 18:05:39,413] {result_logger:77} INFO - actual:
[2024-04-21 18:05:39,413] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 18:05:39,413] {result_logger:79} INFO - predicted:
[2024-04-21 18:05:39,413] {result_logger:80} INFO - 
[[95.11%  4.75%  0.13%]
 [ 4.50% 92.43%  3.08%]
 [16.06%  5.20% 78.74%]]
[2024-04-21 18:05:39,469] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp005/model_8conv_2fc-best.pth
[2024-04-21 18:05:39,470] {run_experiment:112} INFO - [epoch  19] execution time: 151.83s	 avg f1-score: 0.9377

[2024-04-21 18:05:39,470] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:05:39,497] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:05:57,452] {train_model:82} INFO - Train Epoch: 20 [36352/366120 (10%)]	lr:1.58e-04	Loss: 0.070608
[2024-04-21 18:06:10,946] {train_model:82} INFO - Train Epoch: 20 [72960/366120 (20%)]	lr:1.58e-04	Loss: 0.061184
[2024-04-21 18:06:24,472] {train_model:82} INFO - Train Epoch: 20 [109568/366120 (30%)]	lr:1.58e-04	Loss: 0.092896
[2024-04-21 18:06:38,032] {train_model:82} INFO - Train Epoch: 20 [146176/366120 (40%)]	lr:1.58e-04	Loss: 0.096375
[2024-04-21 18:06:51,599] {train_model:82} INFO - Train Epoch: 20 [182784/366120 (50%)]	lr:1.58e-04	Loss: 0.896781
[2024-04-21 18:07:05,191] {train_model:82} INFO - Train Epoch: 20 [219392/366120 (60%)]	lr:1.58e-04	Loss: 0.056517
[2024-04-21 18:07:18,792] {train_model:82} INFO - Train Epoch: 20 [256000/366120 (70%)]	lr:1.58e-04	Loss: 0.034439
[2024-04-21 18:07:32,411] {train_model:82} INFO - Train Epoch: 20 [292608/366120 (80%)]	lr:1.58e-04	Loss: 4.759764
[2024-04-21 18:07:46,064] {train_model:82} INFO - Train Epoch: 20 [329216/366120 (90%)]	lr:1.58e-04	Loss: 0.056659
[2024-04-21 18:07:59,663] {train_model:82} INFO - Train Epoch: 20 [365824/366120 (100%)]	lr:1.58e-04	Loss: 0.217011
[2024-04-21 18:08:05,202] {run_experiment:78} INFO - 
[2024-04-21 18:08:05,203] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 18:08:05,854] {result_logger:103} INFO - precision on Wake: 0.984
[2024-04-21 18:08:06,273] {result_logger:104} INFO - recall on Wake: 0.977
[2024-04-21 18:08:06,694] {result_logger:107} INFO - F1-score on Wake: 0.981
[2024-04-21 18:08:06,694] {result_logger:108} INFO - 
[2024-04-21 18:08:07,329] {result_logger:103} INFO - precision on Non REM: 0.970
[2024-04-21 18:08:07,737] {result_logger:104} INFO - recall on Non REM: 0.958
[2024-04-21 18:08:08,149] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2024-04-21 18:08:08,149] {result_logger:108} INFO - 
[2024-04-21 18:08:08,779] {result_logger:103} INFO - precision on REM: 0.833
[2024-04-21 18:08:09,158] {result_logger:104} INFO - recall on REM: 0.976
[2024-04-21 18:08:09,536] {result_logger:107} INFO - F1-score on REM: 0.899
[2024-04-21 18:08:09,536] {result_logger:108} INFO - 
[2024-04-21 18:08:09,633] {result_logger:111} INFO - average precision on sleep stages: 0.929
[2024-04-21 18:08:09,730] {result_logger:113} INFO - average recall on sleep stages: 0.970
[2024-04-21 18:08:09,825] {result_logger:115} INFO - average F1-score on sleep stages: 0.948
[2024-04-21 18:08:09,827] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 18:08:09,914] {result_logger:103} INFO - precision on Wake: 0.978
[2024-04-21 18:08:09,968] {result_logger:104} INFO - recall on Wake: 0.981
[2024-04-21 18:08:10,021] {result_logger:107} INFO - F1-score on Wake: 0.979
[2024-04-21 18:08:10,021] {result_logger:108} INFO - 
[2024-04-21 18:08:10,112] {result_logger:103} INFO - precision on Non REM: 0.976
[2024-04-21 18:08:10,165] {result_logger:104} INFO - recall on Non REM: 0.942
[2024-04-21 18:08:10,219] {result_logger:107} INFO - F1-score on Non REM: 0.959
[2024-04-21 18:08:10,219] {result_logger:108} INFO - 
[2024-04-21 18:08:10,307] {result_logger:103} INFO - precision on REM: 0.783
[2024-04-21 18:08:10,360] {result_logger:104} INFO - recall on REM: 0.978
[2024-04-21 18:08:10,412] {result_logger:107} INFO - F1-score on REM: 0.870
[2024-04-21 18:08:10,412] {result_logger:108} INFO - 
[2024-04-21 18:08:10,422] {result_logger:111} INFO - average precision on sleep stages: 0.912
[2024-04-21 18:08:10,433] {result_logger:113} INFO - average recall on sleep stages: 0.967
[2024-04-21 18:08:10,444] {result_logger:115} INFO - average F1-score on sleep stages: 0.936
[2024-04-21 18:08:10,444] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 18:08:10,513] {result_logger:134} INFO - 
[[199083   3954    710]
 [  3105 137735   2927]
 [    97    348  18161]]
[2024-04-21 18:08:10,580] {result_logger:141} INFO - 
[[ 97.71%   1.94%   0.35%]
 [  2.16%  95.80%   2.04%]
 [  0.52%   1.87%  97.61%]]
[2024-04-21 18:08:10,647] {result_logger:145} INFO - 
[[ 98.42%   2.78%   3.26%]
 [  1.53%  96.97%  13.43%]
 [  0.05%   0.25%  83.31%]]
[2024-04-21 18:08:10,648] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 18:08:10,655] {result_logger:134} INFO - 
[[27840   435   107]
 [  610 19509   584]
 [   16    39  2490]]
[2024-04-21 18:08:10,663] {result_logger:141} INFO - 
[[ 98.09%   1.53%   0.38%]
 [  2.95%  94.23%   2.82%]
 [  0.63%   1.53%  97.84%]]
[2024-04-21 18:08:10,670] {result_logger:145} INFO - 
[[ 97.80%   2.18%   3.36%]
 [  2.14%  97.63%  18.36%]
 [  0.06%   0.20%  78.28%]]
[2024-04-21 18:08:10,768] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 18:08:10,768] {result_logger:77} INFO - actual:
[2024-04-21 18:08:10,768] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 18:08:10,768] {result_logger:79} INFO - predicted:
[2024-04-21 18:08:10,769] {result_logger:80} INFO - 
[[95.11%  4.67%  0.22%]
 [ 4.44% 92.43%  3.13%]
 [15.84%  5.78% 78.37%]]
[2024-04-21 18:08:10,769] {run_experiment:112} INFO - [epoch  20] execution time: 151.30s	 avg f1-score: 0.9361

[2024-04-21 18:08:10,769] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:08:10,797] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:08:29,060] {train_model:82} INFO - Train Epoch: 21 [36352/366120 (10%)]	lr:1.49e-04	Loss: 0.081093
[2024-04-21 18:08:42,707] {train_model:82} INFO - Train Epoch: 21 [72960/366120 (20%)]	lr:1.49e-04	Loss: 0.042423
[2024-04-21 18:08:56,369] {train_model:82} INFO - Train Epoch: 21 [109568/366120 (30%)]	lr:1.49e-04	Loss: 0.275458
[2024-04-21 18:09:10,038] {train_model:82} INFO - Train Epoch: 21 [146176/366120 (40%)]	lr:1.49e-04	Loss: 0.146356
[2024-04-21 18:09:23,727] {train_model:82} INFO - Train Epoch: 21 [182784/366120 (50%)]	lr:1.49e-04	Loss: 0.095866
[2024-04-21 18:09:37,446] {train_model:82} INFO - Train Epoch: 21 [219392/366120 (60%)]	lr:1.49e-04	Loss: 0.037088
[2024-04-21 18:09:51,180] {train_model:82} INFO - Train Epoch: 21 [256000/366120 (70%)]	lr:1.49e-04	Loss: 0.044448
[2024-04-21 18:10:04,951] {train_model:82} INFO - Train Epoch: 21 [292608/366120 (80%)]	lr:1.49e-04	Loss: 0.120651
[2024-04-21 18:10:18,723] {train_model:82} INFO - Train Epoch: 21 [329216/366120 (90%)]	lr:1.49e-04	Loss: 0.081443
[2024-04-21 18:10:32,442] {train_model:82} INFO - Train Epoch: 21 [365824/366120 (100%)]	lr:1.49e-04	Loss: 0.053590
[2024-04-21 18:10:38,478] {run_experiment:78} INFO - 
[2024-04-21 18:10:38,478] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 18:10:39,145] {result_logger:103} INFO - precision on Wake: 0.985
[2024-04-21 18:10:39,568] {result_logger:104} INFO - recall on Wake: 0.977
[2024-04-21 18:10:39,991] {result_logger:107} INFO - F1-score on Wake: 0.981
[2024-04-21 18:10:39,991] {result_logger:108} INFO - 
[2024-04-21 18:10:40,640] {result_logger:103} INFO - precision on Non REM: 0.970
[2024-04-21 18:10:41,055] {result_logger:104} INFO - recall on Non REM: 0.959
[2024-04-21 18:10:41,473] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2024-04-21 18:10:41,473] {result_logger:108} INFO - 
[2024-04-21 18:10:42,072] {result_logger:103} INFO - precision on REM: 0.838
[2024-04-21 18:10:42,439] {result_logger:104} INFO - recall on REM: 0.980
[2024-04-21 18:10:42,806] {result_logger:107} INFO - F1-score on REM: 0.903
[2024-04-21 18:10:42,807] {result_logger:108} INFO - 
[2024-04-21 18:10:42,901] {result_logger:111} INFO - average precision on sleep stages: 0.931
[2024-04-21 18:10:42,995] {result_logger:113} INFO - average recall on sleep stages: 0.972
[2024-04-21 18:10:43,089] {result_logger:115} INFO - average F1-score on sleep stages: 0.950
[2024-04-21 18:10:43,090] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 18:10:43,174] {result_logger:103} INFO - precision on Wake: 0.973
[2024-04-21 18:10:43,224] {result_logger:104} INFO - recall on Wake: 0.979
[2024-04-21 18:10:43,275] {result_logger:107} INFO - F1-score on Wake: 0.976
[2024-04-21 18:10:43,275] {result_logger:108} INFO - 
[2024-04-21 18:10:43,359] {result_logger:103} INFO - precision on Non REM: 0.974
[2024-04-21 18:10:43,411] {result_logger:104} INFO - recall on Non REM: 0.940
[2024-04-21 18:10:43,462] {result_logger:107} INFO - F1-score on Non REM: 0.957
[2024-04-21 18:10:43,462] {result_logger:108} INFO - 
[2024-04-21 18:10:43,545] {result_logger:103} INFO - precision on REM: 0.802
[2024-04-21 18:10:43,594] {result_logger:104} INFO - recall on REM: 0.974
[2024-04-21 18:10:43,644] {result_logger:107} INFO - F1-score on REM: 0.880
[2024-04-21 18:10:43,644] {result_logger:108} INFO - 
[2024-04-21 18:10:43,654] {result_logger:111} INFO - average precision on sleep stages: 0.916
[2024-04-21 18:10:43,664] {result_logger:113} INFO - average recall on sleep stages: 0.964
[2024-04-21 18:10:43,674] {result_logger:115} INFO - average F1-score on sleep stages: 0.937
[2024-04-21 18:10:43,675] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 18:10:43,741] {result_logger:134} INFO - 
[[199105   3983    659]
 [  2975 137933   2859]
 [    80    301  18225]]
[2024-04-21 18:10:43,804] {result_logger:141} INFO - 
[[ 97.72%   1.95%   0.32%]
 [  2.07%  95.94%   1.99%]
 [  0.43%   1.62%  97.95%]]
[2024-04-21 18:10:43,868] {result_logger:145} INFO - 
[[ 98.49%   2.80%   3.03%]
 [  1.47%  96.99%  13.15%]
 [  0.04%   0.21%  83.82%]]
[2024-04-21 18:10:43,868] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 18:10:43,876] {result_logger:134} INFO - 
[[27789   469   124]
 [  753 19462   488]
 [    9    58  2478]]
[2024-04-21 18:10:43,883] {result_logger:141} INFO - 
[[ 97.91%   1.65%   0.44%]
 [  3.64%  94.01%   2.36%]
 [  0.35%   2.28%  97.37%]]
[2024-04-21 18:10:43,889] {result_logger:145} INFO - 
[[ 97.33%   2.35%   4.01%]
 [  2.64%  97.36%  15.79%]
 [  0.03%   0.29%  80.19%]]
[2024-04-21 18:10:43,981] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 18:10:43,981] {result_logger:77} INFO - actual:
[2024-04-21 18:10:43,981] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 18:10:43,981] {result_logger:79} INFO - predicted:
[2024-04-21 18:10:43,982] {result_logger:80} INFO - 
[[94.83%  4.97%  0.19%]
 [ 5.03% 91.81%  3.16%]
 [15.18%  7.06% 77.77%]]
[2024-04-21 18:10:43,982] {run_experiment:112} INFO - [epoch  21] execution time: 153.21s	 avg f1-score: 0.9374

[2024-04-21 18:10:43,982] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:10:44,009] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:11:02,304] {train_model:82} INFO - Train Epoch: 22 [36352/366120 (10%)]	lr:1.40e-04	Loss: 0.034244
[2024-04-21 18:11:15,851] {train_model:82} INFO - Train Epoch: 22 [72960/366120 (20%)]	lr:1.40e-04	Loss: 0.055643
[2024-04-21 18:11:29,447] {train_model:82} INFO - Train Epoch: 22 [109568/366120 (30%)]	lr:1.40e-04	Loss: 0.069058
[2024-04-21 18:11:42,999] {train_model:82} INFO - Train Epoch: 22 [146176/366120 (40%)]	lr:1.40e-04	Loss: 0.346744
[2024-04-21 18:11:56,599] {train_model:82} INFO - Train Epoch: 22 [182784/366120 (50%)]	lr:1.40e-04	Loss: 0.037733
[2024-04-21 18:12:10,201] {train_model:82} INFO - Train Epoch: 22 [219392/366120 (60%)]	lr:1.40e-04	Loss: 0.056072
[2024-04-21 18:12:23,810] {train_model:82} INFO - Train Epoch: 22 [256000/366120 (70%)]	lr:1.40e-04	Loss: 0.065617
[2024-04-21 18:12:37,466] {train_model:82} INFO - Train Epoch: 22 [292608/366120 (80%)]	lr:1.40e-04	Loss: 0.071370
[2024-04-21 18:12:51,128] {train_model:82} INFO - Train Epoch: 22 [329216/366120 (90%)]	lr:1.40e-04	Loss: 0.109830
[2024-04-21 18:13:04,757] {train_model:82} INFO - Train Epoch: 22 [365824/366120 (100%)]	lr:1.40e-04	Loss: 0.042966
[2024-04-21 18:13:10,451] {run_experiment:78} INFO - 
[2024-04-21 18:13:10,451] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 18:13:11,120] {result_logger:103} INFO - precision on Wake: 0.985
[2024-04-21 18:13:11,545] {result_logger:104} INFO - recall on Wake: 0.979
[2024-04-21 18:13:11,970] {result_logger:107} INFO - F1-score on Wake: 0.982
[2024-04-21 18:13:11,970] {result_logger:108} INFO - 
[2024-04-21 18:13:12,608] {result_logger:103} INFO - precision on Non REM: 0.972
[2024-04-21 18:13:13,023] {result_logger:104} INFO - recall on Non REM: 0.962
[2024-04-21 18:13:13,439] {result_logger:107} INFO - F1-score on Non REM: 0.967
[2024-04-21 18:13:13,440] {result_logger:108} INFO - 
[2024-04-21 18:13:14,042] {result_logger:103} INFO - precision on REM: 0.849
[2024-04-21 18:13:14,407] {result_logger:104} INFO - recall on REM: 0.980
[2024-04-21 18:13:14,772] {result_logger:107} INFO - F1-score on REM: 0.910
[2024-04-21 18:13:14,772] {result_logger:108} INFO - 
[2024-04-21 18:13:14,866] {result_logger:111} INFO - average precision on sleep stages: 0.935
[2024-04-21 18:13:14,961] {result_logger:113} INFO - average recall on sleep stages: 0.973
[2024-04-21 18:13:15,055] {result_logger:115} INFO - average F1-score on sleep stages: 0.953
[2024-04-21 18:13:15,057] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 18:13:15,140] {result_logger:103} INFO - precision on Wake: 0.979
[2024-04-21 18:13:15,191] {result_logger:104} INFO - recall on Wake: 0.977
[2024-04-21 18:13:15,241] {result_logger:107} INFO - F1-score on Wake: 0.978
[2024-04-21 18:13:15,242] {result_logger:108} INFO - 
[2024-04-21 18:13:15,323] {result_logger:103} INFO - precision on Non REM: 0.971
[2024-04-21 18:13:15,373] {result_logger:104} INFO - recall on Non REM: 0.942
[2024-04-21 18:13:15,424] {result_logger:107} INFO - F1-score on Non REM: 0.956
[2024-04-21 18:13:15,424] {result_logger:108} INFO - 
[2024-04-21 18:13:15,507] {result_logger:103} INFO - precision on REM: 0.778
[2024-04-21 18:13:15,556] {result_logger:104} INFO - recall on REM: 0.978
[2024-04-21 18:13:15,605] {result_logger:107} INFO - F1-score on REM: 0.866
[2024-04-21 18:13:15,605] {result_logger:108} INFO - 
[2024-04-21 18:13:15,615] {result_logger:111} INFO - average precision on sleep stages: 0.909
[2024-04-21 18:13:15,625] {result_logger:113} INFO - average recall on sleep stages: 0.966
[2024-04-21 18:13:15,635] {result_logger:115} INFO - average F1-score on sleep stages: 0.934
[2024-04-21 18:13:15,635] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 18:13:15,700] {result_logger:134} INFO - 
[[199397   3745    605]
 [  2891 138245   2631]
 [    68    301  18237]]
[2024-04-21 18:13:15,765] {result_logger:141} INFO - 
[[ 97.86%   1.84%   0.30%]
 [  2.01%  96.16%   1.83%]
 [  0.37%   1.62%  98.02%]]
[2024-04-21 18:13:15,830] {result_logger:145} INFO - 
[[ 98.54%   2.63%   2.82%]
 [  1.43%  97.16%  12.25%]
 [  0.03%   0.21%  84.93%]]
[2024-04-21 18:13:15,831] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 18:13:15,838] {result_logger:134} INFO - 
[[27734   541   107]
 [  590 19509   604]
 [    7    49  2489]]
[2024-04-21 18:13:15,845] {result_logger:141} INFO - 
[[ 97.72%   1.91%   0.38%]
 [  2.85%  94.23%   2.92%]
 [  0.28%   1.93%  97.80%]]
[2024-04-21 18:13:15,852] {result_logger:145} INFO - 
[[ 97.89%   2.69%   3.34%]
 [  2.08%  97.06%  18.88%]
 [  0.02%   0.24%  77.78%]]
[2024-04-21 18:13:15,942] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 18:13:15,942] {result_logger:77} INFO - actual:
[2024-04-21 18:13:15,942] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 18:13:15,942] {result_logger:79} INFO - predicted:
[2024-04-21 18:13:15,942] {result_logger:80} INFO - 
[[95.63%  4.26%  0.11%]
 [ 4.04% 92.80%  3.17%]
 [13.31%  7.53% 79.16%]]
[2024-04-21 18:13:15,942] {run_experiment:112} INFO - [epoch  22] execution time: 151.96s	 avg f1-score: 0.9336

[2024-04-21 18:13:15,942] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:13:15,969] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:13:34,141] {train_model:82} INFO - Train Epoch: 23 [36352/366120 (10%)]	lr:1.32e-04	Loss: 0.085766
[2024-04-21 18:13:47,678] {train_model:82} INFO - Train Epoch: 23 [72960/366120 (20%)]	lr:1.32e-04	Loss: 0.066171
[2024-04-21 18:14:01,265] {train_model:82} INFO - Train Epoch: 23 [109568/366120 (30%)]	lr:1.32e-04	Loss: 0.051798
[2024-04-21 18:14:14,877] {train_model:82} INFO - Train Epoch: 23 [146176/366120 (40%)]	lr:1.32e-04	Loss: 0.065778
[2024-04-21 18:14:28,519] {train_model:82} INFO - Train Epoch: 23 [182784/366120 (50%)]	lr:1.32e-04	Loss: 0.104919
[2024-04-21 18:14:42,208] {train_model:82} INFO - Train Epoch: 23 [219392/366120 (60%)]	lr:1.32e-04	Loss: 0.052497
[2024-04-21 18:14:55,873] {train_model:82} INFO - Train Epoch: 23 [256000/366120 (70%)]	lr:1.32e-04	Loss: 0.068946
[2024-04-21 18:15:09,533] {train_model:82} INFO - Train Epoch: 23 [292608/366120 (80%)]	lr:1.32e-04	Loss: 0.052050
[2024-04-21 18:15:23,185] {train_model:82} INFO - Train Epoch: 23 [329216/366120 (90%)]	lr:1.32e-04	Loss: 0.050044
[2024-04-21 18:15:36,789] {train_model:82} INFO - Train Epoch: 23 [365824/366120 (100%)]	lr:1.32e-04	Loss: 0.041070
[2024-04-21 18:15:42,373] {run_experiment:78} INFO - 
[2024-04-21 18:15:42,373] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 18:15:43,043] {result_logger:103} INFO - precision on Wake: 0.986
[2024-04-21 18:15:43,466] {result_logger:104} INFO - recall on Wake: 0.980
[2024-04-21 18:15:43,888] {result_logger:107} INFO - F1-score on Wake: 0.983
[2024-04-21 18:15:43,888] {result_logger:108} INFO - 
[2024-04-21 18:15:44,526] {result_logger:103} INFO - precision on Non REM: 0.973
[2024-04-21 18:15:44,939] {result_logger:104} INFO - recall on Non REM: 0.963
[2024-04-21 18:15:45,354] {result_logger:107} INFO - F1-score on Non REM: 0.968
[2024-04-21 18:15:45,354] {result_logger:108} INFO - 
[2024-04-21 18:15:45,954] {result_logger:103} INFO - precision on REM: 0.861
[2024-04-21 18:15:46,317] {result_logger:104} INFO - recall on REM: 0.984
[2024-04-21 18:15:46,682] {result_logger:107} INFO - F1-score on REM: 0.918
[2024-04-21 18:15:46,682] {result_logger:108} INFO - 
[2024-04-21 18:15:46,777] {result_logger:111} INFO - average precision on sleep stages: 0.940
[2024-04-21 18:15:46,874] {result_logger:113} INFO - average recall on sleep stages: 0.976
[2024-04-21 18:15:46,970] {result_logger:115} INFO - average F1-score on sleep stages: 0.956
[2024-04-21 18:15:46,971] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 18:15:47,056] {result_logger:103} INFO - precision on Wake: 0.974
[2024-04-21 18:15:47,106] {result_logger:104} INFO - recall on Wake: 0.979
[2024-04-21 18:15:47,157] {result_logger:107} INFO - F1-score on Wake: 0.976
[2024-04-21 18:15:47,157] {result_logger:108} INFO - 
[2024-04-21 18:15:47,239] {result_logger:103} INFO - precision on Non REM: 0.975
[2024-04-21 18:15:47,290] {result_logger:104} INFO - recall on Non REM: 0.942
[2024-04-21 18:15:47,341] {result_logger:107} INFO - F1-score on Non REM: 0.958
[2024-04-21 18:15:47,341] {result_logger:108} INFO - 
[2024-04-21 18:15:47,424] {result_logger:103} INFO - precision on REM: 0.793
[2024-04-21 18:15:47,473] {result_logger:104} INFO - recall on REM: 0.969
[2024-04-21 18:15:47,523] {result_logger:107} INFO - F1-score on REM: 0.872
[2024-04-21 18:15:47,523] {result_logger:108} INFO - 
[2024-04-21 18:15:47,533] {result_logger:111} INFO - average precision on sleep stages: 0.914
[2024-04-21 18:15:47,543] {result_logger:113} INFO - average recall on sleep stages: 0.963
[2024-04-21 18:15:47,553] {result_logger:115} INFO - average F1-score on sleep stages: 0.936
[2024-04-21 18:15:47,553] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 18:15:47,620] {result_logger:134} INFO - 
[[199591   3647    509]
 [  2832 138476   2459]
 [    66    227  18313]]
[2024-04-21 18:15:47,686] {result_logger:141} INFO - 
[[ 97.96%   1.79%   0.25%]
 [  1.97%  96.32%   1.71%]
 [  0.35%   1.22%  98.43%]]
[2024-04-21 18:15:47,752] {result_logger:145} INFO - 
[[ 98.57%   2.56%   2.39%]
 [  1.40%  97.28%  11.55%]
 [  0.03%   0.16%  86.05%]]
[2024-04-21 18:15:47,752] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 18:15:47,759] {result_logger:134} INFO - 
[[27782   436   164]
 [  729 19494   480]
 [   11    67  2467]]
[2024-04-21 18:15:47,766] {result_logger:141} INFO - 
[[ 97.89%   1.54%   0.58%]
 [  3.52%  94.16%   2.32%]
 [  0.43%   2.63%  96.94%]]
[2024-04-21 18:15:47,773] {result_logger:145} INFO - 
[[ 97.41%   2.18%   5.27%]
 [  2.56%  97.48%  15.43%]
 [  0.04%   0.34%  79.30%]]
[2024-04-21 18:15:47,864] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 18:15:47,864] {result_logger:77} INFO - actual:
[2024-04-21 18:15:47,865] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 18:15:47,865] {result_logger:79} INFO - predicted:
[2024-04-21 18:15:47,865] {result_logger:80} INFO - 
[[94.71%  4.96%  0.33%]
 [ 4.84% 92.08%  3.08%]
 [17.42%  5.43% 77.15%]]
[2024-04-21 18:15:47,865] {run_experiment:112} INFO - [epoch  23] execution time: 151.92s	 avg f1-score: 0.9356

[2024-04-21 18:15:47,865] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:15:47,891] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:16:05,723] {train_model:82} INFO - Train Epoch: 24 [36352/366120 (10%)]	lr:1.25e-04	Loss: 0.095603
[2024-04-21 18:16:19,211] {train_model:82} INFO - Train Epoch: 24 [72960/366120 (20%)]	lr:1.25e-04	Loss: 0.065657
[2024-04-21 18:16:32,720] {train_model:82} INFO - Train Epoch: 24 [109568/366120 (30%)]	lr:1.25e-04	Loss: 0.065296
[2024-04-21 18:16:46,261] {train_model:82} INFO - Train Epoch: 24 [146176/366120 (40%)]	lr:1.25e-04	Loss: 0.055909
[2024-04-21 18:16:59,849] {train_model:82} INFO - Train Epoch: 24 [182784/366120 (50%)]	lr:1.25e-04	Loss: 0.041270
[2024-04-21 18:17:13,416] {train_model:82} INFO - Train Epoch: 24 [219392/366120 (60%)]	lr:1.25e-04	Loss: 0.044903
[2024-04-21 18:17:26,993] {train_model:82} INFO - Train Epoch: 24 [256000/366120 (70%)]	lr:1.25e-04	Loss: 0.064671
[2024-04-21 18:17:40,607] {train_model:82} INFO - Train Epoch: 24 [292608/366120 (80%)]	lr:1.25e-04	Loss: 0.055951
[2024-04-21 18:17:54,230] {train_model:82} INFO - Train Epoch: 24 [329216/366120 (90%)]	lr:1.25e-04	Loss: 0.042082
[2024-04-21 18:18:07,848] {train_model:82} INFO - Train Epoch: 24 [365824/366120 (100%)]	lr:1.25e-04	Loss: 0.234508
[2024-04-21 18:18:13,383] {run_experiment:78} INFO - 
[2024-04-21 18:18:13,383] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 18:18:14,046] {result_logger:103} INFO - precision on Wake: 0.986
[2024-04-21 18:18:14,468] {result_logger:104} INFO - recall on Wake: 0.980
[2024-04-21 18:18:14,891] {result_logger:107} INFO - F1-score on Wake: 0.983
[2024-04-21 18:18:14,891] {result_logger:108} INFO - 
[2024-04-21 18:18:15,519] {result_logger:103} INFO - precision on Non REM: 0.974
[2024-04-21 18:18:15,925] {result_logger:104} INFO - recall on Non REM: 0.965
[2024-04-21 18:18:16,333] {result_logger:107} INFO - F1-score on Non REM: 0.969
[2024-04-21 18:18:16,333] {result_logger:108} INFO - 
[2024-04-21 18:18:16,908] {result_logger:103} INFO - precision on REM: 0.865
[2024-04-21 18:18:17,273] {result_logger:104} INFO - recall on REM: 0.985
[2024-04-21 18:18:17,645] {result_logger:107} INFO - F1-score on REM: 0.921
[2024-04-21 18:18:17,645] {result_logger:108} INFO - 
[2024-04-21 18:18:17,737] {result_logger:111} INFO - average precision on sleep stages: 0.942
[2024-04-21 18:18:17,827] {result_logger:113} INFO - average recall on sleep stages: 0.977
[2024-04-21 18:18:17,918] {result_logger:115} INFO - average F1-score on sleep stages: 0.958
[2024-04-21 18:18:17,920] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 18:18:18,001] {result_logger:103} INFO - precision on Wake: 0.980
[2024-04-21 18:18:18,051] {result_logger:104} INFO - recall on Wake: 0.973
[2024-04-21 18:18:18,102] {result_logger:107} INFO - F1-score on Wake: 0.977
[2024-04-21 18:18:18,102] {result_logger:108} INFO - 
[2024-04-21 18:18:18,184] {result_logger:103} INFO - precision on Non REM: 0.967
[2024-04-21 18:18:18,235] {result_logger:104} INFO - recall on Non REM: 0.954
[2024-04-21 18:18:18,286] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2024-04-21 18:18:18,286] {result_logger:108} INFO - 
[2024-04-21 18:18:18,366] {result_logger:103} INFO - precision on REM: 0.813
[2024-04-21 18:18:18,415] {result_logger:104} INFO - recall on REM: 0.962
[2024-04-21 18:18:18,464] {result_logger:107} INFO - F1-score on REM: 0.881
[2024-04-21 18:18:18,464] {result_logger:108} INFO - 
[2024-04-21 18:18:18,474] {result_logger:111} INFO - average precision on sleep stages: 0.920
[2024-04-21 18:18:18,483] {result_logger:113} INFO - average recall on sleep stages: 0.963
[2024-04-21 18:18:18,493] {result_logger:115} INFO - average F1-score on sleep stages: 0.939
[2024-04-21 18:18:18,493] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 18:18:18,556] {result_logger:134} INFO - 
[[199768   3491    488]
 [  2683 138725   2359]
 [    59    228  18319]]
[2024-04-21 18:18:18,619] {result_logger:141} INFO - 
[[ 98.05%   1.71%   0.24%]
 [  1.87%  96.49%   1.64%]
 [  0.32%   1.23%  98.46%]]
[2024-04-21 18:18:18,681] {result_logger:145} INFO - 
[[ 98.65%   2.45%   2.31%]
 [  1.32%  97.39%  11.15%]
 [  0.03%   0.16%  86.55%]]
[2024-04-21 18:18:18,681] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 18:18:18,688] {result_logger:134} INFO - 
[[27616   599   167]
 [  546 19760   397]
 [   15    82  2448]]
[2024-04-21 18:18:18,873] {result_logger:141} INFO - 
[[ 97.30%   2.11%   0.59%]
 [  2.64%  95.45%   1.92%]
 [  0.59%   3.22%  96.19%]]
[2024-04-21 18:18:18,965] {result_logger:145} INFO - 
[[ 98.01%   2.93%   5.54%]
 [  1.94%  96.67%  13.18%]
 [  0.05%   0.40%  81.27%]]
[2024-04-21 18:18:19,224] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 18:18:19,224] {result_logger:77} INFO - actual:
[2024-04-21 18:18:19,224] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 18:18:19,224] {result_logger:79} INFO - predicted:
[2024-04-21 18:18:19,224] {result_logger:80} INFO - 
[[94.91%  4.76%  0.33%]
 [ 4.59% 92.63%  2.78%]
 [16.43%  5.54% 78.02%]]
[2024-04-21 18:18:19,280] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp005/model_8conv_2fc-best.pth
[2024-04-21 18:18:19,280] {run_experiment:112} INFO - [epoch  24] execution time: 151.42s	 avg f1-score: 0.9394

[2024-04-21 18:18:19,281] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:18:19,310] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:18:37,162] {train_model:82} INFO - Train Epoch: 25 [36352/366120 (10%)]	lr:1.17e-04	Loss: 0.064050
[2024-04-21 18:18:50,656] {train_model:82} INFO - Train Epoch: 25 [72960/366120 (20%)]	lr:1.17e-04	Loss: 0.029933
[2024-04-21 18:19:04,188] {train_model:82} INFO - Train Epoch: 25 [109568/366120 (30%)]	lr:1.17e-04	Loss: 0.063709
[2024-04-21 18:19:17,802] {train_model:82} INFO - Train Epoch: 25 [146176/366120 (40%)]	lr:1.17e-04	Loss: 0.014851
[2024-04-21 18:19:31,418] {train_model:82} INFO - Train Epoch: 25 [182784/366120 (50%)]	lr:1.17e-04	Loss: 0.065248
[2024-04-21 18:19:45,050] {train_model:82} INFO - Train Epoch: 25 [219392/366120 (60%)]	lr:1.17e-04	Loss: 0.091376
[2024-04-21 18:19:58,717] {train_model:82} INFO - Train Epoch: 25 [256000/366120 (70%)]	lr:1.17e-04	Loss: 0.065439
[2024-04-21 18:20:12,402] {train_model:82} INFO - Train Epoch: 25 [292608/366120 (80%)]	lr:1.17e-04	Loss: 0.051760
[2024-04-21 18:20:26,088] {train_model:82} INFO - Train Epoch: 25 [329216/366120 (90%)]	lr:1.17e-04	Loss: 0.054917
[2024-04-21 18:20:39,762] {train_model:82} INFO - Train Epoch: 25 [365824/366120 (100%)]	lr:1.17e-04	Loss: 0.084221
[2024-04-21 18:20:45,228] {run_experiment:78} INFO - 
[2024-04-21 18:20:45,228] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 18:20:45,886] {result_logger:103} INFO - precision on Wake: 0.987
[2024-04-21 18:20:46,309] {result_logger:104} INFO - recall on Wake: 0.981
[2024-04-21 18:20:46,731] {result_logger:107} INFO - F1-score on Wake: 0.984
[2024-04-21 18:20:46,731] {result_logger:108} INFO - 
[2024-04-21 18:20:47,392] {result_logger:103} INFO - precision on Non REM: 0.974
[2024-04-21 18:20:47,804] {result_logger:104} INFO - recall on Non REM: 0.966
[2024-04-21 18:20:48,217] {result_logger:107} INFO - F1-score on Non REM: 0.970
[2024-04-21 18:20:48,217] {result_logger:108} INFO - 
[2024-04-21 18:20:48,818] {result_logger:103} INFO - precision on REM: 0.873
[2024-04-21 18:20:49,184] {result_logger:104} INFO - recall on REM: 0.985
[2024-04-21 18:20:49,550] {result_logger:107} INFO - F1-score on REM: 0.925
[2024-04-21 18:20:49,550] {result_logger:108} INFO - 
[2024-04-21 18:20:49,643] {result_logger:111} INFO - average precision on sleep stages: 0.945
[2024-04-21 18:20:49,735] {result_logger:113} INFO - average recall on sleep stages: 0.977
[2024-04-21 18:20:49,828] {result_logger:115} INFO - average F1-score on sleep stages: 0.960
[2024-04-21 18:20:49,829] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 18:20:49,914] {result_logger:103} INFO - precision on Wake: 0.981
[2024-04-21 18:20:49,965] {result_logger:104} INFO - recall on Wake: 0.981
[2024-04-21 18:20:50,015] {result_logger:107} INFO - F1-score on Wake: 0.981
[2024-04-21 18:20:50,015] {result_logger:108} INFO - 
[2024-04-21 18:20:50,100] {result_logger:103} INFO - precision on Non REM: 0.972
[2024-04-21 18:20:50,151] {result_logger:104} INFO - recall on Non REM: 0.953
[2024-04-21 18:20:50,202] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2024-04-21 18:20:50,202] {result_logger:108} INFO - 
[2024-04-21 18:20:50,286] {result_logger:103} INFO - precision on REM: 0.832
[2024-04-21 18:20:50,336] {result_logger:104} INFO - recall on REM: 0.964
[2024-04-21 18:20:50,385] {result_logger:107} INFO - F1-score on REM: 0.893
[2024-04-21 18:20:50,386] {result_logger:108} INFO - 
[2024-04-21 18:20:50,396] {result_logger:111} INFO - average precision on sleep stages: 0.928
[2024-04-21 18:20:50,406] {result_logger:113} INFO - average recall on sleep stages: 0.966
[2024-04-21 18:20:50,416] {result_logger:115} INFO - average F1-score on sleep stages: 0.945
[2024-04-21 18:20:50,417] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 18:20:50,481] {result_logger:134} INFO - 
[[199800   3528    419]
 [  2583 138936   2248]
 [    54    229  18323]]
[2024-04-21 18:20:50,544] {result_logger:141} INFO - 
[[ 98.06%   1.73%   0.21%]
 [  1.80%  96.64%   1.56%]
 [  0.29%   1.23%  98.48%]]
[2024-04-21 18:20:50,608] {result_logger:145} INFO - 
[[ 98.70%   2.47%   2.00%]
 [  1.28%  97.37%  10.71%]
 [  0.03%   0.16%  87.29%]]
[2024-04-21 18:20:50,608] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 18:20:50,616] {result_logger:134} INFO - 
[[27838   493    51]
 [  523 19735   445]
 [   14    78  2453]]
[2024-04-21 18:20:50,712] {result_logger:141} INFO - 
[[ 98.08%   1.74%   0.18%]
 [  2.53%  95.32%   2.15%]
 [  0.55%   3.06%  96.39%]]
[2024-04-21 18:20:50,806] {result_logger:145} INFO - 
[[ 98.11%   2.43%   1.73%]
 [  1.84%  97.19%  15.09%]
 [  0.05%   0.38%  83.18%]]
[2024-04-21 18:20:51,069] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 18:20:51,069] {result_logger:77} INFO - actual:
[2024-04-21 18:20:51,069] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 18:20:51,069] {result_logger:79} INFO - predicted:
[2024-04-21 18:20:51,069] {result_logger:80} INFO - 
[[95.24%  4.68%  0.08%]
 [ 4.43% 92.57%  2.99%]
 [15.29%  6.07% 78.64%]]
[2024-04-21 18:20:51,125] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp005/model_8conv_2fc-best.pth
[2024-04-21 18:20:51,126] {run_experiment:112} INFO - [epoch  25] execution time: 151.85s	 avg f1-score: 0.9455

[2024-04-21 18:20:51,126] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:20:51,153] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:21:09,315] {train_model:82} INFO - Train Epoch: 26 [36352/366120 (10%)]	lr:1.11e-04	Loss: 0.162270
[2024-04-21 18:21:22,855] {train_model:82} INFO - Train Epoch: 26 [72960/366120 (20%)]	lr:1.11e-04	Loss: 0.061549
[2024-04-21 18:21:36,424] {train_model:82} INFO - Train Epoch: 26 [109568/366120 (30%)]	lr:1.11e-04	Loss: 0.033131
[2024-04-21 18:21:50,022] {train_model:82} INFO - Train Epoch: 26 [146176/366120 (40%)]	lr:1.11e-04	Loss: 0.071638
[2024-04-21 18:22:03,648] {train_model:82} INFO - Train Epoch: 26 [182784/366120 (50%)]	lr:1.11e-04	Loss: 0.085713
[2024-04-21 18:22:17,279] {train_model:82} INFO - Train Epoch: 26 [219392/366120 (60%)]	lr:1.11e-04	Loss: 0.044092
[2024-04-21 18:22:30,958] {train_model:82} INFO - Train Epoch: 26 [256000/366120 (70%)]	lr:1.11e-04	Loss: 0.159148
[2024-04-21 18:22:44,619] {train_model:82} INFO - Train Epoch: 26 [292608/366120 (80%)]	lr:1.11e-04	Loss: 0.044695
[2024-04-21 18:22:58,293] {train_model:82} INFO - Train Epoch: 26 [329216/366120 (90%)]	lr:1.11e-04	Loss: 0.092364
[2024-04-21 18:23:11,966] {train_model:82} INFO - Train Epoch: 26 [365824/366120 (100%)]	lr:1.11e-04	Loss: 0.042121
[2024-04-21 18:23:18,059] {run_experiment:78} INFO - 
[2024-04-21 18:23:18,059] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 18:23:18,710] {result_logger:103} INFO - precision on Wake: 0.987
[2024-04-21 18:23:19,130] {result_logger:104} INFO - recall on Wake: 0.981
[2024-04-21 18:23:19,551] {result_logger:107} INFO - F1-score on Wake: 0.984
[2024-04-21 18:23:19,551] {result_logger:108} INFO - 
[2024-04-21 18:23:20,180] {result_logger:103} INFO - precision on Non REM: 0.975
[2024-04-21 18:23:20,588] {result_logger:104} INFO - recall on Non REM: 0.968
[2024-04-21 18:23:20,998] {result_logger:107} INFO - F1-score on Non REM: 0.971
[2024-04-21 18:23:20,998] {result_logger:108} INFO - 
[2024-04-21 18:23:21,599] {result_logger:103} INFO - precision on REM: 0.880
[2024-04-21 18:23:21,964] {result_logger:104} INFO - recall on REM: 0.986
[2024-04-21 18:23:22,328] {result_logger:107} INFO - F1-score on REM: 0.930
[2024-04-21 18:23:22,329] {result_logger:108} INFO - 
[2024-04-21 18:23:22,422] {result_logger:111} INFO - average precision on sleep stages: 0.947
[2024-04-21 18:23:22,515] {result_logger:113} INFO - average recall on sleep stages: 0.978
[2024-04-21 18:23:22,609] {result_logger:115} INFO - average F1-score on sleep stages: 0.962
[2024-04-21 18:23:22,611] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 18:23:22,695] {result_logger:103} INFO - precision on Wake: 0.977
[2024-04-21 18:23:22,746] {result_logger:104} INFO - recall on Wake: 0.978
[2024-04-21 18:23:22,797] {result_logger:107} INFO - F1-score on Wake: 0.977
[2024-04-21 18:23:22,797] {result_logger:108} INFO - 
[2024-04-21 18:23:22,878] {result_logger:103} INFO - precision on Non REM: 0.973
[2024-04-21 18:23:22,929] {result_logger:104} INFO - recall on Non REM: 0.953
[2024-04-21 18:23:22,979] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2024-04-21 18:23:22,979] {result_logger:108} INFO - 
[2024-04-21 18:23:23,063] {result_logger:103} INFO - precision on REM: 0.830
[2024-04-21 18:23:23,112] {result_logger:104} INFO - recall on REM: 0.958
[2024-04-21 18:23:23,161] {result_logger:107} INFO - F1-score on REM: 0.889
[2024-04-21 18:23:23,161] {result_logger:108} INFO - 
[2024-04-21 18:23:23,171] {result_logger:111} INFO - average precision on sleep stages: 0.927
[2024-04-21 18:23:23,181] {result_logger:113} INFO - average recall on sleep stages: 0.963
[2024-04-21 18:23:23,191] {result_logger:115} INFO - average F1-score on sleep stages: 0.943
[2024-04-21 18:23:23,192] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 18:23:23,256] {result_logger:134} INFO - 
[[199914   3426    407]
 [  2519 139149   2099]
 [    61    196  18349]]
[2024-04-21 18:23:23,319] {result_logger:141} INFO - 
[[ 98.12%   1.68%   0.20%]
 [  1.75%  96.79%   1.46%]
 [  0.33%   1.05%  98.62%]]
[2024-04-21 18:23:23,383] {result_logger:145} INFO - 
[[ 98.73%   2.40%   1.95%]
 [  1.24%  97.46%  10.06%]
 [  0.03%   0.14%  87.98%]]
[2024-04-21 18:23:23,384] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 18:23:23,391] {result_logger:134} INFO - 
[[27758   464   160]
 [  640 19725   338]
 [   15    93  2437]]
[2024-04-21 18:23:23,397] {result_logger:141} INFO - 
[[ 97.80%   1.63%   0.56%]
 [  3.09%  95.28%   1.63%]
 [  0.59%   3.65%  95.76%]]
[2024-04-21 18:23:23,404] {result_logger:145} INFO - 
[[ 97.69%   2.29%   5.45%]
 [  2.25%  97.25%  11.52%]
 [  0.05%   0.46%  83.03%]]
[2024-04-21 18:23:23,495] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 18:23:23,495] {result_logger:77} INFO - actual:
[2024-04-21 18:23:23,495] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 18:23:23,495] {result_logger:79} INFO - predicted:
[2024-04-21 18:23:23,495] {result_logger:80} INFO - 
[[95.13%  4.53%  0.34%]
 [ 4.41% 92.96%  2.63%]
 [16.70%  4.77% 78.53%]]
[2024-04-21 18:23:23,495] {run_experiment:112} INFO - [epoch  26] execution time: 152.37s	 avg f1-score: 0.9431

[2024-04-21 18:23:23,495] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:23:23,523] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:23:41,707] {train_model:82} INFO - Train Epoch: 27 [36352/366120 (10%)]	lr:1.04e-04	Loss: 0.049155
[2024-04-21 18:23:55,194] {train_model:82} INFO - Train Epoch: 27 [72960/366120 (20%)]	lr:1.04e-04	Loss: 0.051834
[2024-04-21 18:24:08,699] {train_model:82} INFO - Train Epoch: 27 [109568/366120 (30%)]	lr:1.04e-04	Loss: 0.050046
[2024-04-21 18:24:22,236] {train_model:82} INFO - Train Epoch: 27 [146176/366120 (40%)]	lr:1.04e-04	Loss: 0.041957
[2024-04-21 18:24:35,820] {train_model:82} INFO - Train Epoch: 27 [182784/366120 (50%)]	lr:1.04e-04	Loss: 0.053295
[2024-04-21 18:24:49,390] {train_model:82} INFO - Train Epoch: 27 [219392/366120 (60%)]	lr:1.04e-04	Loss: 0.075279
[2024-04-21 18:25:02,980] {train_model:82} INFO - Train Epoch: 27 [256000/366120 (70%)]	lr:1.04e-04	Loss: 0.057796
[2024-04-21 18:25:16,591] {train_model:82} INFO - Train Epoch: 27 [292608/366120 (80%)]	lr:1.04e-04	Loss: 0.063278
[2024-04-21 18:25:30,209] {train_model:82} INFO - Train Epoch: 27 [329216/366120 (90%)]	lr:1.04e-04	Loss: 0.075950
[2024-04-21 18:25:43,815] {train_model:82} INFO - Train Epoch: 27 [365824/366120 (100%)]	lr:1.04e-04	Loss: 0.020656
[2024-04-21 18:25:49,764] {run_experiment:78} INFO - 
[2024-04-21 18:25:49,764] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 18:25:50,422] {result_logger:103} INFO - precision on Wake: 0.988
[2024-04-21 18:25:50,850] {result_logger:104} INFO - recall on Wake: 0.982
[2024-04-21 18:25:51,275] {result_logger:107} INFO - F1-score on Wake: 0.985
[2024-04-21 18:25:51,276] {result_logger:108} INFO - 
[2024-04-21 18:25:51,928] {result_logger:103} INFO - precision on Non REM: 0.976
[2024-04-21 18:25:52,342] {result_logger:104} INFO - recall on Non REM: 0.970
[2024-04-21 18:25:52,755] {result_logger:107} INFO - F1-score on Non REM: 0.973
[2024-04-21 18:25:52,756] {result_logger:108} INFO - 
[2024-04-21 18:25:53,336] {result_logger:103} INFO - precision on REM: 0.885
[2024-04-21 18:25:53,700] {result_logger:104} INFO - recall on REM: 0.988
[2024-04-21 18:25:54,062] {result_logger:107} INFO - F1-score on REM: 0.934
[2024-04-21 18:25:54,063] {result_logger:108} INFO - 
[2024-04-21 18:25:54,158] {result_logger:111} INFO - average precision on sleep stages: 0.950
[2024-04-21 18:25:54,256] {result_logger:113} INFO - average recall on sleep stages: 0.980
[2024-04-21 18:25:54,351] {result_logger:115} INFO - average F1-score on sleep stages: 0.964
[2024-04-21 18:25:54,354] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 18:25:54,437] {result_logger:103} INFO - precision on Wake: 0.978
[2024-04-21 18:25:54,487] {result_logger:104} INFO - recall on Wake: 0.981
[2024-04-21 18:25:54,538] {result_logger:107} INFO - F1-score on Wake: 0.979
[2024-04-21 18:25:54,538] {result_logger:108} INFO - 
[2024-04-21 18:25:54,622] {result_logger:103} INFO - precision on Non REM: 0.972
[2024-04-21 18:25:54,673] {result_logger:104} INFO - recall on Non REM: 0.953
[2024-04-21 18:25:54,723] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2024-04-21 18:25:54,723] {result_logger:108} INFO - 
[2024-04-21 18:25:54,803] {result_logger:103} INFO - precision on REM: 0.849
[2024-04-21 18:25:54,852] {result_logger:104} INFO - recall on REM: 0.958
[2024-04-21 18:25:54,901] {result_logger:107} INFO - F1-score on REM: 0.900
[2024-04-21 18:25:54,901] {result_logger:108} INFO - 
[2024-04-21 18:25:54,911] {result_logger:111} INFO - average precision on sleep stages: 0.933
[2024-04-21 18:25:54,922] {result_logger:113} INFO - average recall on sleep stages: 0.964
[2024-04-21 18:25:54,931] {result_logger:115} INFO - average F1-score on sleep stages: 0.947
[2024-04-21 18:25:54,931] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 18:25:54,998] {result_logger:134} INFO - 
[[200150   3229    368]
 [  2349 139401   2017]
 [    59    164  18383]]
[2024-04-21 18:25:55,063] {result_logger:141} INFO - 
[[ 98.23%   1.58%   0.18%]
 [  1.63%  96.96%   1.40%]
 [  0.32%   0.88%  98.80%]]
[2024-04-21 18:25:55,128] {result_logger:145} INFO - 
[[ 98.81%   2.26%   1.77%]
 [  1.16%  97.62%   9.71%]
 [  0.03%   0.11%  88.52%]]
[2024-04-21 18:25:55,128] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 18:25:55,136] {result_logger:134} INFO - 
[[27837   462    83]
 [  630 19723   350]
 [   10    96  2439]]
[2024-04-21 18:25:55,232] {result_logger:141} INFO - 
[[ 98.08%   1.63%   0.29%]
 [  3.04%  95.27%   1.69%]
 [  0.39%   3.77%  95.83%]]
[2024-04-21 18:25:55,323] {result_logger:145} INFO - 
[[ 97.75%   2.28%   2.89%]
 [  2.21%  97.25%  12.19%]
 [  0.04%   0.47%  84.92%]]
[2024-04-21 18:25:55,582] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 18:25:55,582] {result_logger:77} INFO - actual:
[2024-04-21 18:25:55,582] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 18:25:55,582] {result_logger:79} INFO - predicted:
[2024-04-21 18:25:55,582] {result_logger:80} INFO - 
[[95.47%  4.41%  0.13%]
 [ 4.25% 93.04%  2.72%]
 [14.97%  5.47% 79.56%]]
[2024-04-21 18:25:55,639] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp005/model_8conv_2fc-best.pth
[2024-04-21 18:25:55,639] {run_experiment:112} INFO - [epoch  27] execution time: 152.14s	 avg f1-score: 0.9474

[2024-04-21 18:25:55,639] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:25:55,668] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:26:13,554] {train_model:82} INFO - Train Epoch: 28 [36352/366120 (10%)]	lr:9.80e-05	Loss: 0.058563
[2024-04-21 18:26:27,100] {train_model:82} INFO - Train Epoch: 28 [72960/366120 (20%)]	lr:9.80e-05	Loss: 0.080758
[2024-04-21 18:26:40,662] {train_model:82} INFO - Train Epoch: 28 [109568/366120 (30%)]	lr:9.80e-05	Loss: 0.059316
[2024-04-21 18:26:54,206] {train_model:82} INFO - Train Epoch: 28 [146176/366120 (40%)]	lr:9.80e-05	Loss: 0.044214
[2024-04-21 18:27:07,838] {train_model:82} INFO - Train Epoch: 28 [182784/366120 (50%)]	lr:9.80e-05	Loss: 0.055146
[2024-04-21 18:27:21,431] {train_model:82} INFO - Train Epoch: 28 [219392/366120 (60%)]	lr:9.80e-05	Loss: 0.101455
[2024-04-21 18:27:35,014] {train_model:82} INFO - Train Epoch: 28 [256000/366120 (70%)]	lr:9.80e-05	Loss: 0.035892
[2024-04-21 18:27:48,639] {train_model:82} INFO - Train Epoch: 28 [292608/366120 (80%)]	lr:9.80e-05	Loss: 0.029233
[2024-04-21 18:28:02,249] {train_model:82} INFO - Train Epoch: 28 [329216/366120 (90%)]	lr:9.80e-05	Loss: 0.061888
[2024-04-21 18:28:15,872] {train_model:82} INFO - Train Epoch: 28 [365824/366120 (100%)]	lr:9.80e-05	Loss: 0.034145
[2024-04-21 18:28:21,693] {run_experiment:78} INFO - 
[2024-04-21 18:28:21,693] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 18:28:22,362] {result_logger:103} INFO - precision on Wake: 0.989
[2024-04-21 18:28:22,784] {result_logger:104} INFO - recall on Wake: 0.983
[2024-04-21 18:28:23,207] {result_logger:107} INFO - F1-score on Wake: 0.986
[2024-04-21 18:28:23,207] {result_logger:108} INFO - 
[2024-04-21 18:28:23,861] {result_logger:103} INFO - precision on Non REM: 0.977
[2024-04-21 18:28:24,269] {result_logger:104} INFO - recall on Non REM: 0.972
[2024-04-21 18:28:24,683] {result_logger:107} INFO - F1-score on Non REM: 0.975
[2024-04-21 18:28:24,684] {result_logger:108} INFO - 
[2024-04-21 18:28:25,283] {result_logger:103} INFO - precision on REM: 0.899
[2024-04-21 18:28:25,646] {result_logger:104} INFO - recall on REM: 0.990
[2024-04-21 18:28:26,010] {result_logger:107} INFO - F1-score on REM: 0.942
[2024-04-21 18:28:26,010] {result_logger:108} INFO - 
[2024-04-21 18:28:26,104] {result_logger:111} INFO - average precision on sleep stages: 0.955
[2024-04-21 18:28:26,199] {result_logger:113} INFO - average recall on sleep stages: 0.982
[2024-04-21 18:28:26,293] {result_logger:115} INFO - average F1-score on sleep stages: 0.968
[2024-04-21 18:28:26,295] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 18:28:26,379] {result_logger:103} INFO - precision on Wake: 0.974
[2024-04-21 18:28:26,429] {result_logger:104} INFO - recall on Wake: 0.981
[2024-04-21 18:28:26,480] {result_logger:107} INFO - F1-score on Wake: 0.977
[2024-04-21 18:28:26,480] {result_logger:108} INFO - 
[2024-04-21 18:28:26,565] {result_logger:103} INFO - precision on Non REM: 0.977
[2024-04-21 18:28:26,616] {result_logger:104} INFO - recall on Non REM: 0.942
[2024-04-21 18:28:26,667] {result_logger:107} INFO - F1-score on Non REM: 0.959
[2024-04-21 18:28:26,667] {result_logger:108} INFO - 
[2024-04-21 18:28:26,750] {result_logger:103} INFO - precision on REM: 0.811
[2024-04-21 18:28:26,799] {result_logger:104} INFO - recall on REM: 0.976
[2024-04-21 18:28:26,848] {result_logger:107} INFO - F1-score on REM: 0.886
[2024-04-21 18:28:26,849] {result_logger:108} INFO - 
[2024-04-21 18:28:26,859] {result_logger:111} INFO - average precision on sleep stages: 0.920
[2024-04-21 18:28:26,869] {result_logger:113} INFO - average recall on sleep stages: 0.966
[2024-04-21 18:28:26,879] {result_logger:115} INFO - average F1-score on sleep stages: 0.941
[2024-04-21 18:28:26,879] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 18:28:26,944] {result_logger:134} INFO - 
[[200295   3134    318]
 [  2241 139775   1751]
 [    46    147  18413]]
[2024-04-21 18:28:27,009] {result_logger:141} INFO - 
[[ 98.31%   1.54%   0.16%]
 [  1.56%  97.22%   1.22%]
 [  0.25%   0.79%  98.96%]]
[2024-04-21 18:28:27,073] {result_logger:145} INFO - 
[[ 98.87%   2.19%   1.55%]
 [  1.11%  97.71%   8.55%]
 [  0.02%   0.10%  89.90%]]
[2024-04-21 18:28:27,074] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 18:28:27,081] {result_logger:134} INFO - 
[[27850   415   117]
 [  743 19497   463]
 [   10    51  2484]]
[2024-04-21 18:28:27,088] {result_logger:141} INFO - 
[[ 98.13%   1.46%   0.41%]
 [  3.59%  94.17%   2.24%]
 [  0.39%   2.00%  97.60%]]
[2024-04-21 18:28:27,095] {result_logger:145} INFO - 
[[ 97.37%   2.08%   3.82%]
 [  2.60%  97.67%  15.11%]
 [  0.03%   0.26%  81.07%]]
[2024-04-21 18:28:27,188] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 18:28:27,188] {result_logger:77} INFO - actual:
[2024-04-21 18:28:27,189] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 18:28:27,189] {result_logger:79} INFO - predicted:
[2024-04-21 18:28:27,189] {result_logger:80} INFO - 
[[94.98%  4.79%  0.24%]
 [ 4.76% 92.31%  2.93%]
 [15.86%  5.42% 78.72%]]
[2024-04-21 18:28:27,189] {run_experiment:112} INFO - [epoch  28] execution time: 151.55s	 avg f1-score: 0.9407

[2024-04-21 18:28:27,189] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:28:27,216] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:28:45,030] {train_model:82} INFO - Train Epoch: 29 [36352/366120 (10%)]	lr:9.23e-05	Loss: 0.029270
[2024-04-21 18:28:58,516] {train_model:82} INFO - Train Epoch: 29 [72960/366120 (20%)]	lr:9.23e-05	Loss: 0.046355
[2024-04-21 18:29:12,042] {train_model:82} INFO - Train Epoch: 29 [109568/366120 (30%)]	lr:9.23e-05	Loss: 0.094283
[2024-04-21 18:29:25,600] {train_model:82} INFO - Train Epoch: 29 [146176/366120 (40%)]	lr:9.23e-05	Loss: 0.031248
[2024-04-21 18:29:39,231] {train_model:82} INFO - Train Epoch: 29 [182784/366120 (50%)]	lr:9.23e-05	Loss: 0.023978
[2024-04-21 18:29:52,821] {train_model:82} INFO - Train Epoch: 29 [219392/366120 (60%)]	lr:9.23e-05	Loss: 0.041631
[2024-04-21 18:30:06,452] {train_model:82} INFO - Train Epoch: 29 [256000/366120 (70%)]	lr:9.23e-05	Loss: 0.029061
[2024-04-21 18:30:20,089] {train_model:82} INFO - Train Epoch: 29 [292608/366120 (80%)]	lr:9.23e-05	Loss: 0.080936
[2024-04-21 18:30:33,743] {train_model:82} INFO - Train Epoch: 29 [329216/366120 (90%)]	lr:9.23e-05	Loss: 0.043544
[2024-04-21 18:30:47,377] {train_model:82} INFO - Train Epoch: 29 [365824/366120 (100%)]	lr:9.23e-05	Loss: 0.039323
[2024-04-21 18:30:53,059] {run_experiment:78} INFO - 
[2024-04-21 18:30:53,059] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 18:30:53,727] {result_logger:103} INFO - precision on Wake: 0.989
[2024-04-21 18:30:54,148] {result_logger:104} INFO - recall on Wake: 0.984
[2024-04-21 18:30:54,569] {result_logger:107} INFO - F1-score on Wake: 0.986
[2024-04-21 18:30:54,569] {result_logger:108} INFO - 
[2024-04-21 18:30:55,225] {result_logger:103} INFO - precision on Non REM: 0.978
[2024-04-21 18:30:55,639] {result_logger:104} INFO - recall on Non REM: 0.973
[2024-04-21 18:30:56,055] {result_logger:107} INFO - F1-score on Non REM: 0.975
[2024-04-21 18:30:56,055] {result_logger:108} INFO - 
[2024-04-21 18:30:56,656] {result_logger:103} INFO - precision on REM: 0.898
[2024-04-21 18:30:57,021] {result_logger:104} INFO - recall on REM: 0.990
[2024-04-21 18:30:57,386] {result_logger:107} INFO - F1-score on REM: 0.942
[2024-04-21 18:30:57,386] {result_logger:108} INFO - 
[2024-04-21 18:30:57,482] {result_logger:111} INFO - average precision on sleep stages: 0.955
[2024-04-21 18:30:57,578] {result_logger:113} INFO - average recall on sleep stages: 0.982
[2024-04-21 18:30:57,674] {result_logger:115} INFO - average F1-score on sleep stages: 0.968
[2024-04-21 18:30:57,676] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 18:30:57,760] {result_logger:103} INFO - precision on Wake: 0.979
[2024-04-21 18:30:57,811] {result_logger:104} INFO - recall on Wake: 0.982
[2024-04-21 18:30:57,861] {result_logger:107} INFO - F1-score on Wake: 0.981
[2024-04-21 18:30:57,861] {result_logger:108} INFO - 
[2024-04-21 18:30:57,945] {result_logger:103} INFO - precision on Non REM: 0.975
[2024-04-21 18:30:57,996] {result_logger:104} INFO - recall on Non REM: 0.951
[2024-04-21 18:30:58,047] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2024-04-21 18:30:58,047] {result_logger:108} INFO - 
[2024-04-21 18:30:58,130] {result_logger:103} INFO - precision on REM: 0.839
[2024-04-21 18:30:58,180] {result_logger:104} INFO - recall on REM: 0.969
[2024-04-21 18:30:58,230] {result_logger:107} INFO - F1-score on REM: 0.899
[2024-04-21 18:30:58,230] {result_logger:108} INFO - 
[2024-04-21 18:30:58,240] {result_logger:111} INFO - average precision on sleep stages: 0.931
[2024-04-21 18:30:58,250] {result_logger:113} INFO - average recall on sleep stages: 0.967
[2024-04-21 18:30:58,260] {result_logger:115} INFO - average F1-score on sleep stages: 0.948
[2024-04-21 18:30:58,261] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 18:30:58,327] {result_logger:134} INFO - 
[[200414   3002    331]
 [  2192 139814   1761]
 [    48    145  18413]]
[2024-04-21 18:30:58,392] {result_logger:141} INFO - 
[[ 98.36%   1.47%   0.16%]
 [  1.52%  97.25%   1.22%]
 [  0.26%   0.78%  98.96%]]
[2024-04-21 18:30:58,457] {result_logger:145} INFO - 
[[ 98.89%   2.10%   1.61%]
 [  1.08%  97.80%   8.59%]
 [  0.02%   0.10%  89.80%]]
[2024-04-21 18:30:58,457] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 18:30:58,465] {result_logger:134} INFO - 
[[27884   445    53]
 [  588 19696   419]
 [   13    67  2465]]
[2024-04-21 18:30:58,560] {result_logger:141} INFO - 
[[ 98.25%   1.57%   0.19%]
 [  2.84%  95.14%   2.02%]
 [  0.51%   2.63%  96.86%]]
[2024-04-21 18:30:58,652] {result_logger:145} INFO - 
[[ 97.89%   2.20%   1.80%]
 [  2.06%  97.47%  14.27%]
 [  0.05%   0.33%  83.93%]]
[2024-04-21 18:30:58,913] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 18:30:58,914] {result_logger:77} INFO - actual:
[2024-04-21 18:30:58,914] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 18:30:58,914] {result_logger:79} INFO - predicted:
[2024-04-21 18:30:58,914] {result_logger:80} INFO - 
[[95.44%  4.49%  0.07%]
 [ 4.28% 92.91%  2.81%]
 [14.78%  5.21% 80.01%]]
[2024-04-21 18:30:58,971] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp005/model_8conv_2fc-best.pth
[2024-04-21 18:30:58,971] {run_experiment:112} INFO - [epoch  29] execution time: 151.78s	 avg f1-score: 0.9476

[2024-04-21 18:30:58,971] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:30:58,998] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:31:17,173] {train_model:82} INFO - Train Epoch: 30 [36352/366120 (10%)]	lr:8.69e-05	Loss: 0.038693
[2024-04-21 18:31:30,665] {train_model:82} INFO - Train Epoch: 30 [72960/366120 (20%)]	lr:8.69e-05	Loss: 0.048426
[2024-04-21 18:31:44,219] {train_model:82} INFO - Train Epoch: 30 [109568/366120 (30%)]	lr:8.69e-05	Loss: 0.049701
[2024-04-21 18:31:57,775] {train_model:82} INFO - Train Epoch: 30 [146176/366120 (40%)]	lr:8.69e-05	Loss: 0.018899
[2024-04-21 18:32:11,374] {train_model:82} INFO - Train Epoch: 30 [182784/366120 (50%)]	lr:8.69e-05	Loss: 0.053104
[2024-04-21 18:32:24,987] {train_model:82} INFO - Train Epoch: 30 [219392/366120 (60%)]	lr:8.69e-05	Loss: 0.046851
[2024-04-21 18:32:38,659] {train_model:82} INFO - Train Epoch: 30 [256000/366120 (70%)]	lr:8.69e-05	Loss: 0.027412
[2024-04-21 18:32:52,351] {train_model:82} INFO - Train Epoch: 30 [292608/366120 (80%)]	lr:8.69e-05	Loss: 0.070481
[2024-04-21 18:33:06,051] {train_model:82} INFO - Train Epoch: 30 [329216/366120 (90%)]	lr:8.69e-05	Loss: 0.024904
[2024-04-21 18:33:19,690] {train_model:82} INFO - Train Epoch: 30 [365824/366120 (100%)]	lr:8.69e-05	Loss: 0.023973
[2024-04-21 18:33:25,110] {run_experiment:78} INFO - 
[2024-04-21 18:33:25,110] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 18:33:25,782] {result_logger:103} INFO - precision on Wake: 0.989
[2024-04-21 18:33:26,207] {result_logger:104} INFO - recall on Wake: 0.984
[2024-04-21 18:33:26,632] {result_logger:107} INFO - F1-score on Wake: 0.987
[2024-04-21 18:33:26,632] {result_logger:108} INFO - 
[2024-04-21 18:33:27,286] {result_logger:103} INFO - precision on Non REM: 0.979
[2024-04-21 18:33:27,702] {result_logger:104} INFO - recall on Non REM: 0.975
[2024-04-21 18:33:28,118] {result_logger:107} INFO - F1-score on Non REM: 0.977
[2024-04-21 18:33:28,118] {result_logger:108} INFO - 
[2024-04-21 18:33:28,723] {result_logger:103} INFO - precision on REM: 0.910
[2024-04-21 18:33:29,087] {result_logger:104} INFO - recall on REM: 0.991
[2024-04-21 18:33:29,451] {result_logger:107} INFO - F1-score on REM: 0.949
[2024-04-21 18:33:29,452] {result_logger:108} INFO - 
[2024-04-21 18:33:29,547] {result_logger:111} INFO - average precision on sleep stages: 0.959
[2024-04-21 18:33:29,642] {result_logger:113} INFO - average recall on sleep stages: 0.983
[2024-04-21 18:33:29,737] {result_logger:115} INFO - average F1-score on sleep stages: 0.971
[2024-04-21 18:33:29,739] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 18:33:29,823] {result_logger:103} INFO - precision on Wake: 0.978
[2024-04-21 18:33:29,873] {result_logger:104} INFO - recall on Wake: 0.980
[2024-04-21 18:33:29,923] {result_logger:107} INFO - F1-score on Wake: 0.979
[2024-04-21 18:33:29,923] {result_logger:108} INFO - 
[2024-04-21 18:33:30,007] {result_logger:103} INFO - precision on Non REM: 0.972
[2024-04-21 18:33:30,058] {result_logger:104} INFO - recall on Non REM: 0.950
[2024-04-21 18:33:30,108] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2024-04-21 18:33:30,108] {result_logger:108} INFO - 
[2024-04-21 18:33:30,192] {result_logger:103} INFO - precision on REM: 0.837
[2024-04-21 18:33:30,242] {result_logger:104} INFO - recall on REM: 0.967
[2024-04-21 18:33:30,291] {result_logger:107} INFO - F1-score on REM: 0.897
[2024-04-21 18:33:30,291] {result_logger:108} INFO - 
[2024-04-21 18:33:30,300] {result_logger:111} INFO - average precision on sleep stages: 0.929
[2024-04-21 18:33:30,310] {result_logger:113} INFO - average recall on sleep stages: 0.966
[2024-04-21 18:33:30,320] {result_logger:115} INFO - average F1-score on sleep stages: 0.946
[2024-04-21 18:33:30,320] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 18:33:30,386] {result_logger:134} INFO - 
[[200558   2924    265]
 [  2103 140113   1551]
 [    33    134  18439]]
[2024-04-21 18:33:30,452] {result_logger:141} INFO - 
[[ 98.43%   1.44%   0.13%]
 [  1.46%  97.46%   1.08%]
 [  0.18%   0.72%  99.10%]]
[2024-04-21 18:33:30,517] {result_logger:145} INFO - 
[[ 98.95%   2.04%   1.31%]
 [  1.04%  97.86%   7.66%]
 [  0.02%   0.09%  91.03%]]
[2024-04-21 18:33:30,517] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 18:33:30,524] {result_logger:134} INFO - 
[[27825   504    53]
 [  599 19676   428]
 [   14    69  2462]]
[2024-04-21 18:33:30,531] {result_logger:141} INFO - 
[[ 98.04%   1.78%   0.19%]
 [  2.89%  95.04%   2.07%]
 [  0.55%   2.71%  96.74%]]
[2024-04-21 18:33:30,538] {result_logger:145} INFO - 
[[ 97.84%   2.49%   1.80%]
 [  2.11%  97.17%  14.54%]
 [  0.05%   0.34%  83.66%]]
[2024-04-21 18:33:30,630] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 18:33:30,630] {result_logger:77} INFO - actual:
[2024-04-21 18:33:30,630] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 18:33:30,630] {result_logger:79} INFO - predicted:
[2024-04-21 18:33:30,630] {result_logger:80} INFO - 
[[95.22%  4.72%  0.06%]
 [ 4.63% 92.50%  2.87%]
 [14.37%  6.01% 79.61%]]
[2024-04-21 18:33:30,630] {run_experiment:112} INFO - [epoch  30] execution time: 151.66s	 avg f1-score: 0.9459

[2024-04-21 18:33:30,631] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:33:30,658] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:33:48,558] {train_model:82} INFO - Train Epoch: 31 [36352/366120 (10%)]	lr:8.19e-05	Loss: 0.071989
[2024-04-21 18:34:02,097] {train_model:82} INFO - Train Epoch: 31 [72960/366120 (20%)]	lr:8.19e-05	Loss: 0.033405
[2024-04-21 18:34:15,671] {train_model:82} INFO - Train Epoch: 31 [109568/366120 (30%)]	lr:8.19e-05	Loss: 0.025369
[2024-04-21 18:34:29,269] {train_model:82} INFO - Train Epoch: 31 [146176/366120 (40%)]	lr:8.19e-05	Loss: 0.021776
[2024-04-21 18:34:42,884] {train_model:82} INFO - Train Epoch: 31 [182784/366120 (50%)]	lr:8.19e-05	Loss: 0.017515
[2024-04-21 18:34:56,535] {train_model:82} INFO - Train Epoch: 31 [219392/366120 (60%)]	lr:8.19e-05	Loss: 0.034158
[2024-04-21 18:35:10,180] {train_model:82} INFO - Train Epoch: 31 [256000/366120 (70%)]	lr:8.19e-05	Loss: 0.045540
[2024-04-21 18:35:23,840] {train_model:82} INFO - Train Epoch: 31 [292608/366120 (80%)]	lr:8.19e-05	Loss: 0.082247
[2024-04-21 18:35:37,513] {train_model:82} INFO - Train Epoch: 31 [329216/366120 (90%)]	lr:8.19e-05	Loss: 0.149065
[2024-04-21 18:35:51,199] {train_model:82} INFO - Train Epoch: 31 [365824/366120 (100%)]	lr:8.19e-05	Loss: 0.057996
[2024-04-21 18:35:56,985] {run_experiment:78} INFO - 
[2024-04-21 18:35:56,986] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 18:35:57,654] {result_logger:103} INFO - precision on Wake: 0.990
[2024-04-21 18:35:58,077] {result_logger:104} INFO - recall on Wake: 0.985
[2024-04-21 18:35:58,500] {result_logger:107} INFO - F1-score on Wake: 0.987
[2024-04-21 18:35:58,500] {result_logger:108} INFO - 
[2024-04-21 18:35:59,148] {result_logger:103} INFO - precision on Non REM: 0.980
[2024-04-21 18:35:59,559] {result_logger:104} INFO - recall on Non REM: 0.976
[2024-04-21 18:35:59,969] {result_logger:107} INFO - F1-score on Non REM: 0.978
[2024-04-21 18:35:59,969] {result_logger:108} INFO - 
[2024-04-21 18:36:00,567] {result_logger:103} INFO - precision on REM: 0.913
[2024-04-21 18:36:00,932] {result_logger:104} INFO - recall on REM: 0.992
[2024-04-21 18:36:01,297] {result_logger:107} INFO - F1-score on REM: 0.951
[2024-04-21 18:36:01,297] {result_logger:108} INFO - 
[2024-04-21 18:36:01,388] {result_logger:111} INFO - average precision on sleep stages: 0.961
[2024-04-21 18:36:01,478] {result_logger:113} INFO - average recall on sleep stages: 0.984
[2024-04-21 18:36:01,569] {result_logger:115} INFO - average F1-score on sleep stages: 0.972
[2024-04-21 18:36:01,571] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 18:36:01,655] {result_logger:103} INFO - precision on Wake: 0.975
[2024-04-21 18:36:01,705] {result_logger:104} INFO - recall on Wake: 0.982
[2024-04-21 18:36:01,756] {result_logger:107} INFO - F1-score on Wake: 0.979
[2024-04-21 18:36:01,756] {result_logger:108} INFO - 
[2024-04-21 18:36:01,840] {result_logger:103} INFO - precision on Non REM: 0.974
[2024-04-21 18:36:01,890] {result_logger:104} INFO - recall on Non REM: 0.950
[2024-04-21 18:36:01,941] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2024-04-21 18:36:01,941] {result_logger:108} INFO - 
[2024-04-21 18:36:02,023] {result_logger:103} INFO - precision on REM: 0.858
[2024-04-21 18:36:02,072] {result_logger:104} INFO - recall on REM: 0.959
[2024-04-21 18:36:02,122] {result_logger:107} INFO - F1-score on REM: 0.906
[2024-04-21 18:36:02,122] {result_logger:108} INFO - 
[2024-04-21 18:36:02,132] {result_logger:111} INFO - average precision on sleep stages: 0.936
[2024-04-21 18:36:02,141] {result_logger:113} INFO - average recall on sleep stages: 0.964
[2024-04-21 18:36:02,151] {result_logger:115} INFO - average F1-score on sleep stages: 0.949
[2024-04-21 18:36:02,152] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 18:36:02,214] {result_logger:134} INFO - 
[[200687   2782    278]
 [  2006 140287   1474]
 [    40    110  18456]]
[2024-04-21 18:36:02,277] {result_logger:141} INFO - 
[[ 98.50%   1.37%   0.14%]
 [  1.40%  97.58%   1.03%]
 [  0.21%   0.59%  99.19%]]
[2024-04-21 18:36:02,340] {result_logger:145} INFO - 
[[ 98.99%   1.94%   1.38%]
 [  0.99%  97.98%   7.29%]
 [  0.02%   0.08%  91.33%]]
[2024-04-21 18:36:02,340] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 18:36:02,346] {result_logger:134} INFO - 
[[27881   443    58]
 [  687 19671   345]
 [   19    85  2441]]
[2024-04-21 18:36:02,442] {result_logger:141} INFO - 
[[ 98.23%   1.56%   0.20%]
 [  3.32%  95.02%   1.67%]
 [  0.75%   3.34%  95.91%]]
[2024-04-21 18:36:02,532] {result_logger:145} INFO - 
[[ 97.53%   2.19%   2.04%]
 [  2.40%  97.39%  12.13%]
 [  0.07%   0.42%  85.83%]]
[2024-04-21 18:36:02,887] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 18:36:02,887] {result_logger:77} INFO - actual:
[2024-04-21 18:36:02,887] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 18:36:02,887] {result_logger:79} INFO - predicted:
[2024-04-21 18:36:02,887] {result_logger:80} INFO - 
[[95.08%  4.81%  0.11%]
 [ 4.73% 92.51%  2.76%]
 [15.86%  4.85% 79.29%]]
[2024-04-21 18:36:02,944] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp005/model_8conv_2fc-best.pth
[2024-04-21 18:36:02,944] {run_experiment:112} INFO - [epoch  31] execution time: 152.31s	 avg f1-score: 0.9489

[2024-04-21 18:36:02,944] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:36:02,972] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:36:20,756] {train_model:82} INFO - Train Epoch: 32 [36352/366120 (10%)]	lr:7.71e-05	Loss: 0.038051
[2024-04-21 18:36:34,245] {train_model:82} INFO - Train Epoch: 32 [72960/366120 (20%)]	lr:7.71e-05	Loss: 0.096536
[2024-04-21 18:36:47,773] {train_model:82} INFO - Train Epoch: 32 [109568/366120 (30%)]	lr:7.71e-05	Loss: 0.057092
[2024-04-21 18:37:01,335] {train_model:82} INFO - Train Epoch: 32 [146176/366120 (40%)]	lr:7.71e-05	Loss: 0.032785
[2024-04-21 18:37:14,917] {train_model:82} INFO - Train Epoch: 32 [182784/366120 (50%)]	lr:7.71e-05	Loss: 0.040820
[2024-04-21 18:37:28,485] {train_model:82} INFO - Train Epoch: 32 [219392/366120 (60%)]	lr:7.71e-05	Loss: 0.035174
[2024-04-21 18:37:42,092] {train_model:82} INFO - Train Epoch: 32 [256000/366120 (70%)]	lr:7.71e-05	Loss: 0.029914
[2024-04-21 18:37:55,721] {train_model:82} INFO - Train Epoch: 32 [292608/366120 (80%)]	lr:7.71e-05	Loss: 0.039621
[2024-04-21 18:38:09,409] {train_model:82} INFO - Train Epoch: 32 [329216/366120 (90%)]	lr:7.71e-05	Loss: 0.028675
[2024-04-21 18:38:23,103] {train_model:82} INFO - Train Epoch: 32 [365824/366120 (100%)]	lr:7.71e-05	Loss: 0.041386
[2024-04-21 18:38:28,669] {run_experiment:78} INFO - 
[2024-04-21 18:38:28,670] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 18:38:29,348] {result_logger:103} INFO - precision on Wake: 0.990
[2024-04-21 18:38:29,771] {result_logger:104} INFO - recall on Wake: 0.985
[2024-04-21 18:38:30,194] {result_logger:107} INFO - F1-score on Wake: 0.988
[2024-04-21 18:38:30,195] {result_logger:108} INFO - 
[2024-04-21 18:38:30,848] {result_logger:103} INFO - precision on Non REM: 0.980
[2024-04-21 18:38:31,264] {result_logger:104} INFO - recall on Non REM: 0.977
[2024-04-21 18:38:31,676] {result_logger:107} INFO - F1-score on Non REM: 0.979
[2024-04-21 18:38:31,676] {result_logger:108} INFO - 
[2024-04-21 18:38:32,284] {result_logger:103} INFO - precision on REM: 0.921
[2024-04-21 18:38:32,648] {result_logger:104} INFO - recall on REM: 0.992
[2024-04-21 18:38:33,015] {result_logger:107} INFO - F1-score on REM: 0.955
[2024-04-21 18:38:33,015] {result_logger:108} INFO - 
[2024-04-21 18:38:33,111] {result_logger:111} INFO - average precision on sleep stages: 0.964
[2024-04-21 18:38:33,207] {result_logger:113} INFO - average recall on sleep stages: 0.985
[2024-04-21 18:38:33,303] {result_logger:115} INFO - average F1-score on sleep stages: 0.974
[2024-04-21 18:38:33,305] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 18:38:33,390] {result_logger:103} INFO - precision on Wake: 0.976
[2024-04-21 18:38:33,440] {result_logger:104} INFO - recall on Wake: 0.980
[2024-04-21 18:38:33,491] {result_logger:107} INFO - F1-score on Wake: 0.978
[2024-04-21 18:38:33,491] {result_logger:108} INFO - 
[2024-04-21 18:38:33,574] {result_logger:103} INFO - precision on Non REM: 0.972
[2024-04-21 18:38:33,625] {result_logger:104} INFO - recall on Non REM: 0.948
[2024-04-21 18:38:33,676] {result_logger:107} INFO - F1-score on Non REM: 0.960
[2024-04-21 18:38:33,676] {result_logger:108} INFO - 
[2024-04-21 18:38:33,759] {result_logger:103} INFO - precision on REM: 0.834
[2024-04-21 18:38:33,808] {result_logger:104} INFO - recall on REM: 0.967
[2024-04-21 18:38:33,859] {result_logger:107} INFO - F1-score on REM: 0.895
[2024-04-21 18:38:33,859] {result_logger:108} INFO - 
[2024-04-21 18:38:33,868] {result_logger:111} INFO - average precision on sleep stages: 0.927
[2024-04-21 18:38:33,878] {result_logger:113} INFO - average recall on sleep stages: 0.965
[2024-04-21 18:38:33,889] {result_logger:115} INFO - average F1-score on sleep stages: 0.944
[2024-04-21 18:38:33,889] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 18:38:33,956] {result_logger:134} INFO - 
[[200741   2752    254]
 [  1921 140507   1339]
 [    31    119  18456]]
[2024-04-21 18:38:34,022] {result_logger:141} INFO - 
[[ 98.52%   1.35%   0.12%]
 [  1.34%  97.73%   0.93%]
 [  0.17%   0.64%  99.19%]]
[2024-04-21 18:38:34,087] {result_logger:145} INFO - 
[[ 99.04%   1.92%   1.27%]
 [  0.95%  98.00%   6.68%]
 [  0.02%   0.08%  92.05%]]
[2024-04-21 18:38:34,087] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 18:38:34,094] {result_logger:134} INFO - 
[[27807   503    72]
 [  665 19619   419]
 [   18    67  2460]]
[2024-04-21 18:38:34,101] {result_logger:141} INFO - 
[[ 97.97%   1.77%   0.25%]
 [  3.21%  94.76%   2.02%]
 [  0.71%   2.63%  96.66%]]
[2024-04-21 18:38:34,108] {result_logger:145} INFO - 
[[ 97.60%   2.49%   2.44%]
 [  2.33%  97.18%  14.20%]
 [  0.06%   0.33%  83.36%]]
[2024-04-21 18:38:34,200] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 18:38:34,200] {result_logger:77} INFO - actual:
[2024-04-21 18:38:34,200] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 18:38:34,200] {result_logger:79} INFO - predicted:
[2024-04-21 18:38:34,200] {result_logger:80} INFO - 
[[95.25%  4.63%  0.12%]
 [ 4.53% 92.61%  2.86%]
 [14.88%  5.86% 79.26%]]
[2024-04-21 18:38:34,200] {run_experiment:112} INFO - [epoch  32] execution time: 151.26s	 avg f1-score: 0.9442

[2024-04-21 18:38:34,201] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:38:34,227] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:38:52,103] {train_model:82} INFO - Train Epoch: 33 [36352/366120 (10%)]	lr:7.26e-05	Loss: 0.029557
[2024-04-21 18:39:05,645] {train_model:82} INFO - Train Epoch: 33 [72960/366120 (20%)]	lr:7.26e-05	Loss: 0.014141
[2024-04-21 18:39:19,180] {train_model:82} INFO - Train Epoch: 33 [109568/366120 (30%)]	lr:7.26e-05	Loss: 0.029181
[2024-04-21 18:39:32,719] {train_model:82} INFO - Train Epoch: 33 [146176/366120 (40%)]	lr:7.26e-05	Loss: 0.041295
[2024-04-21 18:39:46,289] {train_model:82} INFO - Train Epoch: 33 [182784/366120 (50%)]	lr:7.26e-05	Loss: 0.041985
[2024-04-21 18:39:59,861] {train_model:82} INFO - Train Epoch: 33 [219392/366120 (60%)]	lr:7.26e-05	Loss: 0.015697
[2024-04-21 18:40:13,445] {train_model:82} INFO - Train Epoch: 33 [256000/366120 (70%)]	lr:7.26e-05	Loss: 0.044376
[2024-04-21 18:40:27,028] {train_model:82} INFO - Train Epoch: 33 [292608/366120 (80%)]	lr:7.26e-05	Loss: 0.062481
[2024-04-21 18:40:40,666] {train_model:82} INFO - Train Epoch: 33 [329216/366120 (90%)]	lr:7.26e-05	Loss: 0.053458
[2024-04-21 18:40:54,276] {train_model:82} INFO - Train Epoch: 33 [365824/366120 (100%)]	lr:7.26e-05	Loss: 0.051379
[2024-04-21 18:40:59,982] {run_experiment:78} INFO - 
[2024-04-21 18:40:59,983] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 18:41:00,652] {result_logger:103} INFO - precision on Wake: 0.991
[2024-04-21 18:41:01,076] {result_logger:104} INFO - recall on Wake: 0.986
[2024-04-21 18:41:01,500] {result_logger:107} INFO - F1-score on Wake: 0.988
[2024-04-21 18:41:01,500] {result_logger:108} INFO - 
[2024-04-21 18:41:02,159] {result_logger:103} INFO - precision on Non REM: 0.981
[2024-04-21 18:41:02,573] {result_logger:104} INFO - recall on Non REM: 0.978
[2024-04-21 18:41:02,986] {result_logger:107} INFO - F1-score on Non REM: 0.980
[2024-04-21 18:41:02,986] {result_logger:108} INFO - 
[2024-04-21 18:41:03,588] {result_logger:103} INFO - precision on REM: 0.925
[2024-04-21 18:41:03,952] {result_logger:104} INFO - recall on REM: 0.993
[2024-04-21 18:41:04,317] {result_logger:107} INFO - F1-score on REM: 0.958
[2024-04-21 18:41:04,317] {result_logger:108} INFO - 
[2024-04-21 18:41:04,410] {result_logger:111} INFO - average precision on sleep stages: 0.966
[2024-04-21 18:41:04,501] {result_logger:113} INFO - average recall on sleep stages: 0.986
[2024-04-21 18:41:04,592] {result_logger:115} INFO - average F1-score on sleep stages: 0.975
[2024-04-21 18:41:04,594] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 18:41:04,678] {result_logger:103} INFO - precision on Wake: 0.979
[2024-04-21 18:41:04,729] {result_logger:104} INFO - recall on Wake: 0.982
[2024-04-21 18:41:04,779] {result_logger:107} INFO - F1-score on Wake: 0.981
[2024-04-21 18:41:04,779] {result_logger:108} INFO - 
[2024-04-21 18:41:04,864] {result_logger:103} INFO - precision on Non REM: 0.973
[2024-04-21 18:41:04,915] {result_logger:104} INFO - recall on Non REM: 0.953
[2024-04-21 18:41:04,966] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2024-04-21 18:41:04,966] {result_logger:108} INFO - 
[2024-04-21 18:41:05,048] {result_logger:103} INFO - precision on REM: 0.848
[2024-04-21 18:41:05,097] {result_logger:104} INFO - recall on REM: 0.960
[2024-04-21 18:41:05,146] {result_logger:107} INFO - F1-score on REM: 0.901
[2024-04-21 18:41:05,146] {result_logger:108} INFO - 
[2024-04-21 18:41:05,157] {result_logger:111} INFO - average precision on sleep stages: 0.933
[2024-04-21 18:41:05,167] {result_logger:113} INFO - average recall on sleep stages: 0.965
[2024-04-21 18:41:05,177] {result_logger:115} INFO - average F1-score on sleep stages: 0.948
[2024-04-21 18:41:05,177] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 18:41:05,240] {result_logger:134} INFO - 
[[200922   2601    224]
 [  1846 140639   1282]
 [    22    103  18481]]
[2024-04-21 18:41:05,303] {result_logger:141} INFO - 
[[ 98.61%   1.28%   0.11%]
 [  1.28%  97.82%   0.89%]
 [  0.12%   0.55%  99.33%]]
[2024-04-21 18:41:05,366] {result_logger:145} INFO - 
[[ 99.08%   1.81%   1.12%]
 [  0.91%  98.11%   6.41%]
 [  0.01%   0.07%  92.47%]]
[2024-04-21 18:41:05,366] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 18:41:05,374] {result_logger:134} INFO - 
[[27872   463    47]
 [  579 19732   392]
 [   15    86  2444]]
[2024-04-21 18:41:05,381] {result_logger:141} INFO - 
[[ 98.20%   1.63%   0.17%]
 [  2.80%  95.31%   1.89%]
 [  0.59%   3.38%  96.03%]]
[2024-04-21 18:41:05,388] {result_logger:145} INFO - 
[[ 97.91%   2.28%   1.63%]
 [  2.03%  97.29%  13.60%]
 [  0.05%   0.42%  84.77%]]
[2024-04-21 18:41:05,479] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 18:41:05,479] {result_logger:77} INFO - actual:
[2024-04-21 18:41:05,479] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 18:41:05,479] {result_logger:79} INFO - predicted:
[2024-04-21 18:41:05,479] {result_logger:80} INFO - 
[[95.33%  4.61%  0.06%]
 [ 4.42% 92.75%  2.83%]
 [15.02%  5.45% 79.54%]]
[2024-04-21 18:41:05,479] {run_experiment:112} INFO - [epoch  33] execution time: 151.28s	 avg f1-score: 0.9480

[2024-04-21 18:41:05,479] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:41:05,507] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:41:23,532] {train_model:82} INFO - Train Epoch: 34 [36352/366120 (10%)]	lr:6.84e-05	Loss: 0.028651
[2024-04-21 18:41:37,087] {train_model:82} INFO - Train Epoch: 34 [72960/366120 (20%)]	lr:6.84e-05	Loss: 0.045521
[2024-04-21 18:41:50,664] {train_model:82} INFO - Train Epoch: 34 [109568/366120 (30%)]	lr:6.84e-05	Loss: 0.035519
[2024-04-21 18:42:04,267] {train_model:82} INFO - Train Epoch: 34 [146176/366120 (40%)]	lr:6.84e-05	Loss: 0.017165
[2024-04-21 18:42:17,901] {train_model:82} INFO - Train Epoch: 34 [182784/366120 (50%)]	lr:6.84e-05	Loss: 0.025345
[2024-04-21 18:42:31,533] {train_model:82} INFO - Train Epoch: 34 [219392/366120 (60%)]	lr:6.84e-05	Loss: 0.019272
[2024-04-21 18:42:45,184] {train_model:82} INFO - Train Epoch: 34 [256000/366120 (70%)]	lr:6.84e-05	Loss: 0.026929
[2024-04-21 18:42:58,859] {train_model:82} INFO - Train Epoch: 34 [292608/366120 (80%)]	lr:6.84e-05	Loss: 0.034493
[2024-04-21 18:43:12,539] {train_model:82} INFO - Train Epoch: 34 [329216/366120 (90%)]	lr:6.84e-05	Loss: 0.024854
[2024-04-21 18:43:26,230] {train_model:82} INFO - Train Epoch: 34 [365824/366120 (100%)]	lr:6.84e-05	Loss: 0.107521
[2024-04-21 18:43:31,766] {run_experiment:78} INFO - 
[2024-04-21 18:43:31,766] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 18:43:32,420] {result_logger:103} INFO - precision on Wake: 0.991
[2024-04-21 18:43:32,840] {result_logger:104} INFO - recall on Wake: 0.987
[2024-04-21 18:43:33,261] {result_logger:107} INFO - F1-score on Wake: 0.989
[2024-04-21 18:43:33,261] {result_logger:108} INFO - 
[2024-04-21 18:43:33,915] {result_logger:103} INFO - precision on Non REM: 0.982
[2024-04-21 18:43:34,322] {result_logger:104} INFO - recall on Non REM: 0.980
[2024-04-21 18:43:34,732] {result_logger:107} INFO - F1-score on Non REM: 0.981
[2024-04-21 18:43:34,732] {result_logger:108} INFO - 
[2024-04-21 18:43:35,319] {result_logger:103} INFO - precision on REM: 0.928
[2024-04-21 18:43:35,683] {result_logger:104} INFO - recall on REM: 0.993
[2024-04-21 18:43:36,048] {result_logger:107} INFO - F1-score on REM: 0.960
[2024-04-21 18:43:36,049] {result_logger:108} INFO - 
[2024-04-21 18:43:36,137] {result_logger:111} INFO - average precision on sleep stages: 0.967
[2024-04-21 18:43:36,226] {result_logger:113} INFO - average recall on sleep stages: 0.987
[2024-04-21 18:43:36,316] {result_logger:115} INFO - average F1-score on sleep stages: 0.977
[2024-04-21 18:43:36,317] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 18:43:36,399] {result_logger:103} INFO - precision on Wake: 0.972
[2024-04-21 18:43:36,450] {result_logger:104} INFO - recall on Wake: 0.985
[2024-04-21 18:43:36,500] {result_logger:107} INFO - F1-score on Wake: 0.978
[2024-04-21 18:43:36,501] {result_logger:108} INFO - 
[2024-04-21 18:43:36,585] {result_logger:103} INFO - precision on Non REM: 0.975
[2024-04-21 18:43:36,636] {result_logger:104} INFO - recall on Non REM: 0.948
[2024-04-21 18:43:36,687] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2024-04-21 18:43:36,687] {result_logger:108} INFO - 
[2024-04-21 18:43:36,767] {result_logger:103} INFO - precision on REM: 0.882
[2024-04-21 18:43:36,816] {result_logger:104} INFO - recall on REM: 0.945
[2024-04-21 18:43:36,865] {result_logger:107} INFO - F1-score on REM: 0.912
[2024-04-21 18:43:36,865] {result_logger:108} INFO - 
[2024-04-21 18:43:36,875] {result_logger:111} INFO - average precision on sleep stages: 0.943
[2024-04-21 18:43:36,885] {result_logger:113} INFO - average recall on sleep stages: 0.959
[2024-04-21 18:43:36,895] {result_logger:115} INFO - average F1-score on sleep stages: 0.951
[2024-04-21 18:43:36,895] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 18:43:36,957] {result_logger:134} INFO - 
[[201095   2412    240]
 [  1727 140851   1189]
 [    21    101  18484]]
[2024-04-21 18:43:37,017] {result_logger:141} INFO - 
[[ 98.70%   1.18%   0.12%]
 [  1.20%  97.97%   0.83%]
 [  0.11%   0.54%  99.34%]]
[2024-04-21 18:43:37,078] {result_logger:145} INFO - 
[[ 99.14%   1.68%   1.21%]
 [  0.85%  98.25%   5.97%]
 [  0.01%   0.07%  92.82%]]
[2024-04-21 18:43:37,078] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 18:43:37,085] {result_logger:134} INFO - 
[[27953   388    41]
 [  791 19632   280]
 [   18   123  2404]]
[2024-04-21 18:43:37,179] {result_logger:141} INFO - 
[[ 98.49%   1.37%   0.14%]
 [  3.82%  94.83%   1.35%]
 [  0.71%   4.83%  94.46%]]
[2024-04-21 18:43:37,273] {result_logger:145} INFO - 
[[ 97.19%   1.93%   1.50%]
 [  2.75%  97.46%  10.28%]
 [  0.06%   0.61%  88.22%]]
[2024-04-21 18:43:37,532] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 18:43:37,533] {result_logger:77} INFO - actual:
[2024-04-21 18:43:37,533] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 18:43:37,533] {result_logger:79} INFO - predicted:
[2024-04-21 18:43:37,533] {result_logger:80} INFO - 
[[94.83%  5.09%  0.08%]
 [ 5.22% 92.15%  2.63%]
 [15.93%  4.37% 79.71%]]
[2024-04-21 18:43:37,590] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp005/model_8conv_2fc-best.pth
[2024-04-21 18:43:37,590] {run_experiment:112} INFO - [epoch  34] execution time: 152.11s	 avg f1-score: 0.9506

[2024-04-21 18:43:37,590] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:43:37,617] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:43:55,465] {train_model:82} INFO - Train Epoch: 35 [36352/366120 (10%)]	lr:6.44e-05	Loss: 0.048751
[2024-04-21 18:44:08,951] {train_model:82} INFO - Train Epoch: 35 [72960/366120 (20%)]	lr:6.44e-05	Loss: 0.019309
[2024-04-21 18:44:22,473] {train_model:82} INFO - Train Epoch: 35 [109568/366120 (30%)]	lr:6.44e-05	Loss: 0.025566
[2024-04-21 18:44:36,026] {train_model:82} INFO - Train Epoch: 35 [146176/366120 (40%)]	lr:6.44e-05	Loss: 0.187483
[2024-04-21 18:44:49,604] {train_model:82} INFO - Train Epoch: 35 [182784/366120 (50%)]	lr:6.44e-05	Loss: 0.022310
[2024-04-21 18:45:03,192] {train_model:82} INFO - Train Epoch: 35 [219392/366120 (60%)]	lr:6.44e-05	Loss: 0.020527
[2024-04-21 18:45:16,787] {train_model:82} INFO - Train Epoch: 35 [256000/366120 (70%)]	lr:6.44e-05	Loss: 0.017457
[2024-04-21 18:45:30,387] {train_model:82} INFO - Train Epoch: 35 [292608/366120 (80%)]	lr:6.44e-05	Loss: 0.060437
[2024-04-21 18:45:43,994] {train_model:82} INFO - Train Epoch: 35 [329216/366120 (90%)]	lr:6.44e-05	Loss: 0.042320
[2024-04-21 18:45:57,595] {train_model:82} INFO - Train Epoch: 35 [365824/366120 (100%)]	lr:6.44e-05	Loss: 0.027701
[2024-04-21 18:46:03,369] {run_experiment:78} INFO - 
[2024-04-21 18:46:03,370] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 18:46:04,024] {result_logger:103} INFO - precision on Wake: 0.992
[2024-04-21 18:46:04,448] {result_logger:104} INFO - recall on Wake: 0.987
[2024-04-21 18:46:04,873] {result_logger:107} INFO - F1-score on Wake: 0.989
[2024-04-21 18:46:04,874] {result_logger:108} INFO - 
[2024-04-21 18:46:05,528] {result_logger:103} INFO - precision on Non REM: 0.982
[2024-04-21 18:46:05,940] {result_logger:104} INFO - recall on Non REM: 0.981
[2024-04-21 18:46:06,353] {result_logger:107} INFO - F1-score on Non REM: 0.982
[2024-04-21 18:46:06,354] {result_logger:108} INFO - 
[2024-04-21 18:46:06,935] {result_logger:103} INFO - precision on REM: 0.934
[2024-04-21 18:46:07,300] {result_logger:104} INFO - recall on REM: 0.994
[2024-04-21 18:46:07,665] {result_logger:107} INFO - F1-score on REM: 0.963
[2024-04-21 18:46:07,665] {result_logger:108} INFO - 
[2024-04-21 18:46:07,757] {result_logger:111} INFO - average precision on sleep stages: 0.969
[2024-04-21 18:46:07,849] {result_logger:113} INFO - average recall on sleep stages: 0.987
[2024-04-21 18:46:07,941] {result_logger:115} INFO - average F1-score on sleep stages: 0.978
[2024-04-21 18:46:07,943] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 18:46:08,024] {result_logger:103} INFO - precision on Wake: 0.979
[2024-04-21 18:46:08,075] {result_logger:104} INFO - recall on Wake: 0.982
[2024-04-21 18:46:08,125] {result_logger:107} INFO - F1-score on Wake: 0.981
[2024-04-21 18:46:08,125] {result_logger:108} INFO - 
[2024-04-21 18:46:08,210] {result_logger:103} INFO - precision on Non REM: 0.973
[2024-04-21 18:46:08,261] {result_logger:104} INFO - recall on Non REM: 0.957
[2024-04-21 18:46:08,312] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2024-04-21 18:46:08,312] {result_logger:108} INFO - 
[2024-04-21 18:46:08,392] {result_logger:103} INFO - precision on REM: 0.870
[2024-04-21 18:46:08,442] {result_logger:104} INFO - recall on REM: 0.949
[2024-04-21 18:46:08,492] {result_logger:107} INFO - F1-score on REM: 0.908
[2024-04-21 18:46:08,492] {result_logger:108} INFO - 
[2024-04-21 18:46:08,502] {result_logger:111} INFO - average precision on sleep stages: 0.941
[2024-04-21 18:46:08,512] {result_logger:113} INFO - average recall on sleep stages: 0.963
[2024-04-21 18:46:08,522] {result_logger:115} INFO - average F1-score on sleep stages: 0.951
[2024-04-21 18:46:08,522] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 18:46:08,586] {result_logger:134} INFO - 
[[201102   2441    204]
 [  1653 141002   1112]
 [    24     83  18499]]
[2024-04-21 18:46:08,649] {result_logger:141} INFO - 
[[ 98.70%   1.20%   0.10%]
 [  1.15%  98.08%   0.77%]
 [  0.13%   0.45%  99.42%]]
[2024-04-21 18:46:08,712] {result_logger:145} INFO - 
[[ 99.17%   1.70%   1.03%]
 [  0.82%  98.24%   5.61%]
 [  0.01%   0.06%  93.36%]]
[2024-04-21 18:46:08,712] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 18:46:08,719] {result_logger:134} INFO - 
[[27879   448    55]
 [  581 19817   305]
 [   17   112  2416]]
[2024-04-21 18:46:08,815] {result_logger:141} INFO - 
[[ 98.23%   1.58%   0.19%]
 [  2.81%  95.72%   1.47%]
 [  0.67%   4.40%  94.93%]]
[2024-04-21 18:46:08,905] {result_logger:145} INFO - 
[[ 97.90%   2.20%   1.98%]
 [  2.04%  97.25%  10.99%]
 [  0.06%   0.55%  87.03%]]
[2024-04-21 18:46:09,167] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 18:46:09,167] {result_logger:77} INFO - actual:
[2024-04-21 18:46:09,167] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 18:46:09,167] {result_logger:79} INFO - predicted:
[2024-04-21 18:46:09,167] {result_logger:80} INFO - 
[[95.22%  4.67%  0.11%]
 [ 4.54% 92.82%  2.64%]
 [15.74%  4.76% 79.50%]]
[2024-04-21 18:46:09,223] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp005/model_8conv_2fc-best.pth
[2024-04-21 18:46:09,224] {run_experiment:112} INFO - [epoch  35] execution time: 151.63s	 avg f1-score: 0.9512

[2024-04-21 18:46:09,224] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:46:09,250] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:46:27,065] {train_model:82} INFO - Train Epoch: 36 [36352/366120 (10%)]	lr:6.07e-05	Loss: 0.039465
[2024-04-21 18:46:40,621] {train_model:82} INFO - Train Epoch: 36 [72960/366120 (20%)]	lr:6.07e-05	Loss: 0.045694
[2024-04-21 18:46:54,197] {train_model:82} INFO - Train Epoch: 36 [109568/366120 (30%)]	lr:6.07e-05	Loss: 0.024797
[2024-04-21 18:47:07,808] {train_model:82} INFO - Train Epoch: 36 [146176/366120 (40%)]	lr:6.07e-05	Loss: 0.026723
[2024-04-21 18:47:21,472] {train_model:82} INFO - Train Epoch: 36 [182784/366120 (50%)]	lr:6.07e-05	Loss: 0.054163
[2024-04-21 18:47:35,179] {train_model:82} INFO - Train Epoch: 36 [219392/366120 (60%)]	lr:6.07e-05	Loss: 0.045239
[2024-04-21 18:47:48,933] {train_model:82} INFO - Train Epoch: 36 [256000/366120 (70%)]	lr:6.07e-05	Loss: 0.054905
[2024-04-21 18:48:02,666] {train_model:82} INFO - Train Epoch: 36 [292608/366120 (80%)]	lr:6.07e-05	Loss: 0.044236
[2024-04-21 18:48:16,364] {train_model:82} INFO - Train Epoch: 36 [329216/366120 (90%)]	lr:6.07e-05	Loss: 0.031750
[2024-04-21 18:48:30,044] {train_model:82} INFO - Train Epoch: 36 [365824/366120 (100%)]	lr:6.07e-05	Loss: 0.063427
[2024-04-21 18:48:35,809] {run_experiment:78} INFO - 
[2024-04-21 18:48:35,809] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 18:48:36,454] {result_logger:103} INFO - precision on Wake: 0.992
[2024-04-21 18:48:36,863] {result_logger:104} INFO - recall on Wake: 0.988
[2024-04-21 18:48:37,273] {result_logger:107} INFO - F1-score on Wake: 0.990
[2024-04-21 18:48:37,273] {result_logger:108} INFO - 
[2024-04-21 18:48:37,906] {result_logger:103} INFO - precision on Non REM: 0.984
[2024-04-21 18:48:38,304] {result_logger:104} INFO - recall on Non REM: 0.982
[2024-04-21 18:48:38,703] {result_logger:107} INFO - F1-score on Non REM: 0.983
[2024-04-21 18:48:38,703] {result_logger:108} INFO - 
[2024-04-21 18:48:39,286] {result_logger:103} INFO - precision on REM: 0.939
[2024-04-21 18:48:39,640] {result_logger:104} INFO - recall on REM: 0.995
[2024-04-21 18:48:39,992] {result_logger:107} INFO - F1-score on REM: 0.966
[2024-04-21 18:48:39,992] {result_logger:108} INFO - 
[2024-04-21 18:48:40,083] {result_logger:111} INFO - average precision on sleep stages: 0.972
[2024-04-21 18:48:40,171] {result_logger:113} INFO - average recall on sleep stages: 0.988
[2024-04-21 18:48:40,259] {result_logger:115} INFO - average F1-score on sleep stages: 0.980
[2024-04-21 18:48:40,260] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 18:48:40,343] {result_logger:103} INFO - precision on Wake: 0.973
[2024-04-21 18:48:40,392] {result_logger:104} INFO - recall on Wake: 0.981
[2024-04-21 18:48:40,441] {result_logger:107} INFO - F1-score on Wake: 0.977
[2024-04-21 18:48:40,441] {result_logger:108} INFO - 
[2024-04-21 18:48:40,523] {result_logger:103} INFO - precision on Non REM: 0.972
[2024-04-21 18:48:40,574] {result_logger:104} INFO - recall on Non REM: 0.944
[2024-04-21 18:48:40,624] {result_logger:107} INFO - F1-score on Non REM: 0.958
[2024-04-21 18:48:40,624] {result_logger:108} INFO - 
[2024-04-21 18:48:40,705] {result_logger:103} INFO - precision on REM: 0.834
[2024-04-21 18:48:40,752] {result_logger:104} INFO - recall on REM: 0.964
[2024-04-21 18:48:40,800] {result_logger:107} INFO - F1-score on REM: 0.894
[2024-04-21 18:48:40,800] {result_logger:108} INFO - 
[2024-04-21 18:48:40,810] {result_logger:111} INFO - average precision on sleep stages: 0.927
[2024-04-21 18:48:40,821] {result_logger:113} INFO - average recall on sleep stages: 0.963
[2024-04-21 18:48:40,831] {result_logger:115} INFO - average F1-score on sleep stages: 0.943
[2024-04-21 18:48:40,831] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 18:48:40,892] {result_logger:134} INFO - 
[[201297   2262    188]
 [  1629 141133   1005]
 [    22     75  18509]]
[2024-04-21 18:48:40,953] {result_logger:141} INFO - 
[[ 98.80%   1.11%   0.09%]
 [  1.13%  98.17%   0.70%]
 [  0.12%   0.40%  99.48%]]
[2024-04-21 18:48:41,013] {result_logger:145} INFO - 
[[ 99.19%   1.58%   0.95%]
 [  0.80%  98.37%   5.10%]
 [  0.01%   0.05%  93.94%]]
[2024-04-21 18:48:41,013] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 18:48:41,020] {result_logger:134} INFO - 
[[27836   478    68]
 [  742 19542   419]
 [   16    76  2453]]
[2024-04-21 18:48:41,028] {result_logger:141} INFO - 
[[ 98.08%   1.68%   0.24%]
 [  3.58%  94.39%   2.02%]
 [  0.63%   2.99%  96.39%]]
[2024-04-21 18:48:41,035] {result_logger:145} INFO - 
[[ 97.35%   2.38%   2.31%]
 [  2.59%  97.24%  14.25%]
 [  0.06%   0.38%  83.44%]]
[2024-04-21 18:48:41,128] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 18:48:41,128] {result_logger:77} INFO - actual:
[2024-04-21 18:48:41,128] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 18:48:41,128] {result_logger:79} INFO - predicted:
[2024-04-21 18:48:41,128] {result_logger:80} INFO - 
[[94.95%  4.92%  0.13%]
 [ 4.93% 92.21%  2.87%]
 [15.41%  5.41% 79.18%]]
[2024-04-21 18:48:41,128] {run_experiment:112} INFO - [epoch  36] execution time: 151.90s	 avg f1-score: 0.9432

[2024-04-21 18:48:41,128] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:48:41,154] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:48:59,334] {train_model:82} INFO - Train Epoch: 37 [36352/366120 (10%)]	lr:5.71e-05	Loss: 0.014198
[2024-04-21 18:49:12,884] {train_model:82} INFO - Train Epoch: 37 [72960/366120 (20%)]	lr:5.71e-05	Loss: 0.084279
[2024-04-21 18:49:26,483] {train_model:82} INFO - Train Epoch: 37 [109568/366120 (30%)]	lr:5.71e-05	Loss: 0.031288
[2024-04-21 18:49:40,106] {train_model:82} INFO - Train Epoch: 37 [146176/366120 (40%)]	lr:5.71e-05	Loss: 0.017450
[2024-04-21 18:49:53,744] {train_model:82} INFO - Train Epoch: 37 [182784/366120 (50%)]	lr:5.71e-05	Loss: 0.014673
[2024-04-21 18:50:07,389] {train_model:82} INFO - Train Epoch: 37 [219392/366120 (60%)]	lr:5.71e-05	Loss: 0.040778
[2024-04-21 18:50:21,038] {train_model:82} INFO - Train Epoch: 37 [256000/366120 (70%)]	lr:5.71e-05	Loss: 0.022872
[2024-04-21 18:50:34,661] {train_model:82} INFO - Train Epoch: 37 [292608/366120 (80%)]	lr:5.71e-05	Loss: 0.080411
[2024-04-21 18:50:48,309] {train_model:82} INFO - Train Epoch: 37 [329216/366120 (90%)]	lr:5.71e-05	Loss: 0.044519
[2024-04-21 18:51:01,935] {train_model:82} INFO - Train Epoch: 37 [365824/366120 (100%)]	lr:5.71e-05	Loss: 0.036268
[2024-04-21 18:51:07,342] {run_experiment:78} INFO - 
[2024-04-21 18:51:07,342] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 18:51:07,990] {result_logger:103} INFO - precision on Wake: 0.993
[2024-04-21 18:51:08,397] {result_logger:104} INFO - recall on Wake: 0.988
[2024-04-21 18:51:08,802] {result_logger:107} INFO - F1-score on Wake: 0.990
[2024-04-21 18:51:08,802] {result_logger:108} INFO - 
[2024-04-21 18:51:09,434] {result_logger:103} INFO - precision on Non REM: 0.984
[2024-04-21 18:51:09,833] {result_logger:104} INFO - recall on Non REM: 0.983
[2024-04-21 18:51:10,235] {result_logger:107} INFO - F1-score on Non REM: 0.984
[2024-04-21 18:51:10,236] {result_logger:108} INFO - 
[2024-04-21 18:51:10,817] {result_logger:103} INFO - precision on REM: 0.942
[2024-04-21 18:51:11,170] {result_logger:104} INFO - recall on REM: 0.995
[2024-04-21 18:51:11,522] {result_logger:107} INFO - F1-score on REM: 0.967
[2024-04-21 18:51:11,522] {result_logger:108} INFO - 
[2024-04-21 18:51:11,614] {result_logger:111} INFO - average precision on sleep stages: 0.973
[2024-04-21 18:51:11,706] {result_logger:113} INFO - average recall on sleep stages: 0.989
[2024-04-21 18:51:11,797] {result_logger:115} INFO - average F1-score on sleep stages: 0.980
[2024-04-21 18:51:11,799] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 18:51:11,882] {result_logger:103} INFO - precision on Wake: 0.978
[2024-04-21 18:51:11,931] {result_logger:104} INFO - recall on Wake: 0.982
[2024-04-21 18:51:11,980] {result_logger:107} INFO - F1-score on Wake: 0.980
[2024-04-21 18:51:11,980] {result_logger:108} INFO - 
[2024-04-21 18:51:12,062] {result_logger:103} INFO - precision on Non REM: 0.973
[2024-04-21 18:51:12,111] {result_logger:104} INFO - recall on Non REM: 0.954
[2024-04-21 18:51:12,162] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2024-04-21 18:51:12,162] {result_logger:108} INFO - 
[2024-04-21 18:51:12,242] {result_logger:103} INFO - precision on REM: 0.858
[2024-04-21 18:51:12,290] {result_logger:104} INFO - recall on REM: 0.957
[2024-04-21 18:51:12,337] {result_logger:107} INFO - F1-score on REM: 0.905
[2024-04-21 18:51:12,337] {result_logger:108} INFO - 
[2024-04-21 18:51:12,347] {result_logger:111} INFO - average precision on sleep stages: 0.936
[2024-04-21 18:51:12,358] {result_logger:113} INFO - average recall on sleep stages: 0.964
[2024-04-21 18:51:12,368] {result_logger:115} INFO - average F1-score on sleep stages: 0.949
[2024-04-21 18:51:12,368] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 18:51:12,432] {result_logger:134} INFO - 
[[201347   2215    185]
 [  1470 141334    963]
 [    22     79  18505]]
[2024-04-21 18:51:12,495] {result_logger:141} INFO - 
[[ 98.82%   1.09%   0.09%]
 [  1.02%  98.31%   0.67%]
 [  0.12%   0.42%  99.46%]]
[2024-04-21 18:51:12,557] {result_logger:145} INFO - 
[[ 99.26%   1.54%   0.94%]
 [  0.72%  98.40%   4.90%]
 [  0.01%   0.06%  94.16%]]
[2024-04-21 18:51:12,557] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 18:51:12,564] {result_logger:134} INFO - 
[[27862   466    54]
 [  608 19745   350]
 [   19    90  2436]]
[2024-04-21 18:51:12,572] {result_logger:141} INFO - 
[[ 98.17%   1.64%   0.19%]
 [  2.94%  95.37%   1.69%]
 [  0.75%   3.54%  95.72%]]
[2024-04-21 18:51:12,579] {result_logger:145} INFO - 
[[ 97.80%   2.30%   1.90%]
 [  2.13%  97.26%  12.32%]
 [  0.07%   0.44%  85.77%]]
[2024-04-21 18:51:12,669] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 18:51:12,670] {result_logger:77} INFO - actual:
[2024-04-21 18:51:12,670] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 18:51:12,670] {result_logger:79} INFO - predicted:
[2024-04-21 18:51:12,670] {result_logger:80} INFO - 
[[95.27%  4.63%  0.11%]
 [ 4.46% 92.81%  2.72%]
 [15.56%  4.96% 79.47%]]
[2024-04-21 18:51:12,670] {run_experiment:112} INFO - [epoch  37] execution time: 151.54s	 avg f1-score: 0.9492

[2024-04-21 18:51:12,670] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:51:12,696] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:51:30,552] {train_model:82} INFO - Train Epoch: 38 [36352/366120 (10%)]	lr:5.38e-05	Loss: 0.025277
[2024-04-21 18:51:43,984] {train_model:82} INFO - Train Epoch: 38 [72960/366120 (20%)]	lr:5.38e-05	Loss: 0.025153
[2024-04-21 18:51:57,445] {train_model:82} INFO - Train Epoch: 38 [109568/366120 (30%)]	lr:5.38e-05	Loss: 0.013419
[2024-04-21 18:52:10,931] {train_model:82} INFO - Train Epoch: 38 [146176/366120 (40%)]	lr:5.38e-05	Loss: 0.023046
[2024-04-21 18:52:24,428] {train_model:82} INFO - Train Epoch: 38 [182784/366120 (50%)]	lr:5.38e-05	Loss: 0.044697
[2024-04-21 18:52:37,937] {train_model:82} INFO - Train Epoch: 38 [219392/366120 (60%)]	lr:5.38e-05	Loss: 0.039319
[2024-04-21 18:52:51,458] {train_model:82} INFO - Train Epoch: 38 [256000/366120 (70%)]	lr:5.38e-05	Loss: 0.016904
[2024-04-21 18:53:05,000] {train_model:82} INFO - Train Epoch: 38 [292608/366120 (80%)]	lr:5.38e-05	Loss: 0.041832
[2024-04-21 18:53:18,565] {train_model:82} INFO - Train Epoch: 38 [329216/366120 (90%)]	lr:5.38e-05	Loss: 0.027633
[2024-04-21 18:53:32,129] {train_model:82} INFO - Train Epoch: 38 [365824/366120 (100%)]	lr:5.38e-05	Loss: 0.017407
[2024-04-21 18:53:38,114] {run_experiment:78} INFO - 
[2024-04-21 18:53:38,114] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 18:53:38,760] {result_logger:103} INFO - precision on Wake: 0.993
[2024-04-21 18:53:39,169] {result_logger:104} INFO - recall on Wake: 0.989
[2024-04-21 18:53:39,578] {result_logger:107} INFO - F1-score on Wake: 0.991
[2024-04-21 18:53:39,578] {result_logger:108} INFO - 
[2024-04-21 18:53:40,206] {result_logger:103} INFO - precision on Non REM: 0.985
[2024-04-21 18:53:40,605] {result_logger:104} INFO - recall on Non REM: 0.984
[2024-04-21 18:53:41,003] {result_logger:107} INFO - F1-score on Non REM: 0.984
[2024-04-21 18:53:41,003] {result_logger:108} INFO - 
[2024-04-21 18:53:41,583] {result_logger:103} INFO - precision on REM: 0.945
[2024-04-21 18:53:41,936] {result_logger:104} INFO - recall on REM: 0.994
[2024-04-21 18:53:42,288] {result_logger:107} INFO - F1-score on REM: 0.969
[2024-04-21 18:53:42,288] {result_logger:108} INFO - 
[2024-04-21 18:53:42,378] {result_logger:111} INFO - average precision on sleep stages: 0.974
[2024-04-21 18:53:42,467] {result_logger:113} INFO - average recall on sleep stages: 0.989
[2024-04-21 18:53:42,556] {result_logger:115} INFO - average F1-score on sleep stages: 0.981
[2024-04-21 18:53:42,558] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 18:53:42,640] {result_logger:103} INFO - precision on Wake: 0.975
[2024-04-21 18:53:42,689] {result_logger:104} INFO - recall on Wake: 0.981
[2024-04-21 18:53:42,739] {result_logger:107} INFO - F1-score on Wake: 0.978
[2024-04-21 18:53:42,739] {result_logger:108} INFO - 
[2024-04-21 18:53:42,821] {result_logger:103} INFO - precision on Non REM: 0.971
[2024-04-21 18:53:42,872] {result_logger:104} INFO - recall on Non REM: 0.952
[2024-04-21 18:53:42,922] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2024-04-21 18:53:42,922] {result_logger:108} INFO - 
[2024-04-21 18:53:43,002] {result_logger:103} INFO - precision on REM: 0.869
[2024-04-21 18:53:43,050] {result_logger:104} INFO - recall on REM: 0.947
[2024-04-21 18:53:43,098] {result_logger:107} INFO - F1-score on REM: 0.906
[2024-04-21 18:53:43,098] {result_logger:108} INFO - 
[2024-04-21 18:53:43,108] {result_logger:111} INFO - average precision on sleep stages: 0.938
[2024-04-21 18:53:43,118] {result_logger:113} INFO - average recall on sleep stages: 0.960
[2024-04-21 18:53:43,128] {result_logger:115} INFO - average F1-score on sleep stages: 0.948
[2024-04-21 18:53:43,128] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 18:53:43,191] {result_logger:134} INFO - 
[[201432   2138    177]
 [  1466 141396    905]
 [    27     81  18498]]
[2024-04-21 18:53:43,252] {result_logger:141} INFO - 
[[ 98.86%   1.05%   0.09%]
 [  1.02%  98.35%   0.63%]
 [  0.15%   0.44%  99.42%]]
[2024-04-21 18:53:43,313] {result_logger:145} INFO - 
[[ 99.26%   1.49%   0.90%]
 [  0.72%  98.45%   4.62%]
 [  0.01%   0.06%  94.47%]]
[2024-04-21 18:53:43,313] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 18:53:43,320] {result_logger:134} INFO - 
[[27848   482    52]
 [  682 19709   312]
 [   22   114  2409]]
[2024-04-21 18:53:43,327] {result_logger:141} INFO - 
[[ 98.12%   1.70%   0.18%]
 [  3.29%  95.20%   1.51%]
 [  0.86%   4.48%  94.66%]]
[2024-04-21 18:53:43,335] {result_logger:145} INFO - 
[[ 97.53%   2.37%   1.88%]
 [  2.39%  97.06%  11.25%]
 [  0.08%   0.56%  86.87%]]
[2024-04-21 18:53:43,426] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 18:53:43,426] {result_logger:77} INFO - actual:
[2024-04-21 18:53:43,427] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 18:53:43,427] {result_logger:79} INFO - predicted:
[2024-04-21 18:53:43,427] {result_logger:80} INFO - 
[[95.15%  4.74%  0.11%]
 [ 4.67% 92.60%  2.73%]
 [15.72%  5.37% 78.90%]]
[2024-04-21 18:53:43,427] {run_experiment:112} INFO - [epoch  38] execution time: 150.76s	 avg f1-score: 0.9485

[2024-04-21 18:53:43,427] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:53:43,453] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:54:01,744] {train_model:82} INFO - Train Epoch: 39 [36352/366120 (10%)]	lr:5.07e-05	Loss: 0.026724
[2024-04-21 18:54:17,696] {train_model:82} INFO - Train Epoch: 39 [72960/366120 (20%)]	lr:5.07e-05	Loss: 0.036227
[2024-04-21 18:54:34,362] {train_model:82} INFO - Train Epoch: 39 [109568/366120 (30%)]	lr:5.07e-05	Loss: 0.027180
[2024-04-21 18:54:51,195] {train_model:82} INFO - Train Epoch: 39 [146176/366120 (40%)]	lr:5.07e-05	Loss: 0.020358
[2024-04-21 18:55:08,078] {train_model:82} INFO - Train Epoch: 39 [182784/366120 (50%)]	lr:5.07e-05	Loss: 0.017213
[2024-04-21 18:55:24,714] {train_model:82} INFO - Train Epoch: 39 [219392/366120 (60%)]	lr:5.07e-05	Loss: 0.025299
[2024-04-21 18:55:41,526] {train_model:82} INFO - Train Epoch: 39 [256000/366120 (70%)]	lr:5.07e-05	Loss: 0.027650
[2024-04-21 18:55:58,242] {train_model:82} INFO - Train Epoch: 39 [292608/366120 (80%)]	lr:5.07e-05	Loss: 0.017471
[2024-04-21 18:56:14,978] {train_model:82} INFO - Train Epoch: 39 [329216/366120 (90%)]	lr:5.07e-05	Loss: 0.030683
[2024-04-21 18:56:31,831] {train_model:82} INFO - Train Epoch: 39 [365824/366120 (100%)]	lr:5.07e-05	Loss: 0.017790
[2024-04-21 18:56:38,357] {run_experiment:78} INFO - 
[2024-04-21 18:56:38,358] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 18:56:39,073] {result_logger:103} INFO - precision on Wake: 0.993
[2024-04-21 18:56:39,524] {result_logger:104} INFO - recall on Wake: 0.989
[2024-04-21 18:56:39,975] {result_logger:107} INFO - F1-score on Wake: 0.991
[2024-04-21 18:56:39,975] {result_logger:108} INFO - 
[2024-04-21 18:56:40,675] {result_logger:103} INFO - precision on Non REM: 0.985
[2024-04-21 18:56:41,122] {result_logger:104} INFO - recall on Non REM: 0.984
[2024-04-21 18:56:41,570] {result_logger:107} INFO - F1-score on Non REM: 0.985
[2024-04-21 18:56:41,570] {result_logger:108} INFO - 
[2024-04-21 18:56:42,211] {result_logger:103} INFO - precision on REM: 0.949
[2024-04-21 18:56:42,602] {result_logger:104} INFO - recall on REM: 0.995
[2024-04-21 18:56:42,994] {result_logger:107} INFO - F1-score on REM: 0.971
[2024-04-21 18:56:42,994] {result_logger:108} INFO - 
[2024-04-21 18:56:43,097] {result_logger:111} INFO - average precision on sleep stages: 0.976
[2024-04-21 18:56:43,200] {result_logger:113} INFO - average recall on sleep stages: 0.989
[2024-04-21 18:56:43,302] {result_logger:115} INFO - average F1-score on sleep stages: 0.982
[2024-04-21 18:56:43,304] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 18:56:43,395] {result_logger:103} INFO - precision on Wake: 0.976
[2024-04-21 18:56:43,449] {result_logger:104} INFO - recall on Wake: 0.981
[2024-04-21 18:56:43,504] {result_logger:107} INFO - F1-score on Wake: 0.978
[2024-04-21 18:56:43,504] {result_logger:108} INFO - 
[2024-04-21 18:56:43,594] {result_logger:103} INFO - precision on Non REM: 0.969
[2024-04-21 18:56:43,649] {result_logger:104} INFO - recall on Non REM: 0.954
[2024-04-21 18:56:43,702] {result_logger:107} INFO - F1-score on Non REM: 0.961
[2024-04-21 18:56:43,702] {result_logger:108} INFO - 
[2024-04-21 18:56:43,790] {result_logger:103} INFO - precision on REM: 0.880
[2024-04-21 18:56:43,843] {result_logger:104} INFO - recall on REM: 0.944
[2024-04-21 18:56:43,895] {result_logger:107} INFO - F1-score on REM: 0.911
[2024-04-21 18:56:43,896] {result_logger:108} INFO - 
[2024-04-21 18:56:43,906] {result_logger:111} INFO - average precision on sleep stages: 0.942
[2024-04-21 18:56:43,917] {result_logger:113} INFO - average recall on sleep stages: 0.959
[2024-04-21 18:56:43,927] {result_logger:115} INFO - average F1-score on sleep stages: 0.950
[2024-04-21 18:56:43,928] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 18:56:43,998] {result_logger:134} INFO - 
[[201561   2021    165]
 [  1411 141519    837]
 [    27     72  18507]]
[2024-04-21 18:56:44,069] {result_logger:141} INFO - 
[[ 98.93%   0.99%   0.08%]
 [  0.98%  98.44%   0.58%]
 [  0.15%   0.39%  99.47%]]
[2024-04-21 18:56:44,139] {result_logger:145} INFO - 
[[ 99.29%   1.41%   0.85%]
 [  0.70%  98.54%   4.29%]
 [  0.01%   0.05%  94.86%]]
[2024-04-21 18:56:44,139] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 18:56:44,147] {result_logger:134} INFO - 
[[27843   497    42]
 [  675 19742   286]
 [   17   126  2402]]
[2024-04-21 18:56:44,154] {result_logger:141} INFO - 
[[ 98.10%   1.75%   0.15%]
 [  3.26%  95.36%   1.38%]
 [  0.67%   4.95%  94.38%]]
[2024-04-21 18:56:44,162] {result_logger:145} INFO - 
[[ 97.57%   2.44%   1.54%]
 [  2.37%  96.94%  10.48%]
 [  0.06%   0.62%  87.99%]]
[2024-04-21 18:56:44,260] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 18:56:44,260] {result_logger:77} INFO - actual:
[2024-04-21 18:56:44,261] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 18:56:44,261] {result_logger:79} INFO - predicted:
[2024-04-21 18:56:44,261] {result_logger:80} INFO - 
[[95.10%  4.82%  0.08%]
 [ 4.80% 92.58%  2.63%]
 [15.38%  5.05% 79.56%]]
[2024-04-21 18:56:44,261] {run_experiment:112} INFO - [epoch  39] execution time: 180.83s	 avg f1-score: 0.9502

[2024-04-21 18:56:44,261] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:56:44,289] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:57:05,150] {train_model:82} INFO - Train Epoch: 40 [36352/366120 (10%)]	lr:4.77e-05	Loss: 0.025582
[2024-04-21 18:57:21,967] {train_model:82} INFO - Train Epoch: 40 [72960/366120 (20%)]	lr:4.77e-05	Loss: 0.020405
[2024-04-21 18:57:37,391] {train_model:82} INFO - Train Epoch: 40 [109568/366120 (30%)]	lr:4.77e-05	Loss: 0.019307
[2024-04-21 18:57:51,058] {train_model:82} INFO - Train Epoch: 40 [146176/366120 (40%)]	lr:4.77e-05	Loss: 0.037113
[2024-04-21 18:58:04,759] {train_model:82} INFO - Train Epoch: 40 [182784/366120 (50%)]	lr:4.77e-05	Loss: 0.035956
[2024-04-21 18:58:18,452] {train_model:82} INFO - Train Epoch: 40 [219392/366120 (60%)]	lr:4.77e-05	Loss: 0.028264
[2024-04-21 18:58:32,098] {train_model:82} INFO - Train Epoch: 40 [256000/366120 (70%)]	lr:4.77e-05	Loss: 0.028363
[2024-04-21 18:58:45,695] {train_model:82} INFO - Train Epoch: 40 [292608/366120 (80%)]	lr:4.77e-05	Loss: 0.020805
[2024-04-21 18:58:59,311] {train_model:82} INFO - Train Epoch: 40 [329216/366120 (90%)]	lr:4.77e-05	Loss: 0.041908
[2024-04-21 18:59:12,926] {train_model:82} INFO - Train Epoch: 40 [365824/366120 (100%)]	lr:4.77e-05	Loss: 0.020679
[2024-04-21 18:59:18,736] {run_experiment:78} INFO - 
[2024-04-21 18:59:18,736] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 18:59:19,408] {result_logger:103} INFO - precision on Wake: 0.993
[2024-04-21 18:59:19,832] {result_logger:104} INFO - recall on Wake: 0.990
[2024-04-21 18:59:20,256] {result_logger:107} INFO - F1-score on Wake: 0.992
[2024-04-21 18:59:20,256] {result_logger:108} INFO - 
[2024-04-21 18:59:20,910] {result_logger:103} INFO - precision on Non REM: 0.986
[2024-04-21 18:59:21,323] {result_logger:104} INFO - recall on Non REM: 0.985
[2024-04-21 18:59:21,740] {result_logger:107} INFO - F1-score on Non REM: 0.986
[2024-04-21 18:59:21,740] {result_logger:108} INFO - 
[2024-04-21 18:59:22,340] {result_logger:103} INFO - precision on REM: 0.952
[2024-04-21 18:59:22,705] {result_logger:104} INFO - recall on REM: 0.996
[2024-04-21 18:59:23,070] {result_logger:107} INFO - F1-score on REM: 0.973
[2024-04-21 18:59:23,070] {result_logger:108} INFO - 
[2024-04-21 18:59:23,166] {result_logger:111} INFO - average precision on sleep stages: 0.977
[2024-04-21 18:59:23,260] {result_logger:113} INFO - average recall on sleep stages: 0.990
[2024-04-21 18:59:23,354] {result_logger:115} INFO - average F1-score on sleep stages: 0.984
[2024-04-21 18:59:23,356] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 18:59:23,442] {result_logger:103} INFO - precision on Wake: 0.979
[2024-04-21 18:59:23,493] {result_logger:104} INFO - recall on Wake: 0.981
[2024-04-21 18:59:23,543] {result_logger:107} INFO - F1-score on Wake: 0.980
[2024-04-21 18:59:23,544] {result_logger:108} INFO - 
[2024-04-21 18:59:23,627] {result_logger:103} INFO - precision on Non REM: 0.969
[2024-04-21 18:59:23,678] {result_logger:104} INFO - recall on Non REM: 0.958
[2024-04-21 18:59:23,729] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2024-04-21 18:59:23,729] {result_logger:108} INFO - 
[2024-04-21 18:59:23,812] {result_logger:103} INFO - precision on REM: 0.884
[2024-04-21 18:59:23,861] {result_logger:104} INFO - recall on REM: 0.944
[2024-04-21 18:59:23,911] {result_logger:107} INFO - F1-score on REM: 0.913
[2024-04-21 18:59:23,911] {result_logger:108} INFO - 
[2024-04-21 18:59:23,920] {result_logger:111} INFO - average precision on sleep stages: 0.944
[2024-04-21 18:59:23,931] {result_logger:113} INFO - average recall on sleep stages: 0.961
[2024-04-21 18:59:23,940] {result_logger:115} INFO - average F1-score on sleep stages: 0.952
[2024-04-21 18:59:23,941] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 18:59:24,006] {result_logger:134} INFO - 
[[201669   1910    168]
 [  1347 141647    773]
 [    14     58  18534]]
[2024-04-21 18:59:24,071] {result_logger:141} INFO - 
[[ 98.98%   0.94%   0.08%]
 [  0.94%  98.53%   0.54%]
 [  0.08%   0.31%  99.61%]]
[2024-04-21 18:59:24,137] {result_logger:145} INFO - 
[[ 99.33%   1.33%   0.86%]
 [  0.66%  98.63%   3.97%]
 [  0.01%   0.04%  95.17%]]
[2024-04-21 18:59:24,137] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 18:59:24,144] {result_logger:134} INFO - 
[[27838   501    43]
 [  589 19841   273]
 [   19   124  2402]]
[2024-04-21 18:59:24,240] {result_logger:141} INFO - 
[[ 98.08%   1.77%   0.15%]
 [  2.84%  95.84%   1.32%]
 [  0.75%   4.87%  94.38%]]
[2024-04-21 18:59:24,332] {result_logger:145} INFO - 
[[ 97.86%   2.45%   1.58%]
 [  2.07%  96.95%  10.04%]
 [  0.07%   0.61%  88.37%]]
[2024-04-21 18:59:24,591] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 18:59:24,591] {result_logger:77} INFO - actual:
[2024-04-21 18:59:24,591] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 18:59:24,591] {result_logger:79} INFO - predicted:
[2024-04-21 18:59:24,591] {result_logger:80} INFO - 
[[95.18%  4.75%  0.07%]
 [ 4.70% 92.73%  2.58%]
 [15.08%  5.04% 79.87%]]
[2024-04-21 18:59:24,648] {train_model:94} INFO - snapshot saved to /home/s202283/code/grieger_validation/results/exp005/model_8conv_2fc-best.pth
[2024-04-21 18:59:24,648] {run_experiment:112} INFO - [epoch  40] execution time: 160.39s	 avg f1-score: 0.9521

[2024-04-21 18:59:24,648] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:59:24,676] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 18:59:42,636] {train_model:82} INFO - Train Epoch: 41 [36352/366120 (10%)]	lr:4.49e-05	Loss: 0.013210
[2024-04-21 18:59:56,163] {train_model:82} INFO - Train Epoch: 41 [72960/366120 (20%)]	lr:4.49e-05	Loss: 0.051171
[2024-04-21 19:00:09,713] {train_model:82} INFO - Train Epoch: 41 [109568/366120 (30%)]	lr:4.49e-05	Loss: 0.017113
[2024-04-21 19:00:23,309] {train_model:82} INFO - Train Epoch: 41 [146176/366120 (40%)]	lr:4.49e-05	Loss: 0.023359
[2024-04-21 19:00:36,927] {train_model:82} INFO - Train Epoch: 41 [182784/366120 (50%)]	lr:4.49e-05	Loss: 0.016352
[2024-04-21 19:00:50,574] {train_model:82} INFO - Train Epoch: 41 [219392/366120 (60%)]	lr:4.49e-05	Loss: 0.014806
[2024-04-21 19:01:04,241] {train_model:82} INFO - Train Epoch: 41 [256000/366120 (70%)]	lr:4.49e-05	Loss: 0.009555
[2024-04-21 19:01:17,939] {train_model:82} INFO - Train Epoch: 41 [292608/366120 (80%)]	lr:4.49e-05	Loss: 0.026095
[2024-04-21 19:01:31,638] {train_model:82} INFO - Train Epoch: 41 [329216/366120 (90%)]	lr:4.49e-05	Loss: 0.031805
[2024-04-21 19:01:45,273] {train_model:82} INFO - Train Epoch: 41 [365824/366120 (100%)]	lr:4.49e-05	Loss: 0.015098
[2024-04-21 19:01:50,782] {run_experiment:78} INFO - 
[2024-04-21 19:01:50,782] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 19:01:51,437] {result_logger:103} INFO - precision on Wake: 0.994
[2024-04-21 19:01:51,863] {result_logger:104} INFO - recall on Wake: 0.990
[2024-04-21 19:01:52,287] {result_logger:107} INFO - F1-score on Wake: 0.992
[2024-04-21 19:01:52,287] {result_logger:108} INFO - 
[2024-04-21 19:01:52,922] {result_logger:103} INFO - precision on Non REM: 0.987
[2024-04-21 19:01:53,336] {result_logger:104} INFO - recall on Non REM: 0.986
[2024-04-21 19:01:53,752] {result_logger:107} INFO - F1-score on Non REM: 0.986
[2024-04-21 19:01:53,752] {result_logger:108} INFO - 
[2024-04-21 19:01:54,353] {result_logger:103} INFO - precision on REM: 0.953
[2024-04-21 19:01:54,718] {result_logger:104} INFO - recall on REM: 0.996
[2024-04-21 19:01:55,083] {result_logger:107} INFO - F1-score on REM: 0.974
[2024-04-21 19:01:55,083] {result_logger:108} INFO - 
[2024-04-21 19:01:55,180] {result_logger:111} INFO - average precision on sleep stages: 0.978
[2024-04-21 19:01:55,275] {result_logger:113} INFO - average recall on sleep stages: 0.991
[2024-04-21 19:01:55,371] {result_logger:115} INFO - average F1-score on sleep stages: 0.984
[2024-04-21 19:01:55,373] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 19:01:55,457] {result_logger:103} INFO - precision on Wake: 0.977
[2024-04-21 19:01:55,507] {result_logger:104} INFO - recall on Wake: 0.981
[2024-04-21 19:01:55,558] {result_logger:107} INFO - F1-score on Wake: 0.979
[2024-04-21 19:01:55,558] {result_logger:108} INFO - 
[2024-04-21 19:01:55,640] {result_logger:103} INFO - precision on Non REM: 0.973
[2024-04-21 19:01:55,691] {result_logger:104} INFO - recall on Non REM: 0.955
[2024-04-21 19:01:55,741] {result_logger:107} INFO - F1-score on Non REM: 0.964
[2024-04-21 19:01:55,741] {result_logger:108} INFO - 
[2024-04-21 19:01:55,823] {result_logger:103} INFO - precision on REM: 0.863
[2024-04-21 19:01:55,872] {result_logger:104} INFO - recall on REM: 0.954
[2024-04-21 19:01:55,922] {result_logger:107} INFO - F1-score on REM: 0.906
[2024-04-21 19:01:55,922] {result_logger:108} INFO - 
[2024-04-21 19:01:55,931] {result_logger:111} INFO - average precision on sleep stages: 0.938
[2024-04-21 19:01:55,941] {result_logger:113} INFO - average recall on sleep stages: 0.963
[2024-04-21 19:01:55,952] {result_logger:115} INFO - average F1-score on sleep stages: 0.950
[2024-04-21 19:01:55,952] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 19:01:56,019] {result_logger:134} INFO - 
[[201758   1832    157]
 [  1267 141743    757]
 [    22     53  18531]]
[2024-04-21 19:01:56,084] {result_logger:141} INFO - 
[[ 99.02%   0.90%   0.08%]
 [  0.88%  98.59%   0.53%]
 [  0.12%   0.28%  99.60%]]
[2024-04-21 19:01:56,149] {result_logger:145} INFO - 
[[ 99.37%   1.28%   0.81%]
 [  0.62%  98.69%   3.89%]
 [  0.01%   0.04%  95.30%]]
[2024-04-21 19:01:56,149] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 19:01:56,156] {result_logger:134} INFO - 
[[27855   452    75]
 [  626 19768   309]
 [   17   100  2428]]
[2024-04-21 19:01:56,163] {result_logger:141} INFO - 
[[ 98.14%   1.59%   0.26%]
 [  3.02%  95.48%   1.49%]
 [  0.67%   3.93%  95.40%]]
[2024-04-21 19:01:56,171] {result_logger:145} INFO - 
[[ 97.74%   2.22%   2.67%]
 [  2.20%  97.28%  10.99%]
 [  0.06%   0.49%  86.34%]]
[2024-04-21 19:01:56,261] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 19:01:56,261] {result_logger:77} INFO - actual:
[2024-04-21 19:01:56,261] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 19:01:56,262] {result_logger:79} INFO - predicted:
[2024-04-21 19:01:56,262] {result_logger:80} INFO - 
[[95.07%  4.77%  0.15%]
 [ 4.67% 92.63%  2.70%]
 [16.18%  4.87% 78.95%]]
[2024-04-21 19:01:56,262] {run_experiment:112} INFO - [epoch  41] execution time: 151.61s	 avg f1-score: 0.9499

[2024-04-21 19:01:56,262] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 19:01:56,289] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 19:02:14,182] {train_model:82} INFO - Train Epoch: 42 [36352/366120 (10%)]	lr:4.23e-05	Loss: 0.013792
[2024-04-21 19:02:27,722] {train_model:82} INFO - Train Epoch: 42 [72960/366120 (20%)]	lr:4.23e-05	Loss: 0.015856
[2024-04-21 19:02:41,296] {train_model:82} INFO - Train Epoch: 42 [109568/366120 (30%)]	lr:4.23e-05	Loss: 0.028823
[2024-04-21 19:02:54,916] {train_model:82} INFO - Train Epoch: 42 [146176/366120 (40%)]	lr:4.23e-05	Loss: 0.027934
[2024-04-21 19:03:08,555] {train_model:82} INFO - Train Epoch: 42 [182784/366120 (50%)]	lr:4.23e-05	Loss: 0.036679
[2024-04-21 19:03:22,230] {train_model:82} INFO - Train Epoch: 42 [219392/366120 (60%)]	lr:4.23e-05	Loss: 0.037201
[2024-04-21 19:03:35,962] {train_model:82} INFO - Train Epoch: 42 [256000/366120 (70%)]	lr:4.23e-05	Loss: 0.029088
[2024-04-21 19:03:49,696] {train_model:82} INFO - Train Epoch: 42 [292608/366120 (80%)]	lr:4.23e-05	Loss: 0.024756
[2024-04-21 19:04:03,475] {train_model:82} INFO - Train Epoch: 42 [329216/366120 (90%)]	lr:4.23e-05	Loss: 0.020062
[2024-04-21 19:04:17,193] {train_model:82} INFO - Train Epoch: 42 [365824/366120 (100%)]	lr:4.23e-05	Loss: 0.032196
[2024-04-21 19:04:22,957] {run_experiment:78} INFO - 
[2024-04-21 19:04:22,957] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 19:04:23,613] {result_logger:103} INFO - precision on Wake: 0.994
[2024-04-21 19:04:24,036] {result_logger:104} INFO - recall on Wake: 0.990
[2024-04-21 19:04:24,460] {result_logger:107} INFO - F1-score on Wake: 0.992
[2024-04-21 19:04:24,460] {result_logger:108} INFO - 
[2024-04-21 19:04:25,115] {result_logger:103} INFO - precision on Non REM: 0.987
[2024-04-21 19:04:25,531] {result_logger:104} INFO - recall on Non REM: 0.987
[2024-04-21 19:04:25,948] {result_logger:107} INFO - F1-score on Non REM: 0.987
[2024-04-21 19:04:25,948] {result_logger:108} INFO - 
[2024-04-21 19:04:26,535] {result_logger:103} INFO - precision on REM: 0.954
[2024-04-21 19:04:26,902] {result_logger:104} INFO - recall on REM: 0.996
[2024-04-21 19:04:27,268] {result_logger:107} INFO - F1-score on REM: 0.975
[2024-04-21 19:04:27,269] {result_logger:108} INFO - 
[2024-04-21 19:04:27,364] {result_logger:111} INFO - average precision on sleep stages: 0.979
[2024-04-21 19:04:27,459] {result_logger:113} INFO - average recall on sleep stages: 0.991
[2024-04-21 19:04:27,554] {result_logger:115} INFO - average F1-score on sleep stages: 0.985
[2024-04-21 19:04:27,556] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 19:04:27,638] {result_logger:103} INFO - precision on Wake: 0.980
[2024-04-21 19:04:27,689] {result_logger:104} INFO - recall on Wake: 0.979
[2024-04-21 19:04:27,739] {result_logger:107} INFO - F1-score on Wake: 0.979
[2024-04-21 19:04:27,739] {result_logger:108} INFO - 
[2024-04-21 19:04:27,824] {result_logger:103} INFO - precision on Non REM: 0.969
[2024-04-21 19:04:27,874] {result_logger:104} INFO - recall on Non REM: 0.960
[2024-04-21 19:04:27,925] {result_logger:107} INFO - F1-score on Non REM: 0.965
[2024-04-21 19:04:27,925] {result_logger:108} INFO - 
[2024-04-21 19:04:28,006] {result_logger:103} INFO - precision on REM: 0.877
[2024-04-21 19:04:28,056] {result_logger:104} INFO - recall on REM: 0.944
[2024-04-21 19:04:28,105] {result_logger:107} INFO - F1-score on REM: 0.909
[2024-04-21 19:04:28,105] {result_logger:108} INFO - 
[2024-04-21 19:04:28,114] {result_logger:111} INFO - average precision on sleep stages: 0.942
[2024-04-21 19:04:28,124] {result_logger:113} INFO - average recall on sleep stages: 0.961
[2024-04-21 19:04:28,134] {result_logger:115} INFO - average F1-score on sleep stages: 0.951
[2024-04-21 19:04:28,135] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 19:04:28,200] {result_logger:134} INFO - 
[[201802   1782    163]
 [  1202 141843    722]
 [    21     58  18527]]
[2024-04-21 19:04:28,266] {result_logger:141} INFO - 
[[ 99.05%   0.87%   0.08%]
 [  0.84%  98.66%   0.50%]
 [  0.11%   0.31%  99.58%]]
[2024-04-21 19:04:28,332] {result_logger:145} INFO - 
[[ 99.40%   1.24%   0.84%]
 [  0.59%  98.72%   3.72%]
 [  0.01%   0.04%  95.44%]]
[2024-04-21 19:04:28,332] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 19:04:28,339] {result_logger:134} INFO - 
[[27789   517    76]
 [  556 19885   262]
 [   17   126  2402]]
[2024-04-21 19:04:28,346] {result_logger:141} INFO - 
[[ 97.91%   1.82%   0.27%]
 [  2.69%  96.05%   1.27%]
 [  0.67%   4.95%  94.38%]]
[2024-04-21 19:04:28,354] {result_logger:145} INFO - 
[[ 97.98%   2.52%   2.77%]
 [  1.96%  96.87%   9.56%]
 [  0.06%   0.61%  87.66%]]
[2024-04-21 19:04:28,445] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 19:04:28,445] {result_logger:77} INFO - actual:
[2024-04-21 19:04:28,445] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 19:04:28,445] {result_logger:79} INFO - predicted:
[2024-04-21 19:04:28,445] {result_logger:80} INFO - 
[[95.15%  4.70%  0.15%]
 [ 4.59% 92.84%  2.56%]
 [15.80%  4.96% 79.23%]]
[2024-04-21 19:04:28,445] {run_experiment:112} INFO - [epoch  42] execution time: 152.18s	 avg f1-score: 0.9510

[2024-04-21 19:04:28,445] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 19:04:28,472] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 19:04:46,643] {train_model:82} INFO - Train Epoch: 43 [36352/366120 (10%)]	lr:3.99e-05	Loss: 0.037360
[2024-04-21 19:05:00,182] {train_model:82} INFO - Train Epoch: 43 [72960/366120 (20%)]	lr:3.99e-05	Loss: 0.014322
[2024-04-21 19:05:13,760] {train_model:82} INFO - Train Epoch: 43 [109568/366120 (30%)]	lr:3.99e-05	Loss: 0.015288
[2024-04-21 19:05:27,364] {train_model:82} INFO - Train Epoch: 43 [146176/366120 (40%)]	lr:3.99e-05	Loss: 0.028579
[2024-04-21 19:05:40,989] {train_model:82} INFO - Train Epoch: 43 [182784/366120 (50%)]	lr:3.99e-05	Loss: 0.044593
[2024-04-21 19:05:54,618] {train_model:82} INFO - Train Epoch: 43 [219392/366120 (60%)]	lr:3.99e-05	Loss: 0.025814
[2024-04-21 19:06:08,267] {train_model:82} INFO - Train Epoch: 43 [256000/366120 (70%)]	lr:3.99e-05	Loss: 0.011559
[2024-04-21 19:06:21,930] {train_model:82} INFO - Train Epoch: 43 [292608/366120 (80%)]	lr:3.99e-05	Loss: 0.070028
[2024-04-21 19:06:35,617] {train_model:82} INFO - Train Epoch: 43 [329216/366120 (90%)]	lr:3.99e-05	Loss: 0.022115
[2024-04-21 19:06:49,241] {train_model:82} INFO - Train Epoch: 43 [365824/366120 (100%)]	lr:3.99e-05	Loss: 0.018592
[2024-04-21 19:06:54,656] {run_experiment:78} INFO - 
[2024-04-21 19:06:54,656] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 19:06:55,314] {result_logger:103} INFO - precision on Wake: 0.994
[2024-04-21 19:06:55,738] {result_logger:104} INFO - recall on Wake: 0.991
[2024-04-21 19:06:56,162] {result_logger:107} INFO - F1-score on Wake: 0.992
[2024-04-21 19:06:56,162] {result_logger:108} INFO - 
[2024-04-21 19:06:56,819] {result_logger:103} INFO - precision on Non REM: 0.987
[2024-04-21 19:06:57,235] {result_logger:104} INFO - recall on Non REM: 0.987
[2024-04-21 19:06:57,651] {result_logger:107} INFO - F1-score on Non REM: 0.987
[2024-04-21 19:06:57,651] {result_logger:108} INFO - 
[2024-04-21 19:06:58,235] {result_logger:103} INFO - precision on REM: 0.957
[2024-04-21 19:06:58,599] {result_logger:104} INFO - recall on REM: 0.995
[2024-04-21 19:06:58,962] {result_logger:107} INFO - F1-score on REM: 0.976
[2024-04-21 19:06:58,962] {result_logger:108} INFO - 
[2024-04-21 19:06:59,056] {result_logger:111} INFO - average precision on sleep stages: 0.979
[2024-04-21 19:06:59,149] {result_logger:113} INFO - average recall on sleep stages: 0.991
[2024-04-21 19:06:59,242] {result_logger:115} INFO - average F1-score on sleep stages: 0.985
[2024-04-21 19:06:59,244] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 19:06:59,326] {result_logger:103} INFO - precision on Wake: 0.977
[2024-04-21 19:06:59,376] {result_logger:104} INFO - recall on Wake: 0.980
[2024-04-21 19:06:59,426] {result_logger:107} INFO - F1-score on Wake: 0.979
[2024-04-21 19:06:59,426] {result_logger:108} INFO - 
[2024-04-21 19:06:59,511] {result_logger:103} INFO - precision on Non REM: 0.971
[2024-04-21 19:06:59,562] {result_logger:104} INFO - recall on Non REM: 0.956
[2024-04-21 19:06:59,612] {result_logger:107} INFO - F1-score on Non REM: 0.963
[2024-04-21 19:06:59,612] {result_logger:108} INFO - 
[2024-04-21 19:06:59,693] {result_logger:103} INFO - precision on REM: 0.864
[2024-04-21 19:06:59,742] {result_logger:104} INFO - recall on REM: 0.949
[2024-04-21 19:06:59,791] {result_logger:107} INFO - F1-score on REM: 0.904
[2024-04-21 19:06:59,791] {result_logger:108} INFO - 
[2024-04-21 19:06:59,801] {result_logger:111} INFO - average precision on sleep stages: 0.937
[2024-04-21 19:06:59,811] {result_logger:113} INFO - average recall on sleep stages: 0.961
[2024-04-21 19:06:59,821] {result_logger:115} INFO - average F1-score on sleep stages: 0.949
[2024-04-21 19:06:59,821] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 19:06:59,886] {result_logger:134} INFO - 
[[201829   1762    156]
 [  1204 141891    672]
 [    25     70  18511]]
[2024-04-21 19:06:59,949] {result_logger:141} INFO - 
[[ 99.06%   0.86%   0.08%]
 [  0.84%  98.70%   0.47%]
 [  0.13%   0.38%  99.49%]]
[2024-04-21 19:07:00,013] {result_logger:145} INFO - 
[[ 99.39%   1.23%   0.81%]
 [  0.59%  98.73%   3.47%]
 [  0.01%   0.05%  95.72%]]
[2024-04-21 19:07:00,014] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 19:07:00,021] {result_logger:134} INFO - 
[[27814   484    84]
 [  624 19782   297]
 [   18   112  2415]]
[2024-04-21 19:07:00,028] {result_logger:141} INFO - 
[[ 98.00%   1.71%   0.30%]
 [  3.01%  95.55%   1.43%]
 [  0.71%   4.40%  94.89%]]
[2024-04-21 19:07:00,035] {result_logger:145} INFO - 
[[ 97.74%   2.38%   3.00%]
 [  2.19%  97.08%  10.62%]
 [  0.06%   0.55%  86.37%]]
[2024-04-21 19:07:00,126] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 19:07:00,126] {result_logger:77} INFO - actual:
[2024-04-21 19:07:00,126] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 19:07:00,126] {result_logger:79} INFO - predicted:
[2024-04-21 19:07:00,126] {result_logger:80} INFO - 
[[95.05%  4.77%  0.18%]
 [ 4.69% 92.67%  2.64%]
 [16.20%  4.83% 78.97%]]
[2024-04-21 19:07:00,126] {run_experiment:112} INFO - [epoch  43] execution time: 151.68s	 avg f1-score: 0.9487

[2024-04-21 19:07:00,126] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 19:07:00,153] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 19:07:18,062] {train_model:82} INFO - Train Epoch: 44 [36352/366120 (10%)]	lr:3.75e-05	Loss: 0.011593
[2024-04-21 19:07:31,600] {train_model:82} INFO - Train Epoch: 44 [72960/366120 (20%)]	lr:3.75e-05	Loss: 0.036911
[2024-04-21 19:07:45,177] {train_model:82} INFO - Train Epoch: 44 [109568/366120 (30%)]	lr:3.75e-05	Loss: 0.057800
[2024-04-21 19:07:58,784] {train_model:82} INFO - Train Epoch: 44 [146176/366120 (40%)]	lr:3.75e-05	Loss: 0.003197
[2024-04-21 19:08:12,432] {train_model:82} INFO - Train Epoch: 44 [182784/366120 (50%)]	lr:3.75e-05	Loss: 0.018708
[2024-04-21 19:08:26,046] {train_model:82} INFO - Train Epoch: 44 [219392/366120 (60%)]	lr:3.75e-05	Loss: 0.086364
[2024-04-21 19:08:39,632] {train_model:82} INFO - Train Epoch: 44 [256000/366120 (70%)]	lr:3.75e-05	Loss: 0.013741
[2024-04-21 19:08:53,234] {train_model:82} INFO - Train Epoch: 44 [292608/366120 (80%)]	lr:3.75e-05	Loss: 0.025751
[2024-04-21 19:09:06,860] {train_model:82} INFO - Train Epoch: 44 [329216/366120 (90%)]	lr:3.75e-05	Loss: 0.010705
[2024-04-21 19:09:20,473] {train_model:82} INFO - Train Epoch: 44 [365824/366120 (100%)]	lr:3.75e-05	Loss: 0.024334
[2024-04-21 19:09:26,028] {run_experiment:78} INFO - 
[2024-04-21 19:09:26,028] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 19:09:26,683] {result_logger:103} INFO - precision on Wake: 0.994
[2024-04-21 19:09:27,107] {result_logger:104} INFO - recall on Wake: 0.991
[2024-04-21 19:09:27,529] {result_logger:107} INFO - F1-score on Wake: 0.993
[2024-04-21 19:09:27,529] {result_logger:108} INFO - 
[2024-04-21 19:09:28,179] {result_logger:103} INFO - precision on Non REM: 0.988
[2024-04-21 19:09:28,589] {result_logger:104} INFO - recall on Non REM: 0.988
[2024-04-21 19:09:29,001] {result_logger:107} INFO - F1-score on Non REM: 0.988
[2024-04-21 19:09:29,001] {result_logger:108} INFO - 
[2024-04-21 19:09:29,585] {result_logger:103} INFO - precision on REM: 0.962
[2024-04-21 19:09:29,949] {result_logger:104} INFO - recall on REM: 0.996
[2024-04-21 19:09:30,312] {result_logger:107} INFO - F1-score on REM: 0.979
[2024-04-21 19:09:30,313] {result_logger:108} INFO - 
[2024-04-21 19:09:30,405] {result_logger:111} INFO - average precision on sleep stages: 0.981
[2024-04-21 19:09:30,499] {result_logger:113} INFO - average recall on sleep stages: 0.992
[2024-04-21 19:09:30,592] {result_logger:115} INFO - average F1-score on sleep stages: 0.987
[2024-04-21 19:09:30,594] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 19:09:30,676] {result_logger:103} INFO - precision on Wake: 0.979
[2024-04-21 19:09:30,726] {result_logger:104} INFO - recall on Wake: 0.978
[2024-04-21 19:09:30,776] {result_logger:107} INFO - F1-score on Wake: 0.978
[2024-04-21 19:09:30,776] {result_logger:108} INFO - 
[2024-04-21 19:09:30,861] {result_logger:103} INFO - precision on Non REM: 0.968
[2024-04-21 19:09:30,911] {result_logger:104} INFO - recall on Non REM: 0.955
[2024-04-21 19:09:30,962] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2024-04-21 19:09:30,962] {result_logger:108} INFO - 
[2024-04-21 19:09:31,043] {result_logger:103} INFO - precision on REM: 0.855
[2024-04-21 19:09:31,092] {result_logger:104} INFO - recall on REM: 0.949
[2024-04-21 19:09:31,141] {result_logger:107} INFO - F1-score on REM: 0.900
[2024-04-21 19:09:31,141] {result_logger:108} INFO - 
[2024-04-21 19:09:31,151] {result_logger:111} INFO - average precision on sleep stages: 0.934
[2024-04-21 19:09:31,161] {result_logger:113} INFO - average recall on sleep stages: 0.961
[2024-04-21 19:09:31,171] {result_logger:115} INFO - average F1-score on sleep stages: 0.947
[2024-04-21 19:09:31,172] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 19:09:31,236] {result_logger:134} INFO - 
[[201971   1650    126]
 [  1105 142047    615]
 [    18     48  18540]]
[2024-04-21 19:09:31,300] {result_logger:141} INFO - 
[[ 99.13%   0.81%   0.06%]
 [  0.77%  98.80%   0.43%]
 [  0.10%   0.26%  99.65%]]
[2024-04-21 19:09:31,364] {result_logger:145} INFO - 
[[ 99.45%   1.15%   0.65%]
 [  0.54%  98.82%   3.19%]
 [  0.01%   0.03%  96.16%]]
[2024-04-21 19:09:31,364] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 19:09:31,371] {result_logger:134} INFO - 
[[27766   534    82]
 [  595 19781   327]
 [   14   116  2415]]
[2024-04-21 19:09:31,379] {result_logger:141} INFO - 
[[ 97.83%   1.88%   0.29%]
 [  2.87%  95.55%   1.58%]
 [  0.55%   4.56%  94.89%]]
[2024-04-21 19:09:31,386] {result_logger:145} INFO - 
[[ 97.85%   2.61%   2.90%]
 [  2.10%  96.82%  11.58%]
 [  0.05%   0.57%  85.52%]]
[2024-04-21 19:09:31,476] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 19:09:31,476] {result_logger:77} INFO - actual:
[2024-04-21 19:09:31,477] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 19:09:31,477] {result_logger:79} INFO - predicted:
[2024-04-21 19:09:31,477] {result_logger:80} INFO - 
[[95.12%  4.73%  0.16%]
 [ 4.62% 92.68%  2.71%]
 [15.65%  5.49% 78.86%]]
[2024-04-21 19:09:31,477] {run_experiment:112} INFO - [epoch  44] execution time: 151.35s	 avg f1-score: 0.9466

[2024-04-21 19:09:31,477] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 19:09:31,503] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 19:09:49,394] {train_model:82} INFO - Train Epoch: 45 [36352/366120 (10%)]	lr:3.53e-05	Loss: 0.008235
[2024-04-21 19:10:02,928] {train_model:82} INFO - Train Epoch: 45 [72960/366120 (20%)]	lr:3.53e-05	Loss: 0.008472
[2024-04-21 19:10:16,555] {train_model:82} INFO - Train Epoch: 45 [109568/366120 (30%)]	lr:3.53e-05	Loss: 0.008992
[2024-04-21 19:10:30,212] {train_model:82} INFO - Train Epoch: 45 [146176/366120 (40%)]	lr:3.53e-05	Loss: 0.011986
[2024-04-21 19:10:43,899] {train_model:82} INFO - Train Epoch: 45 [182784/366120 (50%)]	lr:3.53e-05	Loss: 0.019373
[2024-04-21 19:10:57,460] {train_model:82} INFO - Train Epoch: 45 [219392/366120 (60%)]	lr:3.53e-05	Loss: 0.010229
[2024-04-21 19:11:11,049] {train_model:82} INFO - Train Epoch: 45 [256000/366120 (70%)]	lr:3.53e-05	Loss: 0.014036
[2024-04-21 19:11:24,654] {train_model:82} INFO - Train Epoch: 45 [292608/366120 (80%)]	lr:3.53e-05	Loss: 0.010307
[2024-04-21 19:11:38,276] {train_model:82} INFO - Train Epoch: 45 [329216/366120 (90%)]	lr:3.53e-05	Loss: 0.021701
[2024-04-21 19:11:51,899] {train_model:82} INFO - Train Epoch: 45 [365824/366120 (100%)]	lr:3.53e-05	Loss: 0.008358
[2024-04-21 19:11:57,387] {run_experiment:78} INFO - 
[2024-04-21 19:11:57,387] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 19:11:58,056] {result_logger:103} INFO - precision on Wake: 0.995
[2024-04-21 19:11:58,483] {result_logger:104} INFO - recall on Wake: 0.991
[2024-04-21 19:11:58,909] {result_logger:107} INFO - F1-score on Wake: 0.993
[2024-04-21 19:11:58,909] {result_logger:108} INFO - 
[2024-04-21 19:11:59,549] {result_logger:103} INFO - precision on Non REM: 0.988
[2024-04-21 19:11:59,966] {result_logger:104} INFO - recall on Non REM: 0.988
[2024-04-21 19:12:00,382] {result_logger:107} INFO - F1-score on Non REM: 0.988
[2024-04-21 19:12:00,382] {result_logger:108} INFO - 
[2024-04-21 19:12:00,981] {result_logger:103} INFO - precision on REM: 0.962
[2024-04-21 19:12:01,347] {result_logger:104} INFO - recall on REM: 0.996
[2024-04-21 19:12:01,715] {result_logger:107} INFO - F1-score on REM: 0.979
[2024-04-21 19:12:01,716] {result_logger:108} INFO - 
[2024-04-21 19:12:01,811] {result_logger:111} INFO - average precision on sleep stages: 0.981
[2024-04-21 19:12:01,905] {result_logger:113} INFO - average recall on sleep stages: 0.992
[2024-04-21 19:12:02,000] {result_logger:115} INFO - average F1-score on sleep stages: 0.987
[2024-04-21 19:12:02,002] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 19:12:02,087] {result_logger:103} INFO - precision on Wake: 0.976
[2024-04-21 19:12:02,136] {result_logger:104} INFO - recall on Wake: 0.981
[2024-04-21 19:12:02,187] {result_logger:107} INFO - F1-score on Wake: 0.979
[2024-04-21 19:12:02,187] {result_logger:108} INFO - 
[2024-04-21 19:12:02,269] {result_logger:103} INFO - precision on Non REM: 0.973
[2024-04-21 19:12:02,320] {result_logger:104} INFO - recall on Non REM: 0.951
[2024-04-21 19:12:02,371] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2024-04-21 19:12:02,371] {result_logger:108} INFO - 
[2024-04-21 19:12:02,454] {result_logger:103} INFO - precision on REM: 0.853
[2024-04-21 19:12:02,503] {result_logger:104} INFO - recall on REM: 0.952
[2024-04-21 19:12:02,552] {result_logger:107} INFO - F1-score on REM: 0.900
[2024-04-21 19:12:02,552] {result_logger:108} INFO - 
[2024-04-21 19:12:02,562] {result_logger:111} INFO - average precision on sleep stages: 0.934
[2024-04-21 19:12:02,571] {result_logger:113} INFO - average recall on sleep stages: 0.962
[2024-04-21 19:12:02,581] {result_logger:115} INFO - average F1-score on sleep stages: 0.947
[2024-04-21 19:12:02,582] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 19:12:02,646] {result_logger:134} INFO - 
[[201978   1648    121]
 [  1099 142052    616]
 [    14     56  18536]]
[2024-04-21 19:12:02,711] {result_logger:141} INFO - 
[[ 99.13%   0.81%   0.06%]
 [  0.76%  98.81%   0.43%]
 [  0.08%   0.30%  99.62%]]
[2024-04-21 19:12:02,776] {result_logger:145} INFO - 
[[ 99.45%   1.15%   0.63%]
 [  0.54%  98.81%   3.20%]
 [  0.01%   0.04%  96.18%]]
[2024-04-21 19:12:02,776] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 19:12:02,783] {result_logger:134} INFO - 
[[27854   451    77]
 [  663 19698   342]
 [   22   100  2423]]
[2024-04-21 19:12:02,790] {result_logger:141} INFO - 
[[ 98.14%   1.59%   0.27%]
 [  3.20%  95.15%   1.65%]
 [  0.86%   3.93%  95.21%]]
[2024-04-21 19:12:02,797] {result_logger:145} INFO - 
[[ 97.60%   2.23%   2.71%]
 [  2.32%  97.28%  12.03%]
 [  0.08%   0.49%  85.26%]]
[2024-04-21 19:12:02,887] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 19:12:02,887] {result_logger:77} INFO - actual:
[2024-04-21 19:12:02,887] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 19:12:02,887] {result_logger:79} INFO - predicted:
[2024-04-21 19:12:02,887] {result_logger:80} INFO - 
[[95.00%  4.82%  0.18%]
 [ 4.74% 92.50%  2.76%]
 [16.40%  5.03% 78.57%]]
[2024-04-21 19:12:02,887] {run_experiment:112} INFO - [epoch  45] execution time: 151.41s	 avg f1-score: 0.9468

[2024-04-21 19:12:02,888] {dataloader:120} INFO - data distribution in database for dataset train:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 19:12:02,915] {dataloader:147} INFO - data distribution after processing:
	Wake                : 203747
	Non REM             : 143767
	REM                 : 18606
[2024-04-21 19:12:21,172] {train_model:82} INFO - Train Epoch: 46 [36352/366120 (10%)]	lr:3.33e-05	Loss: 0.007831
[2024-04-21 19:12:34,650] {train_model:82} INFO - Train Epoch: 46 [72960/366120 (20%)]	lr:3.33e-05	Loss: 0.021844
[2024-04-21 19:12:48,159] {train_model:82} INFO - Train Epoch: 46 [109568/366120 (30%)]	lr:3.33e-05	Loss: 0.017487
[2024-04-21 19:13:01,705] {train_model:82} INFO - Train Epoch: 46 [146176/366120 (40%)]	lr:3.33e-05	Loss: 0.024422
[2024-04-21 19:13:15,279] {train_model:82} INFO - Train Epoch: 46 [182784/366120 (50%)]	lr:3.33e-05	Loss: 0.010716
[2024-04-21 19:13:28,932] {train_model:82} INFO - Train Epoch: 46 [219392/366120 (60%)]	lr:3.33e-05	Loss: 0.032497
[2024-04-21 19:13:42,509] {train_model:82} INFO - Train Epoch: 46 [256000/366120 (70%)]	lr:3.33e-05	Loss: 0.005199
[2024-04-21 19:13:56,114] {train_model:82} INFO - Train Epoch: 46 [292608/366120 (80%)]	lr:3.33e-05	Loss: 0.020859
[2024-04-21 19:14:09,735] {train_model:82} INFO - Train Epoch: 46 [329216/366120 (90%)]	lr:3.33e-05	Loss: 0.017483
[2024-04-21 19:14:23,339] {train_model:82} INFO - Train Epoch: 46 [365824/366120 (100%)]	lr:3.33e-05	Loss: 0.081155
[2024-04-21 19:14:29,105] {run_experiment:78} INFO - 
[2024-04-21 19:14:29,106] {result_logger:97} INFO - scores for sleep stages on dataset: train
[2024-04-21 19:14:29,773] {result_logger:103} INFO - precision on Wake: 0.994
[2024-04-21 19:14:30,199] {result_logger:104} INFO - recall on Wake: 0.992
[2024-04-21 19:14:30,626] {result_logger:107} INFO - F1-score on Wake: 0.993
[2024-04-21 19:14:30,626] {result_logger:108} INFO - 
[2024-04-21 19:14:31,265] {result_logger:103} INFO - precision on Non REM: 0.989
[2024-04-21 19:14:31,681] {result_logger:104} INFO - recall on Non REM: 0.988
[2024-04-21 19:14:32,098] {result_logger:107} INFO - F1-score on Non REM: 0.989
[2024-04-21 19:14:32,098] {result_logger:108} INFO - 
[2024-04-21 19:14:32,694] {result_logger:103} INFO - precision on REM: 0.964
[2024-04-21 19:14:33,056] {result_logger:104} INFO - recall on REM: 0.996
[2024-04-21 19:14:33,419] {result_logger:107} INFO - F1-score on REM: 0.980
[2024-04-21 19:14:33,419] {result_logger:108} INFO - 
[2024-04-21 19:14:33,516] {result_logger:111} INFO - average precision on sleep stages: 0.982
[2024-04-21 19:14:33,611] {result_logger:113} INFO - average recall on sleep stages: 0.992
[2024-04-21 19:14:33,707] {result_logger:115} INFO - average F1-score on sleep stages: 0.987
[2024-04-21 19:14:33,708] {result_logger:97} INFO - scores for sleep stages on dataset: valid
[2024-04-21 19:14:33,792] {result_logger:103} INFO - precision on Wake: 0.975
[2024-04-21 19:14:33,843] {result_logger:104} INFO - recall on Wake: 0.982
[2024-04-21 19:14:33,893] {result_logger:107} INFO - F1-score on Wake: 0.978
[2024-04-21 19:14:33,894] {result_logger:108} INFO - 
[2024-04-21 19:14:33,976] {result_logger:103} INFO - precision on Non REM: 0.971
[2024-04-21 19:14:34,027] {result_logger:104} INFO - recall on Non REM: 0.954
[2024-04-21 19:14:34,077] {result_logger:107} INFO - F1-score on Non REM: 0.962
[2024-04-21 19:14:34,077] {result_logger:108} INFO - 
[2024-04-21 19:14:34,160] {result_logger:103} INFO - precision on REM: 0.886
[2024-04-21 19:14:34,209] {result_logger:104} INFO - recall on REM: 0.936
[2024-04-21 19:14:34,258] {result_logger:107} INFO - F1-score on REM: 0.910
[2024-04-21 19:14:34,258] {result_logger:108} INFO - 
[2024-04-21 19:14:34,268] {result_logger:111} INFO - average precision on sleep stages: 0.944
[2024-04-21 19:14:34,278] {result_logger:113} INFO - average recall on sleep stages: 0.957
[2024-04-21 19:14:34,288] {result_logger:115} INFO - average F1-score on sleep stages: 0.950
[2024-04-21 19:14:34,288] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: train
[2024-04-21 19:14:34,355] {result_logger:134} INFO - 
[[202087   1534    126]
 [  1097 142101    569]
 [    22     44  18540]]
[2024-04-21 19:14:34,420] {result_logger:141} INFO - 
[[ 99.19%   0.75%   0.06%]
 [  0.76%  98.84%   0.40%]
 [  0.12%   0.24%  99.65%]]
[2024-04-21 19:14:34,487] {result_logger:145} INFO - 
[[ 99.45%   1.07%   0.66%]
 [  0.54%  98.90%   2.96%]
 [  0.01%   0.03%  96.39%]]
[2024-04-21 19:14:34,487] {result_logger:130} INFO - confusion matrix for sleep stages on dataset: valid
[2024-04-21 19:14:34,494] {result_logger:134} INFO - 
[[27872   456    54]
 [  700 19750   253]
 [   20   143  2382]]
[2024-04-21 19:14:34,502] {result_logger:141} INFO - 
[[ 98.20%   1.61%   0.19%]
 [  3.38%  95.40%   1.22%]
 [  0.79%   5.62%  93.60%]]
[2024-04-21 19:14:34,509] {result_logger:145} INFO - 
[[ 97.48%   2.24%   2.01%]
 [  2.45%  97.06%   9.41%]
 [  0.07%   0.70%  88.58%]]
[2024-04-21 19:14:34,601] {result_logger:74} INFO - transformation matrix for sleep stages on dataset: valid
[2024-04-21 19:14:34,601] {result_logger:77} INFO - actual:
[2024-04-21 19:14:34,601] {result_logger:78} INFO - 
[[95.61%  4.39%  0.00%]
 [ 4.13% 93.46%  2.41%]
 [15.36%  4.28% 80.35%]]
[2024-04-21 19:14:34,601] {result_logger:79} INFO - predicted:
[2024-04-21 19:14:34,601] {result_logger:80} INFO - 
[[95.05%  4.84%  0.12%]
 [ 4.84% 92.66%  2.50%]
 [16.07%  4.09% 79.84%]]
[2024-04-21 19:14:34,601] {run_experiment:112} INFO - [epoch  46] execution time: 151.71s	 avg f1-score: 0.9503

[2024-04-21 19:14:34,807] {result_logger:56} INFO - final F1-scores on train:
	Wake                : [0.5114395755751671, 0.7215347780848279, 0.8366130823905689, 0.8781650386202151, 0.9185769415226038, 0.9453484992634802, 0.9542238123633472, 0.9603406326034063, 0.9644816260767181, 0.9673942346932467, 0.9705410277304491, 0.9722918060056222, 0.973735658287091, 0.9756024207762755, 0.9763376058470477, 0.9778020754837788, 0.9783744210295383, 0.979215076523509, 0.9800418977202712, 0.980627142688261, 0.9810375283008177, 0.9820021029147777, 0.9826357092921355, 0.9834562850609343, 0.9837905973647412, 0.9842138041211991, 0.9852204624604668, 0.9858759773484048, 0.9862869431915768, 0.9868984674282368, 0.9874384963589845, 0.9878013975002461, 0.988456155282299, 0.9891782877099782, 0.9893684536782396, 0.9899162763250101, 0.9904276094110471, 0.9906361883778574, 0.9910902627192401, 0.991545736361692, 0.9919418673825082, 0.9922118533232375, 0.9922641068816757, 0.9928743661528705, 0.9929160992827611, 0.9931712015883897]
	Non REM             : [0.6448882021619513, 0.7929708573725933, 0.8430108772793766, 0.865425591163715, 0.9012023737366619, 0.9249052257953857, 0.9326114462674151, 0.9399745909420897, 0.9432782585890375, 0.9464694038343692, 0.9499395405078598, 0.9521337420988754, 0.9535232383808097, 0.9555383282411418, 0.9571117170032172, 0.9587969249446497, 0.960025489571334, 0.9611889900030124, 0.9626687180921744, 0.9638423535010007, 0.9646203983439633, 0.9665522376580973, 0.9679676495978918, 0.9693897159787709, 0.9700202471549256, 0.9712429066999838, 0.9729237404950429, 0.9746428982334053, 0.9752378560866047, 0.976608187134503, 0.9777937312246903, 0.9786484180466315, 0.9796872278917488, 0.9810922540582522, 0.9815902232215892, 0.9826937337460008, 0.9835522538666296, 0.9840282272376142, 0.9848945121251031, 0.9857750311432172, 0.9863985107604517, 0.986905548791094, 0.9871021600751331, 0.9881118005509334, 0.9881087773847657, 0.988714402009421]
	REM                 : [0.14384743264013047, 0.32982472908875854, 0.4718639612256633, 0.5916984158812914, 0.6892417298377462, 0.7598199672667758, 0.7819872646479453, 0.8038558256496228, 0.8180205415499533, 0.8311216056670602, 0.8445715647717793, 0.8486668096361427, 0.858398156150965, 0.8648453310205261, 0.8707321791275753, 0.8766124918008892, 0.8822150600644595, 0.8856368034008452, 0.8957294495186374, 0.898970398970399, 0.9033681132122233, 0.9100526460241024, 0.918244039411337, 0.9212008448154481, 0.9254975250025255, 0.9299815007222322, 0.9337633971656424, 0.9421305771592304, 0.9415765385697118, 0.9489719770463961, 0.9509970629154428, 0.9549088086922779, 0.9577384499779753, 0.9597341571691893, 0.9629629629629629, 0.9663255716821552, 0.9673540866201417, 0.9688367464515791, 0.9711137347500985, 0.973398807804417, 0.97400856744895, 0.9746435898784785, 0.9756753195414416, 0.9786998178794838, 0.9786953193062119, 0.9798895378029121]
	avg                 : [0.43339173679241627, 0.6147767881820599, 0.7171626402985364, 0.7784296818884071, 0.8363403483656707, 0.8766912307752138, 0.8896075077595692, 0.9013903497317063, 0.9085934754052363, 0.9149950813982253, 0.921684044336696, 0.9243641192468801, 0.9285523509396217, 0.9319953600126478, 0.9347271673259466, 0.9377371640764393, 0.9402049902217774, 0.9420136233091222, 0.9461466884436943, 0.9478132983865536, 0.9496753466190014, 0.9528689955323258, 0.9562824661004549, 0.9580156152850511, 0.9597694565073974, 0.9618127371811384, 0.963969200040384, 0.9675498175803469, 0.9677004459492978, 0.9708262105363786, 0.9720764301663726, 0.9737862080797184, 0.9752939443840077, 0.97666823297914, 0.9779738799542638, 0.979645193917722, 0.9804446499659395, 0.9811670540223503, 0.982366169864814, 0.9835731917697754, 0.9841163151973032, 0.9845869973309367, 0.9850138621660834, 0.9865619948610959, 0.9865733986579128, 0.9872583804669075]
[2024-04-21 19:14:34,807] {result_logger:56} INFO - final F1-scores on valid:
	Wake                : [0.755362476242194, 0.8403575602130793, 0.7586451851220414, 0.7331132995710679, 0.7753905978751475, 0.8502963386383465, 0.8899872948465809, 0.9409403868110576, 0.9357375091234821, 0.9667082009792738, 0.9715827964478495, 0.9688938680483834, 0.9642788854316953, 0.9705923589204347, 0.9745208489562441, 0.972728705795807, 0.9761384463555618, 0.9746614546977524, 0.9783361152595976, 0.9794539825499577, 0.9762000948483305, 0.9780473612751927, 0.9764515675523688, 0.9765377747131314, 0.9809538911499903, 0.9774804120080993, 0.9791589721943755, 0.9774502061946126, 0.9806742047233018, 0.9794086589229145, 0.9788130386701539, 0.9778801519201012, 0.9805797917253026, 0.9783354332913342, 0.980636310874268, 0.9771131704577365, 0.9798315485924284, 0.9782555239400007, 0.9783720153908323, 0.9797283029492503, 0.9794303797468354, 0.9794515719723672, 0.9787114254548013, 0.9784167591662704, 0.9786897630048665, 0.9784112051111034]
	Non REM             : [0.464748307329997, 0.6957302535839242, 0.428490244364463, 0.20956660761353324, 0.37386769146307985, 0.6848559749025573, 0.8716110602058966, 0.9030681227249089, 0.8675669788717055, 0.9411941194119412, 0.9445583162525621, 0.946182107040016, 0.9364077179513082, 0.945239343771069, 0.9496725352989517, 0.9487166732988461, 0.9581814599546843, 0.9489676471320764, 0.9578135743050781, 0.9590030968883646, 0.9565516563452275, 0.9562766531052399, 0.9579361179361179, 0.960528874197939, 0.9624716525640713, 0.9625472733927047, 0.9624731602576616, 0.9588845718782274, 0.9628706215932145, 0.9609298691150614, 0.9618600557429955, 0.9595519906094102, 0.962912356041382, 0.9612691573226265, 0.9648003894839338, 0.9579646559964705, 0.9630767729977564, 0.9612270776433867, 0.9614298237070226, 0.9638805897641429, 0.9637520415376739, 0.9645654968349058, 0.9630729534334608, 0.9617834394904459, 0.9620042977143973, 0.9621942901685666]
	REM                 : [0.3458631256384065, 0.6652208201892744, 0.6127488810001543, 0.6212121212121211, 0.6896072297532152, 0.7743540669856459, 0.5700816373462113, 0.7171861595653418, 0.7932138284250959, 0.7983447397739933, 0.8571428571428571, 0.8432210634296461, 0.8156479217603911, 0.8122866894197952, 0.8604651162790699, 0.8353750629300218, 0.8430311231393777, 0.8544358311800172, 0.87706813734211, 0.8697170799860287, 0.8795031055900622, 0.8664926022628373, 0.8723479490806224, 0.8810509267590427, 0.8929741536221333, 0.8894160583941606, 0.9004984308657928, 0.8857193795685506, 0.8993068223276176, 0.8972303206997085, 0.9059194655780294, 0.8951965065502184, 0.9005158437730287, 0.9123339658444023, 0.9080999812065401, 0.8944393801276207, 0.9047353760445682, 0.9059796916133885, 0.9107109004739335, 0.9127873836215086, 0.9064775060668283, 0.9089877010406812, 0.9043250327653997, 0.8996088657105606, 0.8995730462223872, 0.9102025219717234]
	avg                 : [0.5219913030701991, 0.7337695446620925, 0.5999614368288863, 0.5212973427989074, 0.6129551730304809, 0.7698354601755165, 0.7772266641328963, 0.8537315563671027, 0.8655061054734278, 0.9020823533884027, 0.9244279899477563, 0.9194323461726818, 0.9054448417144648, 0.909372797370433, 0.9282195001780886, 0.9189401473415583, 0.9257836764832078, 0.9260216443366153, 0.9377392756355952, 0.9360580531414503, 0.9374182855945401, 0.93360553888109, 0.9355785448563697, 0.9393725252233711, 0.9454665657787317, 0.9431479145983216, 0.9473768544392766, 0.9406847192137969, 0.9476172162147113, 0.9458562829125615, 0.9488641866637263, 0.9442095496932433, 0.9480026638465712, 0.950646185486121, 0.9511788938549138, 0.9431724021939426, 0.949214565878251, 0.9484874310655921, 0.9501709131905961, 0.952132092111634, 0.9498866424504459, 0.951001589949318, 0.9487031372178872, 0.946603021455759, 0.9467557023138836, 0.9502693390837976]
[2024-04-21 19:14:34,903] {logger:50} INFO - 
[2024-04-21 19:14:34,904] {logger:51} INFO - ================================================================================
[2024-04-21 19:14:34,904] {logger:52} INFO - finished training
[2024-04-21 19:14:34,904] {logger:53} INFO - ================================================================================
[2024-04-21 19:14:34,904] {logger:54} INFO - 
[2024-04-21 19:14:34,904] {logger:50} INFO - 
[2024-04-21 19:14:34,904] {logger:51} INFO - ================================================================================
[2024-04-21 19:14:34,904] {logger:52} INFO - best model on epoch: 40 	f1-score: 0.9521
[2024-04-21 19:14:34,904] {logger:53} INFO - ================================================================================
[2024-04-21 19:14:34,904] {logger:54} INFO - 
